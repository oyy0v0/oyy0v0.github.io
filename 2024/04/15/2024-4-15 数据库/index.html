<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>数据库 | oyy0v0😼</title><meta name="author" content="oyy0v0"><meta name="copyright" content="oyy0v0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="知识分享">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库">
<meta property="og:url" content="https://oyy0v0.top/2024/04/15/2024-4-15%20%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="oyy0v0😼">
<meta property="og:description" content="知识分享">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg">
<meta property="article:published_time" content="2024-04-15T00:31:00.000Z">
<meta property="article:modified_time" content="2025-10-19T18:09:29.454Z">
<meta property="article:author" content="oyy0v0">
<meta property="article:tag" content="-数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg"><link rel="shortcut icon" href="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E7%8C%AB.svg"><link rel="canonical" href="https://oyy0v0.top/2024/04/15/2024-4-15%20%E6%95%B0%E6%8D%AE%E5%BA%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据库',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-20 02:09:29'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4658720_723un29n3vn.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/readPercent.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="oyy0v0😼"><span class="site-name">oyy0v0😼</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数据库</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-15T00:31:00.000Z" title="发表于 2024-04-15 08:31:00">2024-04-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-19T18:09:29.454Z" title="更新于 2025-10-20 02:09:29">2025-10-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">33.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>118分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数据库"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="数据库基本概念"><a href="#数据库基本概念" class="headerlink" title="数据库基本概念"></a>数据库基本概念</h1><p>（1）数据<br>所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。</p>
<p>（2）数据库<br>数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据集合。</p>
<p>（3）数据库管理系统<br>数据库管理系统（Database Management System，DBMS）是用来定义和管理数据的软件。如何科学的组织和存储数据，如何高效的获取和维护数据，如何保证数据的安全性和完整性，这些都需要靠数据库管理系统完成。目前，比较流行的数据库管理系统有：Oracle、MySQL、SQL Server、DB2等。</p>
<p>（4）数据库应用程序<br>数据库应用程序（Database Application System，DBAS）是在数据库管理系统基础上，使用数据库管理系统的语法，开发的直接面对最终用户的应用程序，如学生管理系统、人事管理系统、图书管理系统等。</p>
<p>（5）数据库管理员<br>数据库管理员（Database Administrator，DBA）是指对数据库管理系统进行操作的人员，其主要负责数据库的运营和维护。</p>
<p>（6）最终用户<br>最终用户（User）指的是数据库应用程序的使用者。用户面向的是数据库应用程序（通过应用程序操作数据），并不会直接与数据库打交道。</p>
<p>（7） 数据库系统<br>数据库系统（Database System，DBS）一般是由数据库、数据库管理系统、数据库应用程序、数据库管理员和最终用户构成。其中DBMS是数据库系统的基础和核心。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805003523928.png" alt="image-20240805003523928"></p>
<h1 id="数据库类型"><a href="#数据库类型" class="headerlink" title="数据库类型"></a>数据库类型</h1><p>【1】数据库类型<br>数据库经过几十年的发展，出现了多种类型。根据数据的组织结构不同，主要分为网状数据库、层次数据库、关系型数据库和非关系型数据库四种。目前最常见的数据库模型主要是：关系型数据库和非关系型数据库。</p>
<ol>
<li>关系型数据库<br>关系型数据库模型是将复杂的数据结构用较为简单的二元关系（二维表）来表示，如图1-4所示。在该类型数据库中，对数据的操作基本上都建立在一个或多个表格上，我们可以采用结构化查询语言（SQL）对数据库进行操作。关系型数据库是目前主流的数据库技术，其中具有代表性的数据库管理系统有：Oracle、DB2、SQL Server、MySQL等。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805003603671.png" alt="image-20240805003603671"></p>
<p>PS：关系=二维表</p>
<ol>
<li>非关系型数据库NOSQL<br>NOSQL（Not Only SQL）泛指非关系型数据库。关系型数据库在超大规模和高并发的web2.0纯动态网站已经显得力不从心，暴露了很多难以克服的问题。NOSQL数据库的产生就是为了解决大规模数据集合多重数据种类带来的挑战，尤其是大数据应用难题。常见的非关系型数据库管理系统有Memcached、MongoDB，redis，HBase等。 </li>
</ol>
<p>【2】常见的关系型数据库<br>虽然非关系型数据库的优点很多，但是由于其并不提供SQL支持、学习和使用成本较高并且无事务处理，所以本书的重点是关系型数据库。下面我们将介绍一下常用的关系型数据库管理系统。</p>
<ol>
<li>Oracle<br>Oracle数据库是由美国的甲骨文（Oracle）公司开发的世界上第一款支持SQL语言的关系型数据库。经过多年的完善与发展，Oracle数据库已经成为世界上最流行的数据库，也是甲骨文公司的核心产品。<br>Oracle数据库具有很好的开放性，能在所有的主流平台上运行，并且性能高、安全性高、风险低；但是其对硬件的要求很高、管理维护和操作比较复杂而且价格昂贵，所以一般用在满足对银行、金融、保险等行业大型数据库的需求上。</li>
<li>DB2<br>DB2是IBM公司著名的关系型数据库产品。DB2无论稳定性，安全性，恢复性等等都无可挑剔，而且从小规模到大规模的应用都可以使用，但是用起来非常繁琐，比较适合大型的分布式应用系统。</li>
<li>SQL Server<br>SQL Server是由Microsoft开发和推广的关系型数据库，SQL Server的功能比较全面、效率高，可以作为中型企业或单位的数据库平台。SQL Server可以与Windows操作系统紧密继承，无论是应用程序开发速度还是系统事务处理运行速度，都能得到大幅度提升。但是，SQL Server只能在Windows系统下运行，毫无开放性可言。</li>
<li>MySQL<br>MySQL是一种开放源代码的轻量级关系型数据库，MySQL数据库使用最常用的结构化查询语言（SQL）对数据库进行管理。由于MySQL是开放源代码的，因此任何人都可以在General Public License的许可下下载并根据个人需要对其缺陷进行修改。<br>由于MySQL数据库体积小、速度快、成本低、开放源码等优点，现已被广泛应用于互联网上的中小型网站中，并且大型网站也开始使用MySQL数据库，如网易、新浪等。  </li>
</ol>
<h1 id="MYSQL介绍"><a href="#MYSQL介绍" class="headerlink" title="MYSQL介绍"></a>MYSQL介绍</h1><ol>
<li><p>MySQL数据库最初是由瑞典MySQL AB公司开发，2008年1月16号被Sun公司收购。2009年，SUN又被Oracle收购。MySQL是目前IT行业最流行的开放源代码的数据库管理系统，同时它也是一个支持多线程高并发多用户的关系型数据库管理系统。MySQL之所以受到业界人士的青睐，主要是因为其具有以下几方面优点：</p>
<ol>
<li><p>开放源代码</p>
<p>MySQL最强大的优势之一在于它是一个开放源代码的数据库管理系统。开源的特点是给予了用户根据自己需要修改DBMS的自由。MySQL采用了General Public License，这意味着授予用户阅读、修改和优化源代码的权利，这样即使是免费版的MySQL的功能也足够强大，这也是为什么MySQL越来越受欢迎的主要原因。</p>
</li>
<li><p>跨平台</p>
<p>MySQL可以在不同的操作系统下运行，简单地说，MySQL可以支持Windows系统、UNIX系统、Linux系统等多种操作系统平台。这意味着在一个操作系统中实现的应用程序可以很方便地移植到其他的操作系统下。</p>
</li>
<li><p>轻量级</p>
<p>MySQL的核心程序完全采用多线程编程，这些线程都是轻量级的进程，它在灵活地为用户提供服务的同时，又不会占用过多的系统资源。因此MySQL能够更快速、高效的处理数据。</p>
</li>
<li><p>成本低</p>
<p>MySQL分为社区版和企业版，社区版是完全免费的，而企业版是收费的。即使在开发中需要用到一些付费的附加功能，价格相对于昂贵的Oracle、DB2等也是有很大优势的。其实免费的社区版也支持多种数据类型和正规的SQL查询语言，能够对数据进行各种查询、增加、删除、修改等操作，所以一般情况下社区版就可以满足开发需求了，而对数据库可靠性要求比较高的企业可以选择企业版。<br>另外，PHP中提供了一整套的MySQL函数，对MySQL进行了全方位的强力支持。<br>总体来说，MySQL是一款开源的、免费的、轻量级的关系型数据库，其具有体积小、速度快、成本低、开放源码等优点，其发展前景是无可限量的。 </p>
</li>
</ol>
<p>PS：社区版与企业版主要的区别是：</p>
<ol>
<li><p>社区版包含所有MySQL的最新功能，而企业版只包含稳定之后的功能。换句话说，社区版可以理解为是企业版的测试版。 </p>
<p>2.MySQL官方的支持服务只是针对企业版，如果用户在使用社区版时出现了问题，MySQL官方是不负责任的。  </p>
</li>
</ol>
</li>
</ol>
<h1 id="MYSQL下载安装"><a href="#MYSQL下载安装" class="headerlink" title="MYSQL下载安装"></a>MYSQL下载安装</h1><p>【2】官方下载地址：<br><a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/windows/installer/8.0.html">https://dev.mysql.com/downloads/windows/installer/8.0.html</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805003816355.png" alt="image-20240805003816355"></p>
<p>【3】安装过程：<br>1.双击MySQL安装文件mysql-installer-community-8.0.18.0.msi，出现安装类型选项。<br>² Developer Default：开发者默认</p>
<p>² Server only：只安装服务器端 </p>
<p>² Client only：只安装客户端</p>
<p>² Full：安装全部选项</p>
<p>² Custom：自定义安装</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805004011376.png" alt="image-20240805004011376"></p>
<p>设置用户名和密码之后一直next就好了</p>
<h1 id="检验安装成果"><a href="#检验安装成果" class="headerlink" title="检验安装成果"></a>检验安装成果</h1><p>1)安装了Windows Service：MySQL80，并且已经启动。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805075716739.png" alt="image-20240805075716739"></p>
<p>2)安装了MySQL软件。安装位置为：C:\Program Files\MySQL。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805075834868.png" alt="image-20240805075834868"></p>
<p>MySQL文件下放的是软件的内容）<br>3)安装了MySQL数据文件夹，用来存放MySQL基础数据和以后新增的数据。安装位置为C:\ProgramData\MySQL\MySQL Server 8.0。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805075926277.png" alt="image-20240805075926277"></p>
<p>（ProgramData文件夹可能是隐藏的，显示出来即可）<br>（MySQL文件下的内容才是真正的MySQL中数据）<br>4)在MySQL数据文件夹中有MySQL的配置文件：my.ini。它是MySQL数据库中使用的配置文件，修改这个文件可以达到更新配置的目的。以下几个配置项需要大家特别理解。</p>
<p>port=3306：监听端口是3306</p>
<p>² basedir=”C:/Program Files/MySQL/MySQL Server 8.0/“：软件安装位置</p>
<p>² datadir=C:/ProgramData/MySQL/MySQL Server 8.0/Data：数据文件夹位置</p>
<p>² default_authentication_plugin=caching_sha2_password：默认验证插件</p>
<p>² default-storage-engine=INNODB：默认存储引擎</p>
<p>（这些内容在Linux下可能会手动更改）</p>
<h1 id="MYSQL登录、访问、退出操作"><a href="#MYSQL登录、访问、退出操作" class="headerlink" title="MYSQL登录、访问、退出操作"></a>MYSQL登录、访问、退出操作</h1><p>需要配置环境变量path:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805080100928.png" alt="image-20240805080100928"></p>
<p>注意：控制命令台必须重启才会生效：</p>
<p>登录的命令：mysql  -hlocalhost -uroot –p<br>² mysql：bin目录下的文件mysql.exe。mysql是MySQL的命令行工具，是一个客户端软件，可以对任何主机的mysql服务（即后台运行的mysqld）发起连接。</p>
<p>² -h：host主机名。后面跟要访问的数据库服务器的地址；如果是登录本机，可以省略</p>
<p>² -u：user 用户名。后面跟登录数据的用户名，第一次安装后以root用户来登录，是MySQL的管理员用户</p>
<p>² -p:   password 密码。一般不直接输入，而是回车后以保密方式输入。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805080125959.png" alt="image-20240805080125959"></p>
<p>【2】访问数据库</p>
<p>显示MySQL中的数据库列表：show databases; 默认有四个自带的数据库，每个数据库中可以有多个数据库表、视图等对象。</p>
<p>切换当前数据库的命令：use mysql;<br>² MySQL下可以有多个数据库，如果要访问哪个数据库，需要将其置为当前数据库。</p>
<p>² 该命令的作用就是将数据库mysql（默认提供的四个数据库之一的名字）置为当前数据库</p>
<p>显示当前数据库的所有数据库表：show tables;</p>
<p>MySQL 层次：不同项目对应不同的数据库组成 - 每个数据库中有很多表  - 每个表中有很多数据</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805080253453.png" alt="image-20240805080253453"></p>
<p>【3】退出数据库</p>
<p>退出数据库可以使用quit或者exit命令完成，也可以用\q;  完成退出操作</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805080308209.png" alt="image-20240805080308209"></p>
<h1 id="安装navicat连接MySQL"><a href="#安装navicat连接MySQL" class="headerlink" title="安装navicat连接MySQL"></a>安装navicat连接MySQL</h1><p>首先登录mysql然后进行设置</p>
<p>设置密码永不过期<br>alter user ‘root’@’localhost’ identified by ‘root’ password expire never;<br>设置加密规则为mysql_native_password<br>alter user ‘root’@’localhost’ identified with mysql_native_password by ‘root’;<br>重新访问navicat，提示连接成功。</p>
<h1 id="SQL语言"><a href="#SQL语言" class="headerlink" title="SQL语言"></a>SQL语言</h1><p>SQL语言分为五个部分：</p>
<p>数据查询语言（Data Query Language，DQL）：DQL主要用于数据的查询，其基本结构是使用SELECT子句，FROM子句和WHERE子句的组合来查询一条或多条数据。<br>数据操作语言（Data Manipulation Language，DML）：DML主要用于对数据库中的数据进行增加、修改和删除的操作，其主要包括：<br>                                        1) INSERT：增加数据<br>                                                                                2) UPDATE：修改数据<br>                                                                                3) DELETE：删除数据<br>                                                                                数据定义语言（Data Definition Language，DDL）：DDL主要用针对是数据库对象（数据库、表、索引、视图、触发器、存储过程、函数）进行创建、修改和删除操作。其主要包括：<br>                                                                                                                        1) CREATE：创建数据库对象<br>                                                                                                                                                                2) ALTER：修改数据库对象<br>                                                                                                                                                                3) DROP：删除数据库对象<br>                                                                                                                         数据控制语言（Data Control Language，DCL）：DCL用来授予或回收访问 数据库的权限，其主要包括：<br>                                                                                                                                                                                                           1) GRANT：授予用户某种权限</p>
<p> 事务控制语言（Transaction Control Language，TCL）：TCL用于数据库的事务管理。其主要包括：<br>                                        1) START TRANSACTION：开启事务<br>                                                                                2) COMMIT：提交事务<br>                                                                                   3) ROLLBACK：回滚事务</p>
<h1 id="DDLDML创建数据库表"><a href="#DDLDML创建数据库表" class="headerlink" title="DDLDML创建数据库表"></a>DDL<em>DML</em>创建数据库表</h1><p>【1】认识数据库表<br>表（Table）是数据库中数据存储最常见和最简单的一种形式，数据库可以将复杂的数据结构用较为简单的二维表来表示。二维表是由行和列组成的，分别都包含着数据，如表所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805081810678.png" alt="image-20240805081810678"></p>
<p>每个表都是由若干行和列组成的，在数据库中表中的行被称为记录，表中的列被称为是这些记录的字段。</p>
<p>记录也被称为一行数据，是表里的一行。在关系型数据库的表里，一行数据是指一条完整的记录。</p>
<p>字段是表里的一列，用于保存每条记录的特定信息。如上表所示的学生信息表中的字段包括“学号”、“姓名”、“性别”和“年龄”。数据表的一列包含了某个特定字段的全部信息。 </p>
<p>【2】创建数据库表 t_student<br>建立一张用来存储学生信息的表<br>字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息<br>学号是主键 = 不能为空 +  唯一<br>姓名不能为空<br>性别默认值是男<br>Email唯一</p>
<p>（1）创建数据库：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805081909538.png" alt="image-20240805081909538"></p>
<p>（2）新建查询：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805081931605.png" alt="image-20240805081931605"></p>
<p>（3）创建数据库表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">##这是一个单行注释</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">建立一张用来存储学生信息的表</span></span><br><span class="line"><span class="comment">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- 创建数据库表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>), <span class="comment">-- 6显示长度 </span></span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>), <span class="comment">-- 5个字符</span></span><br><span class="line">        sex <span class="type">char</span>(<span class="number">1</span>),</span><br><span class="line">        age <span class="type">int</span>(<span class="number">3</span>),</span><br><span class="line">        enterdate <span class="type">date</span>,</span><br><span class="line">        classname <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        email <span class="type">varchar</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 查看表的结构：展示表的字段详细信息</span></span><br><span class="line"><span class="keyword">desc</span> t_student;</span><br><span class="line"><span class="comment">-- 查看表中数据：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="comment">-- 查看建表语句：</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create table</span> t_student;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">CREATE TABLE `t_student` (</span></span><br><span class="line"><span class="comment">  `sno` int DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `sname` varchar(5) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `sex` char(1) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `age` int DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `enterdate` date DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `classname` varchar(10) DEFAULT NULL,</span></span><br><span class="line"><span class="comment">  `email` varchar(15) DEFAULT NULL</span></span><br><span class="line"><span class="comment">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="数据库表列类型"><a href="#数据库表列类型" class="headerlink" title="数据库表列类型"></a>数据库表列类型</h1><p>1、整数类型</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805082228223.png" alt="image-20240805082228223"></p>
<p>M<strong>ySQL支持选择在该类型关键字后面的括号内指定整数值的显示宽度</strong>(例如，INT(4))。显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示<br>主键自增：不使用序列，通过auto_increment，要求是整数类型</p>
<p>2、浮点数类型</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805082246014.png" alt="image-20240805082246014"></p>
<p>需要注意的是与整数类型不一样的是，浮点数类型的宽度不会自动扩充。 score double(4,1)<br> score double(4,1)—小数部分为1位，总宽度4位，并且不会自动扩充。</p>
<p>3.字符串类型</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805082357028.png" alt="image-20240805082357028"></p>
<p>CHAR和VARCHAR类型相似，均用于存于较短的字符串，主要的不同之处在于存储方式。</p>
<p><strong>CHAR类型长度固定，VARCHAR类型的长度可变。</strong></p>
<p><strong>CHAR的长度固定，即使字符长度小于定义长度，也会在字符串末尾填充空格。</strong></p>
<p><strong>VARCHAR需要记录额外长度信息，占据1~2字节</strong></p>
<p><strong>UTF-8字符集，每个字符最大占用3字节，所以VARCHAR支持的最大长度是65535-2=65533，然后最大字符就是65533 / 3 = 21844</strong></p>
<p>因为VARCHAR类型能够根据字符串的实际长度来动态改变所占字节的大小，所以在不能明确该字段具体需要多少字符时推荐使用VARCHAR类型，这样可以大大地节约磁盘空间、提高存储效率。<br>CHAR和VARCHAR表示的是字符的个数，而不是字节的个数</p>
<p>4.日期和时间类型</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805082857685.png" alt="image-20240805082857685"></p>
<p>TIMESTEMP类型的数据指定方式与DATETIME基本相同，两者的不同之处在于以下几点：<br>(1) 数据的取值范围不同，TIMESTEMP类型的取值范围更小。<br>(2) 如果我们对TIMESTAMP类型的字段没有明确赋值，或是被赋与了NULL值，MySQL会自动将该字段赋值为系统当前的日期与时间。<br>(3) TIMESTEMP类型还可以使用CURRENT_TIMESTAMP来获取系统当前时间。<br>(4) TIMESTEMP类型有一个很大的特点，那就是时间是根据时区来显示的。例如，在东八区插入的TIMESTEMP数据为2017-07-11 16:43:25，在东七区显示时，时间部分就变成了15:43:25，在东九区显示时，时间部分就变成了17:43:25。 </p>
<h1 id="DML-添加数据"><a href="#DML-添加数据" class="headerlink" title="DML_添加数据"></a>DML_添加数据</h1><p>注意事项<br>int  宽度是显示宽度，如果超过，可以自动增大宽度 int底层都是4个字节<br>时间的方式多样  ‘1256-12-23’  “1256/12/23”  “1256.12.23”<br>字符串不区分单引号和双引号<br>如何写入当前的时间  now() , sysdate() , CURRENT_DATE()<br>char varchar 是字符的个数，不是字节的个数，可以使用binary，varbinary表示定长和不定长的字节个数。<br>如果不是全字段插入数据的话，需要加入字段的名字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看表记录：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="comment">-- 在t_student数据库表中插入数据：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2022-5-8&#x27;</span>,<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">10010010</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2022-5-8&#x27;</span>,<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">2</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2022.5.8&#x27;</span>,<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">2</span>,&quot;张三&quot;,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;2022.5.8&#x27;</span>,<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">7</span>,&quot;张三&quot;,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,now(),<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">9</span>,&quot;易烊千玺&quot;,<span class="string">&#x27;男&#x27;</span>,<span class="number">18</span>,now(),<span class="string">&#x27;软件1班&#x27;</span>,<span class="string">&#x27;123@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student (sno,sname,enterdate) <span class="keyword">values</span> (<span class="number">10</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;2023-7-5&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="DML-修改，删除数据"><a href="#DML-修改，删除数据" class="headerlink" title="DML_修改，删除数据"></a>DML_修改，删除数据</h1><p>注意事项<br>1.关键字，表名，字段名不区分大小写<br>2.默认情况下，内容不区分大小写<br>3.删除操作from关键字不可缺少<br>4.修改，删除数据别忘记加限制条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改表中数据</span></span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span> ;</span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">where</span> sno <span class="operator">=</span> <span class="number">10</span> ;</span><br><span class="line"><span class="keyword">UPDATE</span> T_STUDENT <span class="keyword">SET</span> AGE <span class="operator">=</span> <span class="number">21</span> <span class="keyword">WHERE</span> SNO <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> CLASSNAME <span class="operator">=</span> <span class="string">&#x27;java01&#x27;</span> <span class="keyword">where</span> sno <span class="operator">=</span> <span class="number">10</span> ;</span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> CLASSNAME <span class="operator">=</span> <span class="string">&#x27;JAVA01&#x27;</span> <span class="keyword">where</span> sno <span class="operator">=</span> <span class="number">9</span> ;</span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> age <span class="operator">=</span> <span class="number">29</span> <span class="keyword">where</span> classname <span class="operator">=</span> <span class="string">&#x27;java01&#x27;</span>;</span><br><span class="line"><span class="comment">-- 删除操作：</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> sno <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h1 id="表的完整性约束"><a href="#表的完整性约束" class="headerlink" title="表的完整性约束"></a>表的完整性约束</h1><p>为防止不符合规范的数据存入数据库，在用户对数据进行插入、修改、删除等操作时，MySQL提供了一种机制来检查数据库中的数据是否满足规定的条件，以保证数据库中数据的准确性和一致性，这种机制就是完整性约束。</p>
<p>MySQL中主要支持以下几种种完整性约束，如表所示。 其中Check约束是MySQL8中提供的支持。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805084728009.png" alt="image-20240805084728009"></p>
<h2 id="非外键约束"><a href="#非外键约束" class="headerlink" title="非外键约束"></a>非外键约束</h2><p>【1】代码演示非外键约束：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">建立一张用来存储学生信息的表</span></span><br><span class="line"><span class="comment">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span></span><br><span class="line"><span class="comment">约束：</span></span><br><span class="line"><span class="comment">建立一张用来存储学生信息的表</span></span><br><span class="line"><span class="comment">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span></span><br><span class="line"><span class="comment">【1】学号是主键 = 不能为空 +  唯一 ，主键的作用：可以通过主键查到唯一的一条记录【2】如果主键是整数类型，那么需要自增</span></span><br><span class="line"><span class="comment">【3】姓名不能为空</span></span><br><span class="line"><span class="comment">【4】Email唯一</span></span><br><span class="line"><span class="comment">【5】性别默认值是男</span></span><br><span class="line"><span class="comment">【6】性别只能是男女</span></span><br><span class="line"><span class="comment">【7】年龄只能在18-50之间</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- 创建数据库表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        sex <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">check</span>(sex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">        age <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">check</span>(age<span class="operator">&gt;=</span><span class="number">18</span> <span class="keyword">and</span> age<span class="operator">&lt;=</span><span class="number">50</span>),</span><br><span class="line">        enterdate <span class="type">date</span>,</span><br><span class="line">        classname <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        email <span class="type">varchar</span>(<span class="number">15</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据：</span></span><br><span class="line"><span class="comment">--  1048 - Column &#x27;sname&#x27; cannot be null 不能为null</span></span><br><span class="line"><span class="comment">-- 3819 - Check constraint &#x27;t_student_chk_1&#x27; is violated. 违反检查约束</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;zs@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 1062 - Duplicate entry &#x27;1&#x27; for key &#x27;t_student.PRIMARY&#x27; 主键重复</span></span><br><span class="line"><span class="comment">-- &gt; 1062 - Duplicate entry &#x27;ls@126.com&#x27; for key &#x27;t_student.email&#x27; 违反唯一约束</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">2</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;ls@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">3</span>,<span class="string">&#x27;露露&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;ls@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 如果主键没有设定值，或者用null.default都可以完成主键自增的效果</span></span><br><span class="line"><span class="keyword">insert into</span> t_student (sname,enterdate) <span class="keyword">values</span> (<span class="string">&#x27;菲菲&#x27;</span>,<span class="string">&#x27;2029-4-5&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;xm@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">default</span>,<span class="string">&#x27;小刚&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;xg@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 如果sql报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;oo@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查看数据：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>【2】约束从作用上可以分为两类：<br>(1)   表级约束：可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中；与定义用‘，’分隔；必须指出要约束的列的名称；</p>
<p>(2)   列级约束：包含在列定义中，直接跟在该列的其它定义之后 ，用空格分隔；不必指定列名；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除表：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="comment">-- 创建数据库表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        sex <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">        age <span class="type">int</span>(<span class="number">3</span>),</span><br><span class="line">        enterdate <span class="type">date</span>,</span><br><span class="line">        classname <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        email <span class="type">varchar</span>(<span class="number">15</span>),</span><br><span class="line">        <span class="keyword">constraint</span> pk_stu <span class="keyword">primary key</span> (sno),  <span class="comment">-- pk_stu 主键约束的名字</span></span><br><span class="line">        <span class="keyword">constraint</span> ck_stu_sex <span class="keyword">check</span> (sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">        <span class="keyword">constraint</span> ck_stu_age <span class="keyword">check</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span> <span class="number">50</span>),</span><br><span class="line">        <span class="keyword">constraint</span> uq_stu_email <span class="keyword">unique</span> (email)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;zs@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- &gt; 3819 - Check constraint &#x27;ck_stu_sex&#x27; is violated.</span></span><br><span class="line"><span class="comment">-- &gt; 3819 - Check constraint &#x27;ck_stu_age&#x27; is violated.</span></span><br><span class="line"><span class="comment">-- &gt; 1062 - Duplicate entry &#x27;zs@126.com&#x27; for key &#x27;t_student.uq_stu_email&#x27;</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="number">3</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;zs@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查看数据：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>
<p>【3】在创建表以后添加约束：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除表：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="comment">-- 创建数据库表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>), </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        sex <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">        age <span class="type">int</span>(<span class="number">3</span>),</span><br><span class="line">        enterdate <span class="type">date</span>,</span><br><span class="line">        classname <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        email <span class="type">varchar</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- &gt; 1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key</span></span><br><span class="line"><span class="comment">-- 错误的解决办法：就是auto_increment去掉</span></span><br><span class="line"><span class="comment">-- 在创建表以后添加约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> pk_stu <span class="keyword">primary key</span> (sno) ; <span class="comment">-- 主键约束</span></span><br><span class="line"><span class="keyword">alter table</span> t_student modify sno <span class="type">int</span>(<span class="number">6</span>) auto_increment; <span class="comment">-- 修改自增条件</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> ck_stu_sex <span class="keyword">check</span> (sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> ck_stu_age <span class="keyword">check</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span> <span class="number">50</span>);</span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> uq_stu_email <span class="keyword">unique</span> (email);</span><br><span class="line"><span class="comment">-- 查看表结构：</span></span><br><span class="line"><span class="keyword">desc</span> t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>验证约束添加成功：查看表结构：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805145052365.png" alt="image-20240805145052365"></p>
<p>【4】总结：</p>
<p>1.主键约束 </p>
<p>主键约束（PRIMARY KEY，缩写PK），是数据库中最重要的一种约束，其作用是约束表中的某个字段可以唯一标识一条记录。因此，使用主键约束可以快速查找表中的记录。就像人的身份证、学生的学号等等，设置为主键的字段取值不能重复（唯一），也不能为空（非空），否则无法唯一标识一条记录。</p>
<p>主键可以是单个字段，也可以是多个字段组合。对于单字段主键的添加可使用表级约束，也可以使用列级约束；而对于多字段主键的添加只能使用表级约束。</p>
<p>2.非空约束 </p>
<p>非空约束（NOT NULL，缩写NK）规定了一张表中指定的某个字段的值不能为空（NULL）。设置了非空约束的字段，在插入的数据为NULL时，数据库会提示错误，导致数据无法插入。</p>
<p>无论是单个字段还是多个字段非空约束的添加只能使用列级约束（非空约束无表级约束）</p>
<p>为已存在表中的字段添加非空约束 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter   table</span> student8 modify stu_sex <span class="type">varchar</span>(<span class="number">1</span>) <span class="keyword">not null</span>;</span><br></pre></td></tr></table></figure>
<p>使用ALTER TABLE语句删除非空约束 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter  table</span> student8 modify stu_sex <span class="type">varchar</span>(<span class="number">1</span>) <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>唯一约束</li>
</ol>
<p>唯一约束（UNIQUE，缩写UK）比较简单，它规定了一张表中指定的某个字段的值不能重复，即这一字段的每个值都是唯一的。如果想要某个字段的值不重复，那么就可以为该字段添加为唯一约束。</p>
<p>无论单个字段还是多个字段唯一约束的添加均可使用列级约束和表级约束</p>
<ol>
<li>检查约束</li>
</ol>
<p>检查约束（CHECK）用来限制某个字段的取值范围，可以定义为列级约束，也可以定义为表级约束。MySQL8开始支持检查约束。 </p>
<ol>
<li>默认值约束 </li>
</ol>
<p>默认值约束（DEFAULT）用来规定字段的默认值。如果某个被设置为DEFAULT约束的字段没插入具体值，那么该字段的值将会被默认值填充。</p>
<pre><code> 默认值约束的设置与非空约束一样，也只能使用列级约束。
</code></pre><ol>
<li>字段值自动增加约束</li>
</ol>
<p>自增约束（AUTO_INCREMENT）可以使表中某个字段的值自动增加。一张表中只能有一个自增长字段，并且该字段必须定义了约束（该约束可以是主键约束、唯一约束以及外键约束），如果自增字段没有定义约束，数据库则会提示“Incorrect table definition; there can be only one auto column and it must be defined as a key”错误。</p>
<p>由于自增约束会自动生成唯一的ID，所以自增约束通常会配合主键使用，并且只适用于整数类型。一般情况下，设置为自增约束字段的值会从1开始，每增加一条记录，该字段的值加1。</p>
<p>为已存在表中的字段添加自增约束 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建表student11*/</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">create   table</span> student11 (</span><br><span class="line"></span><br><span class="line">       stu_id <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">primary key</span>,</span><br><span class="line"></span><br><span class="line">       stu_name <span class="type">varchar</span>(<span class="number">3</span>),</span><br><span class="line"></span><br><span class="line">       stu_sex <span class="type">varchar</span> (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*为student11表中的主键字段添加自增约束*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">alter   table</span> student11 modify stu_id <span class="type">int</span>(<span class="number">10</span>) auto_increment;</span><br></pre></td></tr></table></figure>
<p>使用ALTER TABLE语句删除自增约束 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter   table</span> studen11 modify stu_id <span class="type">int</span>(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h2 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h2><p>【1】什么是外键约束？<br>外键约束（FOREIGN KEY，缩写FK）是用来实现数据库表的参照完整性的。外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。<br>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯一约束。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</p>
<p>举个例子：如果想要表示学生和班级的关系，首先要有学生表和班级表两张表，然后学生表中有个字段为stu_clazz（该字段表示学生所在的班级），而该字段的取值范围由班级表中的主键cla_no字段（该字段表示班级编号）的取值决定。那么班级表为主表，学生表为从表，且stu_clazz字段是学生表的外键。通过stu_clazz字段就建立了学生表和班级表的关系。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805145349710.png" alt="image-20240805145349710"></p>
<p>主表（父表）：班级表  -  班级编号 - 主键<br>从表（子表）：学生表 - 班级编号 - 外键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先创建父表：班级表：</span></span><br><span class="line"><span class="keyword">create table</span> t_class(</span><br><span class="line">        cno <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">        cname <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>,</span><br><span class="line">        room <span class="type">char</span>(<span class="number">4</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 添加班级数据：</span></span><br><span class="line"><span class="keyword">insert into</span> t_class <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;java001&#x27;</span>,<span class="string">&#x27;r803&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_class <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;java002&#x27;</span>,<span class="string">&#x27;r416&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_class <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;大数据001&#x27;</span>,<span class="string">&#x27;r103&#x27;</span>);</span><br><span class="line"><span class="comment">-- 可以一次性添加多条记录：</span></span><br><span class="line"><span class="keyword">insert into</span> t_class <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;java001&#x27;</span>,<span class="string">&#x27;r803&#x27;</span>),(<span class="keyword">null</span>,<span class="string">&#x27;java002&#x27;</span>,<span class="string">&#x27;r416&#x27;</span>),(<span class="keyword">null</span>,<span class="string">&#x27;大数据001&#x27;</span>,<span class="string">&#x27;r103&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查询班级表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_class;</span><br><span class="line"><span class="comment">-- 学生表删除：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="comment">-- 创建子表,学生表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        classno <span class="type">int</span>(<span class="number">4</span>)  <span class="comment">-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加学生信息：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="comment">-- 查看学生表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="comment">-- 出现问题：</span></span><br><span class="line"><span class="comment">-- 1.添加一个学生对应的班级编码为4：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;丽丽&#x27;</span>,<span class="number">4</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 2.删除班级2：</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_class <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 出现问题的原因：12_main目录下配置文件打包问题</span></span><br><span class="line"><span class="comment">-- 因为你现在的外键约束，没用语法添加进去，现在只是逻辑上认为班级编号是外键，没有从语法上定义</span></span><br><span class="line"><span class="comment">-- 解决办法，添加外键约束：</span></span><br><span class="line"><span class="comment">-- 注意：外键约束只有表级约束，没有列级约束：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        classno <span class="type">int</span>(<span class="number">4</span>),<span class="comment">-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></span><br><span class="line">        <span class="keyword">constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        classno <span class="type">int</span>(<span class="number">4</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 在创建表以后添加外键约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno)</span><br><span class="line"><span class="comment">-- 上面的两个问题都解决了：</span></span><br><span class="line"><span class="comment">-- 添加学生信息：</span></span><br><span class="line"><span class="comment">-- &gt; 1452 - Cannot add or update a child row: a foreign key constraint fails (`mytestdb`.`t_student`, CONSTRAINT `fk_stu_classno` FOREIGN KEY (`classno`) REFERENCES `t_class` (`cno`))</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="comment">-- 删除班级1：</span></span><br><span class="line"><span class="comment">-- 2.删除班级2：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">3</span>),(<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">3</span>),(<span class="keyword">null</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">-- &gt; 1451 - Cannot delete or update a parent row: a foreign key constraint fails (`mytestdb`.`t_student`, CONSTRAINT `fk_stu_classno` FOREIGN KEY (`classno`) REFERENCES `t_class` (`cno`))</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_class <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="外键策略"><a href="#外键策略" class="headerlink" title="外键策略"></a>外键策略</h3><p>外键策略用于维护数据库表之间的关联</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 学生表删除：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_student;</span><br><span class="line"><span class="comment">-- 班级表删除：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> t_class;</span><br><span class="line"><span class="comment">-- 注意：先删除从表，再删除主表。</span></span><br><span class="line"><span class="comment">-- 先创建父表：班级表：</span></span><br><span class="line"><span class="keyword">create table</span> t_class(</span><br><span class="line">        cno <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">        cname <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>,</span><br><span class="line">        room <span class="type">char</span>(<span class="number">4</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 可以一次性添加多条记录：</span></span><br><span class="line"><span class="keyword">insert into</span> t_class <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;java001&#x27;</span>,<span class="string">&#x27;r803&#x27;</span>),(<span class="keyword">null</span>,<span class="string">&#x27;java002&#x27;</span>,<span class="string">&#x27;r416&#x27;</span>),(<span class="keyword">null</span>,<span class="string">&#x27;大数据001&#x27;</span>,<span class="string">&#x27;r103&#x27;</span>);</span><br><span class="line"><span class="comment">-- 添加学生表，添加外键约束：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        classno <span class="type">int</span>(<span class="number">4</span>),<span class="comment">-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span></span><br><span class="line">        <span class="keyword">constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 可以一次性添加多条记录：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="number">1</span>),(<span class="keyword">null</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="number">2</span>),(<span class="keyword">null</span>,<span class="string">&#x27;朱六&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">-- 查看班级表和学生表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_class;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="comment">-- 删除班级2：如果直接删除的话肯定不行因为有外键约束：</span></span><br><span class="line"><span class="comment">-- 加入外键策略：</span></span><br><span class="line"><span class="comment">-- 策略1：no action 不允许操作</span></span><br><span class="line"><span class="comment">-- 通过操作sql来完成：</span></span><br><span class="line"><span class="comment">-- 先把班级2的学生对应的班级 改为null </span></span><br><span class="line"><span class="keyword">update</span> t_student <span class="keyword">set</span> classno <span class="operator">=</span> <span class="keyword">null</span> <span class="keyword">where</span> classno <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 然后再删除班级2：</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_class <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 策略2：cascade 级联操作：操作主表的时候影响从表的外键信息：</span></span><br><span class="line"><span class="comment">-- 先删除之前的外键约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">drop</span> <span class="keyword">foreign key</span> fk_stu_classno;</span><br><span class="line"><span class="comment">-- 重新添加外键约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno) <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade;</span><br><span class="line"><span class="comment">-- 试试更新：</span></span><br><span class="line"><span class="keyword">update</span> t_class <span class="keyword">set</span> cno <span class="operator">=</span> <span class="number">5</span> <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 试试删除：</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_class <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"><span class="comment">-- 策略3：set null  置空操作：</span></span><br><span class="line"><span class="comment">-- 先删除之前的外键约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">drop</span> <span class="keyword">foreign key</span> fk_stu_classno;</span><br><span class="line"><span class="comment">-- 重新添加外键约束：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno) <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">-- 试试更新：</span></span><br><span class="line"><span class="keyword">update</span> t_class <span class="keyword">set</span> cno <span class="operator">=</span> <span class="number">8</span> <span class="keyword">where</span> cno <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 注意：</span></span><br><span class="line"><span class="comment">-- 1. 策略2 级联操作  和  策略2 的  删除操作  可以混着使用：</span></span><br><span class="line"><span class="keyword">alter table</span> t_student <span class="keyword">add constraint</span> fk_stu_classno <span class="keyword">foreign key</span> (classno) <span class="keyword">references</span> t_class (cno) <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span> ;</span><br><span class="line"><span class="comment">-- 2.应用场合：</span></span><br><span class="line"><span class="comment">-- （1）朋友圈删除，点赞。留言都删除  --  级联操作</span></span><br><span class="line"><span class="comment">-- （2）解散班级，对应的学生 置为班级为null就可以了，-- set null</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="DDL和DML的补充"><a href="#DDL和DML的补充" class="headerlink" title="DDL和DML的补充"></a>DDL和DML的补充</h1><p>【1】sql展示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表：</span></span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">        sno <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">primary key</span> auto_increment, </span><br><span class="line">        sname <span class="type">varchar</span>(<span class="number">5</span>) <span class="keyword">not null</span>, </span><br><span class="line">        sex <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">check</span>(sex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="operator">||</span> sex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">        age <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">check</span>(age<span class="operator">&gt;=</span><span class="number">18</span> <span class="keyword">and</span> age<span class="operator">&lt;=</span><span class="number">50</span>),</span><br><span class="line">        enterdate <span class="type">date</span>,</span><br><span class="line">        classname <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        email <span class="type">varchar</span>(<span class="number">15</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据：</span></span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;zs@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;ls@126.com&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;露露&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;2023-9-1&#x27;</span>,<span class="string">&#x27;java01班&#x27;</span>,<span class="string">&#x27;ll@126.com&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查看学生表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="comment">-- 添加一张表：快速添加：结构和数据跟t_student 都是一致的</span></span><br><span class="line"><span class="keyword">create table</span> t_student2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student2;</span><br><span class="line"><span class="comment">-- 快速添加，结构跟t_student一致，数据没有：</span></span><br><span class="line"><span class="keyword">create table</span> t_student3</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student3;</span><br><span class="line"><span class="comment">-- 快速添加：只要部分列，部分数据：</span></span><br><span class="line"><span class="keyword">create table</span> t_student4</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> sno,sname,age <span class="keyword">from</span> t_student <span class="keyword">where</span> sno <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student4;</span><br><span class="line"><span class="comment">-- 删除数据操作 :清空数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_student;</span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> t_student;</span><br></pre></td></tr></table></figure>
<p>【2】delete和truncate的区别：<br>从最终的结果来看，虽然使用TRUNCATE操作和使用DELETE操作都可以删除表中的全部记录，但是两者还是有很多区别的，其区别主要体现在以下几个方面：<br>(1)DELETE为数据操作语言DML；TRUNCATE为数据定义语言DDL。<br>(2) DELETE操作是将表中所有记录一条一条删除直到删除完；TRUNCATE操作则是保留了表的结构，重新创建了这个表，所有的状态都相当于新表。因此，TRUNCATE操作的效率更高。<br>(3)DELETE操作可以回滚；TRUNCATE操作会导致隐式提交，因此不能回滚（在第十章中会讲解事务的提交和回滚）。<br>(4)DELETE操作执行成功后会返回已删除的行数（如删除4行记录，则会显示“Affected rows：4”）；截断操作不会返回已删除的行量，结果通常是“Affected rows：0”。DELETE操作删除表中记录后，再次向表中添加新记录时，对于设置有自增约束字段的值会从删除前表中该字段的最大值加1开始自增；TRUNCATE操作则会重新从1开始自增。</p>
<h1 id="DQL-查询操作"><a href="#DQL-查询操作" class="headerlink" title="DQL-查询操作"></a>DQL-查询操作</h1><h2 id="表的准备"><a href="#表的准备" class="headerlink" title="表的准备"></a>表的准备</h2><p>准备四张表：dept(部门表),emp(员工表),salgrade(薪资等级表),bonus(奖金表)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> DEPT(  </span><br><span class="line">  DEPTNO <span class="type">int</span>(<span class="number">2</span>) <span class="keyword">not null</span>,  </span><br><span class="line">  DNAME  <span class="type">VARCHAR</span>(<span class="number">14</span>),  </span><br><span class="line">  LOC    <span class="type">VARCHAR</span>(<span class="number">13</span>)  </span><br><span class="line">);  </span><br><span class="line"><span class="keyword">alter table</span> DEPT  </span><br><span class="line">  <span class="keyword">add constraint</span> PK_DEPT <span class="keyword">primary key</span> (DEPTNO); </span><br><span class="line">        </span><br><span class="line"><span class="keyword">create table</span> EMP  </span><br><span class="line">(  </span><br><span class="line">  EMPNO    <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">primary key</span>,  </span><br><span class="line">  ENAME    <span class="type">VARCHAR</span>(<span class="number">10</span>),  </span><br><span class="line">  JOB      <span class="type">VARCHAR</span>(<span class="number">9</span>),  </span><br><span class="line">  MGR      <span class="type">int</span>(<span class="number">4</span>),  </span><br><span class="line">  HIREDATE <span class="type">DATE</span>,  </span><br><span class="line">  SAL      <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>),  </span><br><span class="line">  COMM     <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>),  </span><br><span class="line">  DEPTNO   <span class="type">int</span>(<span class="number">2</span>)  </span><br><span class="line">);  </span><br><span class="line"><span class="keyword">alter table</span> EMP  </span><br><span class="line">  <span class="keyword">add constraint</span> FK_DEPTNO <span class="keyword">foreign key</span> (DEPTNO)  </span><br><span class="line">  <span class="keyword">references</span> DEPT (DEPTNO);  </span><br><span class="line">        </span><br><span class="line"><span class="keyword">create table</span> SALGRADE  </span><br><span class="line">(  </span><br><span class="line">  GRADE <span class="type">int</span> <span class="keyword">primary key</span>,  </span><br><span class="line">  LOSAL <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>),  </span><br><span class="line">  HISAL <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>)  </span><br><span class="line">);  </span><br><span class="line"><span class="keyword">create table</span> BONUS  </span><br><span class="line">(  </span><br><span class="line">  ENAME <span class="type">VARCHAR</span>(<span class="number">10</span>),  </span><br><span class="line">  JOB   <span class="type">VARCHAR</span>(<span class="number">9</span>),  </span><br><span class="line">  SAL   <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>),  </span><br><span class="line">  COMM  <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>)  </span><br><span class="line">);  </span><br><span class="line"><span class="keyword">insert into</span> DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">10</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>);  </span><br><span class="line"><span class="keyword">insert into</span> DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">20</span>, <span class="string">&#x27;RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span>);  </span><br><span class="line"><span class="keyword">insert into</span> DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">30</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span>);  </span><br><span class="line"><span class="keyword">insert into</span> DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">40</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSTON&#x27;</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7369</span>, <span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7902</span>, <span class="string">&#x27;1980-12-17&#x27;</span>, <span class="number">800</span>, <span class="keyword">null</span>, <span class="number">20</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7499</span>, <span class="string">&#x27;ALLEN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-02-20&#x27;</span>, <span class="number">1600</span>, <span class="number">300</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7521</span>, <span class="string">&#x27;WARD&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-02-22&#x27;</span>, <span class="number">1250</span>, <span class="number">500</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7566</span>, <span class="string">&#x27;JONES&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1981-04-02&#x27;</span>, <span class="number">2975</span>, <span class="keyword">null</span>, <span class="number">20</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7654</span>, <span class="string">&#x27;MARTIN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-09-28&#x27;</span>, <span class="number">1250</span>, <span class="number">1400</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7698</span>, <span class="string">&#x27;BLAKE&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1981-05-01&#x27;</span>, <span class="number">2850</span>, <span class="keyword">null</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7782</span>, <span class="string">&#x27;CLARK&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>, <span class="string">&#x27;1981-06-09&#x27;</span>, <span class="number">2450</span>, <span class="keyword">null</span>, <span class="number">10</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7788</span>, <span class="string">&#x27;SCOTT&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>, <span class="string">&#x27;1987-04-19&#x27;</span>, <span class="number">3000</span>, <span class="keyword">null</span>, <span class="number">20</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7839</span>, <span class="string">&#x27;KING&#x27;</span>, <span class="string">&#x27;PRESIDENT&#x27;</span>, <span class="keyword">null</span>, <span class="string">&#x27;1981-11-17&#x27;</span>, <span class="number">5000</span>, <span class="keyword">null</span>, <span class="number">10</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7844</span>, <span class="string">&#x27;TURNER&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-09-08&#x27;</span>, <span class="number">1500</span>, <span class="number">0</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7876</span>, <span class="string">&#x27;ADAMS&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7788</span>, <span class="string">&#x27;1987-05-23&#x27;</span>, <span class="number">1100</span>, <span class="keyword">null</span>, <span class="number">20</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7900</span>, <span class="string">&#x27;JAMES&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7698</span>, <span class="string">&#x27;1981-12-03&#x27;</span>, <span class="number">950</span>, <span class="keyword">null</span>, <span class="number">30</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7902</span>, <span class="string">&#x27;FORD&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>, <span class="string">&#x27;1981-12-03&#x27;</span>, <span class="number">3000</span>, <span class="keyword">null</span>, <span class="number">20</span>);  </span><br><span class="line"><span class="keyword">insert into</span> EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">7934</span>, <span class="string">&#x27;MILLER&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7782</span>, <span class="string">&#x27;1982-01-23&#x27;</span>, <span class="number">1300</span>, <span class="keyword">null</span>, <span class="number">10</span>);  </span><br><span class="line"><span class="keyword">insert into</span> SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="number">700</span>, <span class="number">1200</span>);  </span><br><span class="line"><span class="keyword">insert into</span> SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">2</span>, <span class="number">1201</span>, <span class="number">1400</span>);  </span><br><span class="line"><span class="keyword">insert into</span> SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">3</span>, <span class="number">1401</span>, <span class="number">2000</span>);  </span><br><span class="line"><span class="keyword">insert into</span> SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">4</span>, <span class="number">2001</span>, <span class="number">3000</span>);  </span><br><span class="line"><span class="keyword">insert into</span> SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line"><span class="keyword">values</span> (<span class="number">5</span>, <span class="number">3001</span>, <span class="number">9999</span>);  </span><br><span class="line"><span class="comment">-- 查看表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept; </span><br><span class="line"><span class="comment">-- 部门表：dept:department 部分 ，loc - location 位置</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 员工表：emp:employee 员工   ,mgr :manager上级领导编号，hiredate 入职日期  firedate 解雇日期 ，common：补助</span></span><br><span class="line"><span class="comment">-- deptno 外键 参考  dept - deptno字段</span></span><br><span class="line"><span class="comment">-- mgr 外键  参考  自身表emp - empno  产生了自关联</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> salgrade;</span><br><span class="line"><span class="comment">-- losal - lowsal</span></span><br><span class="line"><span class="comment">-- hisal - highsal</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> bonus;</span><br></pre></td></tr></table></figure>
<h2 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h2><h3 id="最简单的sql查询"><a href="#最简单的sql查询" class="headerlink" title="最简单的sql查询"></a>最简单的sql查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 对emp表查询：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp; <span class="comment">-- *代表所有数据</span></span><br><span class="line"><span class="comment">-- 显示部分列：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 显示部分行：where子句</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="comment">-- 显示部分列，部分行：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,job,mgr <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="comment">-- 起别名：</span></span><br><span class="line"><span class="keyword">select</span> empno 员工编号,ename 姓名,sal 工资 <span class="keyword">from</span> emp; <span class="comment">-- as 省略，&#x27;&#x27;或者&quot;&quot;省略了</span></span><br><span class="line"><span class="comment">-- as alias 别名</span></span><br><span class="line"><span class="keyword">select</span> empno <span class="keyword">as</span> 员工编号,ename <span class="keyword">as</span> 姓名,sal <span class="keyword">as</span> 工资 <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> empno <span class="keyword">as</span> <span class="string">&#x27;员工编号&#x27;</span>,ename <span class="keyword">as</span> &quot;姓名&quot;,sal <span class="keyword">as</span> 工资 <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- &gt; 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;编号,ename as &quot;姓 名&quot;,sal as 工资 from emp&#x27; at line 1</span></span><br><span class="line"><span class="comment">-- 错误原因：在别名中有特殊符号的时候，&#x27;&#x27;或者&quot;&quot;不可以省略不写</span></span><br><span class="line"><span class="keyword">select</span> empno <span class="keyword">as</span> 员工 编号,ename <span class="keyword">as</span> &quot;姓 名&quot;,sal <span class="keyword">as</span> 工资 <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 算术运算符：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,sal<span class="operator">+</span><span class="number">1000</span> <span class="keyword">as</span> <span class="string">&#x27;涨薪后&#x27;</span>,deptno <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&lt;</span> <span class="number">2500</span>;</span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,comm,sal<span class="operator">+</span>comm <span class="keyword">from</span> emp;  <span class="comment">-- ？？？后面再说</span></span><br><span class="line"><span class="comment">-- 去重操作：</span></span><br><span class="line"><span class="keyword">select</span> job <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> job,deptno <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job,deptno <span class="keyword">from</span> emp; <span class="comment">-- 对后面的所有列组合 去重 ，而不是单独的某一列去重</span></span><br><span class="line"><span class="comment">-- 排序：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal; <span class="comment">-- 默认情况下是按照升序排列的</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>; <span class="comment">-- asc 升序，可以默认不写</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>; <span class="comment">-- desc 降序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span> ,deptno <span class="keyword">desc</span>; <span class="comment">-- 在工资升序的情况下，deptno按照降序排列</span></span><br></pre></td></tr></table></figure>
<h3 id="where子句"><a href="#where子句" class="headerlink" title="where子句"></a>where子句</h3><p>指定查询条件使用where子句，可以查询符合条件的部分记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看emp表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- where子句：将过滤条件放在where子句的后面，可以筛选/过滤出我们想要的符合条件的数据：</span></span><br><span class="line"><span class="comment">-- where 子句 + 关系运算符</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">&gt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">&gt;=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">&lt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">&lt;=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">&lt;&gt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">!=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>; </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;clerk&#x27;</span>; <span class="comment">-- 默认情况下不区分大小写 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="type">binary</span> job <span class="operator">=</span> <span class="string">&#x27;clerk&#x27;</span>; <span class="comment">-- binary区分大小写</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate <span class="operator">&lt;</span> <span class="string">&#x27;1981-12-25&#x27;</span>;</span><br><span class="line"><span class="comment">-- where 子句 + 逻辑运算符：and </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="keyword">and</span> sal <span class="operator">&lt;</span> <span class="number">3000</span>;  <span class="comment">-- (1500,3000)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="operator">&amp;&amp;</span> sal <span class="operator">&lt;</span> <span class="number">3000</span>; </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1500</span> <span class="keyword">and</span> sal <span class="operator">&lt;</span> <span class="number">3000</span> <span class="keyword">order</span> <span class="keyword">by</span> sal;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="keyword">between</span> <span class="number">1500</span> <span class="keyword">and</span> <span class="number">3000</span>; <span class="comment">-- [1500,3000]</span></span><br><span class="line"><span class="comment">-- where 子句 + 逻辑运算符：or</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span> <span class="keyword">or</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span> <span class="operator">||</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="keyword">in</span> (<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="keyword">in</span> (<span class="string">&#x27;MANAGER&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>);</span><br><span class="line"><span class="comment">-- where子句 + 模糊查询：</span></span><br><span class="line"><span class="comment">-- 查询名字中带A的员工  -- %代表任意多个字符 0,1,2，.....</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;%A%&#x27;</span> ;</span><br><span class="line"><span class="comment">-- -任意一个字符</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;__A%&#x27;</span> ;</span><br><span class="line"><span class="comment">-- 关于null的判断：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> comm <span class="keyword">is</span> <span class="keyword">not null</span>;</span><br><span class="line"><span class="comment">-- 小括号的使用  ：因为不同的运算符的优先级别不同，加括号为了可读性</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">and</span> sal <span class="operator">&gt;=</span><span class="number">1500</span>; <span class="comment">-- 先and再or  and &gt; or</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">or</span> (job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">and</span> sal <span class="operator">&gt;=</span><span class="number">1500</span>); </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>) <span class="keyword">and</span> sal <span class="operator">&gt;=</span><span class="number">1500</span>;</span><br></pre></td></tr></table></figure>
<h3 id="使用函数"><a href="#使用函数" class="headerlink" title="使用函数"></a>使用函数</h3><p>MySQL中提供了大量函数来简化用户对数据库的操作，比如字符串的处理、日期的运算、数值的运算等等。使用函数可以大大提高SELECT语句操作数据库的能力，同时也给数据的转换和处理提供了方便。 （在sql中使用函数）</p>
<p>函数只是对查询结果中的数据进行处理，不会改变数据库中数据表的值。MySQL中的函数主要分为单行函数和多行函数两大类，下面我们将详细讲解这两大类函数。 </p>
<p>单行函数 </p>
<p>单行函数是指对每一条记录输入值进行计算，并得到相应的计算结果，然后返回给用户，也就是说，每条记录作为一个输入参数，经过函数计算得到每条记录的计算结果。 </p>
<p>常用的单行函数主要包括字符串函数、数值函数、日期与时间函数、流程函数以及其他函数。 </p>
<p>多行函数 </p>
<p>多行函数是指对一组数据进行运算，针对这一组数据（多行记录）只返回一个结果，也称为分组函数。 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 函数举例：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,<span class="built_in">lower</span>(ename),<span class="built_in">upper</span>(ename),sal <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 函数的功能：封装了特定的一些功能，我们直接拿过来使用，可以实现对应的功能</span></span><br><span class="line"><span class="comment">-- 函数作用：为了提高select的能力</span></span><br><span class="line"><span class="comment">-- 注意：函数没有改变数据自身的值，而是在真实数据的上面进行加工处理，展示新的结果而已。</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(sal),<span class="built_in">min</span>(sal),<span class="built_in">count</span>(sal),<span class="built_in">sum</span>(sal),<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 函数的分类：</span></span><br><span class="line"><span class="comment">-- lower(ename),upper(ename) ：改变每一条结果，每一条数据对应一条结果  -- 单行函数</span></span><br><span class="line"><span class="comment">-- max(sal),min(sal),count(sal),sum(sal),avg(sal):多条数据，最终展示一个结果  -- 多行函数</span></span><br></pre></td></tr></table></figure>
<p>PS：除了多行函数（max,min,count,sum,avg），都是单行函数</p>
<h4 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h4><p>1.字符串函数  （String StringBuilder） </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CONCAT(str1, str2, ···, strn)</td>
<td>将str1、str2···strn拼接成一个新的字符串</td>
</tr>
<tr>
<td>INSERT(str, index, n, newstr)</td>
<td>将字符串str从第index位置开始的n个字符替换成字符串newstr</td>
</tr>
<tr>
<td>LENGTH(str)</td>
<td>获取字符串str的长度</td>
</tr>
<tr>
<td>LOWER(str)</td>
<td>将字符串str中的每个字符转换为小写</td>
</tr>
<tr>
<td>UPPER(str)</td>
<td>将字符串str中的每个字符转换为大写</td>
</tr>
<tr>
<td>LEFT(str, n)</td>
<td>获取字符串str最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(str, n)</td>
<td>获取字符串str最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, n,  pad)</td>
<td>使用字符串pad在str的最左边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>RPAD(str, n,  pad)</td>
<td>使用字符串pad在str的最右边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>LTRIM(str)</td>
<td>去除字符串str左侧的空格</td>
</tr>
<tr>
<td>RTRIM(str)</td>
<td>去除字符串str右侧的空格</td>
</tr>
<tr>
<td>TRIM(str)</td>
<td>去除字符串str左右两侧的空格</td>
</tr>
<tr>
<td>REPLACE(str,oldstr,newstr)</td>
<td>用字符串newstr替换字符串str中所有的子字符串oldstr</td>
</tr>
<tr>
<td>REVERSE(str)</td>
<td>将字符串str中的字符逆序</td>
</tr>
<tr>
<td>STRCMP(str1, str2)</td>
<td>比较字符串str1和str2的大小</td>
</tr>
<tr>
<td>SUBSTRING(str,index,n)</td>
<td>获取从字符串str的index位置开始的n个字符</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>数值函数 （Math）      </li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ABS(num)</td>
<td>返回num的绝对值</td>
</tr>
<tr>
<td>CEIL(num)</td>
<td>返回大于num的最小整数（向上取整）</td>
</tr>
<tr>
<td>FLOOR(num)</td>
<td>返回小于num的最大整数（向下取整）</td>
</tr>
<tr>
<td>MOD(num1, num2)</td>
<td>返回num1/num2的余数（取模）</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率的值</td>
</tr>
<tr>
<td>POW(num,n)/POWER(num, n)</td>
<td>返回num的n次方</td>
</tr>
<tr>
<td>RAND(num)</td>
<td>返回0~1之间的随机数</td>
</tr>
<tr>
<td>ROUND(num, n)</td>
<td>返回x四舍五入后的值，该值保留到小数点后n位</td>
</tr>
<tr>
<td>TRUNCATE(num, n)</td>
<td>返回num被舍去至小数点后n位的值</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>日期与时间函数     </li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CURDATE()</td>
<td>返回当前日期</td>
</tr>
<tr>
<td>CURTIME()</td>
<td>返回当前时间</td>
</tr>
<tr>
<td>NOW()</td>
<td>返回当前日期和时间</td>
</tr>
<tr>
<td>SYSDATE()</td>
<td>返回该函数执行时的日期和时间</td>
</tr>
<tr>
<td>DAYOFYEAR(date)</td>
<td>返回日期date为一年中的第几天</td>
</tr>
<tr>
<td>WEEK(date)/WEEKOFYEAR(date)</td>
<td>返回日期date为一年中的第几周</td>
</tr>
<tr>
<td>DATE_FORMAT(date,   format)</td>
<td>返回按字符串format格式化后的日期date</td>
</tr>
<tr>
<td>DATE_ADD(date,   INTERVAL expr unit)  /ADDDATE(date, INTERVAL expr unit)</td>
<td>返回date加上一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATE_SUB(date,   INTERVAL expr unit)  /SUBDATE(date,   INTERVAL expr unit)</td>
<td>返回date减去一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATEDIFF(date1,   date2)</td>
<td>返回起始日期date1与结束日期date2之间的间隔天数</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行函数包含：</span></span><br><span class="line"><span class="comment">-- 1.字符串函数</span></span><br><span class="line"><span class="keyword">select</span> ename,length(ename),<span class="built_in">substring</span>(ename,<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- substring字符串截取，2:从字符下标为2开始，3：截取长度3    （下标从1开始）</span></span><br><span class="line"><span class="comment">-- 2.数值函数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">abs</span>(<span class="number">-5</span>),<span class="built_in">ceil</span>(<span class="number">5.3</span>),<span class="built_in">floor</span>(<span class="number">5.9</span>),round(<span class="number">3.14</span>) <span class="keyword">from</span> dual; <span class="comment">-- dual实际就是一个伪表 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">abs</span>(<span class="number">-5</span>) 绝对值,<span class="built_in">ceil</span>(<span class="number">5.3</span>) 向上取整,<span class="built_in">floor</span>(<span class="number">5.9</span>) 向下取整,round(<span class="number">3.14</span>) 四舍五入;  <span class="comment">-- 如果没有where条件的话，from dual可以省略不写</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">ceil</span>(sal) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="number">10</span><span class="operator">/</span><span class="number">3</span>,<span class="number">10</span><span class="operator">%</span><span class="number">3</span>,<span class="built_in">mod</span>(<span class="number">10</span>,<span class="number">3</span>) ;</span><br><span class="line"><span class="comment">-- 3.日期与时间函数 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> curdate(),curtime() ; <span class="comment">-- curdate()年月日 curtime()时分秒</span></span><br><span class="line"><span class="keyword">select</span> now(),sysdate(),sleep(<span class="number">3</span>),now(),sysdate() <span class="keyword">from</span> dual; <span class="comment">-- now(),sysdate() 年月日时分秒</span></span><br><span class="line"><span class="keyword">insert into</span> emp <span class="keyword">values</span> (<span class="number">9999</span>,<span class="string">&#x27;lili&#x27;</span>,<span class="string">&#x27;SALASMAN&#x27;</span>,<span class="number">7698</span>,now(),<span class="number">1000</span>,<span class="keyword">null</span>,<span class="number">30</span>);</span><br><span class="line"><span class="comment">-- now()可以表示年月日时分秒，但是插入数据的时候还是要参照表的结构的</span></span><br><span class="line"><span class="keyword">desc</span> emp;</span><br></pre></td></tr></table></figure>
<ol>
<li>流程函数（ IF  SWITCH）</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>间隔类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>IF(condition, t, f)</td>
<td>如果条件condition为真，则返回t，否则返回f</td>
</tr>
<tr>
<td>IFNULL(value1, value2)</td>
<td>如果value1不为null，则返回value1，否则返回value2</td>
</tr>
<tr>
<td>NULLIF(value1, value2)</td>
<td>如果value1等于value2，则返回null，否则返回value1</td>
</tr>
<tr>
<td>CASE value WHEN   [value1] THEN result1 [WHEN [value2] THEN result2 …] [ELSE result] END</td>
<td>如果value等于value1，则返回result1，···，否则返回result</td>
</tr>
<tr>
<td>CASE WHEN [condition1] THEN result1 [WHEN [condition2] THEN   result2 …] [ELSE result] END</td>
<td>如果条件condition1为真，则返回result1，···，否则返回result</td>
</tr>
</tbody>
</table>
</div>
<p>5.JSON函数    </p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON_APPEND()</td>
<td>在JSON文档中追加数据</td>
</tr>
<tr>
<td>JSON_INSERT ()</td>
<td>在JSON文档中插入数据</td>
</tr>
<tr>
<td>JSON_REPLACE ()</td>
<td>替换JSON文档中的数据</td>
</tr>
<tr>
<td>JSON_REMOVE ()</td>
<td>从JSON文档的指定位置移除数据</td>
</tr>
<tr>
<td>JSON_CONTAINS()</td>
<td>判断JSON文档中是否包含某个数据</td>
</tr>
<tr>
<td>JSON_SEARCH()</td>
<td>查找JSON文档中给定字符串的路径</td>
</tr>
</tbody>
</table>
</div>
<p>6.其他函数</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATABASE()</td>
<td>返回当前数据库名</td>
</tr>
<tr>
<td>VERSION()</td>
<td>返回当前MySQL的版本号</td>
</tr>
<tr>
<td>USER()</td>
<td>返回当前登录的用户名</td>
</tr>
<tr>
<td>INET_ATON(IP)</td>
<td>返回IP地址的数字表示</td>
</tr>
<tr>
<td>INET_NTOA</td>
<td>返回数字代表的IP地址</td>
</tr>
<tr>
<td>PASSWORD(str)</td>
<td>实现对字符串str的加密操作</td>
</tr>
<tr>
<td>FORMAT(num, n)</td>
<td>实现对数字num的格式化操作，保留n位小数</td>
</tr>
<tr>
<td>CONVERT(data,   type)</td>
<td>实现将数据data转换成type类型的操作</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 4.流程函数</span></span><br><span class="line"><span class="comment">-- if相关</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,if(sal<span class="operator">&gt;=</span><span class="number">2500</span>,<span class="string">&#x27;高薪&#x27;</span>,<span class="string">&#x27;底薪&#x27;</span>) <span class="keyword">as</span> <span class="string">&#x27;薪资等级&#x27;</span> <span class="keyword">from</span> emp; <span class="comment">-- if-else 双分支结构</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,comm,sal<span class="operator">+</span>ifnull(comm,<span class="number">0</span>) <span class="keyword">from</span> emp; <span class="comment">-- 如果comm是null，那么取值为0 -- 单分支</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">nullif</span>(<span class="number">1</span>,<span class="number">1</span>),<span class="built_in">nullif</span>(<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">from</span> dual; <span class="comment">--  如果value1等于value2，则返回null，否则返回value1  </span></span><br><span class="line"><span class="comment">-- case相关：</span></span><br><span class="line"><span class="comment">-- case等值判断</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,job,</span><br><span class="line"><span class="keyword">case</span> job </span><br><span class="line"> <span class="keyword">when</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;店员&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> <span class="string">&#x27;SALESMAN&#x27;</span>  <span class="keyword">then</span> <span class="string">&#x27;销售&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> <span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;经理&#x27;</span></span><br><span class="line"> <span class="keyword">else</span> <span class="string">&#x27;其他&#x27;</span></span><br><span class="line"><span class="keyword">end</span> <span class="string">&#x27;岗位&#x27;</span>,</span><br><span class="line">sal <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- case区间判断:</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,</span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line"> <span class="keyword">when</span> sal<span class="operator">&lt;=</span><span class="number">1000</span> <span class="keyword">then</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> sal<span class="operator">&lt;=</span><span class="number">2000</span> <span class="keyword">then</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line"> <span class="keyword">when</span> sal<span class="operator">&lt;=</span><span class="number">3000</span> <span class="keyword">then</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"> <span class="keyword">else</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">end</span> <span class="string">&#x27;工资等级&#x27;</span>,</span><br><span class="line">deptno <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 5.JSON函数  </span></span><br><span class="line"><span class="comment">-- 6.其他函数</span></span><br><span class="line"><span class="keyword">select</span> database(),<span class="keyword">user</span>(),version() <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="多行函数"><a href="#多行函数" class="headerlink" title="多行函数"></a>多行函数</h4><p>对一组数据进行运算，针对一组数据（多行记录）只返回一个结果，也称分组函数</p>
<p>多行函数包含： COUNT()  ，SUM()  ，AVG()  ， MAX()  ，MIN()  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多行函数：</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(sal),<span class="built_in">min</span>(sal),<span class="built_in">count</span>(sal),<span class="built_in">sum</span>(sal),<span class="built_in">sum</span>(sal)<span class="operator">/</span><span class="built_in">count</span>(sal),<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 多行函数自动忽略null值</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(comm),<span class="built_in">min</span>(comm),<span class="built_in">count</span>(comm),<span class="built_in">sum</span>(comm),<span class="built_in">sum</span>(comm)<span class="operator">/</span><span class="built_in">count</span>(comm),<span class="built_in">avg</span>(comm) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- max(),min(),count()针对所有类型   sum(),avg() 只针对数值型类型有效</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(ename),<span class="built_in">min</span>(ename),<span class="built_in">count</span>(ename),<span class="built_in">sum</span>(ename),<span class="built_in">avg</span>(ename) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- count --计数   </span></span><br><span class="line"><span class="comment">-- 统计表的记录数：方式1：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(ename) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 统计表的记录数：方式2</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h3 id="group-by函数"><a href="#group-by函数" class="headerlink" title="group_by函数"></a>group_by函数</h3><p>【1】group by : 用来进行分组   </p>
<p>【2】sql展示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 统计各个部门的平均工资 </span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp; <span class="comment">-- 字段和多行函数不可以同时使用</span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno; <span class="comment">-- 字段和多行函数不可以同时使用,除非这个字段属于分组</span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 统计各个岗位的平均工资</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">lower</span>(job),<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>
<h3 id="having分组后筛选"><a href="#having分组后筛选" class="headerlink" title="having分组后筛选"></a>having分组后筛选</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计各个部门的平均工资 ,只显示平均工资2000以上的  - 分组以后进行二次筛选 having</span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> <span class="built_in">avg</span>(sal) <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) 平均工资 <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> 平均工资 <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) 平均工资 <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> 平均工资 <span class="operator">&gt;</span> <span class="number">2000</span> <span class="keyword">order</span> <span class="keyword">by</span> deptno <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 统计各个岗位的平均工资,除了MANAGER</span></span><br><span class="line"><span class="comment">-- 方法1：</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">!=</span> <span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="comment">-- 方法2：</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job <span class="keyword">having</span> job <span class="operator">!=</span> <span class="string">&#x27;MANAGER&#x27;</span> ;</span><br><span class="line"><span class="comment">-- where在分组前进行过滤的，having在分组后进行后滤。</span></span><br></pre></td></tr></table></figure>
<h2 id="单表查询总结"><a href="#单表查询总结" class="headerlink" title="单表查询总结"></a>单表查询总结</h2><p>【1】select语句总结<br>select column, group_function(column)<br>from table<br>[where condition]<br>[group by  group_by_expression]<br>[having group_condition]<br>[order by column]; </p>
<p>注意：顺序固定，不可以改变顺序</p>
<p>【2】select语句的执行顺序<br>from—where — group  by–  select   -  having-   order  by</p>
<p>【3】单表查询练习：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单表查询练习：</span></span><br><span class="line"><span class="comment">-- 列出工资最小值小于2000的职位</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">min</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">min</span>(sal) <span class="operator">&lt;</span> <span class="number">2000</span> ;</span><br><span class="line"><span class="comment">-- 列出平均工资大于1200元的部门和工作搭配组合</span></span><br><span class="line"><span class="keyword">select</span> deptno,job,<span class="built_in">avg</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno,job</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(sal) <span class="operator">&gt;</span> <span class="number">1200</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> deptno;</span><br><span class="line"><span class="comment">-- 统计[人数小于4的]部门的平均工资。 </span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">count</span>(<span class="number">1</span>),<span class="built_in">avg</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="operator">&lt;</span> <span class="number">4</span></span><br><span class="line"><span class="comment">-- 统计各部门的最高工资，排除最高工资小于3000的部门。</span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">max</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">max</span>(sal) <span class="operator">&lt;</span> <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h3 id="99语法：交叉连接，自然连接，内连接查询"><a href="#99语法：交叉连接，自然连接，内连接查询" class="headerlink" title="99语法：交叉连接，自然连接，内连接查询"></a>99语法：交叉连接，自然连接，内连接查询</h3><p>【1】多表查询引入：<br>实际开发中往往需要针对两张甚至更多张数据表进行操作，而这多张表之间需要使用主键和外键关联在一起，然后使用连接查询来查询多张表中满足要求的数据记录。</p>
<p>一条SQL语句查询多个表，得到一个结果，包含多个表的数据。效率高。在SQL99中，连接查询需要使用join关键字实现。</p>
<p>提供了多种连接查询的类型： cross   natural   using   on</p>
<p>交叉连接（CROSS JOIN）是对两个或者多个表进行笛卡儿积操作，所谓笛卡儿积就是关系代数里的一个概念，表示两个表中的每一行数据任意组合的结果。比如：有两个表，左表有m条数据记录，x个字段，右表有n条数据记录，y个字段，则执行交叉连接后将返回m*n条数据记录，x+y个字段。笛卡儿积示意图如图所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805153708849.png" alt="image-20240805153708849"></p>
<p>【2】sql展示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号，姓名，部门编号：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> empno,ename,deptno <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 查询员工的编号，姓名，部门编号,部门名称：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp; <span class="comment">-- 14条记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept; <span class="comment">-- 4条记录 </span></span><br><span class="line"><span class="comment">-- 多表查询 ：</span></span><br><span class="line"><span class="comment">-- 交叉连接：cross join</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">cross</span> <span class="keyword">join</span> dept; <span class="comment">-- 14*4 = 56条 笛卡尔乘积 ： 没有实际意义，有理论意义</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">join</span> dept; <span class="comment">-- cross 可以省略不写，mysql中可以，oracle中不可以</span></span><br><span class="line"><span class="comment">-- 自然连接：natural join </span></span><br><span class="line"><span class="comment">-- 优点：自动匹配所有的同名列 ,同名列只展示一次 ，简单</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept;</span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,dname,loc </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept;</span><br><span class="line"><span class="comment">-- 缺点： 查询字段的时候，没有指定字段所属的数据库表，效率低</span></span><br><span class="line"><span class="comment">-- 解决： 指定表名：</span></span><br><span class="line"><span class="keyword">select</span> emp.empno,emp.ename,emp.sal,dept.dname,dept.loc,dept.deptno</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept;</span><br><span class="line"><span class="comment">-- 缺点：表名太长</span></span><br><span class="line"><span class="comment">-- 解决：表起别名</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,d.dname,d.loc,d.deptno</span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">natural</span> <span class="keyword">join</span> dept d;</span><br><span class="line"><span class="comment">-- 自然连接 natural join 缺点：自动匹配表中所有的同名列，但是有时候我们希望只匹配部分同名列：</span></span><br><span class="line"><span class="comment">-- 解决： 内连接 - using子句：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d <span class="comment">-- inner可以不写</span></span><br><span class="line"><span class="keyword">using</span>(deptno) <span class="comment">-- 这里不能写natural join了 ,这里是内连接</span></span><br><span class="line"><span class="comment">-- using缺点：关联的字段，必须是同名的 </span></span><br><span class="line"><span class="comment">-- 解决： 内连接 - on子句：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> (e.deptno <span class="operator">=</span> d.deptno);</span><br><span class="line"><span class="comment">-- 多表连接查询的类型： 1.交叉连接  cross join  2. 自然连接  natural join  </span></span><br><span class="line"><span class="comment">-- 3. 内连接 - using子句   4.内连接 - on子句</span></span><br><span class="line"><span class="comment">-- 综合看：内连接 - on子句</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> (e.deptno <span class="operator">=</span> d.deptno)</span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">3500</span>;</span><br><span class="line"><span class="comment">-- 条件：</span></span><br><span class="line"><span class="comment">-- 1.筛选条件  where  having</span></span><br><span class="line"><span class="comment">-- 2.连接条件 on,using,natural </span></span><br><span class="line"><span class="comment">-- SQL99语法 ：筛选条件和连接条件是分开的</span></span><br></pre></td></tr></table></figure>
<h3 id="99语法：外连接查询"><a href="#99语法：外连接查询" class="headerlink" title="99语法：外连接查询"></a>99语法：外连接查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- inner join - on子句： 显示的是所有匹配的信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="comment">-- 问题：</span></span><br><span class="line"><span class="comment">-- 1.40号部分没有员工，没有显示在查询结果中</span></span><br><span class="line"><span class="comment">-- 2.员工scott没有部门，没有显示在查询结果中</span></span><br><span class="line"><span class="comment">-- 外连接：除了显示匹配的数据之外，还可以显示不匹配的数据</span></span><br><span class="line"><span class="comment">-- 左外连接： left outer join   -- 左面的那个表的信息，即使不匹配也可以查看出效果</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- 右外连接： right outer join   -- 右面的那个表的信息，即使不匹配也可以查看出效果</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- 全外连接  full outer join -- 这个语法在mysql中不支持，在oracle中支持 -- 展示左，右表全部不匹配的数据 </span></span><br><span class="line"><span class="comment">-- scott ，40号部门都可以看到</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- 解决mysql中不支持全外连接的问题：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line"><span class="keyword">union</span> <span class="comment">-- 并集 去重 效率低</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span><span class="comment">-- 并集 不去重 效率高</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- mysql中对集合操作支持比较弱，只支持并集操作，交集，差集不支持（oracle中支持）</span></span><br><span class="line"><span class="comment">-- outer可以省略不写</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> salgrade;</span><br><span class="line"><span class="keyword">select</span> e.ename,e.sal,e.empno,e.deptno,d.dname,s.<span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> salgrade s </span><br><span class="line"><span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal</span><br></pre></td></tr></table></figure>
<h3 id="内连接和外连接的区别"><a href="#内连接和外连接的区别" class="headerlink" title="内连接和外连接的区别"></a>内连接和外连接的区别</h3><p>内连接只显示符合连接条件的记录，外连接除了显示符合条件的记录外，还显示表中的记录</p>
<h3 id="99语法：自连接查询"><a href="#99语法：自连接查询" class="headerlink" title="99语法：自连接查询"></a>99语法：自连接查询</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805161412528.png" alt="image-20240805161412528"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号、姓名、上级编号,上级的姓名</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> emp e2</span><br><span class="line"><span class="keyword">on</span> e1.mgr <span class="operator">=</span> e2.empno;</span><br><span class="line"><span class="comment">-- 左外连接：</span></span><br><span class="line"><span class="keyword">select</span> e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line"><span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> emp e2</span><br><span class="line"><span class="keyword">on</span> e1.mgr <span class="operator">=</span> e2.empno;</span><br></pre></td></tr></table></figure>
<h3 id="92语法：多表查询"><a href="#92语法：多表查询" class="headerlink" title="92语法：多表查询"></a>92语法：多表查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称：</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="comment">-- 相当于99语法中的cross join ,出现笛卡尔积，没有意义</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno;</span><br><span class="line"><span class="comment">-- 相当于99语法中的natural join </span></span><br><span class="line"><span class="comment">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于2000的员工</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e,dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno <span class="keyword">and</span> e.sal <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br><span class="line"><span class="comment">-- 查询员工的名字，岗位，上级编号，上级名称（自连接）：</span></span><br><span class="line"><span class="keyword">select</span> e1.ename,e1.job,e1.mgr ,e2.ename </span><br><span class="line"><span class="keyword">from</span> emp e1,emp e2</span><br><span class="line"><span class="keyword">where</span> e1.mgr <span class="operator">=</span> e2.empno;</span><br><span class="line"><span class="comment">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,e.deptno,d.dname,s.grade </span><br><span class="line"><span class="keyword">from</span> emp e,dept d,salgrade s</span><br><span class="line"><span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno <span class="keyword">and</span> e.sal <span class="operator">&gt;=</span> s.losal <span class="keyword">and</span> e.sal <span class="operator">&lt;=</span> s.hisal;</span><br><span class="line"><span class="comment">-- 总结：</span></span><br><span class="line"><span class="comment">-- 1.92语法麻烦 </span></span><br><span class="line"><span class="comment">-- 2.92语法中 表的连接条件 和  筛选条件  是放在一起的没有分开</span></span><br><span class="line"><span class="comment">-- 3.99语法中提供了更多的查询连接类型：cross,natural,inner,outer </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><h3 id="不相关子查询"><a href="#不相关子查询" class="headerlink" title="不相关子查询"></a>不相关子查询</h3><h4 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行子查询：</span></span><br><span class="line"><span class="comment">-- 查询工资高于平均工资的雇员名字和工资。</span></span><br><span class="line"><span class="keyword">select</span> ename,sal</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp);</span><br><span class="line"><span class="comment">-- 查询和CLARK同一部门且比他工资低的雇员名字和工资。</span></span><br><span class="line"><span class="keyword">select</span> ename,sal</span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> (<span class="keyword">select</span> deptno <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;CLARK&#x27;</span>) </span><br><span class="line">      <span class="keyword">and</span> </span><br><span class="line">      sal <span class="operator">&lt;</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;CLARK&#x27;</span>)</span><br><span class="line"><span class="comment">-- 查询职务和SCOTT相同，比SCOTT雇佣时间早的雇员信息  </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> job <span class="operator">=</span> (<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;SCOTT&#x27;</span>) </span><br><span class="line">      <span class="keyword">and</span> </span><br><span class="line">      hiredate <span class="operator">&lt;</span> (<span class="keyword">select</span> hiredate <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;SCOTT&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多行子查询：</span></span><br><span class="line"><span class="comment">-- 【1】查询【部门20中职务同部门10的雇员一样的】雇员信息。</span></span><br><span class="line"><span class="comment">-- 查询雇员信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 查询部门20中的雇员信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;<span class="comment">-- CLERK,MANAGER,ANALYST</span></span><br><span class="line"><span class="comment">-- 部门10的雇员的职务：</span></span><br><span class="line"><span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>; <span class="comment">-- MANAGER,PRESIDENT,CLERK</span></span><br><span class="line"><span class="comment">-- 查询部门20中职务同部门10的雇员一样的雇员信息。</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span> </span><br><span class="line"><span class="keyword">and</span> job <span class="keyword">in</span> (<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>)</span><br><span class="line"><span class="comment">-- &gt; Subquery returns more than 1 row</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span> </span><br><span class="line"><span class="keyword">and</span> job <span class="operator">=</span> <span class="keyword">any</span>(<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>)</span><br><span class="line"><span class="comment">-- 【2】查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span></span><br><span class="line"><span class="comment">-- 查询雇员的编号、名字和工资</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal <span class="keyword">from</span> emp</span><br><span class="line"><span class="comment">-- “SALESMAN”的工资：</span></span><br><span class="line"><span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span></span><br><span class="line"><span class="comment">-- 查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span></span><br><span class="line"><span class="comment">-- 多行子查询：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="keyword">all</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>);</span><br><span class="line"><span class="comment">-- 单行子查询：</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>);</span><br><span class="line"><span class="comment">-- 【3】查询工资低于任意一个“CLERK”的工资的雇员信息。  </span></span><br><span class="line"><span class="comment">-- 查询雇员信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 查询工资低于任意一个“CLERK”的工资的雇员信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&lt;</span> <span class="keyword">any</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">and</span> job <span class="operator">!=</span> <span class="string">&#x27;CLERK&#x27;</span></span><br><span class="line"><span class="comment">-- 单行子查询：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">and</span> job <span class="operator">!=</span> <span class="string">&#x27;CLERK&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="相关子查询"><a href="#相关子查询" class="headerlink" title="相关子查询"></a>相关子查询</h3><p>【1】不相关的子查询引入：<br>不相关的子查询：子查询可以独立运行，先运行子查询，再运行外查询。<br>相关子查询：子查询不可以独立运行，并且先运行外查询，再运行子查询</p>
<p>【2】不相关的子查询优缺点：<br>好处：简单   功能强大（一些使用不相关子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现）<br>缺点：稍难理解</p>
<p>【3】sql展示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 【1】查询最高工资的员工  （不相关子查询）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp)</span><br><span class="line"><span class="comment">-- 【2】查询本部门最高工资的员工   （相关子查询）</span></span><br><span class="line"><span class="comment">-- 方法1：通过不相关子查询实现：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span> <span class="keyword">and</span> sal <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span> <span class="keyword">and</span> sal <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span> <span class="keyword">and</span> sal <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>)</span><br><span class="line"><span class="comment">-- 缺点：语句比较多，具体到底有多少个部分未知</span></span><br><span class="line"><span class="comment">-- 方法2： 相关子查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">where</span> sal <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> e.deptno) <span class="keyword">order</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="comment">-- 【3】查询工资高于其所在岗位的平均工资的那些员工  （相关子查询）</span></span><br><span class="line"><span class="comment">-- 不相关子查询：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">and</span> sal <span class="operator">&gt;=</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="string">&#x27;CLERK&#x27;</span>)</span><br><span class="line"><span class="keyword">union</span> ......</span><br><span class="line"><span class="comment">-- 相关子查询：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">where</span> sal <span class="operator">&gt;=</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp e2 <span class="keyword">where</span> e2.job <span class="operator">=</span> e.job)</span><br></pre></td></tr></table></figure>
<h1 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h1><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h3 id="事务及其特征"><a href="#事务及其特征" class="headerlink" title="事务及其特征"></a>事务及其特征</h3><p>事务（Transaction）是用来维护数据库完整性的，它能够保证一系列的MySQL操作要么全部执行，要么全不执行。</p>
<p>例子1：<br>举一个例子来进行说明，例如转账操作：A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。<br>例子2：<br>在淘宝购物下订单的时候，商家库存要减少，订单增加记录，付款我的账号少100元…操作要么全部执行，要么全不执行</p>
<p>【1】事务的概念<br>事务（Transaction）指的是一个操作序列，该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由DBMS（数据库管理系统）中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有InnoDB（MySQL5.5以后默认的存储引擎）和MyISAM（MySQL5.5之前默认的存储引擎），其中InnoDB支持事务处理机制，而MyISAM不支持。</p>
<p>【2】事务的特性<br>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability）。这四个特性简称为ACID特性。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805164341136.png" alt="image-20240805164341136"></p>
<p>1)原子性<br>原子是自然界最小的颗粒，具有不可再分的特性。事务中的所有操作可以看做一个原子，事务是应用中不可再分的最小的逻辑执行体。<br>使用事务对数据进行修改的操作序列，<strong>要么全部执行，要么全不执行</strong>。通常，某个事务中的操作都具有共同的目标，并且是相互依赖的。如果数据库系统只执行这些操作中的一部分，则可能会破坏事务的总体目标，而原子性消除了系统只处理部分操作的可能性。</p>
<p>2) 一致性<br>一致性是指事务执行的结果必须使数据库从一个一致性状态，变到另一个一致性状态。当数据库中只包含事务成功提交的结果时，数据库处于一致性状态。一致性是通过原子性来保证的。<br>例如：在转账时，只有保证转出和转入的金额一致才能构成事务。也就是说事务发生前和发生后，数据的总额依然匹配。</p>
<p>3) 隔离性<br>隔离性是指各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是说：并发执行的事务之间既不能看到对方的中间状态，也不能相互影响。<br>例如：在转账时，只有当A账户中的转出和B账户中转入操作都执行成功后才能看到A账户中的金额减少以及B账户中的金额增多。并且其他的事务对于转账操作的事务是不能产生任何影响的。</p>
<p>4)持久性<br>持久性指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常是保存进物理数据库，即使数据库出现故障，提交的数据也应该能够恢复。但如果是由于外部原因导致的数据库故障，如硬盘被损坏，那么之前提交的数据则有可能会丢失。</p>
<p>【3】sql展示：使用事务保证转账安全</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建账户表：</span></span><br><span class="line"><span class="keyword">create table</span> account(</span><br><span class="line">        id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">        uname <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>,</span><br><span class="line">        balance <span class="keyword">double</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 查看账户表：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;</span><br><span class="line"><span class="comment">-- 在表中插入数据：</span></span><br><span class="line"><span class="keyword">insert into</span> account <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="string">&#x27;丽丽&#x27;</span>,<span class="number">2000</span>),(<span class="keyword">null</span>,<span class="string">&#x27;小刚&#x27;</span>,<span class="number">2000</span>);</span><br><span class="line"><span class="comment">-- 丽丽给小刚 转200元：</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 默认一个DML语句是一个事务，所以上面的操作执行了2个事务。</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance2 <span class="operator">+</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 必须让上面的两个操作控制在一个事务中：</span></span><br><span class="line"><span class="comment">-- 手动开启事务：用begin命令也可以</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 手动回滚：刚才执行的操作全部取消：</span></span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"><span class="comment">-- 手动提交：</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 在回滚和提交之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</span></span><br></pre></td></tr></table></figure>
<h3 id="事务并发问题"><a href="#事务并发问题" class="headerlink" title="事务并发问题"></a>事务并发问题</h3><p>脏读（Dirty read） </p>
<p>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805164642034.png" alt="image-20240805164642034"></p>
<p>不可重复读 </p>
<p>（Unrepeatableread）: 指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805164707924.png" alt="image-20240805164707924"></p>
<p>幻读 </p>
<p>（Phantom read）: 幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805164725814.png" alt="image-20240805164725814"></p>
<p>不可重复度和幻读区别： </p>
<p>不可重复读的重点是修改，幻读的重点在于新增或者删除。</p>
<p>解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表 </p>
<p>例1（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导 致A再读自己的工资时工资变为 2000；这就是不可重复读。</p>
<p>例2（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读 </p>
<h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><p>事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以MySQL中提供了四种隔离级别来解决上述问题。</p>
<p>事务的隔离级别从低到高依次为READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ以及SERIALIZABLE，隔离级别越低，越能支持高并发的数据库操作。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805164845740.png" alt="image-20240805164845740"></p>
<p>PS：√  代表会出现问题   ， ×代表不会出现问题 = 解决问题</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看默认的事务隔离级别  MySQL默认的是repeatable read  </span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@transaction_isolation</span>;  </span><br><span class="line"><span class="comment">-- 设置事务的隔离级别   （设置当前会话的隔离级别）</span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read uncommitted;  </span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read committed;  </span><br><span class="line"><span class="keyword">set</span> session transaction isolation level repeatable read;  </span><br><span class="line"><span class="keyword">set</span> session transaction isolation level serializable;  </span><br><span class="line"><span class="keyword">start</span> transaction ;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>【1】视图的概念</p>
<p>视图（view）是一个从单张或多张基础数据表或其他视图中构建出来的虚拟表。同基础表一样，视图中也包含了一系列带有名称的列和行数据，但是数据库中只是存放视图的定义，也就是动态检索数据的查询语句，而并不存放视图中的数据，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图时才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据依赖于构建视图的基础表，如果基本表中的数据发生了变化，视图中相应的数据也会跟着改变。</p>
<p>PS:视图本质上就是：一个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的sql语句</p>
<p>【2】视图的好处</p>
<p>简化用户操作：视图可以使用户将注意力集中在所关心地数据上，而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。</p>
<p>对机密数据提供安全保护：有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据（如，敏感字段“salary”）出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能</p>
<p>【3】SQL展示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建/替换单表视图：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> myview01</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,job,deptno </span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">check</span> option;</span><br><span class="line"><span class="comment">-- 查看视图：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myview01;</span><br><span class="line"><span class="comment">-- 在视图中插入数据：</span></span><br><span class="line"><span class="keyword">insert into</span> myview01 (empno,ename,job,deptno) <span class="keyword">values</span> (<span class="number">9999</span>,<span class="string">&#x27;lili&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert into</span> myview01 (empno,ename,job,deptno) <span class="keyword">values</span> (<span class="number">8888</span>,<span class="string">&#x27;nana&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">insert into</span> myview01 (empno,ename,job,deptno) <span class="keyword">values</span> (<span class="number">7777</span>,<span class="string">&#x27;feifei&#x27;</span>,<span class="string">&#x27;CLERK&#x27;</span>,<span class="number">30</span>); </span><br><span class="line"><span class="comment">-- &gt; 1369 - CHECK OPTION failed &#x27;mytestdb.myview01&#x27;</span></span><br><span class="line"><span class="comment">-- 创建/替换多表视图：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> myview02</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,d.deptno,d.dname</span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line"><span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">2000</span> ;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myview02;</span><br><span class="line"><span class="comment">-- 创建统计视图：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> myview03</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> e.deptno,d.dname,<span class="built_in">avg</span>(sal),<span class="built_in">min</span>(sal),<span class="built_in">count</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">using</span>(deptno)</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> e.deptno ;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myview03;</span><br><span class="line"><span class="comment">-- 创建基于视图的视图：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> myview04</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myview03 <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> myview04;</span><br></pre></td></tr></table></figure>
<h2 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h2><p>【1】什么是存储过程(Stored Procedure)</p>
<p>通过前面章节的学习，我们已经知道SQL是一种非常便利的语言。从数据库抽取数据，或者对特定的数据集中更新时，都能通过简洁直观的代码实现。</p>
<p>但是这个所谓的“简洁”也是有限制，SQL基本是一个命令实现一个处理，是所谓的非程序语言。</p>
<p>在不能编写流程的情况下，所有的处理只能通过一个个命令来实现。当然，通过使用连接及子查询，即使使用SQL的单一命令也能实现一些高级的处理，但是，其局限性是显而易见的。例如，在SQL中就很难实现针对不同条件进行不同的处理以及循环等功能。</p>
<p>这个时候就出现了存储过程这个概念，简单地说，存储过程就是数据库中保存(Stored)的一系列SQL命令（Procedure）的集合。也可以将其看作相互之间有关系的SQL命令组织在一起形成的一个小程序。</p>
<p>【2】存储过程的优点</p>
<p>1) 提高执行性能。存储过程执行效率之所高，在于普通的SQL语句，每次都会对语法分析，编译，执行，而存储过程只是在第一次执行语法分析，编译，执行，以后都是对结果进行调用。</p>
<p>2) 可减轻网络负担。使用存储过程，复杂的数据库操作也可以在数据库服务器中完成。只需要从客户端(或应用程序)传递给数据库必要的参数就行，比起需要多次传递SQL命令本身，这大大减轻了网络负担。<br>3) 可将数据库的处理黑匣子化。应用程序中完全不用考虑存储过程的内部详细处理，只需要知道调用哪个存储过程就可以了</p>
<p>【3】图解：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20240805165154244.png" alt="image-20240805165154244"></p>
<p>【4】展示存储过程：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 定义一个没有返回值 存储过程</span></span><br><span class="line"><span class="comment">-- 实现：模糊查询操作：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;%A%&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro01(name <span class="type">varchar</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">        if name <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> name <span class="operator">=</span> &quot;&quot; <span class="keyword">then</span></span><br><span class="line">                <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> concat(<span class="string">&#x27;%&#x27;</span>,name,<span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span> if;	</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- 删除存储过程：</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> mypro01;</span><br><span class="line"><span class="comment">-- 调用存储过程：</span></span><br><span class="line"><span class="keyword">call</span> mypro01(<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">call</span> mypro01(<span class="string">&#x27;R&#x27;</span>);</span><br><span class="line"><span class="comment">-- 定义一个  有返回值的存储过程：</span></span><br><span class="line"><span class="comment">-- 实现：模糊查询操作：</span></span><br><span class="line"><span class="comment">-- in 参数前面的in可以省略不写</span></span><br><span class="line"><span class="comment">-- found_rows()mysql中定义的一个函数，作用返回查询结果的条数</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro02(<span class="keyword">in</span> name <span class="type">varchar</span>(<span class="number">10</span>),<span class="keyword">out</span> num <span class="type">int</span>(<span class="number">3</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">        if name <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> name <span class="operator">=</span> &quot;&quot; <span class="keyword">then</span></span><br><span class="line">                <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> concat(<span class="string">&#x27;%&#x27;</span>,name,<span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span> if;	</span><br><span class="line">        <span class="keyword">select</span> found_rows() <span class="keyword">into</span> num;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- -- 调用存储过程：</span></span><br><span class="line"><span class="keyword">call</span> mypro02(<span class="keyword">null</span>,<span class="variable">@num</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@num</span>;</span><br><span class="line"><span class="keyword">call</span> mypro02(<span class="string">&#x27;R&#x27;</span>,<span class="variable">@aaa</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@aaa</span>;</span><br></pre></td></tr></table></figure>
<h1 id="MySQL高级"><a href="#MySQL高级" class="headerlink" title="MySQL高级"></a>MySQL高级</h1><h2 id="MySQL体系结构"><a href="#MySQL体系结构" class="headerlink" title="MySQL体系结构"></a>MySQL体系结构</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250907234437555.png" alt="image-20250907234437555"></p>
<p>第一层 连接层</p>
<p>输入用户名和密码主要是完成授权认证，然后校验每一个客户端的权限</p>
<p>完成连接的处理，以及安全方案，检查是否超过最大连接数等等</p>
<p>第二层 服务层</p>
<p>有SQL接口，解析器，查询优化器，缓存都是在服务层</p>
<p>第三层 存储引擎层</p>
<p>有很多存储引擎供我们选择，可插拔式的存储引擎</p>
<p>索引是在存储引擎实现的，不同的存储引擎，索引结构式不一样的，默认InnoDB</p>
<p>第四层 磁盘层</p>
<p>最后的数据是存储在磁盘中的，日志数据等等都存储在这</p>
<h2 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h2><p><strong>什么是存储引擎</strong>？</p>
<p>存储引擎是基于表的，不是基于库的，也就是说一个数据库的多张表可以用不同的存储引擎，在创建表的时候可以指定存储引擎，默认是InnoDB</p>
<p><strong>存储引擎特点</strong></p>
<p><strong>事务、外键、行级锁</strong></p>
<p><strong>InnoDB</strong> 5.5版本之后是高可靠性和高性能的通用存储引擎。</p>
<p>特点 DML 数据的增删改语句 遵循ACID模型，原子性，持久性，一致性，隔离性，支持事务</p>
<p>行级锁，提高并发访问性能。</p>
<p>支持外键约束</p>
<p>文件特点，用innodb存储的数据最终会变成xxx.ibd，xxx代表表名，这个文件存储该表的表结构（frm、sdi），数据和索引。</p>
<p>然后有一个参数innodb_file_per_table，然后8.0是默认打开的，也就是说每一张表对应一个文件。</p>
<p>然后如果想要查看ibd的文件内容的话直接打开是二进制文件，如果想要查看表格式的话可以用一个命令</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ibd2sdi 表名.ibd</span><br></pre></td></tr></table></figure>
<p>这样就能在cmd中看到表的结构了，是一堆json文件</p>
<p><strong>InnoDB逻辑存储结构</strong></p>
<p>分为了下面几块</p>
<p>TableSpace : 表空间</p>
<p>Segment: 段</p>
<p>Extent： 区</p>
<p>Page: 页</p>
<p>Row: 行</p>
<p>这几类里面装了什么呢？</p>
<p>首先TableSpace表空间，装了很多个Segment段，然后每个Segement段里面装了很多Extent区，然后区里面装了很多Page页，页包含索引页和数据页，然后页里面包含Row行，就是一行一行的数据，一行中有存储了最后一次操作事务的id，一些指针，还有一列一列的字段。</p>
<p><strong>页是磁盘操作的最小单元，一个页的大小是固定的16k，一个区的大小也是固定的1M，所以说一个区可以存64页</strong></p>
<p><strong>MyISAM</strong></p>
<p>特点：不支持事务，不支持外键，支持表锁，不支持行锁。访问速度快。</p>
<p>MyISAM文件</p>
<p>xxx.sdi 存储表结构信息</p>
<p>xxx.MYD 存储数据</p>
<p>xxx.MYI 存储索引</p>
<p><strong>Memory</strong></p>
<p>这个引擎的表数据是存储在内存中的，由于收到硬件问题或者断点问题的影响，只能将这些表作为临时表或者缓存使用。</p>
<p><strong>特点就是内存存放然后默认hash索引</strong></p>
<p>这里的文件就一个文件xxx.sdi文件只存储表结构，数据都在内存中。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250908224211828.png" alt="image-20250908224211828"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919024313510.png" alt="image-20250919024313510"></p>
<h2 id="索引-index"><a href="#索引-index" class="headerlink" title="索引(index)"></a>索引(index)</h2><p>索引是包住MySQL高效<strong>获取数据</strong>的<strong>数据结构</strong>（有效）。</p>
<p>没有索引的时候就是全表扫描，性能很低</p>
<p>如果有索引需要对age来维护数据结构，如果需要对age建立索引就需要对age建立个b+树来维护索引。</p>
<p>下面先用二叉树来解释</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250910122349900.png" alt="image-20250910122349900"></p>
<p>索引的优缺点</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250910122626432.png" alt="image-20250910122626432"></p>
<p><strong>索引的结构</strong></p>
<p>索引是在存储引擎层实现的，所以不同的引擎有不同的存储结构</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250910123022207.png" alt="image-20250910123022207"></p>
<p>那么B+树是怎么样的呢？</p>
<p>二叉树的缺点：顺序插入时，会形成一个链表，查询性能大大降低，大数据量情况下，层级较深，检索速度慢。</p>
<p>那么这种在增删改的时候自动旋转调整的二叉树称为自平衡二叉排序树，AVL树也是一种例子，但是每次都要重复计算因子，这个因子是和父节点的高度差来维持的，红黑树则是维持平衡的规则不同，红黑树是根据颜色来维持平衡的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250910124426314.png" alt="image-20250910124426314"></p>
<p>那么就用到了红黑树：大数据量情况下，层级较深，检索速度慢</p>
<p>多路那么为了解决层级较深的问题就有用到了B树：多路平衡查找树</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250910124941131.png" alt="image-20250910124941131"></p>
<p>B树是当插入的元素大于key的数量的时候，中间元素会向上分裂</p>
<p><strong>B+树</strong></p>
<p>以一个4阶的b+树为例</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912105656738.png" alt="image-20250912105656738"></p>
<p>所有的元素都会出现在 叶子节点，上面的非叶子节点主要起到索引的所用，所有的元素都会出现在叶子节点，叶子节点会组成一个单向链表。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912110105125.png" alt="image-20250912110105125"></p>
<p>中间元素会向上分裂，并且会形成一个链表，非叶子节点只是一个索引的作用。</p>
<p>在MySQL索引数据结构对经典的B+树进行了优化，在原有的基础上，增加了一个指向相邻叶子节点的链表指针，，就形成了带有顺序指针的B+树，这样提高了区间访问的性能。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912133427291.png" alt="image-20250912133427291"></p>
<p><strong>Hash索引</strong></p>
<p>哈希索引就是采用一定的hash算法，将键值换算成新的hash值，映射到对应的槽位上，庵后存储在hash表中。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912134904424.png" alt="image-20250912134904424"></p>
<p>hash索引的特点，hash索引只能用于对等比较(= ， in) ，不支持范围查询</p>
<p>无法利用索引完成排序操作</p>
<p>查询效率高，通常只需要一次检索就可以了，效率通常会高于b+树索引。前提是不出现哈希碰撞</p>
<p>InnoDB中会有自适应hash功能，会在B+树索引自动的构建为hash索引，具体在后面解释。</p>
<h2 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912145544321.png" alt="image-20250912145544321"></p>
<h3 id="InnoDB存储中又分两类"><a href="#InnoDB存储中又分两类" class="headerlink" title="InnoDB存储中又分两类"></a>InnoDB存储中又分两类</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912212238864.png" alt="image-20250912212238864"></p>
<p>那我们在建表的时候没有指定哪个是聚集索引哪个是二级索引</p>
<p>聚集索引选取规则</p>
<p>如果存在主键，主键索引就是聚集索引</p>
<p>如果没有主见，那么会使用第一个唯一索引为聚集索引</p>
<p>如果没有之间也没有唯一索引，那么会自动生成一个rowid作为隐藏的聚集索引</p>
<p><strong>存在主键的情况</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250912212921992.png" alt="image-20250912212921992"></p>
<p>那么如果我们要查询数据的时候，是怎么执行的呢？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;Arm&#x27;</span></span><br></pre></td></tr></table></figure>
<p>会先走二级索引定位到id值，那么查询到10之后再到聚集索引中回表查询，找到10的叶子节点，找到了行数据</p>
<p>找到了对应的叶子节点后，因为一片叶子默认16KB大小，所以理论上可以存多条记录，那么在夜里面会根据二分找到页目录对应的槽位然后找到对应的分组，从而找到对应的记录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919031722231.png" alt="image-20250919031722231"></p>
<p><strong>每个分组1-8条记录</strong></p>
<p>例题：下面sql语句哪条执行效率高？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;Arm&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>备注：id是主键，name也建立了索引</p>
<p>第一条效率高，因为是直接从聚集索引查询，不需要像第二条一样需要回表查询</p>
<p>例题InnoDB主键索引的B+tree高度为多高呢？</p>
<p>假设： 一行数据大小为1k，一页中可以存储16行这样的数据。InnoDB 的指针占用6个字节的空间，主键即使是bigint，占用字节数为8（如果是Int就是4字节，主键占用的空间，由主键的类型决定）</p>
<p>那么高度为2：</p>
<p>指针式6字节的，这里的n指的是一个索引页中可以有的主键数量，暂时待定，算出n约为1170</p>
<p>n <em> 8 + (n +1) </em> 6 =  16 *1024</p>
<p>那么如果高度为2的时候可以存储的数量为1171 * 16 = 18736条记录</p>
<p>高度为3 可以存2000w条记录</p>
<p>总结</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919024439969.png" alt="image-20250919024439969"></p>
<h2 id="索引语法"><a href="#索引语法" class="headerlink" title="索引语法"></a>索引语法</h2><p>创建索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">unique</span> <span class="operator">|</span> fulltext] index index_name <span class="keyword">on</span> table_name(index_col_name,...);</span><br></pre></td></tr></table></figure>
<p>如果一个索引之关联一个字段，叫单列索引，如果多个字段叫联合索引或者组合索引</p>
<p>如果不指定索引类型默认为普通索引</p>
<p>查看索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show index from table_name</span><br></pre></td></tr></table></figure>
<p>删除索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index index_name on table_name</span><br></pre></td></tr></table></figure>
<h3 id="SQL性能分析"><a href="#SQL性能分析" class="headerlink" title="SQL性能分析"></a>SQL性能分析</h3><p>为什么需要学习SQL性能分析工具，因为我们需要了解需要知道每条SQL的性能，我们主要优化的是哪种SQL，主要优化的查询语句，那么一般是优化索引。</p>
<p><strong>Sql的执行频率</strong></p>
<p>MySQL客户端连接成功后，通过下面的指令看到数据库常用的操作是哪个，进而开始思考优化方向</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> [<span class="keyword">global</span> <span class="operator">|</span> session ] status <span class="keyword">like</span> <span class="string">&#x27;Com_______&#x27;</span>;<span class="operator">/</span><span class="operator">/</span> 后面是模糊匹配Com7个下划线</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250913123516838.png" alt="image-20250913123516838"></p>
<p><strong>慢查询日志</strong></p>
<p>如果我们已经知道数据库常用的是select查询，那么我们再看要优化哪些sql语句呢？我们通过慢查询日志，这里面记录了所有执行时间超过制定参数（long_query_time，单位：秒，默认10秒）的所有SQL语句的日志，MySQL的慢查询日志默认没有开启，需要再MySQL的配置文件（/etc/my.cnf）中配置如下信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;slow_query_log&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>看到慢查询开关默认关闭</span><br></pre></td></tr></table></figure>
<p>然后在配置文件中配置如下信息</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250913131550822.png" alt="image-20250913131550822"></p>
<p>然后重启Mysql服务就好了</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysql</span><br></pre></td></tr></table></figure>
<p>然后在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f localhost-slow.log</span><br></pre></td></tr></table></figure>
<p>通过这个命令就能看到慢查询日志记录尾部的记录</p>
<p><strong>profile详情</strong></p>
<p>慢查询是超过了预设时间才会记录的，如果没超过但是依旧很长的就不会记录，那么如果业务简单但是时间依旧很长，那么我们就用profile，利用show profiles 能够在做SQL优化时帮助我们了解时间耗费到哪里了，通过have_profiling参数，能够看到当前MySQL是否支持profile操作：</p>
<p><strong>查看是否支持profile</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@have_profiling</span><br></pre></td></tr></table></figure>
<p><strong>查看是否开启</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@profiling</span><br></pre></td></tr></table></figure>
<p><strong>开启profile</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set profiling = 1;</span><br></pre></td></tr></table></figure>
<p><strong>查看sql语句耗时情况</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> profiles;</span><br></pre></td></tr></table></figure>
<p>那看到了一个耗时比较长的，我们可以更加详尽的查看详尽信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> profile <span class="keyword">for</span> query [query id]</span><br></pre></td></tr></table></figure>
<p>然后就能看到详细的sql信息了。</p>
<p><strong>查看cpu的耗费情况</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> profile cpu <span class="keyword">for</span> query query_id</span><br></pre></td></tr></table></figure>
<p><strong>explain执行计划</strong></p>
<p>通过在select 语句之前加上explain就可以看到这条sql语句的执行计划，可以清晰的看出来</p>
<p>id ： 指代的事sql语句中的执行顺序，如果id相同，执行顺序从上到下，如果id不同，值越大约先执行。(在多表查询的时候就能看出来了)</p>
<p>select_type</p>
<p>表示select的类型，常见的取值有simple(简单表，即不使用表连接或者子查询)、PRIMARY（主查询，即外层查询）、UNION（UNION中的第二个或者后面的查询语句）、SUBQUERY（SELECT/WHERE之后包含了子查询）等</p>
<p>type:</p>
<p>表示连接类型，性能由好到差的连接类型为null、system、const、eq_ref、range、index、all</p>
<p>possible_key</p>
<p>显示可能；应用在这张表的索引</p>
<p>key</p>
<p>实际使用的索引</p>
<p>key_len</p>
<p>表示索引中使用的字节数，该值为索引字段最大可能长度。</p>
<p>rows</p>
<p>MySQL认为必须要执行查询的行数，这是一个估计值</p>
<p>filtered</p>
<p>表示返回结果的行数占需读取行数的百分比，filtered的值越大越好。读了多少返回多少</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250913172738303.png" alt="image-20250913172738303"></p>
<h2 id="索引使用"><a href="#索引使用" class="headerlink" title="索引使用"></a>索引使用</h2><p>在未建立索引之前，可以执行sql语句，查看sql的耗时</p>
<p>然后根据字段创建索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create index index_name on table_name(col_name);</span><br></pre></td></tr></table></figure>
<p>然后再查询sql然后就能发现索引提高性能的优势了。</p>
<p><strong>索引使用原则</strong></p>
<p>如果索引了多列（联合索引），要遵循最左前缀法则。最左前缀法则指的是查询从索引的最左列开始，并且不跳过索引中的列。如果跳跃某一列，<strong>索引将部分失效（后面的字段索引失效）</strong></p>
<p> <strong>如果拥有联合索引但是查询语句的where字段后面没有满足最左前缀法则，就会令索引失效然后全表扫描，跟放的位置没有关系，只要存在就行。</strong></p>
<p><strong>范围查询</strong></p>
<p>联合索引中，出现范围查询（&gt;，&lt;）,范围查询右侧的列索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">and</span> city <span class="operator">=</span> <span class="string">&#x27;beijing&#x27;</span>;<span class="operator">/</span><span class="operator">/</span>那么这时候city的索引就会失效了</span><br></pre></td></tr></table></figure>
<p>规避的话可以用&gt;=就可以规避这个问题了</p>
<p><strong>索引列运算</strong></p>
<p>不要在索引列上进行运算操作，<strong>否则索引会失效</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250913181901172.png" alt="image-20250913181901172"></p>
<p><strong>字符串不加引号</strong></p>
<p>字符串类型字段，不加引号，索引就会失效</p>
<p><strong>模糊查询</strong></p>
<p>如果仅仅是尾部模糊匹配，索引不会失效，如果是头部模糊匹配，索引会失效。</p>
<p><strong>or连接条件</strong></p>
<p>用Or分隔开的条件，如果or前的条件中的列有索引，而后面的列中没有索引，那么设计的索引都不会被用到</p>
<p><strong>mysql使用索引的时候会先判断如果符合条件的&lt;=30 % 就会走索引否则就会全表扫描</strong></p>
<p><strong>SQL提示</strong></p>
<p>在explain执行查询语句的时候,mysql会自动选择最好的索引，但是也可以不用，在SQL语句中加入一些人为的提示来达到优化 操作的目的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250913185020402.png" alt="image-20250913185020402"></p>
<p><strong>覆盖索引</strong></p>
<p>尽量使用覆盖索引（查询使用了索引，并且需要返回的列，在该索引中已经全部能够找到）减少select *</p>
<p>举个例子假设查询name和age这两个字段都有索引，然后如果select里面有这两个字段，这样InnoDB直接从二级索引中拿到所有需要的数据name和age了，不需要回主键索引查完整的行数据，但是如果用select * 那么当某些字段比如city 没有索引的时候，就需要回表查询性能就会变低。</p>
<p><strong>前缀索引</strong></p>
<p>当字段类型为字符串（varchar\text等）时，有时候需要索引很长的字符串，这会让索引变得很大，查询时，浪费大量的磁盘IO，影响查询效率。此时可以只将字符串的一部分前缀，建立索引，这样可以大大节约索引空间，从而提高索引效率。</p>
<p><strong>创建前缀索引</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create index idx_xxx on table_name(column(n));</span><br></pre></td></tr></table></figure>
<p>这个n就代表前缀长度了。那么这个n设置多长合适呢？</p>
<p>我们可以通过下面两个公式来求取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select count(distinct email) / count(*) from user;</span><br><span class="line">select count(distinct substring(email,1,5)) / count(*) from user;</span><br></pre></td></tr></table></figure>
<p><strong>单列索引联合索引</strong></p>
<p>在业务场景中，如果存在多个查询条件，考虑针对查询字段建立索时，建议建立联合索引。</p>
<p><strong>索引下推</strong></p>
<p><strong>这个是对于非聚集索引的联合索引查询来说，如果是聚集索引这个机制不生效</strong></p>
<p>原本没有索引下推这个机制是二级索引查到主键id后回表完成再where条件过滤</p>
<p>有了这个机制是直接查到数据后进行where过滤再进行回表，减少回表次数</p>
<h2 id="SQL优化"><a href="#SQL优化" class="headerlink" title="SQL优化"></a>SQL优化</h2><p><strong>插入数据优化</strong></p>
<p>insert优化</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> tb_name <span class="keyword">values</span>(...);</span><br></pre></td></tr></table></figure>
<p>批量插入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> tb_name <span class="keyword">values</span>(...),(...)...;</span><br></pre></td></tr></table></figure>
<p>手动提交事务：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="keyword">insert into</span> tb_name <span class="keyword">values</span>(...),(...);</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
<p>主键顺序插入</p>
<p>主键插入顺序插入从1、2、3。。。这样顺序插入</p>
<p><strong>如果大批量插入数据用load指令</strong></p>
<p>那么如何使用load命令呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#客户端连接服务端时，加上参数 --local-infile</span><br><span class="line">mysql --local-infile -u root -p</span><br><span class="line">#设置全局参数local_infile为1,开启从本地加载文件导入数据的开关</span><br><span class="line">set global local_infile = 1;</span><br><span class="line">#执行load指令将准备好的数据，加载到表结构中</span><br><span class="line">load data local infile &#x27;/root/sql1.sql&#x27; into table &#x27;user&#x27; fields terminated by &#x27;,&#x27; lines terminated by &#x27;\n&#x27;</span><br><span class="line">#用,分隔列，每一行代表一行数据,</span><br></pre></td></tr></table></figure>
<p><strong>主键优化</strong></p>
<p>主键顺序插入的性能高于乱序插入的性能。</p>
<p>在InnoDB存储引擎中，表数据都是根据主键顺序组织存放的 <strong>也就是说是最后的链表是根据主键顺序存发放的</strong>，这种存储方式的表称为 <strong>索引组织表（IOT Index Organized Table）</strong></p>
<p><strong>页分裂</strong></p>
<p>页可以为空，也可以一半也可以填充100%。每行包含了2 ~ N 行数据（如果一行数据过大，就会行溢出），根据主键排列。</p>
<p>页可以为空，但是不为空的页最少要有2行数据</p>
<p><strong>主键如果乱序插入的时候，由于为了保证叶子节点链表的顺序，可能会出现页分裂的情况，重新设置链表的指针，导致性能降低。</strong></p>
<p><strong>页合并</strong></p>
<p>在删除数据的时候，删除的时候当页中达到页的50%的时候，InnoDB会开始寻找最靠近的页看看是否可以将两个页合并以优化空间使用</p>
<p><strong>MERGE_THRESHOLD: 合并页的阈值，可以自己设置，默认50%</strong></p>
<p><strong>主键设计原则</strong></p>
<p>插入数据的时候，尽量选择顺序插入，选择使用AUTO_INCREMENT自增主键，尽量不要使用UUID做主键或者是其他自然主键，如身份证号。业务操作的时候避免操作主键</p>
<p><strong>order by 优化</strong></p>
<p>1、Using filesort：通过表的索引或全表扫描，读取满足条件的数据行，然后在排序缓冲区sort buffer 中完成排序操作，所有不是通过索引直接返回排序结果的排序都叫FileSort排序</p>
<p>2、Using index: 通过有序索引顺序扫描直接返回有序数据，这种情况叫using index，不需要额外排序，操作效率高</p>
<p>简单理解就是需要排序的字段创建索引就会通过using index直接排序，而不需要全表扫描</p>
<p>并且这个时候也遵循最左前缀法则</p>
<p>并且如果一个用desc 一个用asc，这样查找的时候第一个用using index，第二个就会全表扫描了</p>
<p>那么为了解决这个问题可以创建索引的时候指定升序还是降序，如果不设置默认升序</p>
<p>也可以单独设一个单列索引</p>
<p>如果不可避免的出现filesort ，大量数据排序时，可以适当增大排序缓冲区大小sort_buffer_size(默认256k)</p>
<p><strong>group by优化</strong></p>
<p>也是通过覆盖索引来提升性能，满足最左前缀法则</p>
<p><strong>limit优化</strong></p>
<p>什么时候需要通过对limit的优化呢</p>
<p>一个常见的问题就是limit 200000,10,此时需要排序前2000010条记录，但是仅仅返回200000~2000010十条记录，其他记录丢弃，查询排序的代价极大。</p>
<p>这个时候也需要覆盖索引+子查询的形式进行优化</p>
<p>覆盖索引只是跳过了前200000条数据，但是跳过还是需要从第一个开始找到第200000条，只是没有对前面的进行排序了，那么如果再加上子查询，由于子查询直接定位到第200000条就不用。</p>
<p>详细解释一下，没加子查询的时候用limit的时候，需要利用索引然后找到主键然后回表，从第一条开始回表，然后一直到20000条回表，然后前面的200000条回表式不用的，这就造成了浪费。</p>
<p>那么用子查询的时候直接用id来进行子查询，那么就可以省略2000000条回表，因为id是聚集索引，那么就省略了200000条回表了，然后通过id直接定位到200000条数据，然后再利用索引然后回表10条数据就可以拿到10条数据的信息了</p>
<p><strong>count优化</strong></p>
<p>对于Innodb的时候执行count(*) 的时候，需要把数据一行一行的取出，然后累计计数，这个没有什么好的优化 方法了，优化思路的时候只能自己计数，自己去维护计数了，用redis或者别的方式来计数了。</p>
<p><strong>count的几种用法</strong></p>
<p>count(*)、count(主键)，count(字段)、count(1)</p>
<p>count(1) 是每一行放1进去，直接进行累加</p>
<p>count(*)专门做了优化，不取值，直接进行累加</p>
<p><strong>update优化</strong></p>
<p><strong>注意用例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一个会话开启一个事务</span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">update</span> course <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;JavaEE&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 另一个会话开启事务也更新</span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">update</span> course <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;Spring&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>id和name 不是同一行数据也会更新失败为什么呢？</p>
<p>因为name没有索引，这时候就不是行级锁了，所以他把整张表都锁住了</p>
<p><strong>行锁是针对索引加的锁，不是针对记录加的锁，并且索引不能失效，否则就会进化为表锁</strong></p>
<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>触发器就是当某个事件发生的时候，数据库自动执行的一段代码</p>
<p>在数据库中的事件就是：INSERT、UPDATE、DELETE</p>
<p>然后时机，可以是BEFORE或ALTER事件发生前后</p>
<p>然后在哪张表上定义触发器</p>
<p>然后设置要执行的SQL语句可以是多条</p>
<p>使用别名old和new来引发触发器中发生变化的记录内容。举个例子原来数据库中有个id字段，然后如果创建了一个触发器，那么在begin和end中就能用old_id和new_id来获取更新前和更新后的id数据了，这个数据是在Undo Log<strong>中的具体如何来的可以看UndoLog</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250915205018137.png" alt="image-20250915205018137"></p>
<p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> trigger_name</span><br><span class="line">before<span class="operator">/</span>after <span class="keyword">insert</span><span class="operator">/</span><span class="keyword">update</span><span class="operator">/</span><span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> tb_name <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> <span class="comment">-- 行级触发器</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	trigger_stmt; <span class="comment">-- 具体的sql逻辑</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> triggers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> [schema_name.]trigger_name;<span class="comment">-- 如果没有指定schema_name，默认当前数据库</span></span><br></pre></td></tr></table></figure>
<h2 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h2><p><strong>全局锁</strong> 锁定数据库中的所有表</p>
<p>经典的使用场景就是做全库的逻辑备份，从而获得一致性视图，保证数据的完整性。</p>
<p><strong>加全局锁</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flush tables <span class="keyword">with</span> read lock;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行数据备份</span></span><br><span class="line">mysqldump <span class="operator">-</span>uroot <span class="operator">-</span>p1234 tb_name<span class="operator">&gt;</span>sql_name.sql</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 解锁</span></span><br><span class="line">unlock tables;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>存在的问题：</p>
<p>1、如果在主库上备份，那么在备份期间都不能执行更新，业务基本上就得停摆</p>
<p>2、如果在从库上备份，那么在备份期间从库不能执行主库同步过来的二进制文件（binlog），会导致主从延迟。</p>
<p>在InnoDB引擎中，可以在备份时加上一个参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 执行数据备份</span><br><span class="line">mysqldump --single-transaction -uroot -p1234 tb_name&gt;sql_name.sql</span><br></pre></td></tr></table></figure>
<p>这样就可以不加锁来完成一致性数据备份</p>
<p><strong>表级锁</strong> 锁定整张表</p>
<p>对于表级锁，主要又分为三类</p>
<p>1、表锁    表锁又分为两类，读锁 read lock和写锁 write lock</p>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lock tables 表名  read/write</span><br><span class="line"></span><br><span class="line">unlock tables / 客户端断开连接</span><br></pre></td></tr></table></figure>
<p>读锁就是能读不能写，其他客户端是能读不能写</p>
<p>写锁是当前客户端能读也能写，但是其他客户端不能读和写</p>
<p>2、元数据锁</p>
<p>元数据锁加锁过程中是系统自动控制的，无需显示使用，在访问一张表的时候会自动加上。元数据锁主要作用是维护表元数据的数据一致性，在表上有活动实物的时候，不可以对元数据进行写入操作。</p>
<p><strong>元数据就是表字段</strong></p>
<p><strong>在对一张表进行增删改查的时候，会自动加MDL读锁（共享锁），当对表结构进行变更操作的时候（alter table 的时候），加MDL写锁（排他锁）</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917104257526.png" alt="image-20250917104257526"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>当前已有锁 \ 请求的锁</th>
<th><code>SHARED_READ</code> (SR)</th>
<th><code>SHARED_WRITE</code> (SW)</th>
<th><code>EXCLUSIVE</code> (X)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SHARED_READ</code> (SR)</td>
<td>✅ 兼容</td>
<td>✅ 兼容</td>
<td>❌ 不兼容（等待）</td>
</tr>
<tr>
<td><code>SHARED_WRITE</code> (SW)</td>
<td>✅ 兼容</td>
<td>✅ 兼容</td>
<td>❌ 不兼容（等待）</td>
</tr>
<tr>
<td><code>EXCLUSIVE</code> (X)</td>
<td>❌ 不兼容（等待）</td>
<td>❌ 不兼容（等待）</td>
<td>❌ 不兼容（等待）</td>
</tr>
</tbody>
</table>
</div>
<p>3、意向锁</p>
<p>为了解决行锁和表锁的冲突，加入了意向锁，在加表锁的时候不用检查每行是否加锁，使用意向锁来检查，是否可以添加表锁。因为如果已经加了行锁就不能加表锁了。</p>
<p>1、意向共享锁（IS）：由语句select … lock in share mode添加 ,与表锁共享锁read兼容，与表锁排他锁write互斥。</p>
<p>2、意向排他锁（IX）：由insert,update,delete,select … for update 添加，与表锁共享锁read和排他锁write都互斥。意向锁之间不会互斥。</p>
<p>可以通过下面这个语句查看意向锁的情况</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select object_schema,object_name,index_name,locak_type,lock_mode,lock_data from performance_schema.data_locks;</span><br></pre></td></tr></table></figure>
<p><strong>行级锁</strong> 锁定对应的行数据</p>
<p>行级锁，每次操作锁住对应的行数据，锁定粒度最小，发生锁冲突的概率最低，并发度最高。</p>
<p>InnoDB的数据是基于索引组织的，行锁是通过对索引上的索引项加锁来实现的，而不是对记录加的锁。</p>
<p>行级锁分为</p>
<p>1、行锁（Record Lock），锁定单个行记录的锁，防止其他事务对此进行update和delete。在RC、RR隔离级别下都支持。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>READ UNCOMMITTED</code></td>
<td>✅ 可能</td>
<td>✅ 可能</td>
<td>✅ 可能</td>
<td>最低级别，读未提交数据</td>
</tr>
<tr>
<td><code>READ COMMITTED</code></td>
<td>❌ 不可能</td>
<td>✅ 可能</td>
<td>✅ 可能</td>
<td>读已提交数据（Oracle 默认）</td>
</tr>
<tr>
<td><code>REPEATABLE READ</code></td>
<td>❌ 不可能</td>
<td>❌ 不可能</td>
<td>✅ 可能</td>
<td>可重复读（MySQL InnoDB 默认）</td>
</tr>
<tr>
<td><code>SERIALIZABLE</code></td>
<td>❌ 不可能</td>
<td>❌ 不可能</td>
<td>❌ 不可能</td>
<td>最高级别，完全串行执行</td>
</tr>
</tbody>
</table>
</div>
<p>2、间隙锁（Gap Lock） 锁定索引记录间隙（不含该记录），<strong>确保索引记录间隙不变，防止其他事物在这个间隙进行insert，产生幻读</strong>。在RR隔离级别下都支持。</p>
<p>3、临建锁（Next-Key Lock）: 行锁和间隙锁的组合，同时锁住数据，并且锁住数据前面的所有间隙Gap，在RR隔离级别下支持。</p>
<p><strong>行锁分为共享锁和排他锁</strong></p>
<p>共享锁（S） ：允许一个事务去读一行，防止其他事务获得相同数据集的排他锁</p>
<p>排他锁（X）：允许获取排他锁的事务更新数据，防止其他事务获得相同数据集的共享锁和排他锁。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917115553272.png" alt="image-20250917115553272"></p>
<p>那么在SQL语句，InnoDB会隐式帮我们加锁</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917115714070.png" alt="image-20250917115714070"></p>
<p>默认情况下，InnoDB在RR事务隔离界别运行，InnoDB使用next-key 锁进行搜索和索引扫描，以防止幻读。</p>
<p>1、针对唯一索引进行检索时，对已存在的记录进行等值匹配时，将会自动优化为行锁</p>
<p>2、InnoDB的行锁是针对于索引加的锁，不通过索引条件检索数据，那么InnoDB将对表中的所有记录加锁，此时 <strong>就会升级为表锁</strong></p>
<p><strong>间隙锁/临键锁</strong></p>
<p>默认情况下，InnoDB在Repeatable Read 事务隔离级别运行，InnoDB使用 next-key锁进行搜索和索引扫描，以防止幻读。</p>
<p>1、索引上的等值查询（唯一索引），给不存在的记录加锁时，优化为间隙锁。</p>
<p>2、索引上的等值查询（普通索引），向右遍历时最后一个值不满足查询需求时，next-key lock 退化为间隙锁。</p>
<p>3、索引上的范围查询（唯一索引），会访问到不满足条件的第一个值位置</p>
<p><strong>间隙锁唯一目的是防止其他事务插入间隙。间隙可以共存，一个事务采用的间隙锁不会阻止另一个事物在同一个间隙上采用间隙锁</strong></p>
<p><strong>如果MySQL出现死锁怎么办？</strong></p>
<p>如果线上遇到死锁的情况，可以通过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> ENGINE INNODB STATUS;</span><br></pre></td></tr></table></figure>
<p>来获取死锁的日志信息，从而定位到死锁发生的原因。</p>
<p>解决方法：</p>
<p>1、自动检测与回滚：MySQL自带死锁检测机制（innodb_deadlock_detect），当检测到死锁时，数据库会自动回滚其中一个事务，以解除死锁，通常回滚事务中持有最少资源的那个。</p>
<p>2、也有锁等待超时的参数（innodb_lock_timeout），当获取锁的等待时间超过阈值时，就释放锁进行回滚。</p>
<p>3、手动Kill发生死锁的语句</p>
<p>可以通过命令，手动快速的找出被阻塞的事务及其线程ID，然后手动kill他，及时释放资源。</p>
<p><strong>MySQL中int(11) 的11表示什么</strong></p>
<p>MySQL中，int(11)中的11表示显示宽度，并不影响存储大小或数值范围。</p>
<p>在8.0中，显示宽度被正式弃用</p>
<p><strong>显示宽度</strong> 当使用ZEROFILL属性时，int(11)表示如果数值的位数少于11位，则会在前面填充-，如果不适用这个属性就会显示 42（前面有9个空格）</p>
<p><strong>存储大小</strong> int类型始终占4字节32位，可以表示的范围是-214783648 到 214783647</p>
<h2 id="InnoDB引擎"><a href="#InnoDB引擎" class="headerlink" title="InnoDB引擎"></a>InnoDB引擎</h2><p><strong>逻辑存储结构</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917155028110.png" alt="image-20250917155028110"></p>
<p>表空间（ibd文件），一个mysql实例可以对应多个表空间，用于存储记录、索引等数据。</p>
<p>段 分为数据段、索引段、回滚段，InnoDB是索引组织表，数据段就是B+树的叶子节点，索引段就是B+树的非叶子节点。段用来管理多个Extent（区）</p>
<p>区，表示空间的单元结构，每个区的大小是1M。默认情况下，InnoDB存储引擎页大小为16K，即一个区中一共有64个连续的页</p>
<p>页，是InnoDB存储引擎磁盘管理的最小单元，每个页的大小默认为16KB，为了保证页的连续性，InnoDB存储引擎每次从磁盘申请4-5个区</p>
<p>行，InnoDB存储引擎数据是按行进行存放的。</p>
<p>然后行里面有Trx_id：每次对某条记录进行改动时，都会把对应的事务id赋值给trx_id隐藏列</p>
<p>Roll_pointer：每次对某条记录进行改动时，都会把旧的版本写入到undo日志中，然后这个隐藏列就相当于一个指针，可以通过它来找到该记录修改前的信息。</p>
<p><strong>架构</strong></p>
<p>下面是InnoDB架构图，左侧为内存结构，右侧为磁盘结构</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917174038952.png" alt="image-20250917174038952"></p>
<p><strong>单看内存结构</strong></p>
<p>有四个区域，缓冲区，更改缓冲区，自适应Hash索引，日志缓冲区。</p>
<p><strong>Buffer Pool ：缓冲池</strong>，是主内存中的一个区域，里面可以缓存磁盘上经常操作的真实数据，在执行增删改查操作时，先操作缓冲池中的数据（若缓冲池没有数据，则从磁盘加载并缓存），然后再以一定频率刷新到磁盘，从而减少磁盘IO，加快处理速度。</p>
<p>缓冲区以Page页为单位，底层采用链表数据结构，管理Page,根据状态，将Page分为三种状态</p>
<p>1、free page： 空闲page，未被使用</p>
<p>2、clean page：被使用page，数据没有被修改过</p>
<p>3、dirty page：脏页，被使用page，数据被修改过，页中数据与磁盘的数据产生了不一致。</p>
<p><strong>Change Buffer：更改缓冲区</strong> 针对于非唯一二级索引页，在执行DML（增删改）语句时，如果这些数据Page没有在缓冲池中，不会直接操作磁盘，而会将数据变更  存在  更改缓冲区中，在未来数据被读取时，再将数据合并恢复到缓冲池中，再将合并后的数据刷新到磁盘中。</p>
<p>Change Buffer的意义是什么？</p>
<p>和聚集索引不同，二级索引通常是非唯一的，并且以相对随机的顺序插入二级索引，同样，删除和更新可能会影响索引树中不相邻的二级索引页，如果每一次都操作磁盘，会造成大量的磁盘IO，有了ChangeBuffer之后，我们可以在缓冲池中进行合并处理，减少磁盘IO</p>
<p>​                           </p>
<p><strong>Adaptive Hash Index：自适应hash索引</strong>，用于优化对Buffer Pool 数据的查询。InnoDB存储引擎会监控对表上各个索引页的查询，如果观察到hash索引可以提升速度，则建立hash索引，称之为自适应hash索引。</p>
<p><strong>自适应哈希索引，无需人工干预，是系统根据情况自动完成</strong></p>
<p>参数：adaptive_hash_index</p>
<p><strong>Log Buffer：日志缓冲区</strong> 用来保存要写入到磁盘中的LOG日志数据（redo log\ undo log）</p>
<p>默认大小为16MB，日志缓冲区的日志会定期刷新到磁盘中。如果需要更新、插入或删除许多行的事务，增加日志缓冲区的大小可以节省磁盘I/O</p>
<p>参数：</p>
<p>innodb_log_buffer_size: 缓冲区大小</p>
<p>innodb_flush_log_at_trx_commit: 日志刷新到磁盘的时机</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917195601536.png" alt="image-20250917195601536"></p>
<p><strong>磁盘结构</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917195808847.png" alt="image-20250917195808847"></p>
<p><strong>System Tablespace：系统表空间</strong> 是更改缓冲区的存储区域。如果表是在系统表空间而不是每个表文件或通用表空间中创建的，它也可能包含表和索引数据。</p>
<p>参数：innodb_data_file_path</p>
<p><strong>File-Per-Table Tablespaces：每个表的文件表空间包含单个InnoDB表的数据和索引</strong>，并存储在文件系统上的单个数据文件中。</p>
<p>参数innodb_file_per_table</p>
<p><strong>Genenral Tablespaces：通用表空间</strong>，需要通过CREATE TABLESPACE语法创建通用表空间，在创建表时，可以指定该表空间。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> TABLESPACE xxxx <span class="keyword">ADD</span></span><br><span class="line">DATAFILE <span class="string">&#x27;file_name&#x27;</span></span><br><span class="line">ENGINE<span class="operator">=</span>engine_name;</span><br></pre></td></tr></table></figure>
<p>创建完表空间之后（这个需要自己手动创建不然是不会有的），创建表的时候就可以自己指定表空间</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> xxx.... TABLESPACE ts_name;</span><br></pre></td></tr></table></figure>
<p><strong>Undo Tablespaces：撤销表空间</strong>，MySQL实例在初始化时会自动创建两个默认的undo表空间（初始大小16M），用于存储undo log 日志</p>
<p><strong>Temporary Tablespaces：InnoDB使用会话临时表空间和全局临时表空间</strong>。存储用户创建的临时表等数据</p>
<p><strong>Doublewrite Buffer Files：双写缓冲区</strong>，innoDB引擎将数据页从Buffer Pool 刷新到磁盘前，先将数据页写入双写缓冲区文件中，便于系统异常时恢复数据。</p>
<p>通常在系统表空间文件中，分为两个1MB的区域，合计2MB，每个区域可以存储64个16KB的页。</p>
<p><strong>Redo Log：重做日志</strong>，用来实现事务的持久性。该日志文件由两部分组成，重做日志缓冲redo log buffer，以及重做日志文件redo log，前者是在内存中，后者是在磁盘中。当事务提交后会把所有修改信息都存放到该日志中，用于在刷新脏页到磁盘是，发生错误时，进行数据恢复使用。</p>
<p><strong>后台线程</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917213443794.png" alt="image-20250917213443794"></p>
<p>后台线程就是将InnoDB中缓冲区的数据在合适的时候刷新到磁盘文件当中。</p>
<p>分为4类线程</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917213905984.png" alt="image-20250917213905984"></p>
<h2 id="事务原理"><a href="#事务原理" class="headerlink" title="事务原理"></a><strong>事务原理</strong></h2><p>事务，是一组操作的集合，是一个不可分割的工作单位，要么同时成功，要么同时失败。</p>
<p>事务的四个特性：ACID，原子性，一致性，隔离性，持久性</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250917214407565.png" alt="image-20250917214407565"></p>
<p><strong>redo log 持久性</strong></p>
<p>用来实现事务的持久性。该日志文件由两部分组成，重做日志缓冲redo log buffer，以及重做日志文件redo log，前者是在内存中，后者是在磁盘中。当事务提交后会把所有修改信息都存放到该日志中，用于在刷新脏页到磁盘是，发生错误时，进行数据恢复使用。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918141638233.png" alt="image-20250918141638233"></p>
<p>redo log执行流程：当事务中执行大量的操作数据的操作会先提交到buffer pool 然后把更改的操作记录在redolog buffer 中，当提交的时候，同时将redolog提供过后台线程刷新到磁盘中，如果刷新失败那么也会事务提交失败，所以就保证了一致性。（如果没有redolog的话他会不定时的把脏页刷新到磁盘中，中间可能会刷新失败从而保证不了一致性）</p>
<p>并且redolog不会把脏页刷新，先把redo log 文件异步刷新到磁盘中，而且日志是追加的，脏页是随机的，日志是顺序的，也就是先写日志，再刷新脏页。（WAL  Write-Ahead Logging）</p>
<p>当脏页刷新完之后，redolog 就没用了，所以也会不定时的清理redolog文件</p>
<p><strong>undo log 原子性</strong></p>
<p><strong>在真正修改数据之前，先记下“这个数据原来是什么”</strong></p>
<p>回滚日志，用于记录数据被修改前的信息，作用包含两个：提供回滚 和 MVCC（多版本并发控制）</p>
<p>undo log 和 redo log 记录物理日志不一样，他是逻辑日志。可以认为当delete一条记录时，undo log 会记录一条对应的insert记录，反之亦然。当执行rollback时，就可以从undo log中的逻辑记录读取到相应的内容并进行回滚。</p>
<p>undo log销毁：undo log在事务执行时产生，事务提交时，并不会立即删除undo log，因为这些日志可能还用于MVCC。</p>
<p>undo log存储：undo log采用段的方式进行管理和记录，存放在前面介绍的rollback segment回滚段中，内部包含1024个undo log segment。</p>
<p><strong>MVCC</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918145521659.png" alt="image-20250918145521659"></p>
<p><strong>MVCC实现原理</strong></p>
<p>三个隐式字段、Undo log 日志，readView</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918145723813.png" alt="image-20250918145723813"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ibd2sdi xxx.ibd</span><br></pre></td></tr></table></figure>
<p>可以查看ibd表结构</p>
<p><strong>undo log 版本链</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918151215827.png" alt="image-20250918151215827"></p>
<p>那么回滚的时候回滚到哪个版本呢？这个就取决于readview</p>
<p><strong>readview</strong></p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918151745892.png" alt="image-20250918151745892"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918152533950.png" alt="image-20250918152533950"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918152608171.png" alt="image-20250918152608171"></p>
<p><strong>案例1</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918153251406.png" alt="image-20250918153251406"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918153721232.png" alt="image-20250918153721232"></p>
<p><strong>案例2</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918154104768.png" alt="image-20250918154104768"></p>
<p>最终的隔离性和一致性</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918154326424.png" alt="image-20250918154326424"></p>
<h2 id="MySQL管理"><a href="#MySQL管理" class="headerlink" title="MySQL管理"></a>MySQL管理</h2><h3 id="系统数据库"><a href="#系统数据库" class="headerlink" title="系统数据库"></a>系统数据库</h3><p>MySQL数据库安装完成后，自带了一下四个数据库，具体作用如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918165810875.png" alt="image-20250918165810875"></p>
<h3 id="常用工具"><a href="#常用工具" class="headerlink" title="常用工具"></a>常用工具</h3><ul>
<li>mysql的客户端工具</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918200702073.png" alt="image-20250918200702073"></p>
<ul>
<li>mysqladmin</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918201146141.png" alt="image-20250918201146141"></p>
<ul>
<li>mysqlbinlog</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918202337774.png" alt="image-20250918202337774"></p>
<ul>
<li>mysqlshow</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918203429600.png" alt="image-20250918203429600"></p>
<ul>
<li>mysqldump</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918204055710.png" alt="image-20250918204055710"></p>
<ul>
<li>mysqlimport/source</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918205019911.png" alt="image-20250918205019911"></p>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><ul>
<li>错误日志</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918210244858.png" alt="image-20250918210244858"></p>
<ul>
<li>二进制日志</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918210839989.png" alt="image-20250918210839989"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918210818420.png" alt="image-20250918210818420"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918210952288.png" alt="image-20250918210952288"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918212154001.png" alt="image-20250918212154001"></p>
<ul>
<li>查询日志</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918221325726.png" alt="image-20250918221325726"></p>
<p>更新update操作也会记录</p>
<ul>
<li>慢查询日志</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918221823745.png" alt="image-20250918221823745"></p>
<h2 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h2><p><strong>概述</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250918224828707.png" alt="image-20250918224828707"></p>
<p><strong>原理</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919010124479.png" alt="image-20250919010124479"></p>
<p><strong>搭建</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919010334503.png" alt="image-20250919010334503"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919010550922.png" alt="image-20250919010550922"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919011118595.png" alt="image-20250919011118595"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919011409231.png" alt="image-20250919011409231"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919011648346.png" alt="image-20250919011648346"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919011727236.png" alt="image-20250919011727236"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919011807727.png" alt="image-20250919011807727"></p>
<h2 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h2><p><strong>介绍</strong></p>
<ul>
<li>问题分析</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919012652234.png" alt="image-20250919012652234"></p>
<p><strong>拆分策略</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919012907752.png" alt="image-20250919012907752"></p>
<ul>
<li><strong>垂直拆分</strong></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919013548050.png" alt="image-20250919013548050"></p>
<ul>
<li>水平拆分</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919013849662.png" alt="image-20250919013849662"></p>
<p><strong>实现技术</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919014259514.png" alt="image-20250919014259514"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919015816474.png" alt="image-20250919015816474"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919020245401.png" alt="image-20250919020245401"></p>
<p><strong>Mycat入门</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919020654039.png" alt="image-20250919020654039"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919020819793.png" alt="image-20250919020819793"></p>
<p><strong>Mycat配置</strong></p>
<p><strong>Mycat分片</strong></p>
<ul>
<li><p>分片规则</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919021129023.png" alt="image-20250919021129023"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919021256781.png" alt="image-20250919021256781"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919021632050.png" alt="image-20250919021632050"></p>
<p>首先同一个数hash之后是一个固定的值，那么再对这个值取模就能分片了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022039627.png" alt="image-20250919022039627"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022115665.png" alt="image-20250919022115665"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022138702.png" alt="image-20250919022138702"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022201069.png" alt="image-20250919022201069"></p>
<p>然后还有按照天分还能按照自然月分….</p>
</li>
</ul>
<p><strong>Mycat管理及监控</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022456097.png" alt="image-20250919022456097"></p>
<h2 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h2><p><strong>单主单从</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919022920321.png" alt="image-20250919022920321"></p>
<p><strong>双主双从</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250919023115805.png" alt="image-20250919023115805"></p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p><strong>主从同步机制</strong></p>
<p>MySQL的主从同步机制是一种数据复制技术，用于将主数据库的数据同步到一个或多个从数据库中，</p>
<p>主要通过二进制日志实现数据的复制。主数据库在执行写操作时，会将这些操作记录到Binlog中，然后异步推送给从数据库，从数据库重放对应的日志即可完成复制。</p>
<p><strong>主从复制类型</strong></p>
<ol>
<li>异步复制：主库不需要等待从库的响应（性能高，一致性低）</li>
<li>同步复制：主库同步等待所有从库确认收到数据</li>
<li>半同步复制：主库等待至少一个从库确认收到数据</li>
<li>并行复制：多个SQL线程并发执行重放时间，提高复制效率。</li>
</ol>
<p><strong>主从同步延迟如何处理</strong></p>
<p><strong>首先明确，延迟是必然的，无论怎么优化都无法避免只能减少延迟时间</strong></p>
<p>1、二次查询，如果从库查不到数据，就再去主库查一遍由API封装这个逻辑即可，算是一个兜底策略，比较简单。</p>
<p>2、强制将写之后立马读的操作转移到主库上。这属于代码写死了，比如一些写入之后立马查询的操作，就绑定在一起，写死都走主库，不推荐，比较死板。</p>
<p>3、关键业务读写都走主库，非关键还是读写分离。</p>
<p>4、使用缓存。主库写入后同步到缓存中，这样查询时可以先查询缓存，避免了延迟的问题，不过又引入了缓存数据一致性的 问题。</p>
<p><strong>如果组长要求你主导项目中的分库分表，大致的实施流程是？</strong></p>
<p>1、<strong>第一步会先分析业务需求：</strong>确定数据量以及增长趋势，评估分库分表的必要性（需要一定的预判但是不要过度设计）</p>
<p>2、<strong>然后进行技术选型，设计分库分表方案，</strong>主要确认一下三点：</p>
<ul>
<li>分片键：选好业务意义明确，查询高频，数据分布均匀的字段（比如user_id，order_id）</li>
<li>分库分表方式：rang，hash（通过hash取模），一致性hash(一样的hash放一起)。或者结合、确定分片数量。</li>
<li>路由逻辑：Client端（直接向不同的数据库发送请求），Proxy层（加一层类似Mycat），还是自研中间件。</li>
</ul>
<p>3、考虑现有的数据迁移，需要将现有的数据迁移到新的分库分表结构中，可以通过批量导入，ETL工具或者脚本来完成。</p>
<p>4、部分 <strong>SQL的修改和业务逻辑的调整</strong>。比如有些业务中连表查询的修改或者本地事务变成分布式事务的情况都需要一 一列举出来进行修改。</p>
<p><strong>对数据库进行分库分表可能会引发哪些问题</strong></p>
<p>1、首先是事务的问题</p>
<p>我们使用关系型数据库，有很大一点在于它保证事务的完整性。</p>
<p>而分库之后单机事务就用不上了，必须使用分布式事务来解决，而分布式事务相对而言就比较重了。而且大部分的分布式事务只能保证在最终一致性，所以 <strong>业务上会存在数据不一致的场景</strong></p>
<p>2、连表join问题</p>
<p>在一个库中的时候我们还可以利用 JOIN 来连表查询，而跨库之后就无法使用 JOIN 了。</p>
<p>此时的解决方案就是在业务代码中进行关联，也就是先把一个表的数据查出来，然后通过得到的结果再去查另一张表，然后利用代码关联得到最终的结果。</p>
<p>这种方式实现起来比较复杂，不过也是可以接受的。</p>
<p>还可以适当的冗余一些字段，比如以前的表就存储一个关联ID，但是业务时长要求返回对应的Name或者其他字段。这时候就可以把这些字段冗余到当前表中，来去除需要关联的操作。（意思就是假设有个用户表和姓名表，之前需要关联的，现在直接在用户表里加上姓名，然后就不用连表查询姓名了。）</p>
<p>或者通过 <strong>宽表</strong>的形式查询，比如将数据全量存储至ES来查询数据</p>
<p><strong>宽表（Wide Table）</strong> 是指将多个业务实体的数据<strong>横向拼接成一张大表</strong>，包含很多字段，但每一行代表一个完整的业务对象。</p>
<p><strong>ES（Elasticsearch）</strong>  一个高性能、分布式的搜索与分析引擎，适合做复杂查询和海量数据检索。</p>
<p>3、全局ID唯一性问题</p>
<p>以前单库单表直接使用数据库得到自增ID即可，但是分库分表之后，使用自增ID会导致重复主键的情况，此时需要利用雪花算法或者其他全局唯一ID发号器来生成唯一主键。</p>
<p>雪花算法：全局唯一，趋势递增，高性能本地生成，不依赖数据库，可解析能从中看出生成时间，机器信息等。</p>
<p>4、排序问题</p>
<p>单表直接通过order by 来进行排序，分库分表后直接利用数据库是无法实现排序的，要么利用分库分表中间件的能力进行汇总排序，要么在自己业务代码中进行排序，要么利用ES存储全量数据进行拍需要。</p>
<p>5、count问题</p>
<p>其实和排序类似，单表可以count，分库分表后无法支持，只能多表count然后业务代码中累加，或者单独搞一个地方来维护总数，要么还是利用ES</p>
<p><strong>从MySQL获取数据，是从磁盘读取的吗？</strong></p>
<p>不是，是从buffer pool 中获取的，MySQL使用缓存机制，比如Innodb存储引擎，将常用的数据和索引缓存在内存中，以提高读取性能。当查询数据时，系统会首先查询缓存，比如缓冲池，如果数据在内存中，则会直接池从内存中读取，如果不在则会从磁盘读取并加载到缓存中。</p>
<p>那mysql中的缓存</p>
<p>缓存池中存了数据页、索引页和其他相关信息。查询数据时，MySQL首先在缓冲池中查找，如果找到则直接返回数据，否则从磁盘读取数据页并将其缓存到缓冲池中。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250923153106155.png" alt="image-20250923153106155"></p>
<p>Innodb存储引擎将表数据和索引页为单位存储，每页通常为16KB，当需要读取某条记录时，mysql会加载包含该记录的整个数据页到缓冲池中。从而减少频繁的I/O操作，所以要记住</p>
<p><strong>mysql是以页为单位加载数据的，而不是记录行为单位</strong></p>
<p>那么buffer pool的机制是什么呢？缓冲池的大小是有限的，如果内存放不下的数据，缓冲池也是需要淘汰机制的，淘汰那些不常被访问的数据页。</p>
<p>按照这个需求我们很容易想到LRU机制，最近最少使用的页面将被淘汰，即维护一个链表，被访问的页面移动到头部，新加的页面也加到头部，同时根据内存使用情况淘汰尾部的页面。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250923161824187.png" alt="image-20250923161824187"></p>
<p>那么buffer pool中分为了老年代和新生代。</p>
<p>老年代默认占3/8 当然可以通过参数调整比例。</p>
<p>当有新页面加入 buffer pool时，插入的位置是老年代的头部，同时新页面在1s内再次被访问的话，不会移动到新生代，等1s后，如果该页面再次被访问才会移动到新生代。</p>
<p>这根我们了解的LRU不太一样，正常的LRU是将新页面插入到头部，且老页面只要被访问就会移动到头部，这样保证最近访问的数据都存在头部，淘汰的只会是尾部的数据。</p>
<p>为什么要有这样的改造呢？</p>
<p>因为innodb中有预读机制。简单理解就是读取连续的多个页面后，innodb认为后面的数据也会被读取，于是异步将这些数据加载到buffer pool中，但是这是一个预判，也就是说页面不一定会被访问，所以如果直接将页面都加入到新生代，可能会污染热点数据，但是如果是新页面加到老年代头部，就不会有这个问题。</p>
<p><strong>那1s机制是为了什么呢</strong></p>
<p>这个机制也是为了处理大量数据访问情况，因为及基本上大数据扫描之后，可能立马又再次范文，正常这时候需要把页面移动到新生代了，但等这波操作结束了，后面还有可能再也灭有请求访问这些页面了，但因为这波扫描把热点数据都淘汰了，就不太好了。</p>
<p>于是乎搞了个时间窗口，新页面在1s内的访问并不会将其移到新生代，这样就不会淘汰热点数据了，然后1s后如果这个页面再次被访问，才会被移动到新生代，这次访问大概率已经是业务的请求，也说明这个数据可能是热点数据。</p>
<p><strong>经过这两个改造，innodb就解决了预读失效和一次性大批量数据访问的问题。</strong></p>
<p><strong>MySQL中的数据排序是怎么实现的</strong></p>
<p>首先，排序过程中，如果排序字段命中索引，会直接用索引来排序，比如sort by id，这种，直接输出聚集索引即可，因为聚集索引本来就是有序的，这种排序性能最高。</p>
<p>如果没有命中的话会升级为filesort，那么这时候如果需要排序的数据比较少，则在sort_buffer中进行排序，如果数据量大，就需要利用磁盘临时文件来排序了，性能就比较差了，具体是通过sort_buffer_size来控制排序缓冲池的大小。</p>
<p>那么如果在内存中排序也就是在排序缓冲池中排序的话，一般是单路排序或者双路排序。</p>
<p>然后有一个叫max_length_for_sort_data参数，默认是4096字节，如果select列的数据长度超过他，则MySQL会采用row_id排序，即把主键和排序字段防止到sort_buffer中排序。</p>
<p>通过b排序完之后，在通过id回表查询得到其他需要查询的列，最终将结果集返回给客户端。</p>
<p>如果没有超过max_length_for_sort_data，就会进行单路排序，就是将select的字段都放入sort_buffer中，排序后直接返回结果集，减少了回表操作，效率更高。</p>
<p>那么如果比sort_buffer_size还要大就会需要磁盘文件临时排序了，一般会使用归并排序，就是先把数据分为多分文件，然后单独对文件进行排序，最后在合并成一个有序的大文件。</p>
<p><strong>为什么Mysql中不推荐使用多表join</strong></p>
<p>数据量小无所谓，但是当数据量大的时候，影响就被放大了，如果让数据库来承担这个复杂的关联操作，需要对连接的每个表进行扫描，匹配和组合，消耗大量的CPU和内存资源，让复杂的关联操作占用了大量的数据库资源，会影响其他查询修改操作。</p>
<p><strong>数据库往往是我们系统的弱点</strong>，很多情况下性能瓶颈都在数据库，因此我们需要尽量避免把压力放在数据库上。</p>
<p>所以不推荐多表join。</p>
<p><strong>join的时候注意点</strong></p>
<p><strong>尽量让小表做驱动表</strong>，因为驱动表需要全表扫描，而被驱动表是索引查询的。</p>
<p>举个例子  <code>select * from user1 join user2 on(user1.a = user2.a)</code></p>
<p>让user1作为驱动表，user2是被驱动表</p>
<p>当小表（A）作为驱动表时，数据库可以将<strong>整个小表的数据加载到内存中</strong>（或至少大部分）。然后，它只需要<strong>扫描一次大表（B）</strong>，在扫描过程中，对于B的每一行，都去内存中的小表A里查找匹配项。 </p>
<p>这实际上将嵌套循环优化成了更高效的查找过程（如果小表有索引，则使用索引查找；即使没有，内存中的全表扫描也比磁盘I/O快得多）。</p>
<p><strong>核心优势</strong>：大表（B）只被扫描一次，而小表（A）被完全加载到内存中，避免了重复的磁盘I/O。</p>
<p><strong>mysql中delete drop  truncate的区别是什么</strong></p>
<p>Delete用于删除行数据，但保留表结构和相关的对象</p>
<p>drop用于完全删除数据库表，包括数据库和结构</p>
<p>truncate只删除数据，不会删除表结构和索引等其他结构</p>
<p> 从性能看 drop  &gt; truncate &gt; delete</p>
<p>Delete操作会生成binlog、redolog和undolog，所以如果删除全表使用delete的话，性能会比较差，但是他可以回滚，delete的本质上是给行数据大哥标记，并不实际删除，因此delete之后，空间大小不会变化。</p>
<p>在innodb中，每张表数据内容和索引都存储在一个以.ibd后缀的文件中，drop就是整个文件都给删除了，还有.frm后缀的文件也会被删除，这个文件包含的元数据和结构定义文件都删除了，并且无法回滚，表空间会被回收，</p>
<p>truncate会对整张表的数据进行删除，且不会记录回滚日志，所以无法被回滚，并且主键字段是自增的，使用truncate删除后自增重新从1开始。</p>
<p><strong>MySQL中DATETIME和TIMESTAMP类型的区别是什么？</strong></p>
<p>存储方式上：</p>
<p>1、DATETIME：以字符串形式存储，DATETIME(0) = 5字节，DATETIME(6) = 8字节</p>
<p>2、TIMESTAMP：以Unix时间戳形式存储，范围为<code>1970-01-01</code>UTC到<code>2030-01-19</code>UTC，TIMESTAMP(0)=4字节，TIMESTAMP(6) = 7字节。</p>
<p>这里的0和6表示的屎小数秒精度，也就是秒后面的小数位数。</p>
<p>时区处理上：</p>
<p>DATETIME：不受时区影响，存储的时间是具体的日期和时间，不会进行自动转换。</p>
<p>TIMESTAMP：受时区影响，存储是会转换为UTC，取出时会根据连接的时区进行转换，适合吃力跨时区的数据。</p>
<p><strong>默认值</strong>DATETIME在MySQL5.6及更早的版本中，DATETIME列不能有自动更新的默认值。在之后的版本中，可以使用DEFAULT和ON UPDATE子句来制定自动初始化和更新行为，但不像TIMESTAMP那么直观。</p>
<p>TIMESTAMP：在高版本中，TIMESTAMP列可以有默认的当前时间戳CURRENT_TIMESTAMP，并且可以使用ON UPDATE CURRENT_TIMESTAMP使其在行更新时自动更新为当前时间戳。</p>
<p><strong>MySQL中如何解决深度分页的问题</strong></p>
<p>优化方式用覆盖索引+子查询</p>
<p>深度分页就是指数据量很大的时候，按照分页访问后面的数据，例如limit99999,10</p>
<p><strong>数据库的三大范式</strong></p>
<p>第一范式：确保每个列的值都是原子值，表中的每个字段只能包含单一的数据项，不允许重复的列和多值字段。</p>
<p><strong>反例 ❌</strong>：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>学生ID</th>
<th>姓名</th>
<th>课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>张三</td>
<td>数学, 英语, 物理</td>
</tr>
</tbody>
</table>
</div>
<p>第二范式：在满足第一范式的基础上，确保表中的每个非主键字段完全依赖于之间，而且不是部分依赖，即 <strong>非主键字段必须依赖于整个主键</strong></p>
<p><strong>场景举例</strong>：</p>
<p>假设有一张表记录学生选课成绩：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>学生ID</th>
<th>课程ID</th>
<th>课程名称</th>
<th>成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>101</td>
<td>数学</td>
<td>85</td>
</tr>
<tr>
<td>1</td>
<td>102</td>
<td>英语</td>
<td>90</td>
</tr>
<tr>
<td>2</td>
<td>101</td>
<td>数学</td>
<td>78</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>主键是：<code>(学生ID, 课程ID)</code>（复合主键）</li>
<li>问题：<code>课程名称</code> 只依赖于 <code>课程ID</code>，而<strong>不依赖于学生ID</strong> → 这就是<strong>部分依赖</strong></li>
</ul>
<p>这违反了第二范式。</p>
<p><strong>解决方法 ✅</strong>：拆分表</p>
<p><strong>表1：课程表</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>课程ID</th>
<th>课程名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>101</td>
<td>数学</td>
</tr>
<tr>
<td>102</td>
<td>英语</td>
</tr>
</tbody>
</table>
</div>
<p><strong>表2：学生成绩表</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>学生ID</th>
<th>课程ID</th>
<th>成绩</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>101</td>
<td>85</td>
</tr>
<tr>
<td>1</td>
<td>102</td>
<td>90</td>
</tr>
</tbody>
</table>
</div>
<p>现在：</p>
<ul>
<li><code>成绩</code> 完全依赖于 <code>(学生ID, 课程ID)</code></li>
<li><code>课程名称</code> 依赖于 <code>课程ID</code>（单独的主键）</li>
</ul>
<p>第三范式：在满足第二范式的基础上，确保非主键字段之间不依赖，即消除传递依赖。所有非主键字段只能依赖于主键，不应相互依赖</p>
<p><strong>反例 ❌</strong>：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>学生ID</th>
<th>姓名</th>
<th>所在系</th>
<th>系主任</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>张三</td>
<td>计算机</td>
<td>李教授</td>
</tr>
<tr>
<td>2</td>
<td>李四</td>
<td>计算机</td>
<td>李教授</td>
</tr>
<tr>
<td>3</td>
<td>王五</td>
<td>数学</td>
<td>赵教授</td>
</tr>
</tbody>
</table>
</div>
<p>分析：</p>
<ul>
<li>主键是 <code>学生ID</code></li>
<li><code>姓名</code>、<code>所在系</code> → 依赖于 <code>学生ID</code> ✅</li>
<li><code>系主任</code> → 实际上依赖于 <code>所在系</code>，而不是直接依赖于 <code>学生ID</code> ❌<br>（即：<code>学生ID → 所在系 → 系主任</code>，这是<strong>传递依赖</strong>）</li>
</ul>
<p>违反第三范式。</p>
<p><strong>解决方法 ✅</strong>：拆分表</p>
<p><strong>在MySQL中，你使用过哪些函数</strong></p>
<p>1、字符串函数</p>
<ul>
<li>CONCAT: 连接字符串</li>
<li>SUBSTRING：提取子字符串</li>
<li>LENGTH：返回字符串的长度</li>
<li>REPLACE：替换字符串中的子字符串。</li>
<li>UPPER和LOWER：将字符串转换为大写或小写</li>
<li>TRIM：去除字符串两端的空格</li>
<li>LEFT和RIGHT：返回字符串左边或右边的字符</li>
</ul>
<p>2、数学函数，用于处理数字运算：</p>
<ul>
<li>ABS：返回绝对值</li>
<li>CEIL和FLOOR：返回大于或等于/小于或等于指定数的最小整数/最大整数</li>
<li>MOD：返回除法的余数</li>
<li>POWER：返回一个数的指定次幂</li>
</ul>
<p>3、日期函数，用于处理日期和时间</p>
<ul>
<li>NOW  返回当前日期和时间</li>
<li>DATE_ADD  和  DATE_SUB    日期加上或减去一个时间间隔</li>
<li>YEAR\MONTH\DAY    提取日提的年份、月份、日期</li>
<li>STR_TO_DATE   将字符串转换为日期</li>
</ul>
<p>4、聚合函数用于汇总数据</p>
<p>COUNT   计算行数</p>
<p>SUM    计算总和</p>
<p>AVG    计算平均值</p>
<p>MAX 和  MIN   返回最大值和最小值</p>
<p>5、条件函数</p>
<p>IF   条件判断函数</p>
<p>IFNULL  返回第一个非NULL值</p>
<p>CASE   条件选择函数</p>
<p><strong>MySQL中TEXT类型最大可以存储多长的文本</strong></p>
<p>TEXT是非标准字符串类型，除了他还有TINYTEXT           \        MEDIUMTEXT    \     LONGTEXT</p>
<p>255字节、65535字节（text）、16MB 、 4GB</p>
<p><strong>MySQL中AUTO_INCREMENT列达到最大值会发生什么</strong></p>
<p>如果表的自定义自增ID到达上线限后，再申请下一个ID，得到的值不变！<strong>因此会导致报重复值的错误</strong></p>
<p>如果InnoDB表没有配置主键，会创建一个看不见长度为6个字节的row_id，然后如果这个值达到上线后，又会从0开始，然后继续循环。如果插入的新数据的row_id在表中已经存在，那么老数据会被这个新数据覆盖，不会产生任何报错。</p>
<p>对于TINYINT（8位），最大值是127（有符号）或255（无符号）</p>
<p>对于SMALLINT(16位)，最大值是32767有符号，无符号65535</p>
<p>对于MEDIUMINT（24位）</p>
<p>对于INT  32位，最大值是21亿或400亿</p>
<p>对于BIGINT 64位</p>
<p><strong>在MySQL中存储金额数据，应该使用什么数据类型</strong></p>
<p>在数据库中业界常用两种类型来存储金额：bigint和decimal</p>
<p><strong>decimal</strong>是一种精确数值类型，<strong>用于存储固定精度和小数位的十进制数</strong></p>
<p>他不会出现浮点数float和double那样的精度丢失问题</p>
<p><code>DECIMAL(M,D) M总位数，D小数位数</code></p>
<p>bigint代码中用long，decimal代码中使用BigDecimal,如果用bigint来存储的话追求的是高性能，然后单位是分来避免小数的出现。如果是极致追求精确用decimal。</p>
<p><strong>什么是数据库的游标</strong></p>
<p>数据库游标是一个数据库对象，使得应用程序可以朱行访问查询结果集，而不仅仅是一次性处理所有结果，它允许开发者在结果集中的行之间移动，方便进行复杂的数据操作，比如更新或删除特定的行。</p>
<p>为什么需要游标？SQL是集合导向的语言，比如select返回的是一个结果集，大多数操作都是批量处理的。但是在某些场景下，需要逐行处理数据。</p>
<p>这时候，就需要使用游标来实现过程化的数据处理，首先声明游标（DECLARE），定义一个游标，绑定一个SELECT查询，然后打开游标（OPEN）执行查询，生成结果集，游标指向第一行之前。最后提取数据（Fetch）逐行读取数据，游标向下移动。最后关闭游标CLOSE，释放资源。</p>
<hr>
<p><strong>MySQL中EXISTS和IN的区别是什么</strong></p>
<p>EXISTS用于判断子查询是否返回任何行，通常用于检查某个条件是否满足</p>
<p>IN用于检查某个值是否在指定的集合中，可以是一个子查询或静态值列表</p>
<p>性能差异</p>
<p>EXISTS一旦找到匹配行就会立即返回，通常在子查询返回较大数据集时性能更好。</p>
<p>IN通常会评估整个子查询并构建一个值列表，然后进行匹配，在处理较大数据集时可能性能较差。</p>
<p><strong>在RC隔离级别下，执行更新操作，如果当前行已经被其他事物锁定，数据库会进行什么操作</strong></p>
<p>InnoDB会进行半一致性读操作，来判断当前行的最新版本数据是否影响当前更新操作。</p>
<p><strong>SQL中select \ from \ join \ where \ group by \ having \ order by \ limit的执行顺序是什么？</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20250925205106061.png" alt="image-20250925205106061"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://oyy0v0.top">oyy0v0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://oyy0v0.top/2024/04/15/2024-4-15%20%E6%95%B0%E6%8D%AE%E5%BA%93/">https://oyy0v0.top/2024/04/15/2024-4-15%20%E6%95%B0%E6%8D%AE%E5%BA%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://oyy0v0.top" target="_blank">oyy0v0😼</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">-数据库</a></div><div class="post_share"><div class="social-share" data-image="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/18/2024-4-18%20JDBC/" title="JDBC"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JDBC</div></div></a></div><div class="next-post pull-right"><a href="/2023/12/18/2023-12-18%20%E5%89%8D%E7%AB%AF%E5%B0%8F%E8%AE%B0/" title="前端小记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">前端小记</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">oyy0v0</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/oyy0v0"><i class="fab fa-github"></i><span>💕前往小家</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/assets/QRCode.jpg" target="_blank" title="icon-weixin"><i class="微信" style="color: faa-tada;"></i></a><a class="social-icon" href="https://github.com/oyy0v0" target="_blank" title="icon-github"><i class="Github" style="color: faa-tade;"></i></a><a class="social-icon" href="mailto:2925886492@qq.com" target="_blank" title="icon-youxiang"><i class="QQ邮箱" style="color: faa-tada;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">数据库基本概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-text">数据库类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MYSQL%E4%BB%8B%E7%BB%8D"><span class="toc-text">MYSQL介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MYSQL%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-text">MYSQL下载安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A3%80%E9%AA%8C%E5%AE%89%E8%A3%85%E6%88%90%E6%9E%9C"><span class="toc-text">检验安装成果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MYSQL%E7%99%BB%E5%BD%95%E3%80%81%E8%AE%BF%E9%97%AE%E3%80%81%E9%80%80%E5%87%BA%E6%93%8D%E4%BD%9C"><span class="toc-text">MYSQL登录、访问、退出操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85navicat%E8%BF%9E%E6%8E%A5MySQL"><span class="toc-text">安装navicat连接MySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E8%AF%AD%E8%A8%80"><span class="toc-text">SQL语言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DDLDML%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-text">DDLDML创建数据库表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-text">数据库表列类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DML-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-text">DML_添加数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DML-%E4%BF%AE%E6%94%B9%EF%BC%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">DML_修改，删除数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-text">表的完整性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">非外键约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-text">外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%AD%96%E7%95%A5"><span class="toc-text">外键策略</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DDL%E5%92%8CDML%E7%9A%84%E8%A1%A5%E5%85%85"><span class="toc-text">DDL和DML的补充</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DQL-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-text">DQL-查询操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-text">表的准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">单表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84sql%E6%9F%A5%E8%AF%A2"><span class="toc-text">最简单的sql查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where%E5%AD%90%E5%8F%A5"><span class="toc-text">where子句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">使用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-text">单行函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-text">多行函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group-by%E5%87%BD%E6%95%B0"><span class="toc-text">group_by函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#having%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89"><span class="toc-text">having分组后筛选</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93"><span class="toc-text">单表查询总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%EF%BC%9A%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%EF%BC%8C%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">99语法：交叉连接，自然连接，内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%EF%BC%9A%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">99语法：外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%A4%96%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">内连接和外连接的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#99%E8%AF%AD%E6%B3%95%EF%BC%9A%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">99语法：自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#92%E8%AF%AD%E6%B3%95%EF%BC%9A%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">92语法：多表查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">不相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">单行子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">多行子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">相关子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="toc-text">数据库对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8F%8A%E5%85%B6%E7%89%B9%E5%BE%81"><span class="toc-text">事务及其特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-text">事务并发问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">事务隔离级别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-text">视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">存储过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%AB%98%E7%BA%A7"><span class="toc-text">MySQL高级</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-text">MySQL体系结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-text">存储引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95-index"><span class="toc-text">索引(index)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-text">索引分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#InnoDB%E5%AD%98%E5%82%A8%E4%B8%AD%E5%8F%88%E5%88%86%E4%B8%A4%E7%B1%BB"><span class="toc-text">InnoDB存储中又分两类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E8%AF%AD%E6%B3%95"><span class="toc-text">索引语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-text">SQL性能分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8"><span class="toc-text">索引使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E4%BC%98%E5%8C%96"><span class="toc-text">SQL优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%81"><span class="toc-text">锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#InnoDB%E5%BC%95%E6%93%8E"><span class="toc-text">InnoDB引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86"><span class="toc-text">事务原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">系统数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="toc-text">常用工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-text">日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-text">主从复制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-text">分库分表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span class="toc-text">读写分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-text">常见问题</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By oyy0v0</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script><script async src="//at.alicdn.com/t/c/font_4658720_723un29n3vn.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg);"> <a class="categoryBar-list-link" href="categories/java入门/">java入门</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">java</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg);"> <a class="categoryBar-list-link" href="categories/算法/">算法</a><span class="categoryBar-list-count">6</span><span class="categoryBar-list-descr">算法</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg);"> <a class="categoryBar-list-link" href="categories/博客/">博客</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">博客</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg);"> <a class="categoryBar-list-link" href="categories/面试集合/">面试集合</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">AI</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg);"> <a class="categoryBar-list-link" href="categories/GitHub/">GitHub</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">前端</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg);"> <a class="categoryBar-list-link" href="categories/前端/">前端</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">GitHub</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg);"> <a class="categoryBar-list-link" href="categories/java/">java</a><span class="categoryBar-list-count">22</span><span class="categoryBar-list-descr">八股文</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg);"> <a class="categoryBar-list-link" href="categories/AI/">AI</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">面试集合</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg);"> <a class="categoryBar-list-link" href="categories/操作系统/">操作系统</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">Go语言</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg);"> <a class="categoryBar-list-link" href="categories/Go语言/">Go语言</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">Linux</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg);"> <a class="categoryBar-list-link" href="categories/计算机网络/">计算机网络</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">操作系统</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg);"> <a class="categoryBar-list-link" href="categories/踩坑杂记/">踩坑杂记</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">计算机网络</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/07/28/2025-6-18 八股文/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-28</span><a class="blog-slider__title" href="2025/07/28/2025-6-18 八股文/" alt="">八股文集合</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/07/28/2025-6-18 八股文/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/14/2025-10-14 Java线程池的原理/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-14</span><a class="blog-slider__title" href="2025/10/14/2025-10-14 Java线程池的原理/" alt="">Java线程池的原理</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/10/14/2025-10-14 Java线程池的原理/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/09/01/2024-9-1 Docker基础/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-01</span><a class="blog-slider__title" href="2024/09/01/2024-9-1 Docker基础/" alt="">Docker</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/09/01/2024-9-1 Docker基础/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/24/2024-8-24 虚拟机VMware/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-24</span><a class="blog-slider__title" href="2024/08/24/2024-8-24 虚拟机VMware/" alt="">虚拟机</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/24/2024-8-24 虚拟机VMware/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/29/2024-8-29 Solr/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-29</span><a class="blog-slider__title" href="2024/08/29/2024-8-29 Solr/" alt="">Solr</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/29/2024-8-29 Solr/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-26设计模式/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-26设计模式/" alt="">设计模式</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/11/26/2024-11-26设计模式/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-22 面试/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-22 面试/" alt="">面试集合</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/11/26/2024-11-22 面试/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-22 开发流程化/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-22 开发流程化/" alt="">开发流程化</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-22 开发流程化/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 JSP/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 JSP/" alt="">JSP</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 JSP/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 Servlet入门/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 Servlet入门/" alt="">Servlet入门</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 Servlet入门/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-12 常用注解/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231208202901.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-12 常用注解/" alt="">常用注解</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-12 常用注解/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14  Servlet进阶/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14  Servlet进阶/" alt="">Servlet进阶</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-14  Servlet进阶/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 Maven实战/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 Maven实战/" alt="">Maven</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 Maven实战/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/12/2025-10-13 mybatis的执行原理/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-12</span><a class="blog-slider__title" href="2025/10/12/2025-10-13 mybatis的执行原理/" alt="">Mybatis的执行原理</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/10/12/2025-10-13 mybatis的执行原理/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/22/2025-10-22 Netty了解/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-22</span><a class="blog-slider__title" href="2025/10/22/2025-10-22 Netty了解/" alt="">Dubbo</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/10/22/2025-10-22 Netty了解/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2025-10-21 Dubbo/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2025-10-21 Dubbo/" alt="">Dubbo</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/14/2025-10-21 Dubbo/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/20/2025-10-20 Mybatis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-20</span><a class="blog-slider__title" href="2024/07/20/2025-10-20 Mybatis/" alt="">Mybatis</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/07/20/2025-10-20 Mybatis/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 Springboot/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 Springboot/" alt="">Springboot</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 Springboot/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-9 固定思路详解/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-9 固定思路详解/" alt="">固定思路详解</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/07/2024-8-9 固定思路详解/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 踩坑记录/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 踩坑记录/" alt="">踩坑记录</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 踩坑记录/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2024-8-23 redis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2024-8-23 redis/" alt="">redis</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/23/2024-8-23 redis/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2024-8-23 Nginx和lua和Openresty高性能实践/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2024-8-23 Nginx和lua和Openresty高性能实践/" alt="">Nginx+lua+OpenResty高性能实践</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/23/2024-8-23 Nginx和lua和Openresty高性能实践/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/16/2024-8-16 前端速通/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-16</span><a class="blog-slider__title" href="2024/08/16/2024-8-16 前端速通/" alt="">前端速通</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/16/2024-8-16 前端速通/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2024-8-14 RPC远程服务调用/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2024-8-14 RPC远程服务调用/" alt="">RPC远程服务调用</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/08/14/2024-8-14 RPC远程服务调用/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/06/24/2025-6-24 算法合集/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-24</span><a class="blog-slider__title" href="2025/06/24/2025-6-24 算法合集/" alt="">算法合集</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/06/24/2025-6-24 算法合集/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/10/2025-3-9 队列和栈/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-10</span><a class="blog-slider__title" href="2025/03/10/2025-3-9 队列和栈/" alt="">队列和栈</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/10/2025-3-9 队列和栈/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-3-2 链表/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-3-2 链表/" alt="">链表</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/02/2025-3-2 链表/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-2-25 java8新特性/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-2-25 java8新特性/" alt="">java8新特性</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/02/2025-2-25 java8新特性/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 算法问题合集/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 算法问题合集/" alt="">算法问题合集</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 算法问题合集/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/02/23/2025-2-23 数组和字符串（算法）/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-02-23</span><a class="blog-slider__title" href="2025/02/23/2025-2-23 数组和字符串（算法）/" alt="">数组和字符串（算法）</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/02/23/2025-2-23 数组和字符串（算法）/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/20/2025-10-20 RPC了解/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-20</span><a class="blog-slider__title" href="2025/10/20/2025-10-20 RPC了解/" alt="">RPC了解</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2025/10/20/2025-10-20 RPC了解/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/05/14/2024-4-29 计算机网络/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-05-14</span><a class="blog-slider__title" href="2024/05/14/2024-4-29 计算机网络/" alt="">计算机网络</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/05/14/2024-4-29 计算机网络/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/28/2024-4-28 go语言/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-28</span><a class="blog-slider__title" href="2024/04/28/2024-4-28 go语言/" alt="">Go语言</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/04/28/2024-4-28 go语言/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/13/2024-7-2 Vue2/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-13</span><a class="blog-slider__title" href="2024/07/13/2024-7-2 Vue2/" alt="">Vue2</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/07/13/2024-7-2 Vue2/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/15/2024-4-15 数据库/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-15</span><a class="blog-slider__title" href="2024/04/15/2024-4-15 数据库/" alt="">数据库</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/04/15/2024-4-15 数据库/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-18 JDBC/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-18 JDBC/" alt="">JDBC</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/04/18/2024-4-18 JDBC/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-20 操作系统/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-20 操作系统/" alt="">操作系统</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2024/04/18/2024-4-20 操作系统/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/07/06/2023-7-1Java小记/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-07-06</span><a class="blog-slider__title" href="2023/07/06/2023-7-1Java小记/" alt="">Java小记</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/07/06/2023-7-1Java小记/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/08/15/2023-8-15 AI夏令营天气预报大赛/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-15</span><a class="blog-slider__title" href="2023/08/15/2023-8-15 AI夏令营天气预报大赛/" alt="">AI夏令营天气预报大赛</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/08/15/2023-8-15 AI夏令营天气预报大赛/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/18/2023-12-18 前端小记/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-18</span><a class="blog-slider__title" href="2023/12/18/2023-12-18 前端小记/" alt="">前端小记</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/12/18/2023-12-18 前端小记/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/06/23/2023-6-24Git和Github使用教程/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-06-23</span><a class="blog-slider__title" href="2023/06/23/2023-6-24Git和Github使用教程/" alt="">Git和Github使用教程</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/06/23/2023-6-24Git和Github使用教程/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/12/2023-12-11 建立博客保姆教程（1）/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-12</span><a class="blog-slider__title" href="2023/12/12/2023-12-11 建立博客保姆教程（1）/" alt="">建立博客</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/12/12/2023-12-11 建立博客保姆教程（1）/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/05/08/2023-5-8哈希表和有序表/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-08</span><a class="blog-slider__title" href="2023/05/08/2023-5-8哈希表和有序表/" alt="">哈希表和有序表</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2023/05/08/2023-5-8哈希表和有序表/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/11/27/2022-11-27 枚举类/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-27</span><a class="blog-slider__title" href="2022/11/27/2022-11-27 枚举类/" alt="">javase入门（枚举1）</a><div class="blog-slider__text">知识分享</div><a class="blog-slider__button" href="2022/11/27/2022-11-27 枚举类/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '8b4e8faa226f49ff851d67d0354499b7';
  var gaud_map_key = '85e43a6ba1ebb38fd12b0d8a886ecb9b';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/about/'|| '/about/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://github-api.oyy0v0.top//api?oyy0v0",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'oyy0v0')
    }
  </script><!-- hexo injector body_end end --></body></html>