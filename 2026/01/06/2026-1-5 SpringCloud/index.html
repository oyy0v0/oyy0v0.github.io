<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SpringCloud | oyy0v0ğŸ˜¼</title><meta name="author" content="oyy0v0"><meta name="copyright" content="oyy0v0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="çŸ¥è¯†åˆ†äº«">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringCloud">
<meta property="og:url" content="https://oyy0v0.top/2026/01/06/2026-1-5%20SpringCloud/index.html">
<meta property="og:site_name" content="oyy0v0ğŸ˜¼">
<meta property="og:description" content="çŸ¥è¯†åˆ†äº«">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg">
<meta property="article:published_time" content="2026-01-06T13:40:00.000Z">
<meta property="article:modified_time" content="2026-01-16T01:02:52.864Z">
<meta property="article:author" content="oyy0v0">
<meta property="article:tag" content="-Springå…¨å®¶æ¡¶">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg"><link rel="shortcut icon" href="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E7%8C%AB.svg"><link rel="canonical" href="https://oyy0v0.top/2026/01/06/2026-1-5%20SpringCloud/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SpringCloud',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-01-16 09:02:52'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4658720_723un29n3vn.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/readPercent.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="oyy0v0ğŸ˜¼"><span class="site-name">oyy0v0ğŸ˜¼</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SpringCloud</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2026-01-06T13:40:00.000Z" title="å‘è¡¨äº 2026-01-06 21:40:00">2026-01-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2026-01-16T01:02:52.864Z" title="æ›´æ–°äº 2026-01-16 09:02:52">2026-01-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">46.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>204åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SpringCloud"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106025947877.png" alt="image-20260106025947877"></p>
<p>çº¢è‰²éƒ¨åˆ†æ˜¯Alibaba</p>
<h1 id="1ã€ä»bootå’Œcloudç‰ˆæœ¬é€‰å‹å¼€å§‹"><a href="#1ã€ä»bootå’Œcloudç‰ˆæœ¬é€‰å‹å¼€å§‹" class="headerlink" title="1ã€ä»bootå’Œcloudç‰ˆæœ¬é€‰å‹å¼€å§‹"></a>1ã€ä»bootå’Œcloudç‰ˆæœ¬é€‰å‹å¼€å§‹</h1><h2 id="æœ€ç»ˆé€‰å‹"><a href="#æœ€ç»ˆé€‰å‹" class="headerlink" title="æœ€ç»ˆé€‰å‹"></a>æœ€ç»ˆé€‰å‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Java 17+</span><br><span class="line">cloud 2023.0.0</span><br><span class="line">boot 3.2.0 </span><br><span class="line">cloud alibaba 2022.0.0.0-RC2</span><br><span class="line">Maven 3.9+</span><br><span class="line">Mysql 8.0+</span><br></pre></td></tr></table></figure>
<h2 id="æ¨æ¼”è¿‡ç¨‹"><a href="#æ¨æ¼”è¿‡ç¨‹" class="headerlink" title="æ¨æ¼”è¿‡ç¨‹"></a>æ¨æ¼”è¿‡ç¨‹</h2><p>ä¸ºä»€ä¹ˆé€‰ç‰ˆæœ¬ï¼Ÿæ€ä¹ˆé€‰å‹å‘¢ï¼Ÿ</p>
<p><strong>SpringCloud å’Œ SpringCloud Alibaba æˆªç„¶ä¸åŒï¼Œæ ¹æ®å·¥ä½œéœ€è¦å¯ä»¥ç›´æ¥å­¦SpringCloudAlibaba</strong></p>
<p>SpringBootç‰ˆæœ¬é€‰æ‹©</p>
<p>â€‹    gitæºç åœ°å€  <code>https://github.com/spring-projects/spring-boot/releases/</code></p>
<p>â€‹    å®˜ç½‘çœ‹Bootç‰ˆæœ¬ 3.2.0</p>
<p><strong>ä¹Ÿå°±æ˜¯ç›´æ¥çœ‹å®˜ç½‘ï¼Œä½†æ˜¯å®˜ç½‘æœ‰å»¶åï¼Œè¿˜è¦çœ‹ gitæºç ä¸Šçš„ç‰ˆæœ¬è¯´æ˜ï¼Œé…åˆç€çœ‹</strong></p>
<p>é‚£è°å†³å®šè°å‘¢ï¼Ÿ</p>
<p>è‹¥åŒæ—¶ä½¿ç”¨Bootå’Œcloudï¼Œç”±è¯äº‹äººcloudå†³å®šbootç‰ˆæœ¬</p>
<p>Spring cloud Alibaba æ¯•ä¸šç‰ˆæœ¬ä¾èµ–å…³ç³»</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106031919849.png" alt="image-20260106031919849" style="zoom:150%;" /></p>
<h1 id="2ã€å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´-å‡çº§-æ›¿æ¢"><a href="#2ã€å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´-å‡çº§-æ›¿æ¢" class="headerlink" title="2ã€å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´/å‡çº§/æ›¿æ¢"></a>2ã€å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´/å‡çº§/æ›¿æ¢</h1><h2 id="å¾®æœåŠ¡ç†è®ºçŸ¥è¯†å…¥é—¨"><a href="#å¾®æœåŠ¡ç†è®ºçŸ¥è¯†å…¥é—¨" class="headerlink" title="å¾®æœåŠ¡ç†è®ºçŸ¥è¯†å…¥é—¨"></a>å¾®æœåŠ¡ç†è®ºçŸ¥è¯†å…¥é—¨</h2><p><strong>ä»€ä¹ˆæ˜¯å¾®æœåŠ¡</strong></p>
<p>å½¢è±¡ä¸€ç‚¹æ¥è¯´ï¼šå¾®æœåŠ¡å°±åƒæ­ç§¯æœ¨ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½æ˜¯ä¸€ä¸ªé›¶ä»¶ä¸€ä¸ªç»§æ¯ï¼Œå¹¶ä½¿ç”¨è¿™äº›ç»§æ¯é›¶ä»¶ç»„è£…å‡ºä¸åŒçš„å½¢çŠ¶ï¼Œå‡ºæ¥æœ€åä¸€ä¸ªæˆä½“ã€‚</p>
<p>é€šä¿—æ¥è¯´ï¼šå¾®æœåŠ¡å°±æ˜¯æŠŠä¸€ä¸ªå¤§ç³»ç»ŸæŒ‰ä¸šåŠ¡åŠŸèƒ½åˆ†è§£æˆå¤šä¸ªèŒè´£å•ä¸€çš„å°ç³»ç»Ÿï¼Œæ¯ä¸€ä¸ªå°æœ¨å—å°½é‡ä¸“ä¸€çš„åªåšä¸€ä»¶äº‹ï¼Œå¹¶åˆ©ç”¨ç®€å•çš„æ–¹å¼ä½¿å¤šä¸ªå°ç³»ç»Ÿç›¸äº’åä½œï¼Œç»„åˆæˆä¸€ä¸ªå¤§ç³»ç»Ÿåå†åŒæ„å¯¹å¤–æä¾›æ•´ä½“æœåŠ¡ã€‚</p>
<p>å­¦ç§‘æ´¾ä¸€ç‚¹ï¼šä¸“æ³¨äºå•ä¸€è´£ä»»å°å‹åŠŸèƒ½æ¨¡å—ä¸ºåŸºç¡€ï¼Œå¹¶åˆ©ç”¨è½»é‡åŒ–æœºåˆ¶ï¼ˆé€šå¸¸ä¸ºHTTP RESTful APIï¼‰å®ç°é€šä¿¡å®Œæˆå¤æ‚ä¸šåŠ¡æ­å»ºçš„ä¸€ç§æ¶æ„æ€æƒ³ã€‚</p>
<p>é‚£ä¹ˆå¾®æœåŠ¡æ¶æ„éœ€è¦çš„åŠŸèƒ½æœ‰ä»¥ä¸‹ï¼š</p>
<p>1ã€æœåŠ¡æ³¨å†Œä¸å‘ç°</p>
<p>2ã€æœåŠ¡è°ƒç”¨</p>
<p>3ã€æœåŠ¡ç†”æ–­</p>
<p>4ã€è´Ÿè½½å‡è¡¡</p>
<p>5ã€æœåŠ¡é™çº§</p>
<p>6ã€æœåŠ¡æ¶ˆæ¯é˜Ÿåˆ—</p>
<p>7ã€é…ç½®ä¸­å¿ƒç®¡ç†</p>
<p>8ã€æœåŠ¡ç½‘å…³</p>
<p>9ã€æœåŠ¡ç›‘æ§</p>
<p>10ã€å…¨é“¾è·¯è¿½è¸ª</p>
<p>11ã€è‡ªåŠ¨åŒ–æ„å»ºéƒ¨ç½²</p>
<p>12ã€æœåŠ¡å®šæ—¶ä»»åŠ¡è°ƒåº¦æ“ä½œ</p>
<p>ç­‰ç­‰ã€‚</p>
<p><strong>springcloudå’Œspringbootçš„åŒºåˆ«</strong></p>
<p><strong>Spring Boot æ˜¯ã€Œå¿«é€Ÿå¼€å‘å•ä¸ªå¾®æœåŠ¡åº”ç”¨ã€çš„åŸºç¡€æ¡†æ¶ï¼Œè§£å†³ â€œå•ä½“åº”ç”¨å¿«é€Ÿå¼€å‘ã€é…ç½®ç®€åŒ–â€ é—®é¢˜ï¼›Spring Cloud æ˜¯ã€Œç®¡ç† / åè°ƒå¤šä¸ªå¾®æœåŠ¡ã€çš„åˆ†å¸ƒå¼æ¡†æ¶ï¼ŒåŸºäº Spring Boot æ„å»ºï¼Œè§£å†³ â€œå¾®æœåŠ¡é›†ç¾¤çš„æœåŠ¡æ²»ç†ã€åˆ†å¸ƒå¼åä½œâ€ é—®é¢˜</strong>ã€‚</p>
<p><strong>SpringCloud å’ŒSpringCloud Alibaba çš„åŒºåˆ«</strong></p>
<p><strong>Spring Cloud Alibaba æ˜¯ Spring Cloud ç”Ÿæ€çš„ã€Œæœ¬åœŸåŒ–å¢å¼ºå®ç°ã€ï¼Œæ˜¯ Spring Cloud æ ‡å‡†è§„èŒƒçš„å…·ä½“è½åœ°ï¼›ä¸¤è€…å®Œå…¨å¯ä»¥æ··ç€ç”¨ï¼Œä¸”å®é™…ç”Ÿäº§ä¸­å¤§å¤šæ˜¯ â€œSpring Cloud æ ¸å¿ƒç»„ä»¶ + Spring Cloud Alibaba ç‰¹è‰²ç»„ä»¶â€ çš„ç»„åˆæ–¹å¼</strong>ã€‚</p>
<p><strong>é‚£ä¹ˆSpringCloud = åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œæ˜¯å¤šç§å¾®æœåŠ¡æ¶æ„è½åœ°æŠ€æœ¯çš„é›†åˆä½“ï¼Œä¿—ç§°å¾®æœåŠ¡å…¨å®¶æ¡¶</strong></p>
<p>SpringCloudè¿™ä¸ªå¤§é›†åˆé‡Œæœ‰å¤šå°‘ç§æŠ€æœ¯ï¼Ÿå¤§æ¦‚20å¤šç§å„ç§å„æ ·ï¼Œä½†æ˜¯ä¸‹é¢å°±è®²è§£é€šç”¨çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106033538015.png" alt="image-20260106033538015"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106035205100.png" alt="image-20260106035205100" style="zoom:200%;" /></p>
<p>ç°åœ¨ç”¨çš„ç»„ä»¶ã€‚</p>
<h1 id="3ã€å¾®æœåŠ¡æ¶æ„ç¼–ç Baseå·¥ç¨‹æ¨¡å—æ„å»º"><a href="#3ã€å¾®æœåŠ¡æ¶æ„ç¼–ç Baseå·¥ç¨‹æ¨¡å—æ„å»º" class="headerlink" title="3ã€å¾®æœåŠ¡æ¶æ„ç¼–ç Baseå·¥ç¨‹æ¨¡å—æ„å»º"></a>3ã€å¾®æœåŠ¡æ¶æ„ç¼–ç Baseå·¥ç¨‹æ¨¡å—æ„å»º</h1><p>ç†è®ºçŸ¥é“äº†ï¼Œè¿™é‡Œç›´æ¥å®æˆ˜ç†è§£ã€‚</p>
<p><strong>åšä¸€ä¸ªè®¢å• -&gt; æ”¯ä»˜ çš„æ¡ˆä¾‹</strong></p>
<h3 id="éœ€æ±‚è¯´æ˜"><a href="#éœ€æ±‚è¯´æ˜" class="headerlink" title="éœ€æ±‚è¯´æ˜"></a>éœ€æ±‚è¯´æ˜</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106040501990.png" alt="image-20260106040501990"></p>
<h2 id="çº¦å®š-gt-é…ç½®-gt-ç¼–ç "><a href="#çº¦å®š-gt-é…ç½®-gt-ç¼–ç " class="headerlink" title="çº¦å®š &gt; é…ç½® &gt; ç¼–ç "></a>çº¦å®š &gt; é…ç½® &gt; ç¼–ç </h2><h3 id="IDEAæ–°å»ºProjectå’ŒMavençˆ¶å·¥ç¨‹"><a href="#IDEAæ–°å»ºProjectå’ŒMavençˆ¶å·¥ç¨‹" class="headerlink" title="IDEAæ–°å»ºProjectå’ŒMavençˆ¶å·¥ç¨‹"></a>IDEAæ–°å»ºProjectå’ŒMavençˆ¶å·¥ç¨‹</h3><h4 id="å¾®æœåŠ¡cloudæ•´ä½“èšåˆMavençˆ¶å·¥ç¨‹Project"><a href="#å¾®æœåŠ¡cloudæ•´ä½“èšåˆMavençˆ¶å·¥ç¨‹Project" class="headerlink" title="å¾®æœåŠ¡cloudæ•´ä½“èšåˆMavençˆ¶å·¥ç¨‹Project"></a>å¾®æœåŠ¡cloudæ•´ä½“èšåˆMavençˆ¶å·¥ç¨‹Project</h4><h5 id="1ã€New-Project"><a href="#1ã€New-Project" class="headerlink" title="1ã€New Project"></a>1ã€New Project</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106041413544.png" alt="image-20260106041413544"></p>
<h5 id="2ã€èšåˆæ€»çˆ¶å·¥ç¨‹åå­—"><a href="#2ã€èšåˆæ€»çˆ¶å·¥ç¨‹åå­—" class="headerlink" title="2ã€èšåˆæ€»çˆ¶å·¥ç¨‹åå­—"></a>2ã€èšåˆæ€»çˆ¶å·¥ç¨‹åå­—</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106041541275.png" alt="image-20260106041541275"></p>
<h5 id="3ã€å­—ç¬¦ç¼–ç "><a href="#3ã€å­—ç¬¦ç¼–ç " class="headerlink" title="3ã€å­—ç¬¦ç¼–ç "></a>3ã€å­—ç¬¦ç¼–ç </h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106041745035.png" alt="image-20260106041745035"></p>
<h5 id="4ã€æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»"><a href="#4ã€æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»" class="headerlink" title="4ã€æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»"></a>4ã€æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106041900303.png" alt="image-20260106041900303"></p>
<h5 id="5ã€javaç¼–è¯‘ç‰ˆæœ¬é€‰17"><a href="#5ã€javaç¼–è¯‘ç‰ˆæœ¬é€‰17" class="headerlink" title="5ã€javaç¼–è¯‘ç‰ˆæœ¬é€‰17"></a>5ã€javaç¼–è¯‘ç‰ˆæœ¬é€‰17</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106041943050.png" alt="image-20260106041943050"></p>
<h5 id="6ã€File-Typeè¿‡æ»¤ä»¥åŠé…ç½®è‡ªå·±çš„Maven"><a href="#6ã€File-Typeè¿‡æ»¤ä»¥åŠé…ç½®è‡ªå·±çš„Maven" class="headerlink" title="6ã€File Typeè¿‡æ»¤ä»¥åŠé…ç½®è‡ªå·±çš„Maven"></a>6ã€File Typeè¿‡æ»¤ä»¥åŠé…ç½®è‡ªå·±çš„Maven</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106042255854.png" alt="image-20260106042255854"></p>
<h4 id="çˆ¶å·¥ç¨‹POMæ–‡ä»¶å†…å®¹"><a href="#çˆ¶å·¥ç¨‹POMæ–‡ä»¶å†…å®¹" class="headerlink" title="çˆ¶å·¥ç¨‹POMæ–‡ä»¶å†…å®¹"></a>çˆ¶å·¥ç¨‹POMæ–‡ä»¶å†…å®¹</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hutool.version</span>&gt;</span>5.8.22<span class="tag">&lt;/<span class="name">hutool.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lombok.version</span>&gt;</span>1.18.26<span class="tag">&lt;/<span class="name">lombok.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.1.20<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis.springboot.version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">mybatis.springboot.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.11<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">swagger3.version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">swagger3.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper.version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">mapper.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fastjson2.version</span>&gt;</span>2.0.40<span class="tag">&lt;/<span class="name">fastjson2.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">persistence-api.version</span>&gt;</span>1.0.2<span class="tag">&lt;/<span class="name">persistence-api.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.boot.test.version</span>&gt;</span>3.1.5<span class="tag">&lt;/<span class="name">spring.boot.test.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.boot.version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">spring.boot.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.cloud.version</span>&gt;</span>2023.0.0<span class="tag">&lt;/<span class="name">spring.cloud.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.cloud.alibaba.version</span>&gt;</span>2022.0.0.0-RC2<span class="tag">&lt;/<span class="name">spring.cloud.alibaba.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springboot 3.2.0--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springcloud 2023.0.0--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springcloud alibaba 2022.0.0.0-RC2--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.alibaba.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SpringBooté›†æˆmybatis--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.springboot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--Mysqlæ•°æ®åº“é©±åŠ¨8 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SpringBooté›†æˆdruidè¿æ¥æ± --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--é€šç”¨Mapper4ä¹‹tk.mybatis--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapper.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;persistence-api.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- fastjson2 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;fastjson2.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;swagger3.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hutool.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;lombok.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- spring-boot-starter-test --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.test.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Mavenå·¥ç¨‹è½åœ°ç»†èŠ‚å¤ä¹ "><a href="#Mavenå·¥ç¨‹è½åœ°ç»†èŠ‚å¤ä¹ " class="headerlink" title="Mavenå·¥ç¨‹è½åœ°ç»†èŠ‚å¤ä¹ "></a>Mavenå·¥ç¨‹è½åœ°ç»†èŠ‚å¤ä¹ </h4><h5 id="Mavenä¸­çš„DependencyManagementå’ŒDependencies"><a href="#Mavenä¸­çš„DependencyManagementå’ŒDependencies" class="headerlink" title="Mavenä¸­çš„DependencyManagementå’ŒDependencies"></a>Mavenä¸­çš„DependencyManagementå’ŒDependencies</h5><p>dependencyManagement</p>
<p>Maven ä½¿ç”¨dependencyManagement å…ƒç´ æ¥æä¾›äº†ä¸€ç§ç®¡ç†ä¾èµ–ç‰ˆæœ¬å·çš„æ–¹å¼ã€‚</p>
<p>é€šå¸¸ä¼šåœ¨ä¸€ä¸ªç»„ç»‡æˆ–è€…é¡¹ç›®çš„æœ€é¡¶å±‚çš„çˆ¶POM ä¸­çœ‹åˆ°dependencyManagement å…ƒç´ ã€‚</p>
<p>ä½¿ç”¨pom.xml ä¸­çš„dependencyManagement å…ƒç´ èƒ½è®©æ‰€æœ‰åœ¨å­é¡¹ç›®ä¸­å¼•ç”¨ä¸€ä¸ªä¾èµ–è€Œä¸ç”¨æ˜¾å¼çš„åˆ—å‡ºç‰ˆæœ¬å·ã€‚</p>
<p>Mavenä¼šæ²¿ç€çˆ¶å­å±‚æ¬¡å‘ä¸Šèµ°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ‹¥æœ‰dependencyManagement å…ƒç´ çš„é¡¹ç›®ï¼Œç„¶åå®ƒå°±ä¼šä½¿ç”¨è¿™ä¸ª</p>
<p>dependencyManagement å…ƒç´ ä¸­æŒ‡å®šçš„ç‰ˆæœ¬å·ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106042918071.png" alt="image-20260106042918071"></p>
<p>è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼šå¦‚æœæœ‰å¤šä¸ªå­é¡¹ç›®éƒ½å¼•ç”¨åŒä¸€æ ·ä¾èµ–ï¼Œåˆ™å¯ä»¥é¿å…åœ¨æ¯ä¸ªä½¿ç”¨çš„å­é¡¹ç›®é‡Œéƒ½å£°æ˜ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¼˜åŠ¿ï¼š</p>
<p>1ã€è¿™æ ·å½“æƒ³å‡çº§æˆ–åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼Œåªéœ€è¦åœ¨é¡¶å±‚çˆ¶å®¹å™¨é‡Œæ›´æ–°ï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­é¡¹ç›®çš„ä¿®æ”¹ ï¼›</p>
<p>2ã€å¦å¤–å¦‚æœæŸä¸ªå­é¡¹ç›®éœ€è¦å¦å¤–çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œåªéœ€è¦å£°æ˜versionå°±å¯ã€‚</p>
<p>dependencyManagementé‡Œåªæ˜¯å£°æ˜ä¾èµ–ï¼Œ<strong><em>å¹¶ä¸å®ç°å¼•å…¥\</em></strong>ï¼Œå› æ­¤å­é¡¹ç›®éœ€è¦æ˜¾ç¤ºçš„å£°æ˜éœ€è¦ç”¨çš„ä¾èµ–ã€‚</p>
<p>*  å¦‚æœä¸åœ¨å­é¡¹ç›®ä¸­å£°æ˜ä¾èµ–ï¼Œæ˜¯ä¸ä¼šä»çˆ¶é¡¹ç›®ä¸­ç»§æ‰¿ä¸‹æ¥çš„ï¼Œåªæœ‰åœ¨å­é¡¹ç›®ä¸­å†™äº†è¯¥ä¾èµ–é¡¹å¹¶ä¸”æ²¡æœ‰æŒ‡å®šå…·ä½“ç‰ˆæœ¬ï¼Œæ‰ä¼šä»çˆ¶é¡¹ç›®ä¸­ç»§æ‰¿è¯¥é¡¹     ä¸”versionå’Œscopeéƒ½è¯»å–è‡ªçˆ¶pom;</p>
<p>*   å¦‚æœå­é¡¹ç›®ä¸­æŒ‡å®šäº†ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨å­é¡¹ç›®ä¸­æŒ‡å®šçš„jarç‰ˆæœ¬ã€‚</p>
<h5 id="mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯•"><a href="#mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯•" class="headerlink" title="mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯•"></a>mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯•</h5><p>1ã€é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span><span class="comment">&lt;!-- mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">skip</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skip</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€IDEAå·¥å…·æ”¯æŒï¼ˆæ¨èï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106043113543.png" alt="image-20260106043113543"></p>
<h4 id="mysqlé©±åŠ¨è¯´æ˜"><a href="#mysqlé©±åŠ¨è¯´æ˜" class="headerlink" title="mysqlé©±åŠ¨è¯´æ˜"></a>mysqlé©±åŠ¨è¯´æ˜</h4><h5 id="Mysql5"><a href="#Mysql5" class="headerlink" title="Mysql5"></a>Mysql5</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># mysql5.7---JDBCå››ä»¶å¥—</span><br><span class="line">jdbc.driverClass = com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url= jdbc:mysql://localhost:3306/db2024?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false</span><br><span class="line">jdbc.user = root</span><br><span class="line">jdbc.password =123456</span><br><span class="line"> </span><br><span class="line"># Mavençš„POMæ–‡ä»¶å¤„ç†</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.1.47&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h5 id="Mysql8"><a href="#Mysql8" class="headerlink" title="Mysql8"></a>Mysql8</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># mysql8.0---JDBCå››ä»¶å¥—</span><br><span class="line">jdbc.driverClass = com.mysql.cj.jdbc.Driver</span><br><span class="line">jdbc.url= jdbc:mysql://localhost:3306/db2024?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT%2B8&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span><br><span class="line">jdbc.user = root</span><br><span class="line">jdbc.password =123456</span><br><span class="line"></span><br><span class="line"># Mavençš„POM</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.0.11&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Mapper4ä¹‹ä¸€é”®ç”Ÿæˆ"><a href="#Mapper4ä¹‹ä¸€é”®ç”Ÿæˆ" class="headerlink" title="Mapper4ä¹‹ä¸€é”®ç”Ÿæˆ"></a>Mapper4ä¹‹ä¸€é”®ç”Ÿæˆ</h3><p>è¿™åªæ˜¯ä¸ªå•ç‹¬çš„ç”Ÿæˆå·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ideaçš„ä¸€äº›æ’ä»¶ï¼Œæˆ–è€…ç”¨aiç”Ÿæˆå¸¸è§çš„sqlè„šæœ¬ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<h4 id="mybatis-generator"><a href="#mybatis-generator" class="headerlink" title="mybatis-generator"></a>mybatis-generator</h4><p>å®˜ç½‘ï¼š<code>http://mybatis.org/generator/</code></p>
<h4 id="MyBatisé€šç”¨Mapper4å®˜ç½‘"><a href="#MyBatisé€šç”¨Mapper4å®˜ç½‘" class="headerlink" title="MyBatisé€šç”¨Mapper4å®˜ç½‘"></a>MyBatisé€šç”¨Mapper4å®˜ç½‘</h4><p>å®˜ç½‘ï¼š<code>https://github.com/abel533/Mapper</code></p>
<p>æœ¬æ¬¡ä½¿ç”¨Mapper4</p>
<h4 id="ä¸€é”®ç”Ÿæˆæ­¥éª¤"><a href="#ä¸€é”®ç”Ÿæˆæ­¥éª¤" class="headerlink" title="ä¸€é”®ç”Ÿæˆæ­¥éª¤"></a>ä¸€é”®ç”Ÿæˆæ­¥éª¤</h4><h5 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h5><p>æ–°å»ºæ•°æ®åº“db2024</p>
<p>åˆ›å»ºåº“t_payæ”¯ä»˜ä¿¡æ¯è¡¨SQL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_pay`;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_pay` (</span><br><span class="line"></span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line"></span><br><span class="line">  `pay_no` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;æ”¯ä»˜æµæ°´å·&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `order_no` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;è®¢å•æµæ°´å·&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `user_id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·è´¦å·ID&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `amount` <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;9.9&#x27;</span> COMMENT <span class="string">&#x27;äº¤æ˜“é‡‘é¢&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `deleted` TINYINT(<span class="number">4</span>) UNSIGNED <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;åˆ é™¤æ ‡å¿—ï¼Œé»˜è®¤0ä¸åˆ é™¤ï¼Œ1åˆ é™¤&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `create_time` <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  `update_time` <span class="type">TIMESTAMP</span> <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line"></span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;æ”¯ä»˜äº¤æ˜“è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> t_pay(pay_no,order_no) <span class="keyword">VALUES</span>(<span class="string">&#x27;pay17203699&#x27;</span>,<span class="string">&#x27;6544bafb424a&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_pay;</span><br></pre></td></tr></table></figure>
<h5 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h5><p>æ™®é€šçš„Mavenå·¥ç¨‹ï¼šmybatis_generator2024</p>
<h5 id="POM"><a href="#POM" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æˆ‘è‡ªå·±ç‹¬ä¸€ä»½ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šMavenå·¥ç¨‹ï¼Œä¸bootå’Œcloudæ— å…³--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis_generator2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Mybatis é€šç”¨mapper tkå•ç‹¬ä½¿ç”¨ï¼Œè‡ªå·±ç‹¬æœ‰+è‡ªå¸¦ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mybatis Generator è‡ªå·±ç‹¬æœ‰+è‡ªå¸¦ç‰ˆæœ¬å·--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨Mapper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mysql8.0--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h5><p>åœ¨<code>src\main\resources</code>è·¯å¾„ä¸‹æ–°å»º</p>
<p><code>config.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t_payè¡¨åŒ…å</span></span><br><span class="line"><span class="attr">package.name</span>=<span class="string">com.bitzh.cloud</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># mysql8.0</span></span><br><span class="line"><span class="attr">jdbc.driverClass</span> = <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>= <span class="string">jdbc:mysql://localhost:3306/db2024?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT%2B8&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line"><span class="attr">jdbc.user</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span> = <span class="string">root</span></span><br></pre></td></tr></table></figure>
<p><code>generatorConfig.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;config.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;Mysql&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3Simple&quot;</span> <span class="attr">defaultModelType</span>=<span class="string">&quot;flat&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;beginningDelimiter&quot;</span> <span class="attr">value</span>=<span class="string">&quot;`&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;endingDelimiter&quot;</span> <span class="attr">value</span>=<span class="string">&quot;`&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">&quot;tk.mybatis.mapper.generator.MapperPlugin&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappers&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tk.mybatis.mapper.common.Mapper&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;caseSensitive&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">&quot;$&#123;jdbc.user&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.entities&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;$&#123;package.name&#125;.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;src/main/java&quot;</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_pay&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Pay&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generatedKey</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">sqlStatement</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="ä¸€é”®ç”Ÿæˆ"><a href="#ä¸€é”®ç”Ÿæˆ" class="headerlink" title="ä¸€é”®ç”Ÿæˆ"></a>ä¸€é”®ç”Ÿæˆ</h5><p>åŒå‡»æ’ä»¶ mybatis-generator:generateï¼Œä¸€é”®ç”Ÿæˆ</p>
<p>ç”Ÿæˆenetity + mapperæ¥å£ + xmlå®ç°SQL</p>
<h3 id="Resté€šç”¨Baseå·¥ç¨‹æ„å»º"><a href="#Resté€šç”¨Baseå·¥ç¨‹æ„å»º" class="headerlink" title="Resté€šç”¨Baseå·¥ç¨‹æ„å»º"></a>Resté€šç”¨Baseå·¥ç¨‹æ„å»º</h3><h4 id="å·¥ç¨‹V1"><a href="#å·¥ç¨‹V1" class="headerlink" title="å·¥ç¨‹V1"></a>å·¥ç¨‹V1</h4><h5 id="1ã€cloud-provider-payment8001å¾®æœåŠ¡æä¾›è€…æ”¯ä»˜Moduleæ¨¡å—"><a href="#1ã€cloud-provider-payment8001å¾®æœåŠ¡æä¾›è€…æ”¯ä»˜Moduleæ¨¡å—" class="headerlink" title="1ã€cloud-provider-payment8001å¾®æœåŠ¡æä¾›è€…æ”¯ä»˜Moduleæ¨¡å—"></a>1ã€cloud-provider-payment8001å¾®æœåŠ¡æä¾›è€…æ”¯ä»˜Moduleæ¨¡å—</h5><h6 id="å¾®æœåŠ¡å°å£è¯€"><a href="#å¾®æœåŠ¡å°å£è¯€" class="headerlink" title="å¾®æœåŠ¡å°å£è¯€"></a>å¾®æœåŠ¡å°å£è¯€</h6><p>å»ºmoduleï¼Œæ”¹POMï¼Œå†™YMLï¼Œä¸»å¯åŠ¨ï¼Œä¸šåŠ¡ç±»</p>
<h6 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h6><p>1ã€å»ºmodule</p>
<p>åˆ›å»ºæ™®é€šMavenæ¨¡å—ï¼šcloud-provider-payment8001</p>
<p>2ã€æ”¹POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-provider-payment8001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté€šç”¨ä¾èµ–æ¨¡å—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté›†æˆdruidè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatiså’Œspringbootæ•´åˆ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Mysqlæ•°æ®åº“é©±åŠ¨8 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨Mapper4--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- fastjson2 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3ã€å†™YML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==========applicationName + druid-mysql8 driver===================</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-payment-service</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/db2024?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT%2B8&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================mybatis===================</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.atguigu.cloud.entities</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>4ã€ä¸»å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.bitzh.cloud.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main8001</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Main8001.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5ã€ä¸šåŠ¡ç±»</p>
<p>è¿™ä¸ªç‰ˆæœ¬æœ‰äº›bugï¼Œä½†æ˜¯å¸¸è§æ‰€ä»¥è¿™é‡Œæ¼”ç¤ºä¸€äº›bug</p>
<p>é¦–å…ˆå°†ä¹‹å‰ä¸€é”®ç”Ÿæˆçš„ä»£ç ç›´æ¥æ‹·è´è¿›å…¥8001æ¨¡å—</p>
<p><strong>entities</strong></p>
<p>ä¸»å®ä½“Pay</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆšåˆšç”Ÿæˆçš„</span><br></pre></td></tr></table></figure>
<p>ä¼ é€’æ•°å€¼PayDTOï¼ˆPO å¯¹åº”æ•°æ®åº“è¡¨ï¼ŒDTO ç”¨äºæœåŠ¡é—´ / å±‚é—´ä¼ è¾“ï¼ŒVO é¢å‘å‰ç«¯å±•ç¤º / æ¥æ”¶ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="comment">//æ”¯ä»˜æµæ°´å·</span></span><br><span class="line">    <span class="keyword">private</span> String payNo;</span><br><span class="line">    <span class="comment">//è®¢å•æµæ°´å·</span></span><br><span class="line">    <span class="keyword">private</span> String orderNo;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·è´¦å·ID</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="comment">//äº¤æ˜“é‡‘é¢</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal amount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>mapper</strong></p>
<p>Mapperæ¥å£PayMapperç”¨ç”Ÿæˆçš„</p>
<p>æ˜ å°„æ–‡ä»¶PayMapper.xmlç”¨ç”Ÿæˆçš„</p>
<p>service</p>
<p>æœåŠ¡æ¥å£ PayService</p>
<p>å®ç°ç±» PayServiceImpl</p>
<p>controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayController</span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span> PayService payService;</span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">addPay</span><span class="params">(<span class="meta">@RequestBody</span> Pay pay)</span>&#123;</span><br><span class="line">        System.out.println(pay.toString());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> payService.add(pay);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆåŠŸæ’å…¥è®°å½•ï¼Œè¿”å›å€¼ï¼š&quot;</span>+i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@DeleteMapping(value = &quot;/pay/del/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">deletePay</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> payService.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@PutMapping(value = &quot;/pay/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">updatePay</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span>&#123;</span><br><span class="line">        <span class="type">Pay</span> <span class="variable">pay</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Pay</span>();</span><br><span class="line">        BeanUtils.copyProperties(payDTO, pay);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> payService.update(pay);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æˆåŠŸä¿®æ”¹è®°å½•ï¼Œè¿”å›å€¼ï¼š&quot;</span>+i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Pay <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> payService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/getAll&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Pay&gt; <span class="title function_">getAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> payService.getAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h6><p>1ã€postman/apifoxä¸€é”®ç”Ÿæˆ</p>
<p>2ã€Swqgger3 / Knife4J</p>
<p><strong>å¸¸ç”¨æ³¨è§£</strong></p>
<p>æ³¨è§£åˆ—è¡¨</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106060658087.png" alt="image-20260106060658087"></p>
<p>Swaggeræƒ³è¦å¯åŠ¨éœ€è¦é…ç½®,ä¸‹é¢çš„é…ç½®å«åˆ†ç»„è¿­ä»£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bitzh.cloud.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.v3.oas.models.ExternalDocumentation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.v3.oas.models.OpenAPI;</span><br><span class="line"><span class="keyword">import</span> io.swagger.v3.oas.models.info.Info;</span><br><span class="line"><span class="keyword">import</span> org.springdoc.core.models.GroupedOpenApi;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: oyy0v0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2026/1/6 - 01 - 06 - 6:23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: com.bitzh.cloud.config</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Swagger3Config</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> GroupedOpenApi <span class="title function_">PayApi</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> GroupedOpenApi.builder().group(<span class="string">&quot;æ”¯ä»˜å¾®æœåŠ¡æ¨¡å—&quot;</span>).pathsToMatch(<span class="string">&quot;/pay/**&quot;</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> GroupedOpenApi <span class="title function_">OtherApi</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> GroupedOpenApi.builder().group(<span class="string">&quot;å…¶å®ƒå¾®æœåŠ¡æ¨¡å—&quot;</span>).pathsToMatch(<span class="string">&quot;/other/**&quot;</span>, <span class="string">&quot;/others&quot;</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*@Bean</span></span><br><span class="line"><span class="comment">    public GroupedOpenApi CustomerApi()</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        return GroupedOpenApi.builder().group(&quot;å®¢æˆ·å¾®æœåŠ¡æ¨¡å—&quot;).pathsToMatch(&quot;/customer/**&quot;, &quot;/customers&quot;).build();</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> OpenAPI <span class="title function_">docsOpenApi</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OpenAPI</span>()</span><br><span class="line">            .info(<span class="keyword">new</span> <span class="title class_">Info</span>().title(<span class="string">&quot;cloud2024&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;é€šç”¨è®¾è®¡rest&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;v1.0&quot;</span>))</span><br><span class="line">            .externalDocs(<span class="keyword">new</span> <span class="title class_">ExternalDocumentation</span>()</span><br><span class="line">                .description(<span class="string">&quot;www.atguigu.com&quot;</span>)</span><br><span class="line">                .url(<span class="string">&quot;https://yiyan.baidu.com/&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è®¿é—®ï¼š <code>http://localhost:8001/swagger-ui/index.html</code></p>
<h5 id="2ã€ä¸Šé¢æ¨¡å—è¿˜æœ‰å“ªäº›é—®é¢˜"><a href="#2ã€ä¸Šé¢æ¨¡å—è¿˜æœ‰å“ªäº›é—®é¢˜" class="headerlink" title="2ã€ä¸Šé¢æ¨¡å—è¿˜æœ‰å“ªäº›é—®é¢˜"></a>2ã€ä¸Šé¢æ¨¡å—è¿˜æœ‰å“ªäº›é—®é¢˜</h5><h6 id="1ã€æ—¶é—´æ ¼å¼é—®é¢˜"><a href="#1ã€æ—¶é—´æ ¼å¼é—®é¢˜" class="headerlink" title="1ã€æ—¶é—´æ ¼å¼é—®é¢˜"></a>1ã€æ—¶é—´æ ¼å¼é—®é¢˜</h6><p>æ—¶é—´æ—¥å¿—æ ¼å¼çš„ç»Ÿä¸€å’Œå®šåˆ¶æƒ…å†µï¼Ÿ</p>
<h6 id="2ã€Javaå¦‚ä½•è®¾è®¡APIæ¥å£å®ç°ç»Ÿä¸€æ ¼å¼è¿”å›ï¼Ÿ"><a href="#2ã€Javaå¦‚ä½•è®¾è®¡APIæ¥å£å®ç°ç»Ÿä¸€æ ¼å¼è¿”å›ï¼Ÿ" class="headerlink" title="2ã€Javaå¦‚ä½•è®¾è®¡APIæ¥å£å®ç°ç»Ÿä¸€æ ¼å¼è¿”å›ï¼Ÿ"></a>2ã€Javaå¦‚ä½•è®¾è®¡APIæ¥å£å®ç°ç»Ÿä¸€æ ¼å¼è¿”å›ï¼Ÿ</h6><p>å½±å“å‰ç«¯/å°ç¨‹åº/appç­‰äº¤äº’ä½“éªŒå’Œå¼€å‘</p>
<h6 id="3ã€å…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼"><a href="#3ã€å…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼" class="headerlink" title="3ã€å…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼"></a>3ã€å…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼</h6><p>æœ‰ç»Ÿä¸€è¿”å›å€¼ + å…¨å±€ç»Ÿä¸€å¼‚å¸¸</p>
<p>ç­‰ç­‰</p>
<h4 id="å·¥ç¨‹V2"><a href="#å·¥ç¨‹V2" class="headerlink" title="å·¥ç¨‹V2"></a>å·¥ç¨‹V2</h4><h5 id="è§£å†³æ—¶é—´æ ¼å¼é—®é¢˜"><a href="#è§£å†³æ—¶é—´æ ¼å¼é—®é¢˜" class="headerlink" title="è§£å†³æ—¶é—´æ ¼å¼é—®é¢˜"></a>è§£å†³æ—¶é—´æ ¼å¼é—®é¢˜</h5><p>æ–¹æ³•ä¸€ï¼šåœ¨ç›¸åº”çš„ç±»çš„å±æ€§ä¸Šä½¿ç”¨ @JsonFormat æ³¨è§£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@JsonFormat(pattern = &quot;yyy-MM-dd HH:mm:ss&quot;,timezone = &quot;GMT+8&quot;)</span><br><span class="line">æˆ–è€…</span><br><span class="line">@DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:sss&quot;)</span><br><span class="line">private Date billtime;</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³•äºŒï¼šå¦‚æœæ˜¯ Spring Booté¡¹ç›®ï¼Œä¹Ÿå¯ä»¥åœ¨ application.ymlæ–‡ä»¶ä¸­åˆ¶å®š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">jackson:</span></span><br><span class="line">		<span class="attr">date-format:</span> <span class="string">yyyy-MM-dd</span> <span class="string">HH:mm:ss</span></span><br><span class="line">		<span class="attr">time-zone:</span> <span class="string">GMT+8</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯åæœŸé…ç½®åˆ°ymlé‡Œé¢çš„æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œæ‰€ä»¥å°±ä¸å†™è¿›å»äº†ã€‚</p>
<h5 id="è§£å†³ç»Ÿä¸€è¿”å›å€¼"><a href="#è§£å†³ç»Ÿä¸€è¿”å›å€¼" class="headerlink" title="è§£å†³ç»Ÿä¸€è¿”å›å€¼"></a>è§£å†³ç»Ÿä¸€è¿”å›å€¼</h5><h6 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h6><p>å®šä¹‰è¿”å›æ ‡å‡†æ ¼å¼ï¼Œ3å¤§æ ‡é…</p>
<ul>
<li>code çŠ¶æ€å€¼ï¼šç”±åç«¯ç»Ÿä¸€å®šä¹‰å„ç§è¿”å›ç»“æœçš„çŠ¶æ€ç </li>
<li>message æè¿°ï¼šæœ¬æ¬¡æ¥å£è°ƒç”¨çš„ç»“æœæè¿°</li>
<li>data æ•°æ®ï¼šæœ¬æ¬¡è¿”å›çš„æ•°æ®</li>
</ul>
<p>æ‰©å±•ï¼šæ¥å£è°ƒç”¨æ—¶é—´ä¹‹ç±»</p>
<ul>
<li>timestampï¼šæ¥å£è°ƒç”¨æ—¶é—´</li>
</ul>
<h6 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h6><p><strong>æ–°å»ºæšä¸¾ç±» <code>ReturnCodeEnum</code></strong></p>
<ul>
<li><strong>HTTPè¯·æ±‚è¿”å›çš„çŠ¶æ€ç </strong></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260106184327346.png" alt="image-20260106184327346"></p>
<ul>
<li><strong>ReturnCodeEnum</strong></li>
</ul>
<p>æšä¸¾ç±»å°å£è¯€ï¼šä¸¾å€¼ã€æ„é€ ã€éå†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ReturnCodeEnum</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**æ“ä½œå¤±è´¥**/</span></span><br><span class="line">    RC999(<span class="string">&quot;999&quot;</span>,<span class="string">&quot;æ“ä½œXXXå¤±è´¥&quot;</span>),</span><br><span class="line">    <span class="comment">/**æ“ä½œæˆåŠŸ**/</span></span><br><span class="line">    RC200(<span class="string">&quot;200&quot;</span>,<span class="string">&quot;success&quot;</span>),</span><br><span class="line">    <span class="comment">/**æœåŠ¡é™çº§**/</span></span><br><span class="line">    RC201(<span class="string">&quot;201&quot;</span>,<span class="string">&quot;æœåŠ¡å¼€å¯é™çº§ä¿æŠ¤,è¯·ç¨åå†è¯•!&quot;</span>),</span><br><span class="line">    <span class="comment">/**çƒ­ç‚¹å‚æ•°é™æµ**/</span></span><br><span class="line">    RC202(<span class="string">&quot;202&quot;</span>,<span class="string">&quot;çƒ­ç‚¹å‚æ•°é™æµ,è¯·ç¨åå†è¯•!&quot;</span>),</span><br><span class="line">    <span class="comment">/**ç³»ç»Ÿè§„åˆ™ä¸æ»¡è¶³**/</span></span><br><span class="line">    RC203(<span class="string">&quot;203&quot;</span>,<span class="string">&quot;ç³»ç»Ÿè§„åˆ™ä¸æ»¡è¶³è¦æ±‚,è¯·ç¨åå†è¯•!&quot;</span>),</span><br><span class="line">    <span class="comment">/**æˆæƒè§„åˆ™ä¸é€šè¿‡**/</span></span><br><span class="line">    RC204(<span class="string">&quot;204&quot;</span>,<span class="string">&quot;æˆæƒè§„åˆ™ä¸é€šè¿‡,è¯·ç¨åå†è¯•!&quot;</span>),</span><br><span class="line">    <span class="comment">/**access_denied**/</span></span><br><span class="line">    RC403(<span class="string">&quot;403&quot;</span>,<span class="string">&quot;æ— è®¿é—®æƒé™,è¯·è”ç³»ç®¡ç†å‘˜æˆäºˆæƒé™&quot;</span>),</span><br><span class="line">    <span class="comment">/**access_denied**/</span></span><br><span class="line">    RC401(<span class="string">&quot;401&quot;</span>,<span class="string">&quot;åŒ¿åç”¨æˆ·è®¿é—®æ— æƒé™èµ„æºæ—¶çš„å¼‚å¸¸&quot;</span>),</span><br><span class="line">    RC404(<span class="string">&quot;404&quot;</span>,<span class="string">&quot;404é¡µé¢æ‰¾ä¸åˆ°çš„å¼‚å¸¸&quot;</span>),</span><br><span class="line">    <span class="comment">/**æœåŠ¡å¼‚å¸¸**/</span></span><br><span class="line">    RC500(<span class="string">&quot;500&quot;</span>,<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•&quot;</span>),</span><br><span class="line">    RC375(<span class="string">&quot;375&quot;</span>,<span class="string">&quot;æ•°å­¦è¿ç®—å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•&quot;</span>),</span><br><span class="line"></span><br><span class="line">    INVALID_TOKEN(<span class="string">&quot;2001&quot;</span>,<span class="string">&quot;è®¿é—®ä»¤ç‰Œä¸åˆæ³•&quot;</span>),</span><br><span class="line">    ACCESS_DENIED(<span class="string">&quot;2003&quot;</span>,<span class="string">&quot;æ²¡æœ‰æƒé™è®¿é—®è¯¥èµ„æº&quot;</span>),</span><br><span class="line">    CLIENT_AUTHENTICATION_FAILED(<span class="string">&quot;1001&quot;</span>,<span class="string">&quot;å®¢æˆ·ç«¯è®¤è¯å¤±è´¥&quot;</span>),</span><br><span class="line">    USERNAME_OR_PASSWORD_ERROR(<span class="string">&quot;1002&quot;</span>,<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>),</span><br><span class="line">    BUSINESS_ERROR(<span class="string">&quot;1004&quot;</span>,<span class="string">&quot;ä¸šåŠ¡é€»è¾‘å¼‚å¸¸&quot;</span>),</span><br><span class="line">    UNSUPPORTED_GRANT_TYPE(<span class="string">&quot;1003&quot;</span>, <span class="string">&quot;ä¸æ”¯æŒçš„è®¤è¯æ¨¡å¼&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**è‡ªå®šä¹‰çŠ¶æ€ç **/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String code;</span><br><span class="line">    <span class="comment">/**è‡ªå®šä¹‰æè¿°**/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String message;</span><br><span class="line"></span><br><span class="line">    ReturnCodeEnum(String code, String message)&#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éå†æšä¸¾V1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ReturnCodeEnum <span class="title function_">getReturnCodeEnum</span><span class="params">(String code)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (ReturnCodeEnum element : ReturnCodeEnum.values()) &#123;</span><br><span class="line">            <span class="keyword">if</span>(element.getCode().equalsIgnoreCase(code))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> element;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//éå†æšä¸¾V2</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ReturnCodeEnum <span class="title function_">getReturnCodeEnumV2</span><span class="params">(String code)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(ReturnCodeEnum.values()).filter(x -&gt; x.getCode().equalsIgnoreCase(code)).findFirst().orElse(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*public static void main(String[] args)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        System.out.println(getReturnCodeEnumV2(&quot;200&quot;));</span></span><br><span class="line"><span class="comment">        System.out.println(getReturnCodeEnumV2(&quot;200&quot;).getCode());</span></span><br><span class="line"><span class="comment">        System.out.println(getReturnCodeEnumV2(&quot;200&quot;).getMessage());</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ–°å»ºç»Ÿä¸€å®šä¹‰è¿”å›å¯¹è±¡ResultData</strong>ï¼š<code>ResultData&lt;T&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultData</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String code;<span class="comment">/** ç»“æœçŠ¶æ€ ,å…·ä½“çŠ¶æ€ç å‚è§æšä¸¾ç±»ReturnCodeEnum.java*/</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> timestamp ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ResultData</span> <span class="params">()</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.timestamp = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; ResultData&lt;T&gt; <span class="title function_">success</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        ResultData&lt;T&gt; resultData = <span class="keyword">new</span> <span class="title class_">ResultData</span>&lt;&gt;();</span><br><span class="line">        resultData.setCode(ReturnCodeEnum.RC200.getCode());</span><br><span class="line">        resultData.setMessage(ReturnCodeEnum.RC200.getMessage());</span><br><span class="line">        resultData.setData(data);</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; ResultData&lt;T&gt; <span class="title function_">fail</span><span class="params">(String code, String message)</span> &#123;</span><br><span class="line">        ResultData&lt;T&gt; resultData = <span class="keyword">new</span> <span class="title class_">ResultData</span>&lt;&gt;();</span><br><span class="line">        resultData.setCode(code);</span><br><span class="line">        resultData.setMessage(message);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="ä¿®æ”¹PayController"><a href="#ä¿®æ”¹PayController" class="headerlink" title="ä¿®æ”¹PayController"></a>ä¿®æ”¹PayController</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Tag(name = &quot;æ”¯ä»˜å¾®æœåŠ¡æ¨¡å—&quot;,description = &quot;æ”¯ä»˜CRUD&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    PayService payService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/pay/add&quot;)</span></span><br><span class="line">    <span class="meta">@Operation(summary = &quot;æ–°å¢&quot;,description = &quot;æ–°å¢æ”¯ä»˜æµæ°´æ–¹æ³•,jsonä¸²åšå‚æ•°&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">addPay</span><span class="params">(<span class="meta">@RequestBody</span> Pay pay)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(pay.toString());</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> payService.add(pay);</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(<span class="string">&quot;æˆåŠŸæ’å…¥è®°å½•ï¼Œè¿”å›å€¼ï¼š&quot;</span>+i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping(value = &quot;/pay/del/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@Operation(summary = &quot;åˆ é™¤&quot;,description = &quot;åˆ é™¤æ”¯ä»˜æµæ°´æ–¹æ³•&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;Integer&gt; <span class="title function_">deletePay</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> payService.delete(id);</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping(value = &quot;/pay/update&quot;)</span></span><br><span class="line">    <span class="meta">@Operation(summary = &quot;ä¿®æ”¹&quot;,description = &quot;ä¿®æ”¹æ”¯ä»˜æµæ°´æ–¹æ³•&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">updatePay</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Pay</span> <span class="variable">pay</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Pay</span>();</span><br><span class="line">        BeanUtils.copyProperties(payDTO, pay);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> payService.update(pay);</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(<span class="string">&quot;æˆåŠŸä¿®æ”¹è®°å½•ï¼Œè¿”å›å€¼ï¼š&quot;</span>+i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@Operation(summary = &quot;æŒ‰ç…§IDæŸ¥æµæ°´&quot;,description = &quot;æŸ¥è¯¢æ”¯ä»˜æµæ°´æ–¹æ³•&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;Pay&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Pay</span> <span class="variable">pay</span> <span class="operator">=</span> payService.getById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(pay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¨éƒ¨æŸ¥è¯¢getallä½œä¸ºå®¶åº­ä½œä¸š</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="è§£å†³ï¼šå…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼"><a href="#è§£å†³ï¼šå…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼" class="headerlink" title="è§£å†³ï¼šå…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼"></a>è§£å†³ï¼šå…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼</h5><h6 id="ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€å¼‚å¸¸å¤„ç†å™¨"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€å¼‚å¸¸å¤„ç†å™¨"></a>ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€å¼‚å¸¸å¤„ç†å™¨</h6><p>ä¸è¦å†æ‰‹å†™ try  catch</p>
<p>å½“ç„¶éè¦å†™ä¹Ÿå¯ä»¥</p>
<h6 id="æ–°å»ºå…¨å±€å¼‚å¸¸ç±»"><a href="#æ–°å»ºå…¨å±€å¼‚å¸¸ç±»" class="headerlink" title="æ–°å»ºå…¨å±€å¼‚å¸¸ç±»"></a>æ–°å»ºå…¨å±€å¼‚å¸¸ç±»</h6><p><code>GlobalExceptionHandler</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤å…¨å±€å¼‚å¸¸å¤„ç†ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e the e</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ResultData</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(RuntimeException.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">exception</span><span class="params">(Exception e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----come in GlobalExceptionHandler&quot;</span>);</span><br><span class="line">        log.error(<span class="string">&quot;å…¨å±€å¼‚å¸¸ä¿¡æ¯exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> ResultData.fail(ReturnCodeEnum.RC500.getCode(),e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥å¾®æœåŠ¡ç†å¿µï¼Œä»è¿™é‡Œå¼€å§‹"><a href="#å¼•å…¥å¾®æœåŠ¡ç†å¿µï¼Œä»è¿™é‡Œå¼€å§‹" class="headerlink" title="å¼•å…¥å¾®æœåŠ¡ç†å¿µï¼Œä»è¿™é‡Œå¼€å§‹"></a>å¼•å…¥å¾®æœåŠ¡ç†å¿µï¼Œä»è¿™é‡Œå¼€å§‹</h4><h5 id="è®¢å•å¾®æœåŠ¡80å¦‚ä½•æ‰èƒ½è°ƒç”¨åˆ°æ”¯ä»˜å¾®æœåŠ¡8001ï¼Ÿ"><a href="#è®¢å•å¾®æœåŠ¡80å¦‚ä½•æ‰èƒ½è°ƒç”¨åˆ°æ”¯ä»˜å¾®æœåŠ¡8001ï¼Ÿ" class="headerlink" title="è®¢å•å¾®æœåŠ¡80å¦‚ä½•æ‰èƒ½è°ƒç”¨åˆ°æ”¯ä»˜å¾®æœåŠ¡8001ï¼Ÿ"></a>è®¢å•å¾®æœåŠ¡80å¦‚ä½•æ‰èƒ½è°ƒç”¨åˆ°æ”¯ä»˜å¾®æœåŠ¡8001ï¼Ÿ</h5><h5 id="cloud-consumer-order80å¾®æœåŠ¡è°ƒç”¨è€…è®¢å•Moduleæ¨¡å—"><a href="#cloud-consumer-order80å¾®æœåŠ¡è°ƒç”¨è€…è®¢å•Moduleæ¨¡å—" class="headerlink" title="cloud-consumer-order80å¾®æœåŠ¡è°ƒç”¨è€…è®¢å•Moduleæ¨¡å—"></a>cloud-consumer-order80å¾®æœåŠ¡è°ƒç”¨è€…è®¢å•Moduleæ¨¡å—</h5><h6 id="å»ºç«‹-cloud-consumer-order80"><a href="#å»ºç«‹-cloud-consumer-order80" class="headerlink" title="å»ºç«‹ cloud-consumer-order80"></a>å»ºç«‹ <code>cloud-consumer-order80</code></h6><h6 id="æ”¹POM"><a href="#æ”¹POM" class="headerlink" title="æ”¹POM"></a>æ”¹POM</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-consumer-order80<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--web + actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool-all--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--fastjson2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="å†™YML"><a href="#å†™YML" class="headerlink" title="å†™YML"></a>å†™YML</h6><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>
<p>ä¸»å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main80</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main80.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="ä¸šåŠ¡ç±»"><a href="#ä¸šåŠ¡ç±»" class="headerlink" title="ä¸šåŠ¡ç±»"></a>ä¸šåŠ¡ç±»</h6><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªModuleï¼Œæ€ä¹ˆè°ƒç”¨å¦ä¸€ä¸ªæ¨¡å—å‘¢ï¼Ÿè¿™æ—¶å€™å°±éœ€è¦äº†è§£RestTemplate</p>
<p> <strong>entities</strong> ä¼ é€’æ•°å€¼PayDTO</p>
<p>æ¶ˆè´¹è€…è°ƒç”¨æ”¯ä»˜æ¨¡å—ï¼Œåº”è¯¥æ˜¯æ”¯ä»˜æ¨¡å—æš´éœ²æ¥å£è®©æ¶ˆè´¹è€…è°ƒç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *ä¸€èˆ¬è€Œè¨€ï¼Œè°ƒç”¨è€…ä¸åº”è¯¥è·æ‚‰æœåŠ¡æä¾›è€…çš„entityèµ„æºå¹¶çŸ¥é“è¡¨ç»“æ„å…³ç³»ï¼Œæ‰€ä»¥æœåŠ¡æä¾›æ–¹ç»™å‡ºçš„</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      æ¥å£æ–‡æ¡£éƒ½éƒ½åº”æˆä¸ºDTO</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="comment">//æ”¯ä»˜æµæ°´å·</span></span><br><span class="line">    <span class="keyword">private</span> String payNo;</span><br><span class="line">    <span class="comment">//è®¢å•æµæ°´å·</span></span><br><span class="line">    <span class="keyword">private</span> String orderNo;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·è´¦å·ID</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="comment">//äº¤æ˜“é‡‘é¢</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal amount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>RestTemplate</strong></p>
<p>æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RestTemplateæä¾›äº†å¤šç§ä¾¿æ·è®¿é—®è¿œç¨‹HttpæœåŠ¡çš„æ–¹æ³•ï¼Œ </span><br><span class="line">æ˜¯ä¸€ç§ç®€å•ä¾¿æ·çš„è®¿é—®restfulæœåŠ¡æ¨¡æ¿ç±»ï¼Œæ˜¯Springæä¾›çš„ç”¨äºè®¿é—®RestæœåŠ¡çš„å®¢æˆ·ç«¯æ¨¡æ¿å·¥å…·é›†</span><br><span class="line"></span><br><span class="line">å®˜ç½‘ï¼šhttps://docs.spring.io/spring-framework/docs/6.0.11/javadoc-api/org/springframework/web/client/RestTemplate.html</span><br></pre></td></tr></table></figure>
<p><strong>å¸¸ç”¨APIä½¿ç”¨è¯´æ˜</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨restTemplateè®¿é—®restfulæ¥å£éå¸¸çš„ç®€å•ç²—æš´æ— è„‘ã€‚</span><br><span class="line"></span><br><span class="line">(url, requestMap, ResponseBean.class)è¿™ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ </span><br><span class="line"></span><br><span class="line">RESTè¯·æ±‚åœ°å€ã€è¯·æ±‚å‚æ•°ã€HTTPå“åº”è½¬æ¢è¢«è½¬æ¢æˆçš„å¯¹è±¡ç±»å‹ã€‚</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107005218211.png" alt="image-20260107005218211"></p>
<p><code>getForObjectæ–¹æ³•/getForEntityæ–¹æ³•</code></p>
<p>è¿”å›å¯¹è±¡ä¸ºå“åº”ä½“ä¸­æ•°æ®è½¬åŒ–æˆçš„å¯¹è±¡ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç†è§£ä¸ºJson</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107010234705.png" alt="image-20260107010234705"></p>
<p>è¿”å›å¯¹è±¡ä¸ºResponseEntityå¯¹è±¡ï¼ŒåŒ…å«äº†å“åº”ä¸­çš„ä¸€äº›é‡è¦ä¿¡æ¯ï¼Œæ¯”å¦‚å“åº”å¤´ã€å“åº”çŠ¶æ€ç ã€å“åº”ä½“ç­‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107010842861.png" alt="image-20260107010842861"></p>
<p><code>postForObject / postForEntity</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107011027418.png" alt="image-20260107011027418"></p>
<p><strong>GETè¯·æ±‚æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;T&gt; T <span class="title function_">getForObject</span><span class="params">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; T <span class="title function_">getForObject</span><span class="params">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; T <span class="title function_">getForObject</span><span class="params">(URI url, Class&lt;T&gt; responseType)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">getForEntity</span><span class="params">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">getForEntity</span><span class="params">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">getForEntity</span><span class="params">(URI var1, Class&lt;T&gt; responseType)</span>;</span><br></pre></td></tr></table></figure>
<p><strong>POSTè¯·æ±‚æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;T&gt; T <span class="title function_">postForObject</span><span class="params">(String url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType, Object... uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; T <span class="title function_">postForObject</span><span class="params">(String url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; T <span class="title function_">postForObject</span><span class="params">(URI url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">postForEntity</span><span class="params">(String url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType, Object... uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">postForEntity</span><span class="params">(String url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; ResponseEntity&lt;T&gt; <span class="title function_">postForEntity</span><span class="params">(URI url, <span class="meta">@Nullable</span> Object request, Class&lt;T&gt; responseType)</span>;</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶æ­£å¸¸å¼€å‘çš„æ—¶å€™ä¸ä¼šæ¯ä¸ªéƒ½ä½¿ç”¨éƒ½newä¸€æ¬¡ï¼Œè€Œæ˜¯å†™ä¸€ä¸ªé…ç½®ç±»åˆ©ç”¨å®¹å™¨ç®¡ç†å¯¹è±¡</p>
<p><strong>configé…ç½®ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>controllerè°ƒç”¨æ”¯ä»˜æ¨¡å—</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PaymentSrv_URL</span> <span class="operator">=</span> <span class="string">&quot;http://localhost:8001&quot;</span>;<span class="comment">// å…ˆå†™æ­»ï¼Œç¡¬ç¼–ç </span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šè¿‡æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥urlï¼Œå‘é€çš„åªèƒ½æ˜¯getè¯·æ±‚</span></span><br><span class="line"><span class="comment">     * æˆ‘ä»¬åº•å±‚è°ƒç”¨çš„æ˜¯postæ–¹æ³•ï¼Œæ¨¡æ‹Ÿæ¶ˆè´¹è€…å‘é€getè¯·æ±‚ï¼Œå®¢æˆ·ç«¯æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment">     * å‚æ•°å¯ä»¥ä¸æ·»åŠ <span class="doctag">@RequestBody</span></span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> payDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">addOrder</span><span class="params">(PayDTO payDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.postForObject(PaymentSrv_URL + <span class="string">&quot;/pay/add&quot;</span>, payDTO, ResultData.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(PaymentSrv_URL + <span class="string">&quot;/pay/get/&#123;id&#125;&quot;</span> , ResultData.class,id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/consumer/pay/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">updatePayInfo</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span> &#123;</span><br><span class="line">        HttpEntity&lt;PayDTO&gt; requestEntity = <span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;(payDTO);</span><br><span class="line">        <span class="keyword">return</span> restTemplate.exchange(</span><br><span class="line">            PaymentSrv_URL + <span class="string">&quot;/pay/update&quot;</span>,</span><br><span class="line">            HttpMethod.PUT,</span><br><span class="line">            requestEntity,</span><br><span class="line">            ResultData.class).getBody();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/consumer/pay/delete/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">deletePayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.exchange(</span><br><span class="line">            PaymentSrv_URL + <span class="string">&quot;/pay/del/&#123;id&#125;&quot;</span>,</span><br><span class="line">            HttpMethod.DELETE,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            ResultData.class,id).getBody();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªä¸ªå¯åŠ¨ä¼šå¾ˆå¤šï¼Œæ‰€ä»¥æŠŠä»–çº³å…¥åˆ°serviceé‡Œé¢ï¼Œç»Ÿä¸€ç®¡ç†èµ·æ¥</p>
<p><strong>æµ‹è¯•</strong></p>
<p>ç°åœ¨æµ‹è¯•ç›´æ¥è®¿é—®cosumerçœ‹èƒ½ä¸èƒ½è°ƒç”¨æˆåŠŸã€‚</p>
<h5 id="å·¥ç¨‹é‡æ„"><a href="#å·¥ç¨‹é‡æ„" class="headerlink" title="å·¥ç¨‹é‡æ„"></a>å·¥ç¨‹é‡æ„</h5><h6 id="è§‚å¯Ÿé—®é¢˜"><a href="#è§‚å¯Ÿé—®é¢˜" class="headerlink" title="è§‚å¯Ÿé—®é¢˜"></a>è§‚å¯Ÿé—®é¢˜</h6><p>ç°åœ¨ä¸¤ä¸ªæ¨¡å—ä¸­æœ‰é‡å¤çš„éƒ¨åˆ†ï¼Œéœ€è¦è¿›è¡Œé‡æ„ç®€åŒ–ä»£ç </p>
<h6 id="æ–°å»ºModule"><a href="#æ–°å»ºModule" class="headerlink" title="æ–°å»ºModule"></a>æ–°å»ºModule</h6><p>åˆ›å»º<code>cloud-api-commons</code></p>
<p>åˆ›å»ºå¯¹å¤–æš´éœ²é€šç”¨çš„ç»„ä»¶ / api / æ¥å£ / å·¥å…·ç±»ç­‰</p>
<h6 id="æ”¹POM-1"><a href="#æ”¹POM-1" class="headerlink" title="æ”¹POM"></a>æ”¹POM</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté€šç”¨ä¾èµ–æ¨¡å—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="entities"><a href="#entities" class="headerlink" title="entities"></a>entities</h6><p>è¿™ä¸ªæ¨¡å—ä¸ç”¨å¯åŠ¨ï¼Œåªæ˜¯å…¬å…±æ¨¡å—æ‰€ä»¥ä¸ç”¨å†™ä¸»å¯åŠ¨</p>
<p>ç„¶åç°åœ¨æŠŠé‡å¤çš„ç±»æŠ½å–å‡ºæ¥</p>
<p>ä¸€ä¸ªæ˜¯ <strong>PayDTO</strong>ï¼Œä¸€ä¸ªæ˜¯ç»Ÿä¸€è¿”å›</p>
<p>ç„¶åæŠŠé€šç”¨çš„æ‰“åŒ…æˆ jar åŒ…å¯¹å¤–æš´éœ²ï¼Œæä¾›æœåŠ¡</p>
<p><strong>è®¢å•80å’Œæ”¯ä»˜8001åˆ†åˆ«æ”¹é€ </strong></p>
<p>åˆ é™¤å„è‡ªåŸå…ˆçš„ entities å’Œ ç»Ÿä¸€è¿”å›ä½“ç­‰å†…å®¹</p>
<p>ç„¶åå„è‡ªç²˜è´´POMå†…å®¹</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="ç›®å‰å·¥ç¨‹æ ·å›¾"><a href="#ç›®å‰å·¥ç¨‹æ ·å›¾" class="headerlink" title="ç›®å‰å·¥ç¨‹æ ·å›¾"></a>ç›®å‰å·¥ç¨‹æ ·å›¾</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107043123021.png" alt="image-20260107043123021"></p>
<p>æˆªè‡³ç›®å‰ï¼Œæ²¡æœ‰å¼•å…¥ä»»ä½•SpringCloudç›¸å…³å†…å®¹</p>
<h5 id="ä¸ºä»€ä¹ˆè¦å¼•å…¥å¾®æœåŠ¡"><a href="#ä¸ºä»€ä¹ˆè¦å¼•å…¥å¾®æœåŠ¡" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å¼•å…¥å¾®æœåŠ¡"></a>ä¸ºä»€ä¹ˆè¦å¼•å…¥å¾®æœåŠ¡</h5><p>ä¸Šä¸€ä¸ªé—®é¢˜controllerå†™æ­»çš„é—®é¢˜</p>
<p>å¾®æœåŠ¡æ‰€åœ¨çš„IPåœ°å€å’Œç«¯å£å·ç¡¬ç¼–ç åˆ°è®¢å•å¾®æœåŠ¡ä¸­ï¼Œä¼šå­˜åœ¨éå¸¸å¤šçš„é—®é¢˜</p>
<p>ï¼ˆ1ï¼‰å¦‚æœè®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡çš„IPåœ°å€æˆ–è€…ç«¯å£å·å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™æ”¯ä»˜å¾®æœåŠ¡å°†å˜å¾—ä¸å¯ç”¨ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹è®¢å•å¾®æœåŠ¡ä¸­è°ƒç”¨æ”¯ä»˜å¾®æœåŠ¡çš„IPåœ°å€å’Œç«¯å£å·ã€‚</p>
<p>ï¼ˆ2ï¼‰å¦‚æœç³»ç»Ÿä¸­æä¾›äº†å¤šä¸ªè®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡ï¼Œåˆ™æ— æ³•å®ç°å¾®æœåŠ¡çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</p>
<p>ï¼ˆ3ï¼‰å¦‚æœç³»ç»Ÿéœ€è¦æ”¯æŒæ›´é«˜çš„å¹¶å‘ï¼Œéœ€è¦éƒ¨ç½²æ›´å¤šçš„è®¢å•å¾®æœåŠ¡å’Œæ”¯ä»˜å¾®æœåŠ¡ï¼Œç¡¬ç¼–ç è®¢å•å¾®æœåŠ¡åˆ™åç»­çš„ç»´æŠ¤ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ã€‚</p>
<p>æ‰€ä»¥ï¼Œåœ¨å¾®æœåŠ¡å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼•å…¥æœåŠ¡æ²»ç†åŠŸèƒ½ï¼Œå®ç°å¾®æœåŠ¡ä¹‹é—´çš„åŠ¨æ€æ³¨å†Œä¸å‘ç°ï¼Œä»æ­¤åˆ»å¼€å§‹æˆ‘ä»¬æ­£å¼è¿›å…¥SpringCloudå®æˆ˜</p>
<h1 id="4ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#4ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="4ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°"></a>4ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°</h1><h3 id="ä¸ºä»€ä¹ˆè¦å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒ"><a href="#ä¸ºä»€ä¹ˆè¦å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒ"></a>ä¸ºä»€ä¹ˆè¦å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒ</h3><p>ä¹‹å‰å†™æ­»åœ°å€ç¡¬ç¼–ç ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107182606501.png" alt="image-20260107182606501"></p>
<h3 id="ä¸ºä»€ä¹ˆä¸å†ä½¿ç”¨è€ç‰Œçš„Eureka"><a href="#ä¸ºä»€ä¹ˆä¸å†ä½¿ç”¨è€ç‰Œçš„Eureka" class="headerlink" title="ä¸ºä»€ä¹ˆä¸å†ä½¿ç”¨è€ç‰Œçš„Eureka"></a>ä¸ºä»€ä¹ˆä¸å†ä½¿ç”¨è€ç‰Œçš„Eureka</h3><p>1ã€Eurekaåœæ›´äº†</p>
<p>2ã€Eurekaå¯¹åˆå­¦è€…ä¸å‹å¥½ï¼Œè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</p>
<p>3ã€æ³¨å†Œä¸­å¿ƒç‹¬ç«‹ä¸”å’Œå¾®æœåŠ¡åŠŸèƒ½è§£è€¦ï¼šç›®å‰ä¸»æµæœåŠ¡ä¸­å¿ƒï¼Œå¸Œæœ›å•ç‹¬éš”ç¦»å‡ºæ¥ï¼Œè€Œä¸æ˜¯åµŒå…¥åˆ°ç³»ç»Ÿå½“ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´è®¢å•æœåŠ¡ï¼Œåº“å­˜æœåŠ¡ï¼Œæ”¯ä»˜æœåŠ¡ï¼Œç„¶åè¿˜æœ‰ä¸ªEurekaæœåŠ¡è¿˜éœ€è¦ç¨‹åºå‘˜è‡ªå·±å¼€å‘ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹å‡ºæ¥è§£è€¦ã€‚</p>
<p>4ã€Spring Cloud Alibabaï¼Œç°åœ¨èƒ½åšä¸¤ä»¶äº‹ï¼ŒEurekaåªèƒ½åšä¸€ä»¶äº‹ã€‚</p>
<h3 id="consulç®€ä»‹"><a href="#consulç®€ä»‹" class="headerlink" title="consulç®€ä»‹"></a>consulç®€ä»‹</h3><h4 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p>å®˜ç½‘ï¼š<code>https://www.consul.io/</code></p>
<p>Consul æ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ç³»ç»Ÿï¼Œç”± HashiCorp å…¬å¸ç”¨ Go è¯­è¨€å¼€å‘ã€‚</p>
<p>æä¾›äº†å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„<strong>æœåŠ¡æ²»ç†ã€é…ç½®ä¸­å¿ƒã€æ§åˆ¶æ€»çº¿</strong>ç­‰åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½ä¸­çš„æ¯ä¸€ä¸ªéƒ½<strong>å¯ä»¥æ ¹æ®éœ€è¦å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨ä»¥æ„å»ºå…¨æ–¹ä½çš„æœåŠ¡ç½‘æ ¼</strong>ï¼Œæ€»ä¹‹Consulæä¾›äº†ä¸€ç§å®Œæ•´çš„æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆã€‚å®ƒå…·æœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚åŒ…æ‹¬ï¼š <strong>åŸºäº raft åè®®</strong>ï¼Œæ¯”è¾ƒç®€æ´ï¼› <strong>æ”¯æŒå¥åº·æ£€æŸ¥</strong>, <strong>åŒæ—¶æ”¯æŒ HTTP å’Œ DNS åè®®</strong> <strong>æ”¯æŒè·¨æ•°æ®ä¸­å¿ƒçš„ WAN é›†ç¾¤</strong> <strong>æä¾›å›¾å½¢ç•Œé¢ è·¨å¹³å°</strong>ï¼Œæ”¯æŒ Linuxã€Macã€Windows</p>
<p>HashiCorpæ˜¯ä¸€å®¶éå¸¸çŸ¥åçš„åŸºç¡€è½¯ä»¶æä¾›å•†ï¼Œå¾ˆå¤šäººå¯èƒ½æ²¡å¬è¿‡å®ƒçš„åå­—ï¼Œä½†æ˜¯å…¶æ——ä¸‹çš„6æ¬¾ä¸»æµè½¯ä»¶ï¼ŒTerraformã€Consulã€Vagrantã€Nomadã€Vaultï¼ŒPacker ç›¸ä¿¡ä¸å°‘ç¨‹åºå‘˜éƒ½å¬è¯´æˆ–ä½¿ç”¨è¿‡ï¼Œå°¤å…¶æ˜¯Consulä½¿ç”¨è€…ä¸å°½å…¶æ•°ã€‚æˆªæ­¢ç›®å‰ä¸ºæ­¢ï¼Œä»HashiCorp å®˜ç½‘ä¸Šçš„å£°æ˜æ¥çœ‹ï¼Œå¼€æºé¡¹ç›®å…¶å®è¿˜æ˜¯â€œå®‰å…¨â€çš„ï¼Œè¢«ç¦ç”¨çš„åªæ˜¯Vaultä¼ä¸šç‰ˆ(å¹¶ä¸”åŸå› æ˜¯<strong>Vaultäº§å“</strong>ç›®å‰ä½¿ç”¨çš„åŠ å¯†ç®—æ³•åœ¨ä¸­å›½ä¸ç¬¦åˆæ³•è§„ï¼Œå¦ä¸€æ–¹é¢æ˜¯ç¾å›½å‡ºå£ç®¡åˆ¶æ³•åœ¨æ¶‰åŠåŠ å¯†ç›¸å…³è½¯ä»¶ä¸Šä¹Ÿæœ‰ç›¸åº”è§„å®šã€‚å› æ­¤è¿™ä¸¤é¡¹åŸå› ä½¿å¾—HashiCorpä¸å¾—ä¸åœ¨å£°æ˜ä¸­è¯´æ˜é£é™©)è€Œéå…¶ä»–æ‰€æœ‰å¼€æºäº§å“(Terraformã€Consulç­‰)ã€‚å› æ­¤ï¼Œ<strong>å¤§å®¶å¯ä»¥æš‚æ—¶æ”¾ä¸‹å¿ƒæ¥ï¼Œæ”¾å¿ƒä½¿ç”¨ï¼</strong></p>
<p><strong>spring consul</strong> <code>https://docs.spring.io/spring-cloud-consul/docs/current/reference/html/</code></p>
<h4 id="èƒ½å¹²å˜›"><a href="#èƒ½å¹²å˜›" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h4><h5 id="æœåŠ¡å‘ç°"><a href="#æœåŠ¡å‘ç°" class="headerlink" title="æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°</h5><p>æä¾›HTTPå’ŒDNSä¸¤ç§å‘ç°æ–¹å¼ã€‚</p>
<h5 id="å¥åº·æ£€æµ‹"><a href="#å¥åº·æ£€æµ‹" class="headerlink" title="å¥åº·æ£€æµ‹"></a>å¥åº·æ£€æµ‹</h5><p>æ”¯æŒå¤šç§æ–¹å¼ï¼ŒHTTPã€TCPã€Dockerã€Shellè„šæœ¬å®šåˆ¶åŒ–ç›‘æ§</p>
<h5 id="KVå­˜å‚¨"><a href="#KVå­˜å‚¨" class="headerlink" title="KVå­˜å‚¨"></a>KVå­˜å‚¨</h5><p>Keyã€Valueçš„å­˜å‚¨æ–¹å¼</p>
<h5 id="å¤šæ•°æ®ä¸­å¿ƒ"><a href="#å¤šæ•°æ®ä¸­å¿ƒ" class="headerlink" title="å¤šæ•°æ®ä¸­å¿ƒ"></a>å¤šæ•°æ®ä¸­å¿ƒ</h5><p>Consulæ”¯æŒå¤šæ•°æ®ä¸­å¿ƒ</p>
<h5 id="å¯è§†åŒ–Webç•Œé¢"><a href="#å¯è§†åŒ–Webç•Œé¢" class="headerlink" title="å¯è§†åŒ–Webç•Œé¢"></a>å¯è§†åŒ–Webç•Œé¢</h5><h4 id="å»å“ªé‡Œä¸‹"><a href="#å»å“ªé‡Œä¸‹" class="headerlink" title="å»å“ªé‡Œä¸‹"></a>å»å“ªé‡Œä¸‹</h4><p>å®˜ç½‘ï¼š<code>https://developer.hashicorp.com/consul/install</code></p>
<p>centos</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo</span><br><span class="line">sudo yum -y install consul</span><br></pre></td></tr></table></figure>
<h4 id="æ€ä¹ˆç©"><a href="#æ€ä¹ˆç©" class="headerlink" title="æ€ä¹ˆç©"></a>æ€ä¹ˆç©</h4><p>çœ‹å®˜ç½‘ï¼Œ<strong>ä¸¤å¤§ä½œç”¨ï¼šæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œåˆ†å¸ƒå¼é…ç½®ç®¡ç†</strong></p>
<h3 id="å®‰è£…å¹¶è¿è¡Œconsul"><a href="#å®‰è£…å¹¶è¿è¡Œconsul" class="headerlink" title="å®‰è£…å¹¶è¿è¡Œconsul"></a>å®‰è£…å¹¶è¿è¡Œconsul</h3><p>ä¸‹è½½è§£å‹åï¼Œåœ¨cmdé‡Œé¢ç„¶åè¿›å…¥åˆ°è¯¥è§£å‹è·¯å¾„ä¸‹ï¼Œç„¶åè¾“å…¥å‘½ä»¤ <code>consul --version</code>éªŒè¯æ˜¯å¦å®‰è£…âœ…ï¸</p>
<p><strong>ä½¿ç”¨å¼€å‘æ¨¡å¼å¯åŠ¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">consul agent -dev</span><br><span class="line">é€šè¿‡è®¿é—®Consulçš„é¦–é¡µï¼šhttp://localhost:8500</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107195631672.png" alt="image-20260107195631672"></p>
<h3 id="æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>æœåŠ¡æ³¨å†Œä¸å‘ç°</h3><p>ç°åœ¨è¦æŠŠ8001å’Œ80æ³¨å†Œè¿›å…¥æ³¨å†Œä¸­å¿ƒäº†ã€‚</p>
<h4 id="æœåŠ¡æä¾›è€…8001"><a href="#æœåŠ¡æä¾›è€…8001" class="headerlink" title="æœåŠ¡æä¾›è€…8001"></a>æœåŠ¡æä¾›è€…8001</h4><h5 id="æ”¯ä»˜æœåŠ¡provider8001æ³¨å†Œè¿›consul"><a href="#æ”¯ä»˜æœåŠ¡provider8001æ³¨å†Œè¿›consul" class="headerlink" title="æ”¯ä»˜æœåŠ¡provider8001æ³¨å†Œè¿›consul"></a>æ”¯ä»˜æœåŠ¡provider8001æ³¨å†Œè¿›consul</h5><h5 id="POM-1"><a href="#POM-1" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--SpringCloud consul discovery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="YML"><a href="#YML" class="headerlink" title="YML"></a>YML</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="ä¸»å¯åŠ¨"><a href="#ä¸»å¯åŠ¨" class="headerlink" title="ä¸»å¯åŠ¨"></a>ä¸»å¯åŠ¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.atguigu.cloud.mapper&quot;)</span> <span class="comment">//import tk.mybatis.spring.annotation.MapperScan;</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main8001</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main8001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæ²¡æœ‰ä¸šåŠ¡å’Œä»£ç æ“ä½œï¼Œæœ¬æ¥çš„è¿˜æœ‰çš„ä¸šåŠ¡ç±»å’Œcontrollerï¼Œç°åœ¨éƒ½ä¸ç”¨æ“ä½œäº†ã€‚</p>
<h5 id="å¯åŠ¨8001å¹¶æŸ¥çœ‹consulæ§åˆ¶å°"><a href="#å¯åŠ¨8001å¹¶æŸ¥çœ‹consulæ§åˆ¶å°" class="headerlink" title="å¯åŠ¨8001å¹¶æŸ¥çœ‹consulæ§åˆ¶å°"></a>å¯åŠ¨8001å¹¶æŸ¥çœ‹consulæ§åˆ¶å°</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107202947216.png" alt="image-20260107202947216"></p>
<p>ç„¶åæ§åˆ¶å°è®©æˆ‘ä»¬ remove ä¸€ä¸ª<code>commons-logging.jar</code> </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--SpringCloud consul discovery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="æœåŠ¡æ¶ˆè´¹è€…80"><a href="#æœåŠ¡æ¶ˆè´¹è€…80" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…80"></a>æœåŠ¡æ¶ˆè´¹è€…80</h4><p>ä¿®æ”¹å¾®æœåŠ¡ <code>cloud-consumer-order80</code></p>
<h5 id="POM-2"><a href="#POM-2" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--SpringCloud consul discovery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="YML-1"><a href="#YML-1" class="headerlink" title="YML"></a>YML</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="ä¸»å¯åŠ¨-1"><a href="#ä¸»å¯åŠ¨-1" class="headerlink" title="ä¸»å¯åŠ¨"></a>ä¸»å¯åŠ¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">//è¯¥æ³¨è§£ç”¨äºå‘ä½¿ç”¨consulä¸ºæ³¨å†Œä¸­å¿ƒæ—¶æ³¨å†ŒæœåŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main80</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main80.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PaymentSrv_URL</span> <span class="operator">=</span> <span class="string">&quot;http://cloud-payment-service&quot;</span>;<span class="comment">//æœåŠ¡æ³¨å†Œä¸­å¿ƒä¸Šçš„å¾®æœåŠ¡åç§°</span></span><br></pre></td></tr></table></figure>
<h5 id="å¯åŠ¨å¹¶æŸ¥çœ‹consulæ§åˆ¶å°"><a href="#å¯åŠ¨å¹¶æŸ¥çœ‹consulæ§åˆ¶å°" class="headerlink" title="å¯åŠ¨å¹¶æŸ¥çœ‹consulæ§åˆ¶å°"></a>å¯åŠ¨å¹¶æŸ¥çœ‹consulæ§åˆ¶å°</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107214431135.png" alt="image-20260107214431135"></p>
<h5 id="è®¿é—®æµ‹è¯•åœ°å€"><a href="#è®¿é—®æµ‹è¯•åœ°å€" class="headerlink" title="è®¿é—®æµ‹è¯•åœ°å€"></a>è®¿é—®æµ‹è¯•åœ°å€</h5><p><code>http://localhost/consumer/pay/get/1</code></p>
<p>ä¸€ä¸ªbugï¼ŒæŠ¥é”™äº†è¯´æ‰¾ä¸åˆ°æˆ‘ä»¬çš„åœ°å€ã€‚å› ä¸ºé»˜è®¤æ˜¯è´Ÿè½½å‡è¡¡ï¼Œéœ€è¦åœ¨restTemplateæ”¯æŒè´Ÿè½½å‡è¡¡å°±è¡Œäº†ã€‚</p>
<h5 id="é…ç½®ä¿®æ”¹RestTemplateConfig"><a href="#é…ç½®ä¿®æ”¹RestTemplateConfig" class="headerlink" title="é…ç½®ä¿®æ”¹RestTemplateConfig"></a>é…ç½®ä¿®æ”¹RestTemplateConfig</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒå¼‚åŒç‚¹"><a href="#ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒå¼‚åŒç‚¹" class="headerlink" title="ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒå¼‚åŒç‚¹"></a>ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒå¼‚åŒç‚¹</h4><p>é¢è¯•ä¼šé—®è¿˜ç”¨æ²¡ç”¨è¿‡åˆ«çš„æ³¨å†Œä¸­å¿ƒï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¿™ç§é—®é¢˜éœ€è¦ä» <strong>CAP</strong> çš„è§’åº¦å›ç­”ã€‚</p>
<p>Cï¼šConsistencyï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</p>
<p>Aï¼šAvailabilityï¼ˆå¯ç”¨æ€§ï¼‰</p>
<p>Pï¼šPartition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰</p>
<p><strong>C æ˜¯æ‰€æœ‰èŠ‚ç‚¹æ•°æ®ä¸€è‡´</strong><br><strong>A æ˜¯èŠ‚ç‚¹å§‹ç»ˆèƒ½æä¾›æœåŠ¡</strong><br><strong>P æ˜¯èŠ‚ç‚¹é€šä¿¡ä¸­æ–­ä¹Ÿèƒ½è¿è¡Œ</strong></p>
<p>æœ€å¤šåªèƒ½åŒæ—¶è¾ƒå¥½çš„æ»¡è¶³ä¸¤ä¸ªã€‚</p>
<h5 id="CAPç†è®ºçš„æ ¸å¿ƒæ˜¯"><a href="#CAPç†è®ºçš„æ ¸å¿ƒæ˜¯" class="headerlink" title="CAPç†è®ºçš„æ ¸å¿ƒæ˜¯"></a>CAPç†è®ºçš„æ ¸å¿ƒæ˜¯</h5><p>ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶å¾ˆå¥½çš„æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ï¼Œ</p>
<p>å› æ­¤ï¼Œæ ¹æ® CAP åŸç†å°† NoSQL æ•°æ®åº“åˆ†æˆäº†æ»¡è¶³ CA åŸåˆ™ã€æ»¡è¶³ CP åŸåˆ™å’Œæ»¡è¶³ AP åŸåˆ™ä¸‰ å¤§ç±»ï¼š</p>
<p>CA - å•ç‚¹é›†ç¾¤ï¼Œæ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸åœ¨å¯æ‰©å±•æ€§ä¸Šä¸å¤ªå¼ºå¤§ã€‚</p>
<p><strong>CA ç³»ç»Ÿçš„éšå«å‡è®¾ï¼šæ²¡æœ‰ç½‘ç»œåˆ†åŒº + èŠ‚ç‚¹ä¸ä¼šæŒ‚ï¼ˆæˆ–å•èŠ‚ç‚¹ï¼‰</strong></p>
<p>CP - æ»¡è¶³ä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹å¿å¿…çš„ç³»ç»Ÿï¼Œé€šå¸¸æ€§èƒ½ä¸æ˜¯ç‰¹åˆ«é«˜ã€‚</p>
<p>AP - æ»¡è¶³å¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹å¿æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯èƒ½å¯¹ä¸€è‡´æ€§è¦æ±‚ä½ä¸€äº›ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107215509659.png" alt="image-20260107215509659"></p>
<p><strong>APï¼ˆEurekaï¼‰</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107230008487.png" alt="image-20260107230008487"></p>
<p><strong>CPï¼ˆZookeeper / Consulï¼‰</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107230028573.png" alt="image-20260107230028573"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107220746555.png" alt="image-20260107220746555"></p>
<h3 id="æœåŠ¡é…ç½®ä¸åˆ·æ–°"><a href="#æœåŠ¡é…ç½®ä¸åˆ·æ–°" class="headerlink" title="æœåŠ¡é…ç½®ä¸åˆ·æ–°"></a>æœåŠ¡é…ç½®ä¸åˆ·æ–°</h3><h4 id="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜"></a>åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜</h4><p>å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ã€‚ç”±äºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦å¿…è¦çš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€å¥—é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚æ¯”å¦‚æŸäº›é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å¤§éƒ¨åˆ†éƒ½æ˜¯ç›¸åŒçš„ï¼Œåªæœ‰ä¸ªåˆ«çš„é…ç½®é¡¹ä¸åŒã€‚å°±æ‹¿æ•°æ®åº“é…ç½®æ¥è¯´å§ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡ä½¿ç”¨çš„æŠ€æœ¯æ ˆéƒ½æ˜¯ç›¸åŒçš„ï¼Œåˆ™æ¯ä¸ªå¾®æœåŠ¡ä¸­å…³äºæ•°æ®åº“çš„é…ç½®å‡ ä¹éƒ½æ˜¯ç›¸åŒçš„ï¼Œæœ‰æ—¶å€™ä¸»æœºè¿ç§»äº†ï¼Œæˆ‘å¸Œæœ›ä¸€æ¬¡ä¿®æ”¹ï¼Œå¤„å¤„ç”Ÿæ•ˆã€‚</p>
<p>å½“ä¸‹æˆ‘ä»¬æ¯ä¸€ä¸ªå¾®æœåŠ¡è‡ªå·±å¸¦ç€ä¸€ä¸ªapplication.ymlï¼Œä¸Šç™¾ä¸ªé…ç½®æ–‡ä»¶çš„ç®¡ç†â€¦â€¦/(ã„’oã„’)/~~</p>
<h4 id="å®˜ç½‘è¯´æ˜"><a href="#å®˜ç½‘è¯´æ˜" class="headerlink" title="å®˜ç½‘è¯´æ˜"></a>å®˜ç½‘è¯´æ˜</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107231959496.png" alt="image-20260107231959496"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260107232009737.png" alt="image-20260107232009737"></p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´Consul èƒ½ç®¡ç†æœåŠ¡é…ç½®ä¹Ÿèƒ½è¿›è¡ŒæœåŠ¡æ³¨å†Œä¸­å¿ƒ</p>
<h4 id="æœåŠ¡é…ç½®æ¡ˆä¾‹æ­¥éª¤"><a href="#æœåŠ¡é…ç½®æ¡ˆä¾‹æ­¥éª¤" class="headerlink" title="æœåŠ¡é…ç½®æ¡ˆä¾‹æ­¥éª¤"></a>æœåŠ¡é…ç½®æ¡ˆä¾‹æ­¥éª¤</h4><h5 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h5><p>é€šç”¨å…¨å±€é…ç½®ä¿¡æ¯ï¼Œç›´æ¥æ³¨å†Œè¿›ConsulæœåŠ¡å™¨ï¼Œä»Consulè·å–</p>
<p>æ—¢ç„¶ä»Consulè·å–è‡ªç„¶è¦éµå®ˆConsulçš„é…ç½®è§„åˆ™è¦æ±‚</p>
<p><strong>ä¸€æ¬¡ä¿®æ”¹å‡ºå¤„ç”Ÿæ•ˆï¼Œä¸€æ¬¡ä¿®æ”¹å¹¿æ’­ç”Ÿæ•ˆ</strong></p>
<h5 id="ä¿®æ”¹cloud-provider-payment8001"><a href="#ä¿®æ”¹cloud-provider-payment8001" class="headerlink" title="ä¿®æ”¹cloud-provider-payment8001"></a>ä¿®æ”¹cloud-provider-payment8001</h5><h5 id="POM-3"><a href="#POM-3" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--SpringCloud consul config--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="YML-2"><a href="#YML-2" class="headerlink" title="YML"></a>YML</h5><h6 id="é…ç½®è§„åˆ™è¯´æ˜"><a href="#é…ç½®è§„åˆ™è¯´æ˜" class="headerlink" title="é…ç½®è§„åˆ™è¯´æ˜"></a>é…ç½®è§„åˆ™è¯´æ˜</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260108035636382.png" alt="image-20260108035636382"></p>
<h6 id="æ–°å¢é…ç½®æ–‡ä»¶bootstrap-yml"><a href="#æ–°å¢é…ç½®æ–‡ä»¶bootstrap-yml" class="headerlink" title="æ–°å¢é…ç½®æ–‡ä»¶bootstrap.yml"></a>æ–°å¢é…ç½®æ–‡ä»¶bootstrap.yml</h6><p><strong>æ˜¯ä»€ä¹ˆ</strong></p>
<p>applicaiton.ymlæ˜¯ç”¨æˆ·çº§çš„èµ„æºé…ç½®é¡¹</p>
<p>bootstrap.ymlæ˜¯ç³»ç»Ÿçº§çš„ï¼Œä¼˜å…ˆçº§æ›´åŠ é«˜</p>
<p>Spring Cloudä¼šåˆ›å»ºä¸€ä¸ªâ€œBootstrap Contextâ€ï¼Œä½œä¸ºSpringåº”ç”¨çš„<code>Application Context</code>çš„çˆ¶ä¸Šä¸‹æ–‡ã€‚åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ<code>Bootstrap Context</code>è´Ÿè´£ä»å¤–éƒ¨æºåŠ è½½é…ç½®å±æ€§å¹¶è§£æé…ç½®ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±äº«ä¸€ä¸ªä»å¤–éƒ¨è·å–çš„<code>Environment</code>ã€‚</p>
<p><code>Bootstrap</code>å±æ€§æœ‰é«˜ä¼˜å…ˆçº§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¸ä¼šè¢«æœ¬åœ°é…ç½®è¦†ç›–ã€‚ <code>Bootstrap context</code>å’Œ<code>Application Context</code>æœ‰ç€ä¸åŒçš„çº¦å®šï¼Œæ‰€ä»¥æ–°å¢äº†ä¸€ä¸ª<code>bootstrap.yml</code>æ–‡ä»¶ï¼Œä¿è¯<code>Bootstrap Context</code>å’Œ<code>Application Context</code>é…ç½®çš„åˆ†ç¦»ã€‚</p>
<p> application.ymlæ–‡ä»¶æ”¹ä¸ºbootstrap.yml,è¿™æ˜¯å¾ˆå…³é”®çš„æˆ–è€…ä¸¤è€…å…±å­˜</p>
<p>å› ä¸ºbootstrap.ymlæ˜¯æ¯”application.ymlå…ˆåŠ è½½çš„ã€‚bootstrap.ymlä¼˜å…ˆçº§é«˜äºapplication.yml</p>
<p><strong>bootstrap.yml</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-payment-service</span></span><br><span class="line">    <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">profile-separator:</span> <span class="string">&#x27;-&#x27;</span> <span class="comment"># default value is &quot;,&quot;ï¼Œwe update &#x27;-&#x27;</span></span><br><span class="line">        <span class="attr">format:</span> <span class="string">YAML</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># config/cloud-payment-service/data</span></span><br><span class="line"><span class="comment">#       /cloud-payment-service-dev/data</span></span><br><span class="line"><span class="comment">#       /cloud-payment-service-prod/data</span></span><br></pre></td></tr></table></figure>
<h6 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h6><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==========applicationName + druid-mysql8 driver===================</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/db2024?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=GMT%2B8&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span> <span class="comment"># å¤šç¯å¢ƒé…ç½®åŠ è½½å†…å®¹dev/prod,ä¸å†™å°±æ˜¯é»˜è®¤defaulté…ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================mybatis===================</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.bitzh.cloud.entities</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h5 id="consulæœåŠ¡å™¨key-valueé…ç½®å¡«å†™"><a href="#consulæœåŠ¡å™¨key-valueé…ç½®å¡«å†™" class="headerlink" title="consulæœåŠ¡å™¨key/valueé…ç½®å¡«å†™"></a>consulæœåŠ¡å™¨key/valueé…ç½®å¡«å†™</h5><h6 id="å‚è€ƒè§„åˆ™"><a href="#å‚è€ƒè§„åˆ™" class="headerlink" title="å‚è€ƒè§„åˆ™"></a>å‚è€ƒè§„åˆ™</h6><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># config/cloud-payment-service/data</span><br><span class="line">#       /cloud-payment-service-dev/data</span><br><span class="line">#       /cloud-payment-service-prod/data</span><br></pre></td></tr></table></figure>
<h6 id="åˆ›å»ºconfigæ–‡ä»¶å¤¹ï¼Œä»¥-ç»“å°¾"><a href="#åˆ›å»ºconfigæ–‡ä»¶å¤¹ï¼Œä»¥-ç»“å°¾" class="headerlink" title="åˆ›å»ºconfigæ–‡ä»¶å¤¹ï¼Œä»¥ / ç»“å°¾"></a>åˆ›å»ºconfigæ–‡ä»¶å¤¹ï¼Œä»¥ / ç»“å°¾</h6><p>å¿…é¡»ä»¥configå¼€å¤´ï¼Œç„¶åå­æ–‡ä»¶å¤¹å°±æ˜¯ä»¥æœåŠ¡åä¸ºæ–‡ä»¶å¤¹åæ¥ç¡®è®¤æ˜¯é…ç½®å“ªä¸ªæœåŠ¡ï¼Œä¸å†™å°±æ˜¯é»˜è®¤defaultã€‚</p>
<p>dataå°±ä¸å†æ˜¯æ–‡ä»¶å¤¹äº†ï¼Œè€Œæ˜¯key - value çš„ key</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260108124310037.png" alt="image-20260108124310037"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260108124403339.png" alt="image-20260108124403339"></p>
<h5 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h5><p>ç„¶åç°åœ¨controllerçœ‹çœ‹èƒ½ä¸èƒ½è¯»å–åˆ°é…ç½®æ–‡ä»¶å†…å®¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String port;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/get/info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getInfoByConsul</span><span class="params">(<span class="meta">@Value(&quot;$bitzh.info&quot;)</span> String info)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> info + port;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h5><p>è®¿é—® <code>http://localhost:8001/pay/get/info</code> çœ‹èƒ½å¦è¯»å–åˆ°consulçš„é…ç½®ä¿¡æ¯ã€‚</p>
<h4 id="åŠ¨æ€åˆ·æ–°æ¡ˆä¾‹æ­¥éª¤"><a href="#åŠ¨æ€åˆ·æ–°æ¡ˆä¾‹æ­¥éª¤" class="headerlink" title="åŠ¨æ€åˆ·æ–°æ¡ˆä¾‹æ­¥éª¤"></a>åŠ¨æ€åˆ·æ–°æ¡ˆä¾‹æ­¥éª¤</h4><p>æˆ‘ä»¬åœ¨ consul çš„ é…ç½®åˆ†æ”¯ä¿®æ”¹äº†å†…å®¹ï¼Œé©¬ä¸Šè®¿é—®ï¼Œç»“æœæ— æ•ˆ</p>
<h5 id="æ­¥éª¤-2"><a href="#æ­¥éª¤-2" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h5><h6 id="RefreshScope-ä¸»å¯åŠ¨ç±»æ·»åŠ "><a href="#RefreshScope-ä¸»å¯åŠ¨ç±»æ·»åŠ " class="headerlink" title="@RefreshScope ä¸»å¯åŠ¨ç±»æ·»åŠ "></a>@RefreshScope ä¸»å¯åŠ¨ç±»æ·»åŠ </h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.atguigu.cloud.mapper&quot;)</span> <span class="comment">//import tk.mybatis.spring.annotation.MapperScan;</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">//æœåŠ¡æ³¨å†Œå’Œå‘ç°</span></span><br><span class="line"><span class="meta">@RefreshScope</span> <span class="comment">// åŠ¨æ€åˆ·æ–°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main8001</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main8001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="bootstrap-ymlä¿®æ”¹ä¸‹ç­‰å¾…æ—¶é—´"><a href="#bootstrap-ymlä¿®æ”¹ä¸‹ç­‰å¾…æ—¶é—´" class="headerlink" title="bootstrap.ymlä¿®æ”¹ä¸‹ç­‰å¾…æ—¶é—´"></a>bootstrap.ymlä¿®æ”¹ä¸‹ç­‰å¾…æ—¶é—´</h6><p>è¿™ä¸ªåªæ˜¯æ•™å­¦ï¼Œå®é™…åˆ«æ”¹</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-payment-service</span></span><br><span class="line">    <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">profile-separator:</span> <span class="string">&#x27;-&#x27;</span> <span class="comment"># default value is &quot;,&quot;ï¼Œwe update &#x27;-&#x27;</span></span><br><span class="line">        <span class="attr">format:</span> <span class="string">YAML</span></span><br><span class="line">        <span class="attr">watch:</span></span><br><span class="line">          <span class="attr">wait-time:</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># config/cloud-payment-service/data</span></span><br><span class="line"><span class="comment">#       /cloud-payment-service-dev/data</span></span><br><span class="line"><span class="comment">#       /cloud-payment-service-prod/data</span></span><br></pre></td></tr></table></figure>
<p>é»˜è®¤å·²ç»æœ‰äº†é»˜è®¤å€¼æ˜¯ 55 ç§’ï¼Œè¿™é‡Œæ”¹ä¸º1ç›´æ¥çœ‹æ•ˆæœ</p>
<h4 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>æˆªæ­¢åˆ°è¿™ï¼ŒæœåŠ¡é…ç½®å’ŒåŠ¨æ€åˆ·æ–°å…¨éƒ¨é€šè¿‡ï¼Œå‡è®¾æˆ‘ä»¬é‡å¯Consul ï¼Œ ä¹‹å‰çš„é…ç½®è¿˜åœ¨å—ï¼Ÿ</p>
<p>å°±ä¸åœ¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦Consulé…ç½®æŒä¹…åŒ–ã€‚åç»­å†è®²</p>
<h1 id="5ã€LoadBalancerè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨"><a href="#5ã€LoadBalancerè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨" class="headerlink" title="5ã€LoadBalancerè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨"></a>5ã€LoadBalancerè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨</h1><h3 id="å‰èº«æ˜¯Ribbonï¼Œç›®å‰è¿›å…¥ç»´æŠ¤æ¨¡å¼"><a href="#å‰èº«æ˜¯Ribbonï¼Œç›®å‰è¿›å…¥ç»´æŠ¤æ¨¡å¼" class="headerlink" title="å‰èº«æ˜¯Ribbonï¼Œç›®å‰è¿›å…¥ç»´æŠ¤æ¨¡å¼"></a>å‰èº«æ˜¯Ribbonï¼Œç›®å‰è¿›å…¥ç»´æŠ¤æ¨¡å¼</h3><h4 id="æ˜¯ä»€ä¹ˆ-1"><a href="#æ˜¯ä»€ä¹ˆ-1" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p>Spring Cloud Ribbonæ˜¯åŸºäºNetflix Ribbonå®ç°çš„ä¸€å¥—<em>å®¢æˆ·ç«¯</em>    è´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚</p>
<p>ç®€å•çš„è¯´ï¼ŒRibbonæ˜¯Netflixå‘å¸ƒçš„å¼€æºé¡¹ç›®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æä¾›<strong>å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½</strong>å‡è¡¡ç®—æ³•å’Œ<strong>æœåŠ¡è°ƒç”¨</strong>ã€‚Ribbonå®¢æˆ·ç«¯ç»„ä»¶æä¾›ä¸€ç³»åˆ—å®Œå–„çš„é…ç½®é¡¹å¦‚è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç­‰ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡ºLoad Balancerï¼ˆç®€ç§°LBï¼‰åé¢æ‰€æœ‰çš„æœºå™¨ï¼ŒRibbonä¼šè‡ªåŠ¨çš„å¸®åŠ©ä½ åŸºäºæŸç§è§„åˆ™ï¼ˆå¦‚ç®€å•è½®è¯¢ï¼Œéšæœºè¿æ¥ç­‰ï¼‰å»è¿æ¥è¿™äº›æœºå™¨ã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“ä½¿ç”¨Ribbonå®ç°è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</p>
<h4 id="Ribbonæœªæ¥æ›¿æ¢æ–¹æ¡ˆ"><a href="#Ribbonæœªæ¥æ›¿æ¢æ–¹æ¡ˆ" class="headerlink" title="Ribbonæœªæ¥æ›¿æ¢æ–¹æ¡ˆ"></a>Ribbonæœªæ¥æ›¿æ¢æ–¹æ¡ˆ</h4><p>spring-cloud-loadbalancer</p>
<h3 id="spring-cloud-loadbalanceræ¦‚è¿°"><a href="#spring-cloud-loadbalanceræ¦‚è¿°" class="headerlink" title="spring-cloud-loadbalanceræ¦‚è¿°"></a>spring-cloud-loadbalanceræ¦‚è¿°</h3><h4 id="æ˜¯ä»€ä¹ˆ-2"><a href="#æ˜¯ä»€ä¹ˆ-2" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p><strong>LBè´Ÿè½½å‡è¡¡(Load Balance)æ˜¯ä»€ä¹ˆ</strong></p>
<p>ç®€å•çš„è¯´å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šçš„åˆ†é…åˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„HAï¼ˆé«˜å¯ç”¨ï¼‰ï¼Œå¸¸è§çš„è´Ÿè½½å‡è¡¡æœ‰è½¯ä»¶Nginxï¼ŒLVSï¼Œç¡¬ä»¶ F5ç­‰</p>
<p><strong>spring-cloud-starter-loadbalancerç»„ä»¶æ˜¯ä»€ä¹ˆ</strong></p>
<p>Spring Cloud LoadBalanceræ˜¯ç”±SpringCloudå®˜æ–¹æä¾›çš„ä¸€ä¸ªå¼€æºçš„ã€ç®€å•æ˜“ç”¨çš„<strong>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨</strong>ï¼Œå®ƒåŒ…å«åœ¨SpringCloud-commonsä¸­ç”¨å®ƒæ¥æ›¿æ¢äº†ä»¥å‰çš„Ribbonç»„ä»¶ã€‚ç›¸æ¯”è¾ƒäºRibbonï¼ŒSpringCloud <strong>LoadBalancerä¸ä»…èƒ½å¤Ÿæ”¯æŒRestTemplateï¼Œè¿˜æ”¯æŒWebClient</strong>ï¼ˆWeClientæ˜¯Spring Web Fluxä¸­æä¾›çš„åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å“åº”å¼å¼‚æ­¥è¯·æ±‚ï¼‰</p>
<h4 id="å®¢æˆ·ç«¯è´Ÿè½½-vs-æœåŠ¡ç«¯è´Ÿè½½çš„åŒºåˆ«"><a href="#å®¢æˆ·ç«¯è´Ÿè½½-vs-æœåŠ¡ç«¯è´Ÿè½½çš„åŒºåˆ«" class="headerlink" title="å®¢æˆ·ç«¯è´Ÿè½½ vs æœåŠ¡ç«¯è´Ÿè½½çš„åŒºåˆ«"></a><strong>å®¢æˆ·ç«¯è´Ÿè½½ vs æœåŠ¡ç«¯è´Ÿè½½çš„åŒºåˆ«</strong></h4><p>loadbalanceræœ¬åœ°è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ VS NginxæœåŠ¡ç«¯è´Ÿè½½å‡è¡¡åŒºåˆ«</p>
<p>Nginxæ˜¯æœåŠ¡å™¨è´Ÿè½½å‡è¡¡ï¼Œå®¢æˆ·ç«¯æ‰€æœ‰è¯·æ±‚éƒ½ä¼šäº¤ç»™nginxï¼Œç„¶åç”±nginxå®ç°è½¬å‘è¯·æ±‚ï¼Œå³è´Ÿè½½å‡è¡¡æ˜¯ç”±æœåŠ¡ç«¯å®ç°çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109005710814.png" alt="image-20260109005710814"></p>
<p>loadbalanceræœ¬åœ°è´Ÿè½½å‡è¡¡ï¼Œåœ¨è°ƒç”¨å¾®æœåŠ¡æ¥å£æ—¶å€™ï¼Œä¼šåœ¨æ³¨å†Œä¸­å¿ƒä¸Šè·å–æ³¨å†Œä¿¡æ¯æœåŠ¡åˆ—è¡¨ä¹‹åç¼“å­˜åˆ°JVMæœ¬åœ°ï¼Œä»è€Œåœ¨æœ¬åœ°å®ç°RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æŠ€æœ¯ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109005800356.png" alt="image-20260109005800356"></p>
<h3 id="spring-cloud-loadbalancerè´Ÿè½½å‡è¡¡è§£æ"><a href="#spring-cloud-loadbalancerè´Ÿè½½å‡è¡¡è§£æ" class="headerlink" title="spring-cloud-loadbalancerè´Ÿè½½å‡è¡¡è§£æ"></a>spring-cloud-loadbalancerè´Ÿè½½å‡è¡¡è§£æ</h3><h4 id="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-ç†è®º"><a href="#è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-ç†è®º" class="headerlink" title="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-ç†è®º"></a>è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-ç†è®º</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109010050415.png" alt="image-20260109010050415"></p>
<p>LoadBalancer åœ¨å·¥ä½œæ—¶åˆ†æˆä¸¤æ­¥ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œå…ˆé€‰æ‹©ConsulServerä»æœåŠ¡ç«¯æŸ¥è¯¢å¹¶æ‹‰å–æœåŠ¡åˆ—è¡¨ï¼ŒçŸ¥é“äº†å®ƒæœ‰å¤šä¸ªæœåŠ¡(ä¸Šå›¾3ä¸ªæœåŠ¡)ï¼Œè¿™3ä¸ªå®ç°æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œ</p>
<p>é»˜è®¤è½®è¯¢è°ƒç”¨è°éƒ½å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ç±»ä¼¼ç”Ÿæ´»ä¸­æ±‚åŒ»æŒ‚å·ï¼ŒæŸä¸ªç§‘å®¤ä»Šæ—¥å‡ºè¯Šçš„å…¨éƒ¨åŒ»ç”Ÿï¼Œå®¢æˆ·ç«¯ä½ è‡ªå·±é€‰ä¸€ä¸ªã€‚</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼ŒæŒ‰ç…§æŒ‡å®šçš„è´Ÿè½½å‡è¡¡ç­–ç•¥ä»serverå–åˆ°çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¸­ç”±å®¢æˆ·ç«¯è‡ªå·±é€‰æ‹©ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥LoadBalanceræ˜¯ä¸€ä¸ª<strong>å®¢æˆ·ç«¯çš„</strong>è´Ÿè½½å‡è¡¡å™¨ã€‚</p>
<p>å¦‚æœæ˜¯nginxï¼Œå‹åŠ›éƒ½åœ¨æœåŠ¡å™¨ï¼Œéœ€è¦æ¥å—æ‰€æœ‰çš„è¯·æ±‚ç„¶ååˆ†å‘ã€‚</p>
<p>ç°åœ¨ribbionï¼Œå‹åŠ›åœ¨å®¢æˆ·ç«¯ä¹Ÿå°±æ˜¯è¯·æ±‚çš„äººï¼Œè€Œä¸”å‹åŠ›åˆ†æ•£ï¼Œç›´æ¥å¾—çŸ¥æ‰¾çš„çœŸæ­£æœåŠ¡çš„åœ°å€ï¼Œç„¶åå°±èƒ½é€šè¿‡è´Ÿè½½å‡è¡¡è°ƒç”¨å¯¹åº”çš„æœåŠ¡äº†ã€‚ç±»ä¼¼äºå»åŒ»é™¢ï¼Œé€‰åŒ»ç”Ÿã€‚</p>
<p><strong>æ¶æ„è¯´æ˜:80é€šè¿‡è½®è¯¢è´Ÿè½½è®¿é—® 8001 / 8002 / 8003</strong></p>
<h4 id="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å®æ“"><a href="#è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å®æ“" class="headerlink" title="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å®æ“"></a>è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å®æ“</h4><h5 id="å®˜ç½‘å‚è€ƒå¦‚ä½•ä½¿ç”¨"><a href="#å®˜ç½‘å‚è€ƒå¦‚ä½•ä½¿ç”¨" class="headerlink" title="å®˜ç½‘å‚è€ƒå¦‚ä½•ä½¿ç”¨"></a>å®˜ç½‘å‚è€ƒå¦‚ä½•ä½¿ç”¨</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109010507785.png" alt="image-20260109010507785"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109010516823.png" alt="image-20260109010516823"></p>
<h5 id="æŒ‰ç…§8001æ‹·è´åæ–°å»º8002å¾®æœåŠ¡"><a href="#æŒ‰ç…§8001æ‹·è´åæ–°å»º8002å¾®æœåŠ¡" class="headerlink" title="æŒ‰ç…§8001æ‹·è´åæ–°å»º8002å¾®æœåŠ¡"></a>æŒ‰ç…§8001æ‹·è´åæ–°å»º8002å¾®æœåŠ¡</h5><p>ä¹Ÿæ˜¯æŒ‰ç…§POMï¼ŒYMLï¼Œä¸šåŠ¡ç±»ï¼Œcontrollerï¼Œä¸»å¯åŠ¨</p>
<h5 id="å¯åŠ¨Consul-å°†8001-8002å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡"><a href="#å¯åŠ¨Consul-å°†8001-8002å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡" class="headerlink" title="å¯åŠ¨Consul,å°†8001/8002å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡"></a>å¯åŠ¨Consul,å°†8001/8002å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">consul agent -dev</span><br><span class="line">å°† 8001 / 8002 å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡</span><br><span class="line">å‡ºbugäº†ï¼Œæˆ‘ä»¬ä¹‹å‰çš„é…ç½®å®Œå…¨æ¶ˆå¤±äº†ï¼Œæ²¡æœ‰æŒä¹…åŒ–ä¿å­˜</span><br></pre></td></tr></table></figure>
<h6 id="Consulæ•°æ®æŒä¹…åŒ–é…ç½®"><a href="#Consulæ•°æ®æŒä¹…åŒ–é…ç½®" class="headerlink" title="Consulæ•°æ®æŒä¹…åŒ–é…ç½®"></a>Consulæ•°æ®æŒä¹…åŒ–é…ç½®</h6><p>å¹¶ä¸”æ³¨å†Œä¸ºWindowsæœåŠ¡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1ã€åœ¨ä¸€ä¸ªD:\Study4It\SoftWare\consul\consul_1.17.0_windows_386ç›®å½•ä¸‹æ–°å»º</span><br><span class="line">D:\Study4It\SoftWare\consul\consul_1.17.0_windows_386\mydata</span><br><span class="line">2ã€consul_start.batå†…å®¹ä¿¡æ¯</span><br><span class="line">@echo.æœåŠ¡å¯åŠ¨......  </span><br><span class="line">@echo off  </span><br><span class="line">@sc create Consul binpath= &quot;D:\Study4It\SoftWare\consul\consul_1.17.0_windows_386\consul.exe agent -server -ui -bind=127.0.0.1 -client=0.0.0.0 -bootstrap-expect 1 -data-dir D:\Study4It\SoftWare\consul\consul_1.17.0_windows_386\mydata&quot;</span><br><span class="line">@net start Consul</span><br><span class="line">@sc config Consul start= AUTO  </span><br><span class="line">@echo.Consul start is OK......success</span><br><span class="line">@pause</span><br></pre></td></tr></table></figure>
<p>ç„¶åconsul å°±æŒä¹…åŒ–äº†ã€‚</p>
<p>ç°åœ¨å¯åŠ¨8001 å’Œ 8002 ç„¶åç™»å½• consul ç„¶åå‘ç°æœ‰2ä¸ªå®ä¾‹</p>
<p>ç„¶åè®¿é—® <code>http://localhost:8001/pay/get/info</code></p>
<h4 id="è®¢å•80æ¨¡å—ä¿®æ”¹POMå¹¶æ³¨å†Œè¿›consulï¼Œæ–°å¢LoadBalancerç»„ä»¶"><a href="#è®¢å•80æ¨¡å—ä¿®æ”¹POMå¹¶æ³¨å†Œè¿›consulï¼Œæ–°å¢LoadBalancerç»„ä»¶" class="headerlink" title="è®¢å•80æ¨¡å—ä¿®æ”¹POMå¹¶æ³¨å†Œè¿›consulï¼Œæ–°å¢LoadBalancerç»„ä»¶"></a>è®¢å•80æ¨¡å—ä¿®æ”¹POMå¹¶æ³¨å†Œè¿›consulï¼Œæ–°å¢LoadBalancerç»„ä»¶</h4><p><strong>POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--loadbalancer--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>Controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/consumer/pay/get/info&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">getInfoByConsul</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> restTemplate.getForObject(PaymentSrv_URL + <span class="string">&quot;/pay/get/info&quot;</span>, String.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè´Ÿè½½å‡è¡¡çš„æ¨¡å¼é»˜è®¤æ˜¯è½®è¯¢ã€‚</p>
<p>æµ‹è¯•è®¿é—®</p>
<h4 id="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å°æ€»ç»“"><a href="#è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å°æ€»ç»“" class="headerlink" title="è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å°æ€»ç»“"></a>è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å°æ€»ç»“</h4><h5 id="ç¼–ç ä½¿ç”¨DiscoverClientåŠ¨æ€è·å–æ‰€æœ‰ä¸Šçº¿çš„æœåŠ¡åˆ—è¡¨"><a href="#ç¼–ç ä½¿ç”¨DiscoverClientåŠ¨æ€è·å–æ‰€æœ‰ä¸Šçº¿çš„æœåŠ¡åˆ—è¡¨" class="headerlink" title="ç¼–ç ä½¿ç”¨DiscoverClientåŠ¨æ€è·å–æ‰€æœ‰ä¸Šçº¿çš„æœåŠ¡åˆ—è¡¨"></a>ç¼–ç ä½¿ç”¨DiscoverClientåŠ¨æ€è·å–æ‰€æœ‰ä¸Šçº¿çš„æœåŠ¡åˆ—è¡¨</h5><p>æ˜¯æ€ä¹ˆå®ç°çŸ¥é“å“ªäº›æœåŠ¡ä¸Šçº¿çš„å‘¢ï¼Ÿ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109041145088.png" alt="image-20260109041145088"></p>
<p>å®˜ç½‘è¯´æœ‰è¿™ä¸ªé…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“è¿™ä¸ªé…ç½®å°±æ˜¯æ”¾æ‰€æœ‰æœåŠ¡èŠ‚ç‚¹çš„äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ä»ä»£ç ä¸Šæµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> DiscoveryClient discoveryClient;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/consumer/discovery&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">discovery</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    List&lt;String&gt; services = discoveryClient.getServices();</span><br><span class="line">    <span class="keyword">for</span> (String element : services) &#123;</span><br><span class="line">        System.out.println(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;===================================&quot;</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="string">&quot;cloud-payment-service&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (ServiceInstance element : instances) &#123;</span><br><span class="line">        System.out.println(element.getServiceId()+<span class="string">&quot;\t&quot;</span>+element.getHost()+<span class="string">&quot;\t&quot;</span>+element.getPort()+<span class="string">&quot;\t&quot;</span>+element.getUri());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instances.get(<span class="number">0</span>).getServiceId()+<span class="string">&quot;:&quot;</span>+instances.get(<span class="number">0</span>).getPort();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè´Ÿè½½å‡è¡¡çš„åŸç†æ˜¯ä»€ä¹ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">è´Ÿè½½å‡è¡¡ç®—æ³•ï¼šrestæ¥å£ç¬¬å‡ æ¬¡è¯·æ±‚æ•° % æœåŠ¡å™¨é›†ç¾¤æ€»æ•°é‡ = å®é™…è°ƒç”¨æœåŠ¡å™¨ä½ç½®ä¸‹æ ‡  ï¼Œæ¯æ¬¡æœåŠ¡é‡å¯åŠ¨årestæ¥å£è®¡æ•°ä»1å¼€å§‹ã€‚</span><br><span class="line"></span><br><span class="line">List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;cloud-payment-service&quot;);</span><br><span class="line"> </span><br><span class="line">å¦‚ï¼š   List [0] instances = 127.0.0.1:8002</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€List [1] instances = 127.0.0.1:8001</span><br><span class="line"></span><br><span class="line">8001+ 8002 ç»„åˆæˆä¸ºé›†ç¾¤ï¼Œå®ƒä»¬å…±è®¡2å°æœºå™¨ï¼Œé›†ç¾¤æ€»æ•°ä¸º2ï¼Œ æŒ‰ç…§è½®è¯¢ç®—æ³•åŸç†ï¼š</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">å½“æ€»è¯·æ±‚æ•°ä¸º1æ—¶ï¼š 1 % 2 =1 å¯¹åº”ä¸‹æ ‡ä½ç½®ä¸º1 ï¼Œåˆ™è·å¾—æœåŠ¡åœ°å€ä¸º127.0.0.1:8001</span><br><span class="line"></span><br><span class="line">å½“æ€»è¯·æ±‚æ•°ä½2æ—¶ï¼š 2 % 2 =0 å¯¹åº”ä¸‹æ ‡ä½ç½®ä¸º0 ï¼Œåˆ™è·å¾—æœåŠ¡åœ°å€ä¸º127.0.0.1:8002</span><br><span class="line"></span><br><span class="line">å½“æ€»è¯·æ±‚æ•°ä½3æ—¶ï¼š 3 % 2 =1 å¯¹åº”ä¸‹æ ‡ä½ç½®ä¸º1 ï¼Œåˆ™è·å¾—æœåŠ¡åœ°å€ä¸º127.0.0.1:8001</span><br><span class="line"></span><br><span class="line">å½“æ€»è¯·æ±‚æ•°ä½4æ—¶ï¼š 4 % 2 =0 å¯¹åº”ä¸‹æ ‡ä½ç½®ä¸º0 ï¼Œåˆ™è·å¾—æœåŠ¡åœ°å€ä¸º127.0.0.1:8002</span><br><span class="line"></span><br><span class="line">å¦‚æ­¤ç±»æ¨......</span><br></pre></td></tr></table></figure>
<h4 id="è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†"><a href="#è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†" class="headerlink" title="è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†"></a>è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†</h4><h5 id="é»˜è®¤ç®—æ³•æ˜¯ä»€ä¹ˆæœ‰å‡ ç§ï¼Ÿ"><a href="#é»˜è®¤ç®—æ³•æ˜¯ä»€ä¹ˆæœ‰å‡ ç§ï¼Ÿ" class="headerlink" title="é»˜è®¤ç®—æ³•æ˜¯ä»€ä¹ˆæœ‰å‡ ç§ï¼Ÿ"></a>é»˜è®¤ç®—æ³•æ˜¯ä»€ä¹ˆæœ‰å‡ ç§ï¼Ÿ</h5><p>é»˜è®¤æ˜¯è½®è¯¢ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯éšæœºã€‚å¦‚æœæƒ³è¦åˆ‡æ¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@LoadBalancerClient(</span></span><br><span class="line"><span class="meta">        //ä¸‹é¢çš„valueå€¼å¤§å°å†™ä¸€å®šè¦å’Œconsulé‡Œé¢çš„åå­—ä¸€æ ·ï¼Œå¿…é¡»ä¸€æ ·</span></span><br><span class="line"><span class="meta">        value = &quot;cloud-payment-service&quot;,configuration = RestTemplateConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span> <span class="comment">//ä½¿ç”¨@LoadBalancedæ³¨è§£èµ‹äºˆRestTemplateè´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    ReactorLoadBalancer&lt;ServiceInstance&gt; <span class="title function_">randomLoadBalancer</span><span class="params">(Environment environment,</span></span><br><span class="line"><span class="params">                                                            LoadBalancerClientFactory loadBalancerClientFactory)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> environment.getProperty(LoadBalancerClientFactory.PROPERTY_NAME);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RandomLoadBalancer</span>(loadBalancerClientFactory.getLazyProvider(name, ServiceInstanceListSupplier.class), name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="6ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨"><a href="#6ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨" class="headerlink" title="6ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨"></a>6ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨</h1><p><strong>å·²ç»æœ‰LoadBalancerä¸ºä»€ä¹ˆè¿˜è¦å­¦ä¹ OpenFeignï¼Ÿ</strong></p>
<p>ä¸¤ä¸ªéƒ½æœ‰é“ç†æ—¥å¸¸ç”¨å“ªä¸ªï¼Ÿ</p>
<h2 id="æ˜¯ä»€ä¹ˆ-3"><a href="#æ˜¯ä»€ä¹ˆ-3" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h2><p>openfeignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯</p>
<p>åªéœ€è¦åˆ›å»ºä¸€ä¸ªRestæ¥å£å¹¶åœ¨è¯¥æ¥å£ä¸Šæ·»åŠ æ³¨è§£@FeignClientå³å¯</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109053040055.png" alt="image-20260109053040055"></p>
<p><strong>OpenFeignåŸºæœ¬ä¸Šå°±æ˜¯å½“å‰å¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„äº‹å®æ ‡å‡†</strong></p>
<h2 id="èƒ½å¹²å˜›-1"><a href="#èƒ½å¹²å˜›-1" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h2><h3 id="å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£"><a href="#å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£" class="headerlink" title="å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£"></a>å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£</h3><h3 id="æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨"><a href="#æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨" class="headerlink" title="æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨"></a>æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨</h3><h3 id="æ”¯æŒSentinelå’Œä»–çš„Fallback"><a href="#æ”¯æŒSentinelå’Œä»–çš„Fallback" class="headerlink" title="æ”¯æŒSentinelå’Œä»–çš„Fallback"></a>æ”¯æŒSentinelå’Œä»–çš„Fallback</h3><h3 id="æ”¯æŒSpringCloudLoadBalancerçš„è´Ÿè½½å‡è¡¡"><a href="#æ”¯æŒSpringCloudLoadBalancerçš„è´Ÿè½½å‡è¡¡" class="headerlink" title="æ”¯æŒSpringCloudLoadBalancerçš„è´Ÿè½½å‡è¡¡"></a>æ”¯æŒSpringCloudLoadBalancerçš„è´Ÿè½½å‡è¡¡</h3><h3 id="æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©"><a href="#æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©" class="headerlink" title="æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©"></a>æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©</h3><p>å‰é¢åœ¨ä½¿ç”¨<strong>SpringCloud LoadBalancer</strong>+RestTemplateæ—¶ï¼Œåˆ©ç”¨RestTemplateå¯¹httpè¯·æ±‚çš„å°è£…å¤„ç†å½¢æˆäº†ä¸€å¥—æ¨¡ç‰ˆåŒ–çš„è°ƒç”¨æ–¹æ³•ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå¯¹æœåŠ¡ä¾èµ–çš„è°ƒç”¨å¯èƒ½ä¸æ­¢ä¸€å¤„ï¼Œå¾€å¾€ä¸€ä¸ªæ¥å£ä¼šè¢«å¤šå¤„è°ƒç”¨ï¼Œæ‰€ä»¥é€šå¸¸éƒ½ä¼šé’ˆå¯¹æ¯ä¸ªå¾®æœåŠ¡è‡ªè¡Œå°è£…ä¸€äº›å®¢æˆ·ç«¯ç±»æ¥åŒ…è£…è¿™äº›ä¾èµ–æœåŠ¡çš„è°ƒç”¨ã€‚</p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½è¦åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ç„¶å<code>new RestTemplate</code>ï¼Œæ¯ä¸ªç³»ç»Ÿéƒ½æ•£è½è¿™äº›newå¾ˆä¸è§„èŒƒ</strong></p>
<p>æ‰€ä»¥ï¼ŒOpenFeignåœ¨æ­¤åŸºç¡€ä¸Šåšäº†è¿›ä¸€æ­¥å°è£…ï¼Œç”±ä»–æ¥å¸®åŠ©æˆ‘ä»¬å®šä¹‰å’Œå®ç°ä¾èµ–æœåŠ¡æ¥å£çš„å®šä¹‰ã€‚åœ¨OpenFeignçš„å®ç°ä¸‹ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒ(åœ¨ä¸€ä¸ªå¾®æœåŠ¡æ¥å£ä¸Šé¢æ ‡æ³¨ä¸€ä¸ª<strong><em>@FeignClient\</em></strong>æ³¨è§£å³å¯)ï¼Œå³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®šï¼Œç»Ÿä¸€å¯¹å¤–æš´éœ²å¯ä»¥è¢«è°ƒç”¨çš„æ¥å£æ–¹æ³•ï¼Œå¤§å¤§ç®€åŒ–å’Œé™ä½äº†è°ƒç”¨å®¢æˆ·ç«¯çš„å¼€å‘é‡ï¼Œä¹Ÿå³ç”±æœåŠ¡æä¾›è€…ç»™å‡ºè°ƒç”¨æ¥å£æ¸…å•ï¼Œæ¶ˆè´¹è€…ç›´æ¥é€šè¿‡OpenFeignè°ƒç”¨å³å¯ï¼ŒO(âˆ©_âˆ©)Oã€‚</p>
<p><strong>OpenFeignåŒæ—¶è¿˜é›†æˆSpringCloud LoadBalancer</strong></p>
<p>å¯ä»¥åœ¨ä½¿ç”¨OpenFeignæ—¶æä¾›Httpå®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ï¼Œ<strong>ä¹Ÿå¯ä»¥é›†æˆé˜¿é‡Œå·´å·´Sentinelæ¥æä¾›ç†”æ–­ã€é™çº§ç­‰åŠŸèƒ½</strong>ã€‚è€Œä¸SpringCloud LoadBalancerä¸åŒçš„æ˜¯ï¼Œé€šè¿‡OpenFeignåªéœ€è¦å®šä¹‰æœåŠ¡ç»‘å®šæ¥å£ä¸”ä»¥å£°æ˜å¼çš„æ–¹æ³•ï¼Œä¼˜é›…è€Œç®€å•çš„å®ç°äº†æœåŠ¡è°ƒç”¨ã€‚</p>
<h2 id="æ€ä¹ˆç©-1"><a href="#æ€ä¹ˆç©-1" class="headerlink" title="æ€ä¹ˆç©"></a>æ€ä¹ˆç©</h2><h3 id="æ¥å£-æ³¨è§£"><a href="#æ¥å£-æ³¨è§£" class="headerlink" title="æ¥å£+æ³¨è§£"></a>æ¥å£+æ³¨è§£</h3><p>å¾®æœåŠ¡Apiæ¥å£ + @FeignClientæ³¨è§£æ ‡ç­¾</p>
<p>æ¶æ„è¯´æ˜å›¾</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109055528101.png" alt="image-20260109055528101"></p>
<p>æœåŠ¡æ¶ˆè´¹è€…80 â†’ è°ƒç”¨å«æœ‰@FeignClientæ³¨è§£çš„ApiæœåŠ¡æ¥å£ â†’ æœåŠ¡æä¾›è€…(8001/8002)</p>
<h3 id="æµç¨‹æ­¥éª¤"><a href="#æµç¨‹æ­¥éª¤" class="headerlink" title="æµç¨‹æ­¥éª¤"></a>æµç¨‹æ­¥éª¤</h3><h3 id="å»ºMoudle"><a href="#å»ºMoudle" class="headerlink" title="å»ºMoudle"></a>å»ºMoudle</h3><p>å»ºç«‹ <code>cloud-consumer-feign-order80</code></p>
<h3 id="æ”¹POM-2"><a href="#æ”¹POM-2" class="headerlink" title="æ”¹POM"></a>æ”¹POM</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-consumer-feign-order80<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--openfeign--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringCloud consul discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--web + actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool-all--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--fastjson2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å†™YML-1"><a href="#å†™YML-1" class="headerlink" title="å†™YML"></a>å†™YML</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸»å¯åŠ¨-2"><a href="#ä¸»å¯åŠ¨-2" class="headerlink" title="ä¸»å¯åŠ¨"></a>ä¸»å¯åŠ¨</h3><p>åœ¨ä¸»å¯åŠ¨ç±»ä¸Šé¢é…ç½® <code>@EnableFeignClients</code>è¡¨ç¤ºå¼€å¯OpenFeignåŠŸèƒ½å¹¶æ¿€æ´»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainOpenFeign80</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MainOpenFeign80.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ä¸šåŠ¡ç±»-1"><a href="#ä¸šåŠ¡ç±»-1" class="headerlink" title="ä¸šåŠ¡ç±»"></a>ä¸šåŠ¡ç±»</h3><p>æŒ‰ç…§æ¶æ„å›¾ï¼ŒæœåŠ¡æä¾›è€…å·²ç»é…å¥½äº†ï¼Œç°åœ¨è¦é…ç½®å…¬å…±æ¨¡å—äº†ã€‚</p>
<h4 id="ä¿®æ”¹cloud-api-commonsé€šç”¨æ¨¡å—"><a href="#ä¿®æ”¹cloud-api-commonsé€šç”¨æ¨¡å—" class="headerlink" title="ä¿®æ”¹cloud-api-commonsé€šç”¨æ¨¡å—"></a><strong>ä¿®æ”¹<code>cloud-api-commonsé€šç”¨æ¨¡å—</code></strong></h4><p>åœ¨é€šç”¨æ¨¡å—é…ç½®ï¼Œå°±ä¸ç”¨æ¯ä¸ªæœåŠ¡éƒ½é…ç½®ä¸€éæ–°å»ºä¸€ä¸ªtemplateäº†</p>
<h5 id="å¼•å…¥openfeignä¾èµ–"><a href="#å¼•å…¥openfeignä¾èµ–" class="headerlink" title="å¼•å…¥openfeignä¾èµ–"></a>å¼•å…¥openfeignä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--openfeign--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–°å»ºæœåŠ¡æ¥å£PayFeignApi-å¤´ä¸Šé…ç½®-FeignClientæ³¨è§£"><a href="#æ–°å»ºæœåŠ¡æ¥å£PayFeignApi-å¤´ä¸Šé…ç½®-FeignClientæ³¨è§£" class="headerlink" title="æ–°å»ºæœåŠ¡æ¥å£PayFeignApi,å¤´ä¸Šé…ç½®@FeignClientæ³¨è§£"></a>æ–°å»ºæœåŠ¡æ¥å£PayFeignApi,å¤´ä¸Šé…ç½®@FeignClientæ³¨è§£</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109060652304.png" alt="image-20260109060652304"></p>
<h4 id="å‚è€ƒå¾®æœåŠ¡8001çš„Controllerå±‚ï¼Œæ–°å»ºPayFeignApiæ¥å£"><a href="#å‚è€ƒå¾®æœåŠ¡8001çš„Controllerå±‚ï¼Œæ–°å»ºPayFeignApiæ¥å£" class="headerlink" title="å‚è€ƒå¾®æœåŠ¡8001çš„Controllerå±‚ï¼Œæ–°å»ºPayFeignApiæ¥å£"></a>å‚è€ƒå¾®æœåŠ¡8001çš„Controllerå±‚ï¼Œæ–°å»ºPayFeignApiæ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-payment-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PayFeignApi</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢ä¸€æ¡æ”¯ä»˜ç›¸å…³æµæ°´è®°å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> payDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">addPay</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ä¸»é”®è®°å½•æŸ¥è¯¢æ”¯ä»˜æµæ°´ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * openfeignå¤©ç„¶æ”¯æŒè´Ÿè½½å‡è¡¡æ¼”ç¤º</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/get/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">mylb</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´80ç«¯å£è®¿é—®8001å’Œ8002ä¸æ˜¯è®¿é—®æœ¬åœ°çš„Ribbonäº†ï¼Œè€Œæ˜¯è®¿é—®Openfeignçš„è¿™ä¸ªæ¥å£ç„¶ååœ¨è®¿é—®8001å’Œ8002äº†ã€‚</p>
<p>ç„¶åç°åœ¨å…¬å…±æ¨¡å—å¥½äº†ï¼Œç°åœ¨ä¿®æ”¹80ç«¯å£çš„controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PayFeignApi payFeignApi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/feign/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">addOrder</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸€æ­¥ï¼šæ¨¡æ‹Ÿæœ¬åœ°addOrderæ–°å¢è®¢å•æˆåŠŸ(çœç•¥sqlæ“ä½œ)ï¼Œç¬¬äºŒæ­¥ï¼šå†å¼€å¯addPayæ”¯ä»˜å¾®æœåŠ¡è¿œç¨‹è°ƒç”¨&quot;</span>);</span><br><span class="line">        <span class="type">ResultData</span> <span class="variable">resultData</span> <span class="operator">=</span> payFeignApi.addPay(payDTO);</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/feign/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;-------æ”¯ä»˜å¾®æœåŠ¡è¿œç¨‹è°ƒç”¨ï¼ŒæŒ‰ç…§idæŸ¥è¯¢è®¢å•æ”¯ä»˜æµæ°´ä¿¡æ¯&quot;</span>);</span><br><span class="line">        <span class="type">ResultData</span> <span class="variable">resultData</span> <span class="operator">=</span> payFeignApi.getPayInfo(id);</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * openfeignå¤©ç„¶æ”¯æŒè´Ÿè½½å‡è¡¡æ¼”ç¤º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/feign/pay/mylb&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">mylb</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> payFeignApi.mylb();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><h3 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109074337179.png" alt="image-20260109074337179"></p>
<h2 id="é«˜çº§ç‰¹æ€§"><a href="#é«˜çº§ç‰¹æ€§" class="headerlink" title="é«˜çº§ç‰¹æ€§"></a>é«˜çº§ç‰¹æ€§</h2><h3 id="1ã€OpenFeignè¶…æ—¶æ§åˆ¶"><a href="#1ã€OpenFeignè¶…æ—¶æ§åˆ¶" class="headerlink" title="1ã€OpenFeignè¶…æ—¶æ§åˆ¶"></a>1ã€OpenFeignè¶…æ—¶æ§åˆ¶</h3><p>OpenFeignçš„ç‰ˆæœ¬è¦æ³¨æ„ï¼Œç‰ˆæœ¬ä¼šå½±å“é…ç½®çš„ã€‚</p>
<p>åœ¨Spring Cloudå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¤§éƒ¨åˆ†å…¬å¸éƒ½æ˜¯åˆ©ç”¨OpenFeignè¿›è¡ŒæœåŠ¡é—´çš„è°ƒç”¨ï¼Œè€Œæ¯”è¾ƒç®€å•çš„ä¸šåŠ¡ä½¿ç”¨é»˜è®¤é…ç½®æ˜¯ä¸ä¼šæœ‰å¤šå¤§é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯ä¸šåŠ¡æ¯”è¾ƒå¤æ‚ï¼ŒæœåŠ¡è¦è¿›è¡Œæ¯”è¾ƒç¹æ‚çš„ä¸šåŠ¡è®¡ç®—ï¼Œé‚£<strong>åå°å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°Read Timeoutè¿™ä¸ªå¼‚å¸¸ï¼Œå› æ­¤å®šåˆ¶åŒ–é…ç½®è¶…æ—¶æ—¶é—´å°±æœ‰å¿…è¦äº†</strong>ã€‚</p>
<p><strong>è¶…æ—¶è®¾ç½®ï¼Œæ•…æ„è®¾ç½®è¶…æ—¶æ¼”ç¤ºå‡ºé”™æƒ…å†µï¼Œè‡ªå·±ä½¿åå†™bug</strong></p>
<h4 id="æ•…æ„è®¾ç½®è¶…æ—¶é”™è¯¯"><a href="#æ•…æ„è®¾ç½®è¶…æ—¶é”™è¯¯" class="headerlink" title="æ•…æ„è®¾ç½®è¶…æ—¶é”™è¯¯"></a>æ•…æ„è®¾ç½®è¶…æ—¶é”™è¯¯</h4><h5 id="æœåŠ¡æä¾›æ–¹8001å†™æš‚åœ62ç§’ç¨‹åº"><a href="#æœåŠ¡æä¾›æ–¹8001å†™æš‚åœ62ç§’ç¨‹åº" class="headerlink" title="æœåŠ¡æä¾›æ–¹8001å†™æš‚åœ62ç§’ç¨‹åº"></a>æœåŠ¡æä¾›æ–¹8001å†™æš‚åœ62ç§’ç¨‹åº</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109191814318.png" alt="image-20260109191814318"></p>
<p>ä¸ºä»€ä¹ˆæ˜¯62ç§’ï¼Ÿ</p>
<h5 id="æœåŠ¡è°ƒç”¨æ–¹80å†™å¥½æ•æ‰è¶…æ—¶å¼‚å¸¸"><a href="#æœåŠ¡è°ƒç”¨æ–¹80å†™å¥½æ•æ‰è¶…æ—¶å¼‚å¸¸" class="headerlink" title="æœåŠ¡è°ƒç”¨æ–¹80å†™å¥½æ•æ‰è¶…æ—¶å¼‚å¸¸"></a>æœåŠ¡è°ƒç”¨æ–¹80å†™å¥½æ•æ‰è¶…æ—¶å¼‚å¸¸</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/feign/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;-------æ”¯ä»˜å¾®æœåŠ¡è¿œç¨‹è°ƒç”¨ï¼ŒæŒ‰ç…§idæŸ¥è¯¢è®¢å•æ”¯ä»˜æµæ°´ä¿¡æ¯&quot;</span>);</span><br><span class="line">    <span class="type">ResultData</span> <span class="variable">resultData</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨å¼€å§‹-----:&quot;</span>+DateUtil.now());</span><br><span class="line">        resultData = payFeignApi.getPayInfo(id);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        System.out.println(<span class="string">&quot;è°ƒç”¨ç»“æŸ-----:&quot;</span>+DateUtil.now());</span><br><span class="line">        ResultData.fail(ReturnCodeEnum.RC500.getCode(),e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> resultData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æµ‹è¯•-3"><a href="#æµ‹è¯•-3" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h5><p>ç„¶åçœ‹æŠ¥é”™</p>
<h5 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h5><p>OpenFeigné»˜è®¤ç­‰å¾…60ç§’é’Ÿï¼Œè¶…è¿‡åæŠ¥é”™ã€‚</p>
<h4 id="å®˜ç½‘è§£é‡Š-é…ç½®å¤„ç†"><a href="#å®˜ç½‘è§£é‡Š-é…ç½®å¤„ç†" class="headerlink" title="å®˜ç½‘è§£é‡Š+é…ç½®å¤„ç†"></a>å®˜ç½‘è§£é‡Š+é…ç½®å¤„ç†</h4><p>é»˜è®¤OpenFeignå®¢æˆ·ç«¯ç­‰å¾…60ç§’é’Ÿï¼Œä½†æ˜¯æœåŠ¡ç«¯å¤„ç†è¶…è¿‡è§„å®šæ—¶é—´ä¼šå¯¼è‡´Feignå®¢æˆ·ç«¯è¿”å›æŠ¥é”™ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™æ ·çš„æƒ…å†µï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®¾ç½®Feignå®¢æˆ·ç«¯çš„è¶…æ—¶æ§åˆ¶ï¼Œé»˜è®¤60ç§’å¤ªé•¿æˆ–è€…ä¸šåŠ¡æ—¶é—´å¤ªçŸ­éƒ½ä¸å¥½</p>
<p>ymlæ–‡ä»¶ä¸­å¼€å¯é…ç½®ï¼š</p>
<p>connectTimeout    è¿æ¥è¶…æ—¶æ—¶é—´</p>
<p>readTimeout       è¯·æ±‚å¤„ç†è¶…æ—¶æ—¶é—´</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260109232216827.png" alt="image-20260109232216827"></p>
<h4 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">3000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">3000</span></span><br></pre></td></tr></table></figure>
<p><strong>å…¨éƒ¨çš„é…ç½®</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">3000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">3000</span></span><br></pre></td></tr></table></figure>
<h4 id="æŒ‡å®šé…ç½®"><a href="#æŒ‡å®šé…ç½®" class="headerlink" title="æŒ‡å®šé…ç½®"></a>æŒ‡å®šé…ç½®</h4><p>å•ä¸ªæœåŠ¡é…ç½®è¶…æ—¶æ—¶é—´</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line"></span><br><span class="line">          <span class="comment"># default è®¾ç½®çš„å…¨å±€è¶…æ—¶æ—¶é—´ï¼ŒæŒ‡å®šæœåŠ¡åç§°å¯ä»¥è®¾ç½®å•ä¸ªæœåŠ¡çš„è¶…æ—¶æ—¶é—´</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">             <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">             <span class="attr">connectTimeout:</span> <span class="number">4000</span></span><br><span class="line">             <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">             <span class="attr">readTimeout:</span> <span class="number">4000</span></span><br><span class="line"></span><br><span class="line">          <span class="comment"># ä¸ºserviceCè¿™ä¸ªæœåŠ¡å•ç‹¬é…ç½®è¶…æ—¶æ—¶é—´ï¼Œå•ä¸ªé…ç½®çš„è¶…æ—¶æ—¶é—´å°†ä¼šè¦†ç›–å…¨å±€é…ç½®</span></span><br><span class="line"></span><br><span class="line">          <span class="attr">serviceC:</span></span><br><span class="line">             <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">             <span class="attr">connectTimeout:</span> <span class="number">2000</span></span><br><span class="line">             <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">             <span class="attr">readTimeout:</span> <span class="number">2000</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                      <span class="attr">connectTimeout:</span> <span class="number">5000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                      <span class="attr">readTimeout:</span> <span class="number">5000</span></span><br></pre></td></tr></table></figure>
<p><strong>å…¨éƒ¨å†…å®¹</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">                <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">         <span class="comment">#default:</span></span><br><span class="line">            <span class="comment">#connectTimeout: 4000 #è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="comment">#readTimeout: 4000 #è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                   <span class="attr">cloud-payment-service:</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">8000</span> <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">readTimeout:</span> <span class="number">8000</span> <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br></pre></td></tr></table></figure>
<h3 id="2ã€OpenFeigné‡è¯•æœºåˆ¶"><a href="#2ã€OpenFeigné‡è¯•æœºåˆ¶" class="headerlink" title="2ã€OpenFeigné‡è¯•æœºåˆ¶"></a>2ã€OpenFeigné‡è¯•æœºåˆ¶</h3><h4 id="æ­¥éª¤-3"><a href="#æ­¥éª¤-3" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h4><h4 id="é»˜è®¤é‡è¯•æ˜¯å…³é—­çš„ï¼Œç»™äº†é»˜è®¤å€¼"><a href="#é»˜è®¤é‡è¯•æ˜¯å…³é—­çš„ï¼Œç»™äº†é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤é‡è¯•æ˜¯å…³é—­çš„ï¼Œç»™äº†é»˜è®¤å€¼"></a>é»˜è®¤é‡è¯•æ˜¯å…³é—­çš„ï¼Œç»™äº†é»˜è®¤å€¼</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110000715003.png" alt="image-20260110000715003"></p>
<h4 id="å¼€å¯é‡è¯•åŠŸèƒ½"><a href="#å¼€å¯é‡è¯•åŠŸèƒ½" class="headerlink" title="å¼€å¯é‡è¯•åŠŸèƒ½"></a>å¼€å¯é‡è¯•åŠŸèƒ½</h4><h5 id="æ–°å¢é…ç½®ç±»FeignConfigå¹¶ä¿®æ”¹Retryeré…ç½®"><a href="#æ–°å¢é…ç½®ç±»FeignConfigå¹¶ä¿®æ”¹Retryeré…ç½®" class="headerlink" title="æ–°å¢é…ç½®ç±»FeignConfigå¹¶ä¿®æ”¹Retryeré…ç½®"></a>æ–°å¢é…ç½®ç±»FeignConfigå¹¶ä¿®æ”¹Retryeré…ç½®</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Retryer <span class="title function_">myRetryer</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//return Retryer.NEVER_RETRY; //Feigné»˜è®¤é…ç½®æ˜¯ä¸èµ°é‡è¯•ç­–ç•¥çš„</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœ€å¤§è¯·æ±‚æ¬¡æ•°ä¸º3(1+2)ï¼Œåˆå§‹é—´éš”æ—¶é—´ä¸º100msï¼Œé‡è¯•é—´æœ€å¤§é—´éš”æ—¶é—´ä¸º1s</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Retryer</span>.Default(<span class="number">100</span>,<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ è§‰å¾—æ•ˆæœä¸æ˜æ˜¾çš„åŒå­¦ï¼Œåç»­æ¼”ç¤ºfeign æ—¥å¿—åŠŸèƒ½çš„æ—¶å€™å†æ¼”ç¤ºï¼Œ</p>
<p> ç›®å‰æ§åˆ¶å°æ²¡æœ‰çœ‹åˆ°3æ¬¡é‡è¯•è¿‡ç¨‹ï¼Œåªçœ‹åˆ°ç»“æœï¼Œ<strong><em>æ­£å¸¸çš„ï¼Œæ­£ç¡®çš„\</em></strong>ï¼Œæ˜¯feignçš„æ—¥å¿—æ‰“å°é—®é¢˜</p>
<h3 id="3ã€OpenFeigné»˜è®¤HttpClientä¿®æ”¹"><a href="#3ã€OpenFeigné»˜è®¤HttpClientä¿®æ”¹" class="headerlink" title="3ã€OpenFeigné»˜è®¤HttpClientä¿®æ”¹"></a>3ã€OpenFeigné»˜è®¤HttpClientä¿®æ”¹</h3><h4 id="æ˜¯ä»€ä¹ˆ-4"><a href="#æ˜¯ä»€ä¹ˆ-4" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p>OpenFeignä¸­http client</p>
<p>å¦‚æœä¸åšç‰¹æ®Šé…ç½®ï¼ŒOpenFeigné»˜è®¤ä½¿ç”¨JDKè‡ªå¸¦çš„HttpURLConnectionå‘é€HTTPè¯·æ±‚ï¼Œ</p>
<p> ç”±äºé»˜è®¤HttpURLConnectionæ²¡æœ‰è¿æ¥æ± ã€æ€§èƒ½å’Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œå¦‚æœé‡‡ç”¨é»˜è®¤ï¼Œæ€§èƒ½ä¸Šä¸æ˜¯æœ€ç‰›Bçš„ï¼Œæ‰€ä»¥åŠ åˆ°æœ€å¤§ã€‚</p>
<h4 id="Apache-HttpClient5æ›¿æ¢"><a href="#Apache-HttpClient5æ›¿æ¢" class="headerlink" title="Apache HttpClient5æ›¿æ¢"></a>Apache HttpClient5æ›¿æ¢</h4><h5 id="ä¸ºä»€ä¹ˆ"><a href="#ä¸ºä»€ä¹ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110002130716.png" alt="image-20260110002130716"></p>
<h5 id="ä¿®æ”¹å¾®æœåŠ¡feign90"><a href="#ä¿®æ”¹å¾®æœåŠ¡feign90" class="headerlink" title="ä¿®æ”¹å¾®æœåŠ¡feign90"></a>ä¿®æ”¹å¾®æœåŠ¡feign90</h5><h6 id="FeignConfigç±»é‡Œé¢å°†Retryerå±æ€§ä¿®æ”¹ä¸ºé»˜è®¤"><a href="#FeignConfigç±»é‡Œé¢å°†Retryerå±æ€§ä¿®æ”¹ä¸ºé»˜è®¤" class="headerlink" title="FeignConfigç±»é‡Œé¢å°†Retryerå±æ€§ä¿®æ”¹ä¸ºé»˜è®¤"></a>FeignConfigç±»é‡Œé¢å°†Retryerå±æ€§ä¿®æ”¹ä¸ºé»˜è®¤</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Retryer <span class="title function_">myRetryer</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Retryer.NEVER_RETRY; <span class="comment">//Feigné»˜è®¤é…ç½®æ˜¯ä¸èµ°é‡è¯•ç­–ç•¥çš„</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h5 id="POMä¿®æ”¹"><a href="#POMä¿®æ”¹" class="headerlink" title="POMä¿®æ”¹"></a>POMä¿®æ”¹</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- httpclient5--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents.client5<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- feign-hc5--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-hc5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  Apache HttpClient5 é…ç½®å¼€å¯</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p><strong>å…¨éƒ¨é…ç½®</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">4000</span> <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">4000</span> <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">              <span class="comment">#cloud-payment-service:</span></span><br><span class="line">              <span class="comment">#connectTimeout: 4000 #è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="comment">#readTimeout: 4000 #è¯»å–è¶…æ—¶æ—¶é—´</span></span><br></pre></td></tr></table></figure>
<h3 id="4ã€OpenFeignè¯·æ±‚-å“åº”å‹ç¼©"><a href="#4ã€OpenFeignè¯·æ±‚-å“åº”å‹ç¼©" class="headerlink" title="4ã€OpenFeignè¯·æ±‚/å“åº”å‹ç¼©"></a>4ã€OpenFeignè¯·æ±‚/å“åº”å‹ç¼©</h3><h4 id="æ˜¯ä»€ä¹ˆ-5"><a href="#æ˜¯ä»€ä¹ˆ-5" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p><strong>å¯¹è¯·æ±‚å’Œå“åº”è¿›è¡ŒGZIPå‹ç¼©</strong></p>
<p>Spring Cloud OpenFeignæ”¯æŒå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡ŒGZIPå‹ç¼©ï¼Œä»¥å‡å°‘é€šä¿¡è¿‡ç¨‹ä¸­çš„æ€§èƒ½æŸè€—ã€‚</p>
<p>é€šè¿‡ä¸‹é¢çš„ä¸¤ä¸ªå‚æ•°è®¾ç½®ï¼Œå°±èƒ½å¼€å¯è¯·æ±‚ä¸ç›¸åº”çš„å‹ç¼©åŠŸèƒ½ï¼š</p>
<p><code>spring.cloud.openfeign.compression.request.enabled=true</code></p>
<p><code>spring.cloud.openfeign.compression.response.enabled=true</code></p>
<p><strong>ç»†ç²’åº¦åŒ–è®¾ç½®</strong></p>
<p>å¯¹è¯·æ±‚å‹ç¼©åšä¸€äº›æ›´ç»†è‡´çš„è®¾ç½®ï¼Œæ¯”å¦‚ä¸‹é¢çš„é…ç½®å†…å®¹æŒ‡å®šå‹ç¼©çš„è¯·æ±‚æ•°æ®ç±»å‹å¹¶è®¾ç½®äº†è¯·æ±‚å‹ç¼©çš„å¤§å°ä¸‹é™ï¼Œ</p>
<p>åªæœ‰è¶…è¿‡è¿™ä¸ªå¤§å°çš„è¯·æ±‚æ‰ä¼šè¿›è¡Œå‹ç¼©ï¼š</p>
<p><code>spring.cloud.openfeign.compression.request.enabled=true</code></p>
<p><code>spring.cloud.openfeign.compression.request.mime-types=text/xml,application/xml,application/json #è§¦å‘å‹ç¼©æ•°æ®ç±»å‹</code></p>
<p><code>spring.cloud.openfeign.compression.request.min-request-size=2048 #æœ€å°è§¦å‘å‹ç¼©çš„å¤§å°</code></p>
<h4 id="é…ç½®-2"><a href="#é…ç½®-2" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">          <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">connectTimeout:</span> <span class="number">4000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">readTimeout:</span> <span class="number">4000</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span> <span class="comment">#æœ€å°è§¦å‘å‹ç¼©çš„å¤§å°</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span> <span class="comment">#è§¦å‘å‹ç¼©æ•°æ®ç±»å‹</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="5ã€OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½"><a href="#5ã€OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½" class="headerlink" title="5ã€OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½"></a>5ã€OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½</h3><h4 id="æ˜¯ä»€ä¹ˆ-6"><a href="#æ˜¯ä»€ä¹ˆ-6" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p>Feign æä¾›äº†æ—¥å¿—æ‰“å°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ¥è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œ</p>
<p>ä»è€Œäº†è§£ Feign ä¸­ Http è¯·æ±‚çš„ç»†èŠ‚ï¼Œ</p>
<p>è¯´ç™½äº†å°±æ˜¯å¯¹Feignæ¥å£çš„è°ƒç”¨æƒ…å†µè¿›è¡Œç›‘æ§å’Œè¾“å‡º</p>
<h4 id="æ—¥å¿—çº§åˆ«"><a href="#æ—¥å¿—çº§åˆ«" class="headerlink" title="æ—¥å¿—çº§åˆ«"></a>æ—¥å¿—çº§åˆ«</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NONEï¼šé»˜è®¤çš„ï¼Œä¸æ˜¾ç¤ºä»»ä½•æ—¥å¿—ï¼›</span><br><span class="line">BASICï¼šä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€URLã€å“åº”çŠ¶æ€ç åŠæ‰§è¡Œæ—¶é—´ï¼›</span><br><span class="line">HEADERSï¼šé™¤äº† BASIC ä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯ï¼›</span><br><span class="line">FULLï¼šé™¤äº† HEADERS ä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„æ­£æ–‡åŠå…ƒæ•°æ®ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®-3"><a href="#é…ç½®-3" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Retryer <span class="title function_">myRetryer</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Retryer.NEVER_RETRY; <span class="comment">//é»˜è®¤</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    Logger.Level <span class="title function_">feignLoggerLevel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Logger.Level.FULL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="YMLæ–‡ä»¶é‡Œéœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯"><a href="#YMLæ–‡ä»¶é‡Œéœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯" class="headerlink" title="YMLæ–‡ä»¶é‡Œéœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯"></a>YMLæ–‡ä»¶é‡Œéœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</h4><p>å…¬å¼(ä¸‰æ®µ)ï¼š<strong>logging.level</strong> + å«æœ‰@FeignClientæ³¨è§£çš„å®Œæ•´å¸¦åŒ…åçš„æ¥å£å+debug</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">bitzh:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span> </span><br></pre></td></tr></table></figure>
<h4 id="åå°æ—¥å¿—æŸ¥çœ‹"><a href="#åå°æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="åå°æ—¥å¿—æŸ¥çœ‹"></a>åå°æ—¥å¿—æŸ¥çœ‹</h4><h5 id="å¸¦ç€å‹ç¼©è°ƒç”¨"><a href="#å¸¦ç€å‹ç¼©è°ƒç”¨" class="headerlink" title="å¸¦ç€å‹ç¼©è°ƒç”¨"></a>å¸¦ç€å‹ç¼©è°ƒç”¨</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110004515774.png" alt="image-20260110004515774"></p>
<h5 id="å»æ‰å‹ç¼©è°ƒç”¨"><a href="#å»æ‰å‹ç¼©è°ƒç”¨" class="headerlink" title="å»æ‰å‹ç¼©è°ƒç”¨"></a>å»æ‰å‹ç¼©è°ƒç”¨</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110004533178.png" alt="image-20260110004533178"></p>
<h4 id="è¡¥å……å®éªŒï¼Œé‡è¯•æœºåˆ¶æ§åˆ¶å°çœ‹åˆ°3æ¬¡è¿‡ç¨‹"><a href="#è¡¥å……å®éªŒï¼Œé‡è¯•æœºåˆ¶æ§åˆ¶å°çœ‹åˆ°3æ¬¡è¿‡ç¨‹" class="headerlink" title="è¡¥å……å®éªŒï¼Œé‡è¯•æœºåˆ¶æ§åˆ¶å°çœ‹åˆ°3æ¬¡è¿‡ç¨‹"></a>è¡¥å……å®éªŒï¼Œé‡è¯•æœºåˆ¶æ§åˆ¶å°çœ‹åˆ°3æ¬¡è¿‡ç¨‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Retryer <span class="title function_">myRetryer</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æœ€å¤§è¯·æ±‚æ¬¡æ•°ä¸º3(1+2)ï¼Œåˆå§‹é—´éš”æ—¶é—´ä¸º100msï¼Œé‡è¯•é—´æœ€å¤§é—´éš”æ—¶é—´ä¸º1s</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Retryer</span>.Default(<span class="number">100</span>,<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    Logger.Level <span class="title function_">feignLoggerLevel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Logger.Level.FULL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">          <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">connectTimeout:</span> <span class="number">2000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">readTimeout:</span> <span class="number">2000</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">bitzh:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110004645751.png" alt="image-20260110004645751"></p>
<p><strong>æœ€ç»ˆYML</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">2000</span> <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">                        <span class="attr">readTimeout:</span> <span class="number">2000</span> <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line">           <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">         <span class="attr">request:</span></span><br><span class="line">           <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">           <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">           <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">         <span class="attr">response:</span></span><br><span class="line">           <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#connectTimeout: 4000 #è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">            <span class="comment">#readTimeout: 4000 #è¯»å–è¶…æ—¶æ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">atguigu:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>
<h2 id="OpenFeignå’ŒSentinelé›†æˆå®ç°fallbackæœåŠ¡é™çº§"><a href="#OpenFeignå’ŒSentinelé›†æˆå®ç°fallbackæœåŠ¡é™çº§" class="headerlink" title="OpenFeignå’ŒSentinelé›†æˆå®ç°fallbackæœåŠ¡é™çº§"></a>OpenFeignå’ŒSentinelé›†æˆå®ç°fallbackæœåŠ¡é™çº§</h2><p>è¿™ä¸ªåœ¨åé¢çš„springcloud alibaba ç¯‡ç« </p>
<h1 id="7ã€CircuitBreakeræ–­è·¯å™¨"><a href="#7ã€CircuitBreakeræ–­è·¯å™¨" class="headerlink" title="7ã€CircuitBreakeræ–­è·¯å™¨"></a>7ã€CircuitBreakeræ–­è·¯å™¨</h1><h3 id="Hystrixç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼"><a href="#Hystrixç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼" class="headerlink" title="Hystrixç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼"></a>Hystrixç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼</h3><p>Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å»¶è¿Ÿå’Œå®¹é”™çš„å¼€æºåº“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥ï¼Œæ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥ï¼Œé¿å…çº§è”æ•…éšœï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚</p>
<p>äº†è§£ä¸€ä¸‹å³å¯ï¼Œ2024å¹´äº†ä¸å†ä½¿ç”¨Hystrix</p>
<p><strong>æœªæ¥æ›¿ä»£æ–¹æ¡ˆï¼šResilience4J</strong></p>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><h4 id="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"></a>åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</h4><p>åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</p>
<p>å¤æ‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„åº”ç”¨ç¨‹åºæœ‰æ•°åä¸ªä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªä¾èµ–å…³ç³»åœ¨æŸäº›æ—¶å€™å°†ä¸å¯é¿å…åœ°å¤±è´¥ã€‚</p>
<p><strong>æœåŠ¡é›ªå´©</strong></p>
<p>å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ—¶å€™ï¼Œå‡è®¾å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cï¼Œå¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cåˆè°ƒç”¨å…¶å®ƒçš„å¾®æœåŠ¡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ‰‡å‡ºâ€ã€‚å¦‚æœæ‰‡å‡ºçš„é“¾è·¯ä¸ŠæŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨ï¼Œå¯¹å¾®æœåŠ¡Açš„è°ƒç”¨å°±ä¼šå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æºï¼Œè¿›è€Œå¼•èµ·ç³»ç»Ÿå´©æºƒï¼Œæ‰€è°“çš„â€œé›ªå´©æ•ˆåº”â€.</p>
<p>å¯¹äºé«˜æµé‡çš„åº”ç”¨æ¥è¯´ï¼Œå•ä¸€çš„åç«¯ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½åœ¨å‡ ç§’é’Ÿå†…é¥±å’Œã€‚æ¯”å¤±è´¥æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¿˜å¯èƒ½å¯¼è‡´æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿå¢åŠ ï¼Œå¤‡ä»½é˜Ÿåˆ—ï¼Œçº¿ç¨‹å’Œå…¶ä»–ç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå‘ç”Ÿæ›´å¤šçš„çº§è”æ•…éšœã€‚è¿™äº›éƒ½è¡¨ç¤ºéœ€è¦å¯¹æ•…éšœå’Œå»¶è¿Ÿè¿›è¡Œéš”ç¦»å’Œç®¡ç†ï¼Œä»¥ä¾¿å•ä¸ªä¾èµ–å…³ç³»çš„å¤±è´¥ï¼Œä¸èƒ½å–æ¶ˆæ•´ä¸ªåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿã€‚</p>
<p>æ‰€ä»¥ï¼Œ</p>
<p>é€šå¸¸å½“ä½ å‘ç°ä¸€ä¸ªæ¨¡å—ä¸‹çš„æŸä¸ªå®ä¾‹å¤±è´¥åï¼Œè¿™æ—¶å€™è¿™ä¸ªæ¨¡å—ä¾ç„¶è¿˜ä¼šæ¥æ”¶æµé‡ï¼Œç„¶åè¿™ä¸ªæœ‰é—®é¢˜çš„æ¨¡å—è¿˜è°ƒç”¨äº†å…¶ä»–çš„æ¨¡å—ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿçº§è”æ•…éšœï¼Œæˆ–è€…å«é›ªå´©ã€‚</p>
<h4 id="éœ€æ±‚-1"><a href="#éœ€æ±‚-1" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h4><p>é—®é¢˜ï¼š</p>
<p>ç¦æ­¢æœåŠ¡é›ªå´©æ•…éšœ</p>
<p>è§£å†³ï¼š </p>
<p>- æœ‰é—®é¢˜çš„èŠ‚ç‚¹ï¼Œå¿«é€Ÿç†”æ–­ï¼ˆå¿«é€Ÿè¿”å›å¤±è´¥å¤„ç†æˆ–è€…è¿”å›é»˜è®¤å…œåº•æ•°æ®ã€æœåŠ¡é™çº§ã€‘ï¼‰ã€‚</p>
<p>â€œæ–­è·¯å™¨â€æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”(FallBack)ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸ï¼Œè¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚</p>
<h4 id="å¦‚ä½•è§£å†³é—®é¢˜"><a href="#å¦‚ä½•è§£å†³é—®é¢˜" class="headerlink" title="å¦‚ä½•è§£å†³é—®é¢˜"></a>å¦‚ä½•è§£å†³é—®é¢˜</h4><h5 id="æœåŠ¡ç†”æ–­"><a href="#æœåŠ¡ç†”æ–­" class="headerlink" title="æœåŠ¡ç†”æ–­"></a>æœåŠ¡ç†”æ–­</h5><h5 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h5><h5 id="æœåŠ¡é™æµ"><a href="#æœåŠ¡é™æµ" class="headerlink" title="æœåŠ¡é™æµ"></a>æœåŠ¡é™æµ</h5><h5 id="æœåŠ¡é™æ—¶"><a href="#æœåŠ¡é™æ—¶" class="headerlink" title="æœåŠ¡é™æ—¶"></a>æœåŠ¡é™æ—¶</h5><h5 id="æœåŠ¡é¢„çƒ­"><a href="#æœåŠ¡é¢„çƒ­" class="headerlink" title="æœåŠ¡é¢„çƒ­"></a>æœåŠ¡é¢„çƒ­</h5><h5 id="æ¥è¿‘å®æ—¶çš„ç›‘æ§"><a href="#æ¥è¿‘å®æ—¶çš„ç›‘æ§" class="headerlink" title="æ¥è¿‘å®æ—¶çš„ç›‘æ§"></a>æ¥è¿‘å®æ—¶çš„ç›‘æ§</h5><h5 id="å…œåº•çš„å¤„ç†åŠ¨ä½œ"><a href="#å…œåº•çš„å¤„ç†åŠ¨ä½œ" class="headerlink" title="å…œåº•çš„å¤„ç†åŠ¨ä½œ"></a>å…œåº•çš„å¤„ç†åŠ¨ä½œ</h5><p>ä¸€å¥è¯ï¼Œ<strong>å‡ºæ•…éšœäº†â€œä¿é™©ä¸â€è·³é—¸ï¼Œåˆ«æŠŠæ•´ä¸ªå®¶ç»™çƒ§äº†ï¼ŒğŸ˜„</strong></p>
<h3 id="Circuit-Breakeræ˜¯ä»€ä¹ˆ"><a href="#Circuit-Breakeræ˜¯ä»€ä¹ˆ" class="headerlink" title="Circuit Breakeræ˜¯ä»€ä¹ˆ"></a>Circuit Breakeræ˜¯ä»€ä¹ˆ</h3><p>è¿™æ˜¯ä¸€å¥—è§„èŒƒï¼ŒæŠ½è±¡å®ç°ï¼Œæ”¯æŒç”¨Resilience4Jå®ç°å’ŒSpring Retryã€‚è¿™é‡Œæˆ‘ä»¬ç”¨Resilience4Jã€‚</p>
<h4 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h4><p>CircuitBreakerçš„ç›®çš„æ˜¯ä¿æŠ¤åˆ†å¸ƒå¼ç³»ç»Ÿå…å—æ•…éšœå’Œå¼‚å¸¸ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¥å£®æ€§ã€‚</p>
<p>å½“ä¸€ä¸ªç»„ä»¶æˆ–æœåŠ¡å‡ºç°æ•…éšœæ—¶ï¼ŒCircuitBreakerä¼šè¿…é€Ÿåˆ‡æ¢åˆ°å¼€æ”¾OPENçŠ¶æ€(ä¿é™©ä¸è·³é—¸æ–­ç”µ)ï¼Œé˜»æ­¢è¯·æ±‚å‘é€åˆ°è¯¥ç»„ä»¶æˆ–æœåŠ¡ä»è€Œé¿å…æ›´å¤šçš„è¯·æ±‚å‘é€åˆ°è¯¥ç»„ä»¶æˆ–æœåŠ¡ã€‚è¿™å¯ä»¥å‡å°‘å¯¹è¯¥ç»„ä»¶æˆ–æœåŠ¡çš„è´Ÿè½½ï¼Œé˜²æ­¢è¯¥ç»„ä»¶æˆ–æœåŠ¡è¿›ä¸€æ­¥å´©æºƒï¼Œå¹¶ä½¿æ•´ä¸ªç³»ç»Ÿèƒ½å¤Ÿç»§ç»­æ­£å¸¸è¿è¡Œã€‚åŒæ—¶ï¼ŒCircuitBreakerè¿˜å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¥å£®æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„å„ä¸ªç»„ä»¶ä¹‹é—´è‡ªåŠ¨åˆ‡æ¢ï¼Œä»è€Œé¿å…å•ç‚¹æ•…éšœçš„é—®é¢˜ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110014458140.png" alt="image-20260110014458140"></p>
<h4 id="ä¸€å¥è¯"><a href="#ä¸€å¥è¯" class="headerlink" title="ä¸€å¥è¯"></a>ä¸€å¥è¯</h4><p>Circuit Breakeråªæ˜¯ä¸€å¥—è§„èŒƒå’Œæ¥å£ï¼Œè½åœ°å®ç°è€…æ˜¯Resilience4J</p>
<h3 id="Resilience4J"><a href="#Resilience4J" class="headerlink" title="Resilience4J"></a>Resilience4J</h3><h4 id="æ˜¯ä»€ä¹ˆ-7"><a href="#æ˜¯ä»€ä¹ˆ-7" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110014601849.png" alt="image-20260110014601849"></p>
<h4 id="èƒ½å¹²å˜›-2"><a href="#èƒ½å¹²å˜›-2" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110014621645.png" alt="image-20260110014621645"></p>
<p>ç¼“å­˜å°±ç”¨redisï¼Œé‡è¯•ç”¨guavaï¼ˆå•ç‚¹é‡è¯•ï¼‰OpenFeignï¼ˆè·¨èŠ‚ç‚¹é‡è¯•ï¼‰ï¼Œè¶…æ—¶å¤„ç†OpenFeigné‡Œé¢å†…ç½®äº†ã€‚</p>
<h3 id="æ¡ˆä¾‹å®æˆ˜"><a href="#æ¡ˆä¾‹å®æˆ˜" class="headerlink" title="æ¡ˆä¾‹å®æˆ˜"></a>æ¡ˆä¾‹å®æˆ˜</h3><h4 id="ç†”æ–­-CircuitBreakerï¼ˆæœåŠ¡ç†”æ–­-æœåŠ¡é™çº§ï¼‰"><a href="#ç†”æ–­-CircuitBreakerï¼ˆæœåŠ¡ç†”æ–­-æœåŠ¡é™çº§ï¼‰" class="headerlink" title="ç†”æ–­ CircuitBreakerï¼ˆæœåŠ¡ç†”æ–­ + æœåŠ¡é™çº§ï¼‰"></a>ç†”æ–­ CircuitBreakerï¼ˆæœåŠ¡ç†”æ–­ + æœåŠ¡é™çº§ï¼‰</h4><h5 id="æ–­è·¯å™¨3å¤§çŠ¶æ€"><a href="#æ–­è·¯å™¨3å¤§çŠ¶æ€" class="headerlink" title="æ–­è·¯å™¨3å¤§çŠ¶æ€"></a>æ–­è·¯å™¨3å¤§çŠ¶æ€</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110020327694.png" alt="image-20260110020327694"></p>
<h5 id="æ–­è·¯å™¨3å¤§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢"><a href="#æ–­è·¯å™¨3å¤§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="æ–­è·¯å™¨3å¤§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢"></a>æ–­è·¯å™¨3å¤§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110020350206.png" alt="image-20260110020350206"></p>
<h5 id="æ–­è·¯å™¨æ‰€æœ‰é…ç½®å‚æ•°å‚è€ƒ"><a href="#æ–­è·¯å™¨æ‰€æœ‰é…ç½®å‚æ•°å‚è€ƒ" class="headerlink" title="æ–­è·¯å™¨æ‰€æœ‰é…ç½®å‚æ•°å‚è€ƒ"></a>æ–­è·¯å™¨æ‰€æœ‰é…ç½®å‚æ•°å‚è€ƒ</h5><div class="table-container">
<table>
<thead>
<tr>
<th>é…ç½®é¡¹å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>failure-rate-threshold</td>
<td>ä»¥ç™¾åˆ†æ¯”é…ç½®å¤±è´¥ç‡å³°å€¼</td>
</tr>
<tr>
<td>sliding-window-type</td>
<td>æ–­è·¯å™¨çš„æ»‘åŠ¨çª—å£æœŸç±»å‹ï¼Œå¯ä»¥åŸºäºâ€œæ¬¡æ•°â€ï¼ˆCOUNT_BASEDï¼‰æˆ–è€…â€œæ—¶é—´â€ï¼ˆTIME_BASEDï¼‰è¿›è¡Œç†”æ–­ï¼Œé»˜è®¤æ˜¯ COUNT_BASED</td>
</tr>
<tr>
<td>sliding-window-size</td>
<td>è‹¥ COUNT_BASEDï¼Œåˆ™10æ¬¡è°ƒç”¨ä¸­æœ‰50%å¤±è´¥ï¼ˆå³5æ¬¡ï¼‰æ‰“å¼€ç†”æ–­æ–­è·¯å™¨ï¼›è‹¥ä¸º TIME_BASED åˆ™ï¼Œæ­¤æ—¶è¿˜æœ‰é¢å¤–çš„ä¸¤ä¸ªè®¾ç½®å±æ€§ï¼Œå«ä¹‰ä¸ºï¼šåœ¨Nç§’å†…ï¼ˆsliding-window-sizeï¼‰100%ï¼ˆslow-call-rate-thresholdï¼‰çš„è¯·æ±‚è¶…è¿‡Nç§’ï¼ˆslow-call-duration-thresholdï¼‰æ‰“å¼€æ–­è·¯å™¨</td>
</tr>
<tr>
<td>slowCallRateThreshold</td>
<td>ä»¥ç™¾åˆ†æ¯”çš„æ–¹å¼é…ç½®ï¼Œæ–­è·¯å™¨æŠŠè°ƒç”¨æ—¶é—´å¤§äº slowCallDurationThreshold çš„è°ƒç”¨è§†ä¸ºæ…¢è°ƒç”¨ï¼Œå½“æ…¢è°ƒç”¨æ¯”ä¾‹å¤§äºç­‰äºå³°å€¼æ—¶ï¼Œæ–­è·¯å™¨å¼€å¯ï¼Œå¹¶è¿›å…¥æœåŠ¡é™çº§</td>
</tr>
<tr>
<td>slowCallDurationThreshold</td>
<td>é…ç½®è°ƒç”¨æ—¶é—´çš„å³°å€¼ï¼Œé«˜äºè¯¥å³°å€¼çš„è§†ä¸ºæ…¢è°ƒç”¨</td>
</tr>
<tr>
<td>permitted-number-of-calls-in-half-open-state</td>
<td>è¿è¡Œæ–­è·¯å™¨åœ¨ HALF_OPEN çŠ¶æ€ä¸‹æ—¶è¿›è¡Œ N æ¬¡è°ƒç”¨ï¼Œå¦‚æœæ•…éšœæˆ–æ…¢é€Ÿè°ƒç”¨ä»ç„¶é«˜äºé˜ˆå€¼ï¼Œæ–­è·¯å™¨å†æ¬¡è¿›å…¥æ‰“å¼€çŠ¶æ€</td>
</tr>
<tr>
<td>minimum-number-of-calls</td>
<td>åœ¨æ¯ä¸ªæ»‘åŠ¨çª—å£æœŸæ ·æœ¬æ•°ï¼Œé…ç½®æ–­è·¯å™¨è®¡ç®—é”™è¯¯ç‡æˆ–è€…æ…¢è°ƒç”¨ç‡çš„æœ€å°è°ƒç”¨æ•°ã€‚æ¯”å¦‚è®¾ç½®ä¸º5æ„å‘³ç€ï¼Œåœ¨è®¡ç®—æ•…éšœç‡ä¹‹å‰ï¼Œå¿…é¡»è‡³å°‘è°ƒç”¨5æ¬¡ã€‚å¦‚æœåªè®°å½•äº†4æ¬¡ï¼Œå³ä½¿4æ¬¡éƒ½å¤±è´¥äº†ï¼Œæ–­è·¯å™¨ä¹Ÿä¸ä¼šè¿›å…¥åˆ°æ‰“å¼€çŠ¶æ€</td>
</tr>
<tr>
<td>wait-duration-in-open-state</td>
<td>ä» OPEN åˆ° HALF_OPEN çŠ¶æ€éœ€è¦ç­‰å¾…çš„æ—¶é—´</td>
</tr>
</tbody>
</table>
</div>
<h5 id="ç†”æ–­-é™çº§æ¡ˆä¾‹éœ€æ±‚è¯´æ˜"><a href="#ç†”æ–­-é™çº§æ¡ˆä¾‹éœ€æ±‚è¯´æ˜" class="headerlink" title="ç†”æ–­+é™çº§æ¡ˆä¾‹éœ€æ±‚è¯´æ˜"></a>ç†”æ–­+é™çº§æ¡ˆä¾‹éœ€æ±‚è¯´æ˜</h5><p> 6æ¬¡è®¿é—®ä¸­å½“æ‰§è¡Œæ–¹æ³•çš„å¤±è´¥ç‡è¾¾åˆ°<strong>50%</strong>æ—¶<strong>CircuitBreaker</strong>å°†è¿›å…¥å¼€å¯<strong>OPEN</strong>çŠ¶æ€<strong>(</strong>ä¿é™©ä¸è·³é—¸æ–­ç”µ<strong>)</strong>æ‹’ç»æ‰€æœ‰è¯·æ±‚ã€‚<br><strong>ç­‰å¾…</strong>5<strong>ç§’åï¼Œ</strong>CircuitBreaker<strong>å°†è‡ªåŠ¨ä»å¼€å¯</strong>OPEN<strong>çŠ¶æ€è¿‡æ¸¡åˆ°åŠå¼€</strong>HALF_OPEN<strong>çŠ¶æ€ï¼Œå…è®¸ä¸€äº›è¯·æ±‚é€šè¿‡ä»¥æµ‹è¯•æœåŠ¡æ˜¯å¦æ¢å¤æ­£å¸¸ã€‚
</strong> å¦‚è¿˜æ˜¯å¼‚å¸¸<strong>CircuitBreaker</strong>å°†é‡æ–°è¿›å…¥å¼€å¯<strong>OPEN</strong>çŠ¶æ€ï¼›å¦‚æ­£å¸¸å°†è¿›å…¥å…³é—­<strong>CLOSE</strong>é—­åˆçŠ¶æ€æ¢å¤æ­£å¸¸å¤„ç†è¯·æ±‚ã€‚</p>
<p>å…·ä½“æ—¶é—´å’Œé¢‘æ¬¡ç­‰å±æ€§è§å…·ä½“å®é™…æ¡ˆä¾‹ï¼Œè¿™é‡Œåªæ˜¯ä½œä¸ºcaseä¸¾ä¾‹è®²è§£</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110021625279.png" alt="image-20260110021625279"></p>
<p>åˆ¤å®šæ–¹å¼æœ‰æŒ‰ç…§æ¬¡æ•°æœ‰æŒ‰ç…§æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´6æ¬¡3æ¬¡å¤±è´¥ï¼Œæˆ–è€…6ç§’ä¸­3ç§’å¤±è´¥ã€‚</p>
<h5 id="æŒ‰ç…§COUNT-BASED-è®¡æ•°çš„æ»‘åŠ¨çª—å£"><a href="#æŒ‰ç…§COUNT-BASED-è®¡æ•°çš„æ»‘åŠ¨çª—å£" class="headerlink" title="æŒ‰ç…§COUNT_BASED è®¡æ•°çš„æ»‘åŠ¨çª—å£"></a>æŒ‰ç…§COUNT_BASED è®¡æ•°çš„æ»‘åŠ¨çª—å£</h5><h6 id="ä¿®æ”¹cloud-provider-payment8001-1"><a href="#ä¿®æ”¹cloud-provider-payment8001-1" class="headerlink" title="ä¿®æ”¹cloud-provider-payment8001"></a>ä¿®æ”¹cloud-provider-payment8001</h6><p>æ–°å»ºPayCircuitController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayCircuitController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//=========Resilience4j CircuitBreaker çš„ä¾‹å­</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/circuit/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myCircuit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(id == -<span class="number">4</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;----circuit id ä¸èƒ½è´Ÿæ•°&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(id == <span class="number">9999</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">5</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, circuit! inputId:  &quot;</span>+id+<span class="string">&quot; \t &quot;</span> + IdUtil.simpleUUID();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹å¯¹å¤–æš´éœ²çš„æ¥å£PayFeignApiæ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-payment-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PayFeignApi</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢ä¸€æ¡æ”¯ä»˜ç›¸å…³æµæ°´è®°å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> payDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">addPay</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ä¸»é”®è®°å½•æŸ¥è¯¢æ”¯ä»˜æµæ°´ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * openfeignå¤©ç„¶æ”¯æŒè´Ÿè½½å‡è¡¡æ¼”ç¤º</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/get/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">mylb</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Resilience4j CircuitBreaker çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/circuit/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myCircuit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>ä¿é™©ä¸è£…åœ¨è°ƒç”¨è€…ï¼Œæ‰€ä»¥ä¿®æ”¹cloud-consumer-feign-order80</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--resilience4j-circuitbreaker--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-circuitbreaker-resilience4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ç”±äºæ–­è·¯ä¿æŠ¤ç­‰éœ€è¦AOPå®ç°ï¼Œæ‰€ä»¥å¿…é¡»å¯¼å…¥AOPåŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ”¹<strong>YML</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#å¼€å¯httpclient5</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">            <span class="comment">#å¼€å¯å‹ç¼©ç‰¹æ€§</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment"># å¼€å¯circuitbreakerå’Œåˆ†ç»„æ¿€æ´» spring.cloud.openfeign.circuitbreaker.enabled</span></span><br><span class="line">      <span class="attr">circuitbreaker:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">group:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#æ²¡å¼€åˆ†ç»„æ°¸è¿œä¸ç”¨åˆ†ç»„çš„é…ç½®ã€‚ç²¾ç¡®ä¼˜å…ˆã€åˆ†ç»„æ¬¡ä¹‹(å¼€äº†åˆ†ç»„)ã€é»˜è®¤æœ€å</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="comment">#logging:</span></span><br><span class="line"><span class="comment">#  level:</span></span><br><span class="line"><span class="comment">#    com:</span></span><br><span class="line"><span class="comment">#      bitzh:</span></span><br><span class="line"><span class="comment">#        cloud:</span></span><br><span class="line"><span class="comment">#          apis:</span></span><br><span class="line"><span class="comment">#            PayFeignApi: debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Resilience4j CircuitBreaker æŒ‰ç…§æ¬¡æ•°ï¼šCOUNT_BASED çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">#  6æ¬¡è®¿é—®ä¸­å½“æ‰§è¡Œæ–¹æ³•çš„å¤±è´¥ç‡è¾¾åˆ°50%æ—¶CircuitBreakerå°†è¿›å…¥å¼€å¯OPENçŠ¶æ€(ä¿é™©ä¸è·³é—¸æ–­ç”µ)æ‹’ç»æ‰€æœ‰è¯·æ±‚ã€‚</span></span><br><span class="line"><span class="comment">#  ç­‰å¾…5ç§’åï¼ŒCircuitBreaker å°†è‡ªåŠ¨ä»å¼€å¯OPENçŠ¶æ€è¿‡æ¸¡åˆ°åŠå¼€HALF_OPENçŠ¶æ€ï¼Œå…è®¸ä¸€äº›è¯·æ±‚é€šè¿‡ä»¥æµ‹è¯•æœåŠ¡æ˜¯å¦æ¢å¤æ­£å¸¸ã€‚</span></span><br><span class="line"><span class="comment">#  å¦‚è¿˜æ˜¯å¼‚å¸¸CircuitBreaker å°†é‡æ–°è¿›å…¥å¼€å¯OPENçŠ¶æ€ï¼›å¦‚æ­£å¸¸å°†è¿›å…¥å…³é—­CLOSEé—­åˆçŠ¶æ€æ¢å¤æ­£å¸¸å¤„ç†è¯·æ±‚ã€‚</span></span><br><span class="line"><span class="attr">resilience4j:</span></span><br><span class="line">  <span class="attr">circuitbreaker:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">failureRateThreshold:</span> <span class="number">50</span> <span class="comment">#è®¾ç½®50%çš„è°ƒç”¨å¤±è´¥æ—¶æ‰“å¼€æ–­è·¯å™¨ï¼Œè¶…è¿‡å¤±è´¥è¯·æ±‚ç™¾åˆ†â½CircuitBreakerå˜ä¸ºOPENçŠ¶æ€ã€‚</span></span><br><span class="line">        <span class="attr">slidingWindowType:</span> <span class="string">COUNT_BASED</span> <span class="comment"># æ»‘åŠ¨çª—å£çš„ç±»å‹</span></span><br><span class="line">        <span class="attr">slidingWindowSize:</span> <span class="number">6</span> <span class="comment">#æ»‘åŠ¨çª—â¼çš„â¼¤â¼©é…ç½®COUNT_BASEDè¡¨ç¤º6ä¸ªè¯·æ±‚ï¼Œé…ç½®TIME_BASEDè¡¨ç¤º6ç§’</span></span><br><span class="line">        <span class="attr">minimumNumberOfCalls:</span> <span class="number">6</span> <span class="comment">#æ–­è·¯å™¨è®¡ç®—å¤±è´¥ç‡æˆ–æ…¢è°ƒç”¨ç‡ä¹‹å‰æ‰€éœ€çš„æœ€å°æ ·æœ¬(æ¯ä¸ªæ»‘åŠ¨çª—å£å‘¨æœŸ)ã€‚å¦‚æœminimumNumberOfCallsä¸º10ï¼Œåˆ™å¿…é¡»æœ€å°‘è®°å½•10ä¸ªæ ·æœ¬ï¼Œç„¶åæ‰èƒ½è®¡ç®—å¤±è´¥ç‡ã€‚å¦‚æœåªè®°å½•äº†9æ¬¡è°ƒç”¨ï¼Œå³ä½¿æ‰€æœ‰9æ¬¡è°ƒç”¨éƒ½å¤±è´¥ï¼Œæ–­è·¯å™¨ä¹Ÿä¸ä¼šå¼€å¯ã€‚</span></span><br><span class="line">        <span class="attr">automaticTransitionFromOpenToHalfOpenEnabled:</span> <span class="literal">true</span> <span class="comment"># æ˜¯å¦å¯ç”¨è‡ªåŠ¨ä»å¼€å¯çŠ¶æ€è¿‡æ¸¡åˆ°åŠå¼€çŠ¶æ€ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚å¦‚æœå¯ç”¨ï¼ŒCircuitBreakerå°†è‡ªåŠ¨ä»å¼€å¯çŠ¶æ€è¿‡æ¸¡åˆ°åŠå¼€çŠ¶æ€ï¼Œå¹¶å…è®¸ä¸€äº›è¯·æ±‚é€šè¿‡ä»¥æµ‹è¯•æœåŠ¡æ˜¯å¦æ¢å¤æ­£å¸¸</span></span><br><span class="line">        <span class="attr">waitDurationInOpenState:</span> <span class="string">5s</span> <span class="comment">#ä»OPENåˆ°HALF_OPENçŠ¶æ€éœ€è¦ç­‰å¾…çš„æ—¶é—´</span></span><br><span class="line">        <span class="attr">permittedNumberOfCallsInHalfOpenState:</span> <span class="number">2</span> <span class="comment">#åŠå¼€çŠ¶æ€å…è®¸çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œé»˜è®¤å€¼ä¸º10ã€‚åœ¨åŠå¼€çŠ¶æ€ä¸‹ï¼ŒCircuitBreakerå°†å…è®¸æœ€å¤špermittedNumberOfCallsInHalfOpenStateä¸ªè¯·æ±‚é€šè¿‡ï¼Œå¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€ä¸ªè¯·æ±‚å¤±è´¥ï¼ŒCircuitBreakerå°†é‡æ–°è¿›å…¥å¼€å¯çŠ¶æ€ã€‚</span></span><br><span class="line">        <span class="attr">recordExceptions:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">java.lang.Exception</span></span><br><span class="line">    <span class="attr">instances:</span></span><br><span class="line">      <span class="attr">cloud-payment-service:</span></span><br><span class="line">        <span class="attr">baseConfig:</span> <span class="string">default</span></span><br></pre></td></tr></table></figure>
<p><strong>æ–°å»ºOrderCircuitController</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderCircuitController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PayFeignApi payFeignApi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/feign/pay/circuit/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@CircuitBreaker(name = &quot;cloud-payment-service&quot;, fallbackMethod = &quot;myCircuitFallback&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myCircuitBreaker</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> payFeignApi.myCircuit(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//myCircuitFallbackå°±æ˜¯æœåŠ¡é™çº§åçš„å…œåº•å¤„ç†æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">myCircuitFallback</span><span class="params">(Integer id,Throwable t)</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œæ˜¯å®¹é”™å¤„ç†é€»è¾‘ï¼Œè¿”å›å¤‡ç”¨ç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;myCircuitFallbackï¼Œç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•-----/(ã„’oã„’)/~~&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æµ‹è¯•</strong></p>
<p>è®¿é—®é”™è¯¯æ¬¡æ•°å¤šäº†ï¼Œå°±ç®—èŒƒæ–‡æ­£å¸¸çš„ä¹Ÿæ˜¯é”™è¯¯çš„å“åº”è¿‡5ç§’åæ¢å¤ã€‚</p>
<h5 id="æŒ‰ç…§TIME-BASED-æ—¶é—´çš„æ»‘åŠ¨çª—å£"><a href="#æŒ‰ç…§TIME-BASED-æ—¶é—´çš„æ»‘åŠ¨çª—å£" class="headerlink" title="æŒ‰ç…§TIME_BASED æ—¶é—´çš„æ»‘åŠ¨çª—å£"></a>æŒ‰ç…§TIME_BASED æ—¶é—´çš„æ»‘åŠ¨çª—å£</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260110183737723.png" alt="image-20260110183737723"></p>
<p><strong>åŸç†ï¼šä¸ç”¨æ·±ç©¶ï¼Œç„¶åä¸ºäº†è®¡ç®—ï¼Œæ¯ä¸ªæ¡¶é‡Œé¢æœ‰ä¸‰ä¸ªæ•´å½¢ï¼Œå¤±è´¥è°ƒç”¨æ•°ï¼Œæ…¢è°ƒç”¨æ•°ï¼Œæ€»è°ƒç”¨æ•°ã€è¿˜æœ‰ä¸€ä¸ªlongç±»å‹å˜é‡ï¼Œå­˜å‚¨æ‰€æœ‰è°ƒç”¨çš„å“åº”æ—¶é—´ã€‚</strong></p>
<h6 id="ä¿®æ”¹cloud-consumer-feign-order80"><a href="#ä¿®æ”¹cloud-consumer-feign-order80" class="headerlink" title="ä¿®æ”¹cloud-consumer-feign-order80"></a>ä¿®æ”¹cloud-consumer-feign-order80</h6><p><strong>å†™YML</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#å¼€å¯httpclient5</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#å¼€å¯å‹ç¼©ç‰¹æ€§</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment">#å¼€å¯circuitbreakerå’Œåˆ†ç»„æ¿€æ´»</span></span><br><span class="line">      <span class="attr">circuitbreaker:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">group:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#æ²¡å¼€åˆ†ç»„æ°¸è¿œä¸ç”¨åˆ†ç»„çš„é…ç½®ã€‚ç²¾ç¡®ä¼˜å…ˆã€åˆ†ç»„æ¬¡ä¹‹(å¼€äº†åˆ†ç»„)ã€é»˜è®¤æœ€å</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">atguigu:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Resilience4j CircuitBreaker æŒ‰ç…§æ—¶é—´ï¼šTIME_BASED çš„ä¾‹å­</span></span><br><span class="line"><span class="attr">resilience4j:</span></span><br><span class="line">  <span class="attr">timelimiter:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">timeout-duration:</span> <span class="string">10s</span> <span class="comment">#ç¥å‘çš„ä½ç½®ï¼Œtimelimiter é»˜è®¤é™åˆ¶è¿œç¨‹1sï¼Œè¶…äº1så°±è¶…æ—¶å¼‚å¸¸ï¼Œé…ç½®äº†é™çº§ï¼Œå°±èµ°é™çº§é€»è¾‘</span></span><br><span class="line">  <span class="attr">circuitbreaker:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">failureRateThreshold:</span> <span class="number">50</span> <span class="comment">#è®¾ç½®50%çš„è°ƒç”¨å¤±è´¥æ—¶æ‰“å¼€æ–­è·¯å™¨ï¼Œè¶…è¿‡å¤±è´¥è¯·æ±‚ç™¾åˆ†â½CircuitBreakerå˜ä¸ºOPENçŠ¶æ€ã€‚</span></span><br><span class="line">        <span class="attr">slowCallDurationThreshold:</span> <span class="string">2s</span> <span class="comment">#æ…¢è°ƒç”¨æ—¶é—´é˜ˆå€¼ï¼Œé«˜äºè¿™ä¸ªé˜ˆå€¼çš„è§†ä¸ºæ…¢è°ƒç”¨å¹¶å¢åŠ æ…¢è°ƒç”¨æ¯”ä¾‹ã€‚</span></span><br><span class="line">        <span class="attr">slowCallRateThreshold:</span> <span class="number">30</span> <span class="comment">#æ…¢è°ƒç”¨ç™¾åˆ†æ¯”å³°å€¼ï¼Œæ–­è·¯å™¨æŠŠè°ƒç”¨æ—¶é—´â¼¤äºslowCallDurationThresholdï¼Œè§†ä¸ºæ…¢è°ƒç”¨ï¼Œå½“æ…¢è°ƒç”¨æ¯”ä¾‹é«˜äºé˜ˆå€¼ï¼Œæ–­è·¯å™¨æ‰“å¼€ï¼Œå¹¶å¼€å¯æœåŠ¡é™çº§</span></span><br><span class="line">        <span class="attr">slidingWindowType:</span> <span class="string">TIME_BASED</span> <span class="comment"># æ»‘åŠ¨çª—å£çš„ç±»å‹</span></span><br><span class="line">        <span class="attr">slidingWindowSize:</span> <span class="number">2</span> <span class="comment">#æ»‘åŠ¨çª—å£çš„å¤§å°é…ç½®ï¼Œé…ç½®TIME_BASEDè¡¨ç¤º2ç§’</span></span><br><span class="line">        <span class="attr">minimumNumberOfCalls:</span> <span class="number">2</span> <span class="comment">#æ–­è·¯å™¨è®¡ç®—å¤±è´¥ç‡æˆ–æ…¢è°ƒç”¨ç‡ä¹‹å‰æ‰€éœ€çš„æœ€å°æ ·æœ¬(æ¯ä¸ªæ»‘åŠ¨çª—å£å‘¨æœŸ)ã€‚</span></span><br><span class="line">        <span class="attr">permittedNumberOfCallsInHalfOpenState:</span> <span class="number">2</span> <span class="comment">#åŠå¼€çŠ¶æ€å…è®¸çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œé»˜è®¤å€¼ä¸º10ã€‚</span></span><br><span class="line">        <span class="attr">waitDurationInOpenState:</span> <span class="string">5s</span> <span class="comment">#ä»OPENåˆ°HALF_OPENçŠ¶æ€éœ€è¦ç­‰å¾…çš„æ—¶é—´</span></span><br><span class="line">        <span class="attr">recordExceptions:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">java.lang.Exception</span></span><br><span class="line">    <span class="attr">instances:</span></span><br><span class="line">      <span class="attr">cloud-payment-service:</span></span><br><span class="line">        <span class="attr">baseConfig:</span> <span class="string">default</span></span><br></pre></td></tr></table></figure>
<p><strong>ä¸ºäº†é¿å…å½±å“å®éªŒæ•ˆæœï¼Œè®°å¾—å…³é—­FeignConfigè‡ªå·±å†™çš„é‡è¯•3æ¬¡</strong></p>
<h6 id="æµ‹è¯•ï¼ˆæ…¢æŸ¥è¯¢ï¼‰"><a href="#æµ‹è¯•ï¼ˆæ…¢æŸ¥è¯¢ï¼‰" class="headerlink" title="æµ‹è¯•ï¼ˆæ…¢æŸ¥è¯¢ï¼‰"></a><strong>æµ‹è¯•ï¼ˆæ…¢æŸ¥è¯¢ï¼‰</strong></h6><p><strong>ä¸€æ¬¡è¶…æ—¶ï¼Œä¸€æ¬¡æ­£å¸¸è®¿é—®ï¼ŒåŒæ—¶è¿›è¡Œ</strong></p>
<h6 id="å°æ€»ç»“-1"><a href="#å°æ€»ç»“-1" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h6><p><strong>æ–­è·¯å™¨å¼€å¯æˆ–è€…å…³é—­çš„æ¡ä»¶</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111052237086.png" alt="image-20260111052237086"></p>
<p>å½“æ»¡è¶³ä¸€å®šçš„å³°å€¼å’Œå¤±è´¥ç‡è¾¾åˆ°ä¸€å®šæ¡ä»¶åï¼Œæ–­è·¯å™¨å°†ä¼šè¿›å…¥OPENçŠ¶æ€ï¼ˆä¿é™©ä¸è·³é—¸ï¼‰ï¼ŒæœåŠ¡ç†”æ–­</p>
<p>å½“OPENçš„æ—¶å€™ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¸ä¼šè°ƒç”¨ä¸»ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œè€Œæ˜¯ç›´æ¥èµ°fallbackmethodå…œåº•èƒŒé”…æ–¹æ³•ï¼ŒæœåŠ¡é™çº§ã€‚</p>
<p>ä¸€æ®µæ—¶é—´ä¹‹åï¼Œè¿™ä¸ªæ—¶å€™æ–­è·¯å™¨ä¼šä»OPENè¿›å…¥åˆ°HALF_OPENåŠå¼€çŠ¶æ€ï¼Œä¼šæ”¾å‡ ä¸ªè¯·æ±‚è¿‡å»æ¢æ¢é“¾è·¯æ˜¯å¦é€šï¼Ÿ</p>
<p>å¦‚æœæˆåŠŸï¼Œæ–­è·¯å™¨ä¼šå…³é—­CLOSEï¼ˆç±»ä¼¼ä¿é™©ä¸é—­åˆï¼Œæ¢å¤å¯ç”¨ï¼‰</p>
<p>å¦‚æœå¤±è´¥ï¼Œç»§ç»­å¼€å¯ï¼Œé‡å¤ä¸Šè¿°ã€‚</p>
<p>ä¸è¦æ··ç”¨ï¼Œæ¨èæŒ‰ç…§è°ƒç”¨æ¬¡æ•°ã€‚</p>
<h4 id="éš”ç¦»ï¼ˆBulkHeadï¼‰"><a href="#éš”ç¦»ï¼ˆBulkHeadï¼‰" class="headerlink" title="éš”ç¦»ï¼ˆBulkHeadï¼‰"></a>éš”ç¦»ï¼ˆBulkHeadï¼‰</h4><h5 id="æ˜¯ä»€ä¹ˆ-8"><a href="#æ˜¯ä»€ä¹ˆ-8" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h5><p>bulkhead(èˆ¹çš„)èˆ±å£/(é£æœºçš„)éš”æ¿</p>
<p>æ¿æ¥è‡ªé€ èˆ¹è¡Œä¸šï¼ŒåºŠä»“å†…éƒ¨ä¸€èˆ¬ä¼šåˆ†æˆå¾ˆå¤šå°éš”èˆ±ï¼Œä¸€æ—¦ä¸€ä¸ªéš”èˆ±æ¼æ°´å› ä¸ºéš”æ¿çš„å­˜åœ¨è€Œä¸è‡³äºå½±å“å…¶å®ƒéš”èˆ±å’Œæ•´ä½“èˆ¹ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111053000936.png" alt="image-20260111053000936"></p>
<p>ç”¨æ¥é™å¹¶å‘çš„ã€‚</p>
<h5 id="èƒ½å¹²å˜›-3"><a href="#èƒ½å¹²å˜›-3" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h5><p><strong>ä¸€æ¥éš”ç¦» &amp; è´Ÿè½½ä¿æŠ¤ï¼šç”¨æ¥é™åˆ¶å¯¹äºä¸‹æ¸¸æœåŠ¡çš„æœ€å¤§å¹¶å‘æ•°é‡çš„é™åˆ¶</strong></p>
<h5 id="Resilience4Jæä¾›äº†å¦‚ä¸‹ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡"><a href="#Resilience4Jæä¾›äº†å¦‚ä¸‹ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡" class="headerlink" title="Resilience4Jæä¾›äº†å¦‚ä¸‹ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡"></a>Resilience4Jæä¾›äº†å¦‚ä¸‹ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡</h5><h6 id="å®ç°SemaphoreBulkheadï¼ˆä¿¡å·é‡èˆ±å£ï¼‰"><a href="#å®ç°SemaphoreBulkheadï¼ˆä¿¡å·é‡èˆ±å£ï¼‰" class="headerlink" title="å®ç°SemaphoreBulkheadï¼ˆä¿¡å·é‡èˆ±å£ï¼‰"></a>å®ç°SemaphoreBulkheadï¼ˆä¿¡å·é‡èˆ±å£ï¼‰</h6><p>è¿™ä¸ªä½¿ç”¨äº†ä¿¡å·é‡</p>
<p><strong>ä¿¡å·é‡åŸç†</strong></p>
<p>åŸºæœ¬ä¸Šå°±æ˜¯æˆ‘ä»¬JUCä¿¡å·ç¯å†…å®¹çš„åŒæ ·æ€æƒ³</p>
<p>ä¿¡å·é‡èˆ±å£ï¼ˆSemaphoreBulkheadï¼‰åŸç†</p>
<p>å½“ä¿¡å·é‡æœ‰ç©ºé—²æ—¶ï¼Œè¿›å…¥ç³»ç»Ÿçš„è¯·æ±‚ä¼šç›´æ¥è·å–ä¿¡å·é‡å¹¶å¼€å§‹ä¸šåŠ¡å¤„ç†ã€‚</p>
<p>å½“ä¿¡å·é‡å…¨è¢«å ç”¨æ—¶ï¼Œæ¥ä¸‹æ¥çš„è¯·æ±‚å°†ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒSemaphoreBulkheadæä¾›äº†ä¸€ä¸ªé˜»å¡è®¡æ—¶å™¨ï¼Œ</p>
<p>å¦‚æœé˜»å¡çŠ¶æ€çš„è¯·æ±‚åœ¨é˜»å¡è®¡æ—¶å†…æ— æ³•è·å–åˆ°ä¿¡å·é‡åˆ™ç³»ç»Ÿä¼šæ‹’ç»è¿™äº›è¯·æ±‚ã€‚</p>
<p>è‹¥è¯·æ±‚åœ¨é˜»å¡è®¡æ—¶å†…è·å–åˆ°äº†ä¿¡å·é‡ï¼Œé‚£å°†ç›´æ¥è·å–ä¿¡å·é‡å¹¶æ‰§è¡Œç›¸åº”çš„ä¸šåŠ¡å¤„ç†ã€‚</p>
<p><strong>æºç åˆ†æ</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111060722914.png" alt="image-20260111060722914"></p>
<p><strong>cloud-provider-payment8001æ”¯ä»˜å¾®æœåŠ¡</strong></p>
<p>ä¿®æ”¹PayCircuitController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//=========Resilience4j bulkhead çš„ä¾‹å­</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/bulkhead/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myBulkhead</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(id == -<span class="number">4</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;----bulkhead id ä¸èƒ½-4&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(id == <span class="number">9999</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">5</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, bulkhead! inputId:  &quot;</span>+id+<span class="string">&quot; \t &quot;</span> + IdUtil.simpleUUID();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>PayFeignApiæ¥å£æ–°å¢èˆ±å£apiæ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Resilience4j Bulkhead çš„ä¾‹å­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/bulkhead/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myBulkhead</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br></pre></td></tr></table></figure>
<p><strong>ä¿®æ”¹ cloud-consumer-feign-order80</strong></p>
<p><strong>POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--resilience4j-bulkhead--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-bulkhead<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>YML</strong></p>
<p>ç¤ºä¾‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111061745375.png" alt="image-20260111061745375"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">          <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#å¼€å¯httpclient5</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#å¼€å¯å‹ç¼©ç‰¹æ€§</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment">#å¼€å¯circuitbreakerå’Œåˆ†ç»„æ¿€æ´»</span></span><br><span class="line">      <span class="attr">circuitbreaker:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">group:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#æ²¡å¼€åˆ†ç»„æ°¸è¿œä¸ç”¨åˆ†ç»„çš„é…ç½®ã€‚ç²¾ç¡®ä¼˜å…ˆã€åˆ†ç»„æ¬¡ä¹‹(å¼€äº†åˆ†ç»„)ã€é»˜è®¤æœ€å</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">bitzh:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####resilience4j bulkhead çš„ä¾‹å­</span></span><br><span class="line"><span class="attr">resilience4j:</span></span><br><span class="line">  <span class="attr">bulkhead:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">maxConcurrentCalls:</span> <span class="number">2</span> <span class="comment"># éš”ç¦»å…è®¸å¹¶å‘çº¿ç¨‹æ‰§è¡Œçš„æœ€å¤§æ•°é‡</span></span><br><span class="line">                <span class="attr">maxWaitDuration:</span> <span class="string">1s</span> <span class="comment"># å½“è¾¾åˆ°å¹¶å‘è°ƒç”¨æ•°é‡æ—¶ï¼Œæ–°çš„çº¿ç¨‹çš„é˜»å¡æ—¶é—´ï¼Œæˆ‘åªæ„¿æ„ç­‰å¾…1ç§’ï¼Œè¿‡æ—¶ä¸å€™è¿›èˆ±å£å…œåº•fallback</span></span><br><span class="line">    <span class="attr">instances:</span></span><br><span class="line">      <span class="attr">cloud-payment-service:</span></span><br><span class="line">        <span class="attr">baseConfig:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">timelimiter:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">timeout-duration:</span> <span class="string">20s</span></span><br></pre></td></tr></table></figure>
<p><strong>ä¸šåŠ¡ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *(èˆ¹çš„)èˆ±å£,éš”ç¦»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/feign/pay/bulkhead/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@Bulkhead(name = &quot;cloud-payment-service&quot;,fallbackMethod = &quot;myBulkheadFallback&quot;,type = Bulkhead.Type.SEMAPHORE)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myBulkhead</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> payFeignApi.myBulkhead(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myBulkheadFallback</span><span class="params">(Throwable t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;myBulkheadFallbackï¼Œéš”æ¿è¶…å‡ºæœ€å¤§æ•°é‡é™åˆ¶ï¼Œç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•-----/(ã„’oã„’)/~~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>@Bulkhead</strong> <strong>Bulkhead.Type.SEMAPHORE</strong></p>
<h6 id="å®ç°FixedThreadPoolBulkheadï¼ˆå›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼‰"><a href="#å®ç°FixedThreadPoolBulkheadï¼ˆå›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼‰" class="headerlink" title="å®ç°FixedThreadPoolBulkheadï¼ˆå›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼‰"></a>å®ç°FixedThreadPoolBulkheadï¼ˆå›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼‰</h6><p>è¿™ä¸ªä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—å’Œå›ºå®šå¤§å°çº¿ç¨‹æ± </p>
<p><strong>æ¦‚è¿°</strong></p>
<p>åŸºæœ¬ä¸Šå°±æ˜¯æˆ‘ä»¬JUC-çº¿ç¨‹æ± å†…å®¹çš„åŒæ ·æ€æƒ³</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111163134319.png" alt="image-20260111163134319"></p>
<p>å›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼ˆFixedThreadPoolBulkheadï¼‰</p>
<p>FixedThreadPoolBulkheadçš„åŠŸèƒ½ä¸SemaphoreBulkheadä¸€æ ·ä¹Ÿæ˜¯<strong>ç”¨äºé™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ¬¡æ•°</strong>çš„ï¼Œä½†æ˜¯äºŒè€…çš„å®ç°åŸç†å­˜åœ¨å·®åˆ«è€Œä¸”è¡¨ç°æ•ˆæœä¹Ÿå­˜åœ¨ç»†å¾®çš„å·®åˆ«ã€‚FixedThreadPoolBulkheadä½¿ç”¨ä¸€ä¸ªå›ºå®šçº¿ç¨‹æ± å’Œä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—æ¥å®ç°èˆ±å£ã€‚</p>
<p>å½“çº¿ç¨‹æ± ä¸­å­˜åœ¨ç©ºé—²æ—¶ï¼Œåˆ™æ­¤æ—¶è¿›å…¥ç³»ç»Ÿçš„è¯·æ±‚å°†ç›´æ¥è¿›å…¥çº¿ç¨‹æ± å¼€å¯æ–°çº¿ç¨‹æˆ–ä½¿ç”¨ç©ºé—²çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚ã€‚</p>
<p>å½“çº¿ç¨‹æ± ä¸­æ— ç©ºé—²æ—¶æ—¶ï¼Œæ¥ä¸‹æ¥çš„è¯·æ±‚å°†è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œ</p>
<p>  è‹¥ç­‰å¾…é˜Ÿåˆ—ä»ç„¶æ— å‰©ä½™ç©ºé—´æ—¶æ¥ä¸‹æ¥çš„è¯·æ±‚å°†ç›´æ¥è¢«æ‹’ç»ï¼Œ</p>
<p>  åœ¨é˜Ÿåˆ—ä¸­çš„è¯·æ±‚ç­‰å¾…çº¿ç¨‹æ± å‡ºç°ç©ºé—²æ—¶ï¼Œå°†è¿›å…¥çº¿ç¨‹æ± è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚</p>
<p>å¦å¤–ï¼šThreadPoolBulkheadåªå¯¹CompletableFutureæ–¹æ³•æœ‰æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…åˆ›å»ºè¿”å›CompletableFutureç±»å‹çš„æ–¹æ³•</p>
<p><strong>ä¿¡å·é‡èˆ±å£å°±æ˜¯åˆ©ç”¨è°ƒç”¨æ–¹çš„çº¿ç¨‹ï¼Œå¯¹å¹¶å‘é‡é™åˆ¶ï¼Œå›ºå®šçº¿ç¨‹æ± èˆ±å£å°±æ˜¯æœåŠ¡å™¨é‡Œé¢ä¸“å±çº¿ç¨‹æ± ï¼Œå’Œè°ƒç”¨æ–¹çº¿ç¨‹éš”ç¦»</strong></p>
<p><strong>æƒ³è¦ç†è§£å…·ä½“æºç ï¼Œå»JUCé‡Œé¢çœ‹äº†</strong></p>
<p><strong>è¿™é‡Œäº†è§£å¦‚ä½•ä½¿ç”¨</strong></p>
<p><strong>ä¿®æ”¹cloud-consumer-feign-order80</strong></p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--resilience4j-bulkhead--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-bulkhead<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>YML</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111164117503.png" alt="image-20260111164117503"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111164506626.png" alt="image-20260111164506626"></p>
<p>è¿™é‡Œè®²è§£åŸç†ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹è¿›å…¥CorePoolå¦‚æœå¤šäº†å°±è¿›å…¥åˆ°é˜»å¡é˜Ÿåˆ—ï¼Œå¦‚æœé˜»å¡é˜Ÿåˆ—æ»¡äº†å°±æ‰©Poolï¼Œç„¶ååˆ°maximumPoolã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-openfeign-order</span></span><br><span class="line">  <span class="comment">####Spring Cloud Consul for Service Discovery</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#ä¼˜å…ˆä½¿ç”¨æœåŠ¡ipè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">openfeign:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">default:</span></span><br><span class="line">            <span class="comment">#cloud-payment-service:</span></span><br><span class="line">            <span class="comment">#è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">connectTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#è¯»å–è¶…æ—¶æ—¶é—´ï¼Œä¸ºé¿å…æ¼”ç¤ºå‡ºé”™ï¼Œè®²è§£å®Œæœ¬æ¬¡å†…å®¹åè®¾ç½®ä¸º20ç§’</span></span><br><span class="line">            <span class="attr">readTimeout:</span> <span class="number">20000</span></span><br><span class="line">            <span class="comment">#å¼€å¯httpclient5</span></span><br><span class="line">      <span class="attr">httpclient:</span></span><br><span class="line">        <span class="attr">hc5:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#å¼€å¯å‹ç¼©ç‰¹æ€§</span></span><br><span class="line">      <span class="attr">compression:</span></span><br><span class="line">        <span class="attr">request:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">min-request-size:</span> <span class="number">2048</span></span><br><span class="line">          <span class="attr">mime-types:</span> <span class="string">text/xml,application/xml,application/json</span></span><br><span class="line">        <span class="attr">response:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="comment">#å¼€å¯circuitbreakerå’Œåˆ†ç»„æ¿€æ´»</span></span><br><span class="line">      <span class="attr">circuitbreaker:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#        group:</span></span><br><span class="line"><span class="comment">#          enabled: true # æ¼”ç¤ºBulkhead.Type.THREADPOOLæ—¶spring.cloud.openfeign.circuitbreaker.group.enabled</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ä¸ºfalseæ–°å¯çº¿ç¨‹å’ŒåŸæ¥ä¸»çº¿ç¨‹è„±ç¦»äº†ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">bitzh:</span></span><br><span class="line">        <span class="attr">cloud:</span></span><br><span class="line">          <span class="attr">apis:</span></span><br><span class="line">            <span class="attr">PayFeignApi:</span> <span class="string">debug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####resilience4j bulkhead -THREADPOOLçš„ä¾‹å­</span></span><br><span class="line"><span class="attr">resilience4j:</span></span><br><span class="line">  <span class="attr">timelimiter:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">timeout-duration:</span> <span class="string">10s</span> <span class="comment">#timelimiteré»˜è®¤é™åˆ¶è¿œç¨‹1sï¼Œè¶…è¿‡æŠ¥é”™ä¸å¥½æ¼”ç¤ºæ•ˆæœæ‰€ä»¥åŠ ä¸Š10ç§’</span></span><br><span class="line">  <span class="attr">thread-pool-bulkhead:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">core-thread-pool-size:</span> <span class="number">1</span></span><br><span class="line">        <span class="attr">max-thread-pool-size:</span> <span class="number">1</span></span><br><span class="line">        <span class="attr">queue-capacity:</span> <span class="number">1</span></span><br><span class="line">        <span class="comment">#æ‰€ä»¥è¿™é‡Œæœ€å¤§å¹¶å‘æ•°å°±æ˜¯2ä¸ª</span></span><br><span class="line">    <span class="attr">instances:</span></span><br><span class="line">      <span class="attr">cloud-payment-service:</span></span><br><span class="line">        <span class="attr">baseConfig:</span> <span class="string">default</span></span><br><span class="line"><span class="comment"># spring.cloud.openfeign.circuitbreaker.group.enabled è¯·è®¾ç½®ä¸ºfalse æ–°å¯çº¿ç¨‹å’ŒåŸæ¥ä¸»çº¿ç¨‹è„±ç¦»</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260111164158477.png" alt="image-20260111164158477"></p>
<p><strong>order80çš„controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * (èˆ¹çš„)èˆ±å£,éš”ç¦»,THREADPOOL</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/feign/pay/bulkhead/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@Bulkhead(name = &quot;cloud-payment-service&quot;,fallbackMethod = &quot;myBulkheadPoolFallback&quot;,type = Bulkhead.Type.THREADPOOL)</span></span><br><span class="line"><span class="keyword">public</span> CompletableFuture&lt;String&gt; <span class="title function_">myBulkheadTHREADPOOL</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;enter the method!!!&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">3</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">    System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;exist the method!!!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; payFeignApi.myBulkhead(id) + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot; Bulkhead.Type.THREADPOOL&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> CompletableFuture&lt;String&gt; <span class="title function_">myBulkheadPoolFallback</span><span class="params">(Integer id,Throwable t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;Bulkhead.Type.THREADPOOLï¼Œç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•-----/(ã„’oã„’)/~~&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é™æµ"><a href="#é™æµ" class="headerlink" title="é™æµ"></a>é™æµ</h4><p><strong>é™æµ</strong>ï¼šé™åˆ¶ â€œå•ä½æ—¶é—´å†…è¿›å…¥å¤§æ¥¼çš„æ€»äººæ•°â€ï¼Œé˜²æ­¢å¤§æ¥¼å…¥å£æ‹¥å µã€‚</p>
<p><strong>èˆ±å£</strong>ï¼šæŠŠå¤§æ¥¼åˆ†æˆå¤šä¸ªç‹¬ç«‹æˆ¿é—´ï¼Œé™åˆ¶ â€œæ¯ä¸ªæˆ¿é—´çš„äººæ•°â€ï¼Œé˜²æ­¢ä¸€ä¸ªæˆ¿é—´çˆ†æ»¡å½±å“å…¶ä»–æˆ¿é—´ã€‚</p>
<p>é™æµ å°±æ˜¯é™åˆ¶æœ€å¤§è®¿é—®æµé‡ã€‚ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§å¹¶å‘æ˜¯æœ‰é™çš„ï¼ŒåŒæ—¶æ¥çš„è¯·æ±‚åˆå¤ªå¤šï¼Œå°±éœ€è¦é™æµã€‚ </p>
<p>æ¯”å¦‚å•†åŸç§’æ€ä¸šåŠ¡ï¼Œç¬æ—¶å¤§é‡è¯·æ±‚æ¶Œå…¥ï¼ŒæœåŠ¡å™¨å¿™ä¸è¿‡å°±åªå¥½æ’é˜Ÿé™æµäº†ï¼Œå’Œå»æ™¯ç‚¹æ’é˜Ÿä¹°ç¥¨å’Œå»åŒ»é™¢åŠç†ä¸šåŠ¡æ’é˜Ÿç­‰å·é“ç†ç›¸åŒã€‚</p>
<p>æ‰€è°“é™æµï¼Œå°±æ˜¯é€šè¿‡å¯¹å¹¶å‘è®¿é—®/è¯·æ±‚è¿›è¡Œé™é€Ÿï¼Œæˆ–è€…å¯¹ä¸€ä¸ªæ—¶é—´çª—å£å†…çš„è¯·</p>
<p>æ±‚è¿›è¡Œé™é€Ÿï¼Œä»¥ä¿æŠ¤åº”ç”¨ç³»ç»Ÿï¼Œä¸€æ—¦è¾¾åˆ°é™åˆ¶é€Ÿç‡åˆ™å¯ä»¥æ‹’ç»æœåŠ¡ã€æ’é˜Ÿæˆ–</p>
<p>ç­‰å¾…ã€é™çº§ç­‰å¤„ç†ã€‚</p>
<p><strong>é™æµæ˜¯é¢‘ç‡æ§åˆ¶</strong></p>
<h5 id="å¸¸è§çš„é™æµç®—æ³•"><a href="#å¸¸è§çš„é™æµç®—æ³•" class="headerlink" title="å¸¸è§çš„é™æµç®—æ³•"></a>å¸¸è§çš„é™æµç®—æ³•</h5><h6 id="æ¼æ–—ç®—æ³•"><a href="#æ¼æ–—ç®—æ³•" class="headerlink" title="æ¼æ–—ç®—æ³•"></a>æ¼æ–—ç®—æ³•</h6><p> ä¸€ä¸ªå›ºå®šå®¹é‡çš„æ¼æ¡¶ï¼ŒæŒ‰ç…§è®¾å®šå¸¸é‡å›ºå®šé€Ÿç‡æµå‡ºæ°´æ»´ï¼Œç±»ä¼¼åŒ»é™¢æ‰“åŠé’ˆï¼Œä¸ç®¡ä½ æºå¤´æµé‡å¤šå¤§ï¼Œæˆ‘è®¾å®šåŒ€é€Ÿæµå‡ºã€‚ å¦‚æœæµå…¥æ°´æ»´è¶…å‡ºäº†æ¡¶çš„å®¹é‡ï¼Œåˆ™æµå…¥çš„æ°´æ»´å°†ä¼šæº¢å‡ºäº†(è¢«ä¸¢å¼ƒ)ï¼Œè€Œæ¼æ¡¶å®¹é‡æ˜¯ä¸å˜çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112002111218.png" alt="image-20260112002111218"></p>
<p><strong>ç¼ºç‚¹ï¼š</strong>è¿™é‡Œæœ‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯æ¡¶çš„å¤§å°ï¼Œæ”¯æŒæµé‡çªå‘å¢å¤šæ—¶å¯ä»¥å­˜å¤šå°‘çš„æ°´ï¼ˆburstï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æ°´æ¡¶æ¼æ´çš„å¤§å°ï¼ˆrateï¼‰ã€‚å› ä¸ºæ¼æ¡¶çš„æ¼å‡ºé€Ÿç‡æ˜¯å›ºå®šçš„å‚æ•°ï¼Œæ‰€ä»¥ï¼Œå³ä½¿ç½‘ç»œä¸­ä¸å­˜åœ¨èµ„æºå†²çªï¼ˆæ²¡æœ‰å‘ç”Ÿæ‹¥å¡ï¼‰ï¼Œæ¼æ¡¶ç®—æ³•ä¹Ÿä¸èƒ½ä½¿æµçªå‘ï¼ˆburstï¼‰åˆ°ç«¯å£é€Ÿç‡ã€‚å› æ­¤ï¼Œ<strong>æ¼æ¡¶ç®—æ³•å¯¹äºå­˜åœ¨çªå‘ç‰¹æ€§çš„æµé‡æ¥è¯´ç¼ºä¹æ•ˆç‡</strong>ã€‚</p>
<p><strong>æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰åœ¨å¤„ç†çªå‘ï¼ˆburstyï¼‰æµé‡æ—¶ï¼Œæ— æ³•çµæ´»åº”å¯¹çŸ­æ—¶é—´å†…çš„å¤§é‡è¯·æ±‚ï¼Œå®¹æ˜“é€ æˆä¸å¿…è¦çš„æ‹’ç»æˆ–å»¶è¿Ÿï¼Œä»è€Œé™ä½ç³»ç»Ÿå¯¹åˆæ³•çªå‘æµé‡çš„åˆ©ç”¨ç‡å’Œå“åº”æ•ˆç‡ã€‚</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112003939773.png" alt="image-20260112003939773"></p>
<h6 id="ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆé‡ç‚¹ï¼‰"><a href="#ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆé‡ç‚¹ï¼‰"></a>ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆé‡ç‚¹ï¼‰</h6><p><strong>SpringCloudé»˜è®¤ä½¿ç”¨è¯¥ç®—æ³•</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112004632214.png" alt="image-20260112004632214"></p>
<h6 id="æ»šåŠ¨æ—¶é—´çª—å£"><a href="#æ»šåŠ¨æ—¶é—´çª—å£" class="headerlink" title="æ»šåŠ¨æ—¶é—´çª—å£"></a>æ»šåŠ¨æ—¶é—´çª—å£</h6><p>å…è®¸å›ºå®šæ•°é‡çš„è¯·æ±‚è¿›å…¥(æ¯”å¦‚1ç§’å–4ä¸ªæ•°æ®ç›¸åŠ ï¼Œè¶…è¿‡25å€¼å°±over)è¶…è¿‡æ•°é‡å°±æ‹’ç»æˆ–è€…æ’é˜Ÿï¼Œç­‰ä¸‹ä¸€ä¸ªæ—¶é—´æ®µè¿›å…¥ã€‚</p>
<p>ç”±äºæ˜¯åœ¨ä¸€ä¸ªæ—¶é—´é—´éš”å†…è¿›è¡Œé™åˆ¶ï¼Œå¦‚æœç”¨æˆ·åœ¨ä¸Šä¸ªæ—¶é—´é—´éš”ç»“æŸå‰è¯·æ±‚ï¼ˆä½†æ²¡æœ‰è¶…è¿‡é™åˆ¶ï¼‰ï¼ŒåŒæ—¶åœ¨å½“å‰æ—¶é—´é—´éš”åˆšå¼€å§‹è¯·æ±‚ï¼ˆåŒæ ·æ²¡è¶…è¿‡é™åˆ¶ï¼‰ï¼Œåœ¨å„è‡ªçš„æ—¶é—´é—´éš”å†…ï¼Œè¿™äº›è¯·æ±‚éƒ½æ˜¯æ­£å¸¸çš„ã€‚ä¸‹å›¾ç»Ÿè®¡äº†3æ¬¡ï¼Œbutâ€¦â€¦</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112004801480.png" alt="image-20260112004801480"></p>
<p><strong>ç¼ºç‚¹ï¼šé—´éš”ä¸´ç•Œçš„ä¸€æ®µæ—¶é—´å†…çš„è¯·æ±‚å°±ä¼šè¶…è¿‡ç³»ç»Ÿé™åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«å‹å®</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112004851173.png" alt="image-20260112004851173"></p>
<p>å‡å¦‚è®¾å®š1åˆ†é’Ÿæœ€å¤šå¯ä»¥è¯·æ±‚100æ¬¡æŸä¸ªæ¥å£ï¼Œå¦‚12:00:00-12:00:59æ—¶é—´æ®µå†…æ²¡æœ‰æ•°æ®è¯·æ±‚ä½†12:00:59-12:01:00æ—¶é—´æ®µå†…çªç„¶å¹¶å‘100æ¬¡è¯·æ±‚ï¼Œç´§æ¥ç€ç¬é—´è·¨å…¥ä¸‹ä¸€ä¸ªè®¡æ•°å‘¨æœŸè®¡æ•°å™¨æ¸…é›¶ï¼›åœ¨12:01:00-12:01:01å†…åˆæœ‰100æ¬¡è¯·æ±‚ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´åœ¨æ—¶é—´ä¸´ç•Œç‚¹å·¦å³å¯èƒ½åŒæ—¶æœ‰2å€çš„å³°å€¼è¿›è¡Œè¯·æ±‚ï¼Œä»è€Œé€ æˆåå°å¤„ç†è¯·æ±‚<strong>åŠ å€è¿‡è½½</strong>çš„bugï¼Œå¯¼è‡´ç³»ç»Ÿè¿è¥èƒ½åŠ›ä¸è¶³ï¼Œç”šè‡³å¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œ/(ã„’oã„’)/~~</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‡è®¾é™æµæ˜¯ 100 äºº/åˆ†é’Ÿã€‚</span><br><span class="line">00:59 ç§’ï¼š 100 äººå†²è¿›æ¥ã€‚æ»šåŠ¨çª—å£ä¿å®‰çœ‹äº†ä¸€çœ¼è¡¨ï¼šâ€œå—¯ï¼Œè¿™ä¸€åˆ†é’Ÿæ­£å¥½ 100 äººï¼Œå‡†å…¥ï¼â€</span><br><span class="line">01:00 ç§’ï¼š çª—å£é‡ç½®ï¼Œè®¡æ•°å™¨æ¸…é›¶ã€‚</span><br><span class="line">01:01 ç§’ï¼š åˆå†²è¿›æ¥ 100 äººã€‚æ»šåŠ¨çª—å£ä¿å®‰åˆçœ‹äº†ä¸€çœ¼è¡¨ï¼šâ€œè¿™ä¸€åˆ†é’Ÿåˆšå¼€å§‹ï¼Œç°åœ¨æ‰ 100 äººï¼Œå‡†å…¥ï¼â€</span><br><span class="line">ç»“æœï¼š ä¿å®‰åœ¨ 2 ç§’å†…æ”¾è¿›äº† 200 äººã€‚åç«¯æœåŠ¡å™¨ç›´æ¥è¢«å‹å®äº†ã€‚</span><br></pre></td></tr></table></figure>
<h6 id="æ»‘åŠ¨æ—¶é—´çª—å£"><a href="#æ»‘åŠ¨æ—¶é—´çª—å£" class="headerlink" title="æ»‘åŠ¨æ—¶é—´çª—å£"></a>æ»‘åŠ¨æ—¶é—´çª—å£</h6><p>æ»‘åŠ¨æ—¶é—´çª—å£ï¼ˆsliding time windowï¼‰</p>
<p>é¡¾åæ€ä¹‰ï¼Œè¯¥æ—¶é—´çª—å£æ˜¯æ»‘åŠ¨çš„ã€‚æ‰€ä»¥ï¼Œä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹é¢çš„æ¦‚å¿µéœ€è¦ç†è§£ï¼š </p>
<p>- çª—å£ï¼šéœ€è¦å®šä¹‰çª—å£çš„å¤§å°</p>
<p>- æ»‘åŠ¨ï¼šéœ€è¦å®šä¹‰åœ¨çª—å£ä¸­æ»‘åŠ¨çš„å¤§å°ï¼Œä½†ç†è®ºä¸Šè®²æ»‘åŠ¨çš„å¤§å°ä¸èƒ½è¶…è¿‡çª—å£å¤§å°</p>
<p>æ»‘åŠ¨çª—å£ç®—æ³•æ˜¯æŠŠå›ºå®šæ—¶é—´ç‰‡è¿›è¡Œåˆ’åˆ†å¹¶ä¸”éšç€æ—¶é—´ç§»åŠ¨ï¼Œç§»åŠ¨æ–¹å¼ä¸ºå¼€å§‹æ—¶é—´ç‚¹å˜ä¸ºæ—¶é—´åˆ—è¡¨ä¸­çš„ç¬¬2ä¸ªæ—¶é—´ç‚¹ï¼Œç»“æŸæ—¶é—´ç‚¹å¢åŠ ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œ</p>
<p>ä¸æ–­é‡å¤ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å·§å¦™çš„é¿å¼€è®¡æ•°å™¨çš„ä¸´ç•Œç‚¹çš„é—®é¢˜ã€‚ä¸‹å›¾ç»Ÿè®¡äº†5æ¬¡</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112013020379.png" alt="image-20260112013020379"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ»‘åŠ¨çª—å£ï¼šé‚£ä¸ªâ€œæ—¶åˆ»è­¦æƒ•â€çš„ä¿å®‰</span><br><span class="line">å‡è®¾é™æµä¾ç„¶æ˜¯ 100 äºº/åˆ†é’Ÿï¼Œä½†æˆ‘ä»¬ç”¨æ»‘åŠ¨çª—å£ï¼ˆæ¯ç§’ç§»åŠ¨ä¸€æ¬¡ï¼‰ã€‚</span><br><span class="line">00:59 ç§’ï¼š 100 äººå†²è¿›æ¥ã€‚ä¿å®‰çœ‹äº†ä¸€ä¸‹è¿‡å» 60 ç§’ï¼ˆ00:00-01:00ï¼‰ï¼Œæ­£å¥½ 100 äººï¼Œå‡†å…¥ã€‚</span><br><span class="line">01:00 ç§’ï¼š ä¿å®‰çš„çª—å£ç§»åŠ¨äº†ï¼Œç°åœ¨çœ‹çš„æ˜¯ï¼ˆ00:01-01:01ï¼‰ã€‚</span><br><span class="line">01:01 ç§’ï¼š åˆæœ‰ 1 äººæƒ³å†²è¿›æ¥ã€‚</span><br><span class="line">å…³é”®æ—¶åˆ»ï¼š ä¿å®‰ä½å¤´çœ‹è¡¨ï¼Œå‘ç° 00:01 åˆ° 01:01 è¿™è¿‡å»çš„ä¸€åˆ†é’Ÿé‡Œï¼Œå·²ç»æœ‰ 100 äººäº†ï¼</span><br><span class="line">ä¿å®‰ååº”ï¼š â€œåœï¼è¿™ 1 åˆ†é’Ÿåé¢æ»¡äº†ï¼Œä½ ä¸èƒ½è¿›å»ï¼â€ï¼ˆç›´æ¥ä¸¢å¼ƒè¯·æ±‚æˆ–æŠ¥ 429 é”™è¯¯ï¼‰ã€‚</span><br></pre></td></tr></table></figure>
<h5 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h5><p><code>cloud-provider-payment8001</code>æ”¯ä»˜å¾®æœåŠ¡ ä¿®æ”¹<code>PayCircuitController</code>æ–°å¢<code>myRatelimit</code>æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//=========Resilience4j ratelimit çš„ä¾‹å­</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/ratelimit/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myRatelimit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, myRatelimitæ¬¢è¿åˆ°æ¥ inputId:  &quot;</span>+id+<span class="string">&quot; \t &quot;</span> + IdUtil.simpleUUID();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>PayFeignApiæ¥å£æ–°å¢é™æµapiæ–¹æ³•</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Resilience4j Ratelimit çš„ä¾‹å­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/ratelimit/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myRatelimit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ <code>cloud-consumer-feign-order80</code></p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--resilience4j-ratelimiter--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-ratelimiter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>YML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####resilience4j ratelimiter é™æµçš„ä¾‹å­</span></span><br><span class="line"><span class="attr">resilience4j:</span></span><br><span class="line">  <span class="attr">ratelimiter:</span></span><br><span class="line">    <span class="attr">configs:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">limitForPeriod:</span> <span class="number">2</span> <span class="comment">#åœ¨ä¸€æ¬¡åˆ·æ–°å‘¨æœŸå†…ï¼Œå…è®¸æ‰§è¡Œçš„æœ€å¤§è¯·æ±‚æ•°</span></span><br><span class="line">        <span class="attr">limitRefreshPeriod:</span> <span class="string">1s</span> <span class="comment"># é™æµå™¨æ¯éš”limitRefreshPeriodåˆ·æ–°ä¸€æ¬¡ï¼Œå°†å…è®¸å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°é‡é‡ç½®ä¸ºlimitForPeriod</span></span><br><span class="line">        <span class="attr">timeout-duration:</span> <span class="number">1</span> <span class="comment"># çº¿ç¨‹ç­‰å¾…æƒé™çš„é»˜è®¤ç­‰å¾…æ—¶é—´</span></span><br><span class="line">    <span class="attr">instances:</span></span><br><span class="line">        <span class="attr">cloud-payment-service:</span></span><br><span class="line">          <span class="attr">baseConfig:</span> <span class="string">default</span></span><br></pre></td></tr></table></figure>
<p>orderçš„controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/feign/pay/ratelimit/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@RateLimiter(name = &quot;cloud-payment-service&quot;,fallbackMethod = &quot;myRatelimitFallback&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myBulkhead</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> payFeignApi.myRatelimit(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">myRatelimitFallback</span><span class="params">(Integer id,Throwable t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ä½ è¢«é™æµäº†ï¼Œç¦æ­¢è®¿é—®/(ã„’oã„’)/~~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="8ã€Sleuth-Micrometer-ZipKinåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª"><a href="#8ã€Sleuth-Micrometer-ZipKinåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª" class="headerlink" title="8ã€Sleuth(Micrometer)+ZipKinåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª"></a>8ã€Sleuth(Micrometer)+ZipKinåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</h1><h2 id="âŒï¸Sleuthç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼"><a href="#âŒï¸Sleuthç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼" class="headerlink" title="âŒï¸Sleuthç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼"></a>âŒï¸Sleuthç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼</h2><p><strong>Sleuthæœªæ¥æ›¿æ¢æ–¹æ¡ˆï¼šMicrometer Tracing</strong></p>
<h2 id="åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæ¦‚è¿°"><a href="#åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæ¦‚è¿°" class="headerlink" title="åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæ¦‚è¿°"></a>åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæ¦‚è¿°</h2><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªæŠ€æœ¯ï¼Œéœ€è¦è§£å†³ä»€ä¹ˆé—®é¢˜</p>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨å¾®æœåŠ¡æ¡†æ¶ä¸­ï¼Œä¸€ä¸ªç”±å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚åœ¨åç«¯ç³»ç»Ÿä¸­ä¼šç»è¿‡å¤šä¸ªä¸åŒçš„çš„æœåŠ¡èŠ‚ç‚¹è°ƒç”¨æ¥ååŒäº§ç”Ÿæœ€åçš„è¯·æ±‚ç»“æœï¼Œæ¯ä¸€ä¸ªå‰æ®µè¯·æ±‚éƒ½ä¼šå½¢æˆä¸€æ¡å¤æ‚çš„åˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨é“¾è·¯ï¼Œé“¾è·¯ä¸­çš„ä»»ä½•ä¸€ç¯å‡ºç°é«˜å»¶æ—¶æˆ–é”™è¯¯éƒ½ä¼šå¼•èµ·æ•´ä¸ªè¯·æ±‚æœ€åçš„å¤±è´¥ã€‚</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112023002044.png" alt="image-20260112023002044"></p>
<p>åœ¨åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³å¦‚ä¸‹é—®é¢˜ï¼š</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å®æ—¶è§‚æµ‹ç³»ç»Ÿçš„æ•´ä½“è°ƒç”¨é“¾è·¯æƒ…å†µã€‚</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å¿«é€Ÿå‘ç°å¹¶å®šä½åˆ°é—®é¢˜ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å°½å¯èƒ½ç²¾ç¡®çš„åˆ¤æ–­æ•…éšœå¯¹ç³»ç»Ÿçš„å½±å“èŒƒå›´ä¸å½±å“ç¨‹åº¦ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å°½å¯èƒ½ç²¾ç¡®çš„æ¢³ç†å‡ºæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶åˆ¤æ–­å‡ºæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»æ˜¯å¦åˆç†ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å°½å¯èƒ½ç²¾ç¡®çš„åˆ†ææ•´ä¸ªç³»ç»Ÿè°ƒç”¨é“¾è·¯çš„æ€§èƒ½ä¸ç“¶é¢ˆç‚¹ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡é›†ç¾¤ä¸‹ï¼Œå¦‚ä½•å°½å¯èƒ½ç²¾ç¡®çš„åˆ†æç³»ç»Ÿçš„å­˜å‚¨ç“¶é¢ˆä¸å®¹é‡è§„åˆ’ã€‚</p>
<p>ä¸Šè¿°é—®é¢˜å°±æ˜¯æˆ‘ä»¬çš„è½åœ°è®®é¢˜ç­”æ¡ˆï¼š</p>
<p>åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæŠ€æœ¯è¦è§£å†³çš„é—®é¢˜ï¼Œåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªï¼ˆDistributed Tracingï¼‰ï¼Œå°±æ˜¯å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚è¿˜åŸæˆè°ƒç”¨é“¾è·¯ï¼Œè¿›è¡Œæ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç›‘æ§å¹¶å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚çš„è°ƒç”¨æƒ…å†µé›†ä¸­å±•ç¤ºã€‚æ¯”å¦‚å„ä¸ªæœåŠ¡èŠ‚ç‚¹ä¸Šçš„è€—æ—¶ã€è¯·æ±‚å…·ä½“åˆ°è¾¾å“ªå°æœºå™¨ä¸Šã€æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹çš„è¯·æ±‚çŠ¶æ€ç­‰ç­‰ã€‚</p>
<h2 id="Micrometer-Tracing"><a href="#Micrometer-Tracing" class="headerlink" title="Micrometer Tracing"></a>Micrometer Tracing</h2><h3 id="zipkinæ˜¯å•¥"><a href="#zipkinæ˜¯å•¥" class="headerlink" title="zipkinæ˜¯å•¥"></a>zipkinæ˜¯å•¥</h3><p>Spring Cloud Sleuth (micrometer)æä¾›äº†ä¸€å¥—å®Œæ•´çš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªè§£å†³æ–¹æ¡ˆä¸”å…¼å®¹æ”¯æŒäº†zipkinå±•ç°</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112140645022.png" alt="image-20260112140645022"></p>
<p>Sleuthè´Ÿè´£æ”¶é›†ï¼Œzipkinè´Ÿè´£å±•ç°</p>
<h3 id="å°æ€»ç»“-2"><a href="#å°æ€»ç»“-2" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h3><p>å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚è¿˜åŸæˆè°ƒç”¨é“¾è·¯ï¼Œè¿›è¡Œæ—¥å¿—è®°å½•å’Œæ€§èƒ½ç›‘æ§ï¼Œå¹¶å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚çš„è°ƒç”¨æƒ…å†µé›†ä¸­webå±•ç¤ºã€‚</p>
<p>è¡Œä¸šå†…æ¯”è¾ƒæˆç†Ÿçš„å…¶ä»–åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæŠ€æœ¯è§£å†³æ–¹æ¡ˆ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112140902801.png" alt="image-20260112140902801"></p>
<p>å¦‚æœä¸æƒ³ç”¨ zipkin æ¨èç”¨ skywalking</p>
<h3 id="åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåŸç†"><a href="#åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåŸç†" class="headerlink" title="åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåŸç†"></a>åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåŸç†</h3><p><strong>å‡å®š3ä¸ªå¾®æœåŠ¡è°ƒç”¨é“¾è·¯</strong></p>
<p>Service1 è°ƒç”¨ 2ï¼Œ2è°ƒç”¨3å’Œ4</p>
<p>ä¸Šä¸€æ­¥çš„å®Œæ•´çš„è°ƒç”¨é“¾è·¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é‚£ä¹ˆä¸€æ¡é“¾è·¯è¿½è¸ªä¼šåœ¨æ¯ä¸ªæœåŠ¡è°ƒç”¨çš„æ—¶å€™åŠ ä¸ŠTrace ID å’Œ Span ID</span><br><span class="line">é“¾è·¯é€šè¿‡TraceIdå”¯ä¸€æ ‡è¯†ï¼Œ</span><br><span class="line">Spanæ ‡è¯†å‘èµ·çš„è¯·æ±‚ä¿¡æ¯ï¼Œå„spané€šè¿‡parent id å…³è”èµ·æ¥ (Span:è¡¨ç¤ºè°ƒç”¨é“¾è·¯æ¥æºï¼Œé€šä¿—çš„ç†è§£spanå°±æ˜¯ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112143807061.png" alt="image-20260112143807061"></p>
<p>ä¸Šé¢éƒ½æ˜¯è¯·æ±‚ï¼Œä¸‹é¢éƒ½æ˜¯å“åº”ã€‚</p>
<p>ç®€åŒ–å›¾ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112144357391.png" alt="image-20260112144357391"></p>
<p>ä¸€æ¡é“¾è·¯é€šè¿‡Trace Idå”¯ä¸€æ ‡è¯†ï¼ŒSpanæ ‡è¯†å‘èµ·çš„è¯·æ±‚ä¿¡æ¯ï¼Œå„spané€šè¿‡parent id å…³è”èµ·æ¥</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹åºå·</th>
<th>Span ID</th>
<th>Parent ID</th>
<th>èŠ‚ç‚¹æè¿°</th>
<th>æ¶‰åŠæœåŠ¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>null</td>
<td>Service 1 æ¥æ”¶åˆ°è¯·æ±‚</td>
<td>Service 1</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>A</td>
<td>Service 1 å‘é€è¯·æ±‚åˆ° Service 2 è¿”å›å“åº”ç»™ Service 1 çš„è¿‡ç¨‹</td>
<td>Service 1ã€Service 2</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>B</td>
<td>Service 2 çš„ä¸­é—´è§£å†³è¿‡ç¨‹</td>
<td>Service 2</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>C</td>
<td>Service 2 å‘é€è¯·æ±‚åˆ° Service 3 è¿”å›å“åº”ç»™ Service 2 çš„è¿‡ç¨‹</td>
<td>Service 2ã€Service 3</td>
</tr>
<tr>
<td>5</td>
<td>E</td>
<td>D</td>
<td>Service 3 çš„ä¸­é—´è§£å†³è¿‡ç¨‹</td>
<td>Service 3</td>
</tr>
<tr>
<td>6</td>
<td>F</td>
<td>C</td>
<td>Service 3 å‘é€è¯·æ±‚åˆ° Service 4 è¿”å›å“åº”ç»™ Service 3 çš„è¿‡ç¨‹</td>
<td>Service 3ã€Service 4</td>
</tr>
<tr>
<td>7</td>
<td>G</td>
<td>F</td>
<td>Service 4 çš„ä¸­é—´è§£å†³è¿‡ç¨‹</td>
<td>Service 4</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Zipkin"><a href="#Zipkin" class="headerlink" title="Zipkin"></a>Zipkin</h3><p>Zipkinæ˜¯ä¸€ç§åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿå›¾å½¢åŒ–çš„å·¥å…·ï¼ŒZipkin æ˜¯ Twitter å¼€æºçš„åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿï¼Œèƒ½å¤Ÿæ”¶é›†å¾®æœåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­çš„å®æ—¶è°ƒç”¨é“¾è·¯ä¿¡æ¯ï¼Œå¹¶èƒ½å¤Ÿå°†è¿™äº›è°ƒç”¨é“¾è·¯ä¿¡æ¯å±•ç¤ºåˆ°Webå›¾å½¢åŒ–ç•Œé¢ä¸Šä¾›å¼€å‘äººå‘˜åˆ†æï¼Œå¼€å‘äººå‘˜èƒ½å¤Ÿä»ZipKinä¸­åˆ†æå‡ºè°ƒç”¨é“¾è·¯ä¸­çš„æ€§èƒ½ç“¶é¢ˆï¼Œè¯†åˆ«å‡ºå­˜åœ¨é—®é¢˜çš„åº”ç”¨ç¨‹åºï¼Œè¿›è€Œå®šä½é—®é¢˜å’Œè§£å†³é—®é¢˜ã€‚</p>
<h4 id="ä¸‹è½½-å®‰è£…-è¿è¡Œ"><a href="#ä¸‹è½½-å®‰è£…-è¿è¡Œ" class="headerlink" title="ä¸‹è½½+å®‰è£…+è¿è¡Œ"></a>ä¸‹è½½+å®‰è£…+è¿è¡Œ</h4><h5 id="ä¸‹è½½èŒä¸š"><a href="#ä¸‹è½½èŒä¸š" class="headerlink" title="ä¸‹è½½èŒä¸š"></a>ä¸‹è½½èŒä¸š</h5><p><code>https://zipkin.io/pages/quickstart</code></p>
<p>æ”¯æŒ3ä¸ªæ–¹å¼</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112145627177.png" alt="image-20260112145627177"></p>
<p>2023.12ï¼Œç‰ˆæœ¬åç§°</p>
<p>zipkin-server-3.0.0-rc0-exec.jar</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–¹å¼1ï¼šç›´æ¥ä¸‹è½½æŒ‡å®šç‰ˆæœ¬JARåŒ…ï¼ˆæ¨èï¼Œè·³è¿‡é»˜è®¤è„šæœ¬çš„ç‰ˆæœ¬è‡ªåŠ¨é€‰æ‹©ï¼‰</span></span><br><span class="line">curl -sSL -o zipkin-server-3.0.0-rc0-exec.jar https://repo1.maven.org/maven2/io/zipkin/zipkin-server/3.0.0-rc0/zipkin-server-3.0.0-rc0-exec.jar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–¹å¼2ï¼šå¯åŠ¨æŒ‡å®šç‰ˆæœ¬çš„Zipkin</span></span><br><span class="line">java -jar zipkin-server-3.0.0-rc0-exec.jar</span><br></pre></td></tr></table></figure>
<h4 id="Micrometer-ZipKinæ­å»ºé“¾è·¯ç›‘æ§æ¡ˆä¾‹æ­¥éª¤"><a href="#Micrometer-ZipKinæ­å»ºé“¾è·¯ç›‘æ§æ¡ˆä¾‹æ­¥éª¤" class="headerlink" title="Micrometer+ZipKinæ­å»ºé“¾è·¯ç›‘æ§æ¡ˆä¾‹æ­¥éª¤"></a>Micrometer+ZipKinæ­å»ºé“¾è·¯ç›‘æ§æ¡ˆä¾‹æ­¥éª¤</h4><p>Micrometer æ•°æ®é‡‡æ ·</p>
<p>ZipKin å›¾å½¢å±•ç¤º</p>
<h5 id="æ­¥éª¤-4"><a href="#æ­¥éª¤-4" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h5><p><strong>æ€»ä½“POMçˆ¶å·¥ç¨‹</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--micrometer-tracing-bomå¯¼å…¥é“¾è·¯è¿½è¸ªç‰ˆæœ¬ä¸­å¿ƒ  1--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bom<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--micrometer-tracingæŒ‡æ ‡è¿½è¸ª  2--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--micrometer-tracing-bridge-braveé€‚é…zipkinçš„æ¡¥æ¥åŒ… 3--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--micrometer-observation 4--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-observation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-observation.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--feign-micrometer 5--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-micrometer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;feign-micrometer.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--zipkin-reporter-brave 6--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.reporter2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-reporter-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;zipkin-reporter-brave.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>è¿™äº› jar åŒ…ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<p>ç”±äºMicrometer Tracingæ˜¯ä¸€ä¸ªé—¨é¢å·¥å…·è‡ªèº«å¹¶æ²¡æœ‰å®ç°å®Œæ•´çš„é“¾è·¯è¿½è¸ªç³»ç»Ÿï¼Œå…·ä½“çš„é“¾è·¯è¿½è¸ªå¦å¤–éœ€è¦å¼•å…¥çš„æ˜¯ç¬¬ä¸‰æ–¹é“¾è·¯è¿½è¸ªç³»ç»Ÿçš„ä¾èµ–ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åºå·</th>
<th>ç»„ä»¶åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>micrometer-tracing-bom</code></td>
<td>å¯¼å…¥é“¾è·¯è¿½è¸ªçš„ç‰ˆæœ¬ä¸­å¿ƒï¼ˆBill of Materialsï¼‰ï¼Œç”¨äºç»Ÿä¸€ç®¡ç† Micrometer Tracing ç›¸å…³ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå®ç°ä½“ç³»åŒ–çš„ä¾èµ–ç®¡ç†ã€‚</td>
</tr>
<tr>
<td>2</td>
<td><code>micrometer-tracing</code></td>
<td>æä¾›åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæŠ½è±¡å’ŒåŸºç¡€èƒ½åŠ›ï¼Œæ˜¯ Micrometer ç”Ÿæ€ä¸­ç”¨äºè·Ÿè¸ªï¼ˆTracingï¼‰çš„ä¸»æ¨¡å—ã€‚</td>
</tr>
<tr>
<td>3</td>
<td><code>micrometer-tracing-bridge-brave</code></td>
<td>Micrometer çš„æ¡¥æ¥æ¨¡å—ï¼Œç”¨äºä¸åˆ†å¸ƒå¼è¿½è¸ªå·¥å…· <strong>Brave</strong> é›†æˆã€‚Brave æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªåº“ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­ä¼ é€’â€œè·Ÿè¸ªä¸Šä¸‹æ–‡â€ï¼ˆTrace Contextï¼‰ï¼Œè®°å½•è¯·æ±‚åœ¨å„æœåŠ¡é—´çš„æµè½¬è·¯å¾„ã€è€—æ—¶ç­‰ä¿¡æ¯ï¼Œå®ç°ç«¯åˆ°ç«¯çš„é“¾è·¯è¿½è¸ªã€‚</td>
</tr>
<tr>
<td>4</td>
<td><code>micrometer-observation</code></td>
<td>åŸºäº Micrometer çš„è§‚æµ‹ï¼ˆObservationï¼‰æ¨¡å—ï¼Œæä¾›ç»Ÿä¸€çš„ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºæ”¶é›†æŒ‡æ ‡ï¼ˆMetricsï¼‰ã€æ—¥å¿—ï¼ˆLogsï¼‰å’Œè¿½è¸ªï¼ˆTracesï¼‰ç­‰å¯è§‚æµ‹æ€§æ•°æ®ã€‚</td>
</tr>
<tr>
<td>5</td>
<td><code>feign-micrometer</code></td>
<td>ä¸º Feign HTTP å®¢æˆ·ç«¯æä¾›çš„ Micrometer é›†æˆæ¨¡å—ï¼Œè‡ªåŠ¨æ”¶é›† Feign å‘èµ·çš„è¿œç¨‹è°ƒç”¨çš„æŒ‡æ ‡å’Œè¿½è¸ªæ•°æ®ï¼ˆå¦‚è¯·æ±‚æ¬¡æ•°ã€å»¶è¿Ÿã€æˆåŠŸç‡ç­‰ï¼‰ã€‚</td>
</tr>
<tr>
<td>6</td>
<td><code>zipkin-reporter-brave</code></td>
<td>å°† Brave é‡‡é›†çš„åˆ†å¸ƒå¼è¿½è¸ªæ•°æ®ä¸ŠæŠ¥åˆ° <strong>Zipkin</strong> å¯è§†åŒ–è¿½è¸ªç³»ç»Ÿçš„æŠ¥å‘Šå™¨ï¼ˆReporterï¼‰åº“ï¼Œå®ç°è¿½è¸ªæ•°æ®çš„é›†ä¸­å­˜å‚¨ä¸å±•ç¤ºã€‚</td>
</tr>
</tbody>
</table>
</div>
<p>è¡¥å……åŒ…ï¼šspring-boot-starter-actuator  SpringBootæ¡†æ¶çš„ä¸€ä¸ªæ¨¡å—ç”¨äºç›‘è§†å’Œç®¡ç†åº”ç”¨ç¨‹åº</p>
<p>è‹¥æ˜¯æ²¡æœ‰ä½¿ç”¨çˆ¶å·¥ç¨‹çš„è¦æ·»åŠ å¼€å¯spring bootç›‘æ§å’Œç®¡ç†å·¥å…·çš„ä¾èµ–</p>
<p><strong>æ€»POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"> æœç´¢</span><br><span class="line"></span><br><span class="line">ä¾¿ç¬º</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mscloudV6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>cloud-provider-payment8001<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>cloud-consumer-order80<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>cloud-provider-payment8002<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>cloud-consumer-feign-order80<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hutool.version</span>&gt;</span>5.8.22<span class="tag">&lt;/<span class="name">hutool.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lombok.version</span>&gt;</span>1.18.26<span class="tag">&lt;/<span class="name">lombok.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.1.20<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis.springboot.version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">mybatis.springboot.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.11<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">swagger3.version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">swagger3.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper.version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">mapper.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fastjson2.version</span>&gt;</span>2.0.41<span class="tag">&lt;/<span class="name">fastjson2.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">persistence-api.version</span>&gt;</span>1.0.2<span class="tag">&lt;/<span class="name">persistence-api.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.boot.test.version</span>&gt;</span>3.1.5<span class="tag">&lt;/<span class="name">spring.boot.test.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.boot.version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">spring.boot.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.cloud.version</span>&gt;</span>2023.0.0<span class="tag">&lt;/<span class="name">spring.cloud.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.cloud.alibaba.version</span>&gt;</span>2022.0.0.0-RC2<span class="tag">&lt;/<span class="name">spring.cloud.alibaba.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">micrometer-tracing.version</span>&gt;</span>1.2.0<span class="tag">&lt;/<span class="name">micrometer-tracing.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">micrometer-observation.version</span>&gt;</span>1.12.0<span class="tag">&lt;/<span class="name">micrometer-observation.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">feign-micrometer.version</span>&gt;</span>12.5<span class="tag">&lt;/<span class="name">feign-micrometer.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">zipkin-reporter-brave.version</span>&gt;</span>2.17.0<span class="tag">&lt;/<span class="name">zipkin-reporter-brave.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springboot 3.2.0--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springcloud 2023.0.0--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--springcloud alibaba 2022.0.0.0-RC2--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.cloud.alibaba.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SpringBooté›†æˆmybatis--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.springboot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--Mysqlæ•°æ®åº“é©±åŠ¨8 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SpringBooté›†æˆdruidè¿æ¥æ± --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--é€šç”¨Mapper4ä¹‹tk.mybatis--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapper.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;persistence-api.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- fastjson2 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.40<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;swagger3.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hutool.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;lombok.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- spring-boot-starter-test --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.boot.test.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--micrometer-tracing-bomå¯¼å…¥é“¾è·¯è¿½è¸ªç‰ˆæœ¬ä¸­å¿ƒ  1--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bom<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--micrometer-tracingæŒ‡æ ‡è¿½è¸ª  2--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--micrometer-tracing-bridge-braveé€‚é…zipkinçš„æ¡¥æ¥åŒ… 3--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-tracing.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--micrometer-observation 4--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-observation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;micrometer-observation.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--feign-micrometer 5--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-micrometer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;feign-micrometer.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--zipkin-reporter-brave 6--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.reporter2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-reporter-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;zipkin-reporter-brave.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶å€™Aè°ƒç”¨Bï¼Œæœ‰æ—¶å€™Bè°ƒç”¨Aæ‰€ä»¥æœ€å¥½ä¸¤ä¸ªéƒ½åŠ ä¸Šã€‚ä½†æ˜¯è¿™æ¬¡æ˜¯å•å‘ï¼Œ80 è°ƒç”¨ 8001</p>
<p><strong>æœåŠ¡æä¾›è€…8001</strong></p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-provider-payment8001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-tracingæŒ‡æ ‡è¿½è¸ª  1--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-tracing-bridge-braveé€‚é…zipkinçš„æ¡¥æ¥åŒ… 2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-observation 3--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-observation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--feign-micrometer 4--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-micrometer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--zipkin-reporter-brave 5--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.reporter2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-reporter-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringCloud consul config--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringCloud consul discovery --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté€šç”¨ä¾èµ–æ¨¡å—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté›†æˆdruidè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatiså’Œspringbootæ•´åˆ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Mysqlæ•°æ®åº“é©±åŠ¨8 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--persistence--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.persistence<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>persistence-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨Mapper4--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- fastjson2 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ–°å»ºä¸šåŠ¡ç±»PayMicrometerController</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayMicrometerController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Micrometer(Sleuth)è¿›è¡Œé“¾è·¯ç›‘æ§çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/micrometer/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myMicrometer</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, æ¬¢è¿åˆ°æ¥myMicrometer inputId:  &quot;</span>+id+<span class="string">&quot; \t    æœåŠ¡è¿”å›:&quot;</span> + IdUtil.simpleUUID();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Apiæ¥å£PayFeignApi</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-payment-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PayFeignApi</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢ä¸€æ¡æ”¯ä»˜ç›¸å…³æµæ°´è®°å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> payDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/pay/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">addPay</span><span class="params">(<span class="meta">@RequestBody</span> PayDTO payDTO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ä¸»é”®è®°å½•æŸ¥è¯¢æ”¯ä»˜æµæ°´ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/pay/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * openfeignå¤©ç„¶æ”¯æŒè´Ÿè½½å‡è¡¡æ¼”ç¤º</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/get/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">mylb</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Resilience4j CircuitBreaker çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/circuit/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myCircuit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Resilience4j Bulkhead çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/bulkhead/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myBulkhead</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Resilience4j Ratelimit çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/ratelimit/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myRatelimit</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Micrometer(Sleuth)è¿›è¡Œé“¾è·¯ç›‘æ§çš„ä¾‹å­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/micrometer/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myMicrometer</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>æœåŠ¡è°ƒç”¨è€…80</strong></p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--micrometer-tracingæŒ‡æ ‡è¿½è¸ª  1--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--micrometer-tracing-bridge-braveé€‚é…zipkinçš„æ¡¥æ¥åŒ… 2--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--micrometer-observation 3--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-observation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--feign-micrometer 4--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-micrometer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--zipkin-reporter-brave 5--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.reporter2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-reporter-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ€»POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"> æœç´¢</span><br><span class="line"></span><br><span class="line">ä¾¿ç¬º</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mscloudV6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-consumer-feign-order80<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-tracingæŒ‡æ ‡è¿½è¸ª  1--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-tracing-bridge-braveé€‚é…zipkinçš„æ¡¥æ¥åŒ… 2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-tracing-bridge-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--micrometer-observation 3--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-observation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--feign-micrometer 4--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-micrometer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--zipkin-reporter-brave 5--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.reporter2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-reporter-brave<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--resilience4j-ratelimiter--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-ratelimiter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--resilience4j-bulkhead--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-bulkhead<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--resilience4j-circuitbreaker--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-circuitbreaker-resilience4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ç”±äºæ–­è·¯ä¿æŠ¤ç­‰éœ€è¦AOPå®ç°ï¼Œæ‰€ä»¥å¿…é¡»å¯¼å…¥AOPåŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- httpclient5--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents.client5<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- feign-hc5--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-hc5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--openfeign--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringCloud consul discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--web + actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool-all--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--fastjson2--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- swagger3 è°ƒç”¨æ–¹å¼ http://ä½ çš„ä¸»æœºIPåœ°å€:5555/swagger-ui/index.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>yml</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># zipkinå›¾å½¢å±•ç°åœ°å€å’Œé‡‡æ ·ç‡è®¾ç½®</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">zipkin:</span></span><br><span class="line">    <span class="attr">tracing:</span></span><br><span class="line">      <span class="attr">endpoint:</span> <span class="string">http://localhost:9411/api/v2/spans</span></span><br><span class="line">  <span class="attr">tracing:</span></span><br><span class="line">    <span class="attr">sampling:</span></span><br><span class="line">      <span class="attr">probability:</span> <span class="number">1.0</span> <span class="comment">#é‡‡æ ·ç‡é»˜è®¤ä¸º0.1(0.1å°±æ˜¯10æ¬¡åªèƒ½æœ‰ä¸€æ¬¡è¢«è®°å½•ä¸‹æ¥)ï¼Œå€¼è¶Šå¤§æ”¶é›†è¶ŠåŠæ—¶ã€‚</span></span><br></pre></td></tr></table></figure>
<p><strong>controller</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderMicrometerController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PayFeignApi payFeignApi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/feign/micrometer/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">myMicrometer</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> payFeignApi.myMicrometer(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•</p>
<p>è®¿é—® <code>http://localhost:9411</code> å³å¯</p>
<h1 id="9ã€Gatewayæ–°ä¸€ä»£ç½‘å…³"><a href="#9ã€Gatewayæ–°ä¸€ä»£ç½‘å…³" class="headerlink" title="9ã€Gatewayæ–°ä¸€ä»£ç½‘å…³"></a>9ã€Gatewayæ–°ä¸€ä»£ç½‘å…³</h1><p>æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæœ‰äº†nginxè¿˜è¦æœ‰gatewayï¼Œä¸¤ä¸ªéƒ½è¦ç”¨è¿˜æ˜¯åªç”¨ä¸€ä¸ªï¼Ÿ</p>
<h3 id="æ˜¯ä»€ä¹ˆ-9"><a href="#æ˜¯ä»€ä¹ˆ-9" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h3><p>Gatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„<strong>APIç½‘å…³æœåŠ¡</strong>ï¼ŒåŸºäºSpring6ï¼ŒSpring Boot 3å’ŒProject Reactorç­‰æŠ€æœ¯ã€‚å®ƒæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•æœ‰æ•ˆçš„ç»Ÿä¸€çš„ <strong>API è·¯ç”±ç®¡ç†æ–¹å¼</strong>ï¼Œå¹¶ä¸ºå®ƒä»¬æä¾›è·¨é¢†åŸŸçš„å…³æ³¨ç‚¹ï¼Œä¾‹å¦‚ï¼šå®‰å…¨æ€§ã€ç›‘æ§/åº¦é‡å’Œæ¢å¤èƒ½åŠ›ã€‚</p>
<h4 id="ä½“ç³»å®šä½"><a href="#ä½“ç³»å®šä½" class="headerlink" title="ä½“ç³»å®šä½"></a>ä½“ç³»å®šä½</h4><p>Cloudå…¨å®¶æ¡¶ä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ç»„ä»¶å°±æ˜¯ç½‘å…³ï¼Œåœ¨1.xç‰ˆæœ¬ä¸­éƒ½æ˜¯é‡‡ç”¨çš„Zuulç½‘å…³ï¼›</p>
<p>ä½†åœ¨2.xç‰ˆæœ¬ä¸­ï¼Œzuulçš„å‡çº§ä¸€ç›´è·³ç¥¨ï¼ŒSpringCloudæœ€åè‡ªå·±ç ”å‘äº†ä¸€ä¸ªç½‘å…³SpringCloud Gatewayæ›¿ä»£Zuulï¼Œ</p>
<p>é‚£å°±æ˜¯SpringCloud Gatewayä¸€å¥è¯ï¼šgatewayæ˜¯åŸzuul1.xç‰ˆçš„æ›¿ä»£</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112182358045.png" alt="image-20260112182358045"></p>
<h4 id="å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ª"><a href="#å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ª" class="headerlink" title="å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ª"></a>å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ª</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112182429219.png" alt="image-20260112182429219"></p>
<p>è¿™é‡Œçš„è´Ÿè½½å‡è¡¡å°±æ˜¯nginxï¼Œé‚£ä¹ˆè¿™é‡Œåˆä¼šæœ‰ç–‘é—®ï¼Œé‚£ä¹‹å‰çš„loadbalancerä¸ä¹Ÿæ˜¯è´Ÿè½½å‡è¡¡å—ï¼Ÿ</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">ç»„ä»¶</th>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:left">å·¥ä½œä½ç½®</th>
<th style="text-align:left">ä¸»è¦ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Nginx</strong></td>
<td style="text-align:left"><strong>L7 åå‘ä»£ç† + è´Ÿè½½å‡è¡¡å™¨ï¼ˆå¤–éƒ¨/è¾¹ç¼˜å±‚ï¼‰</strong></td>
<td style="text-align:left">å®¢æˆ·ç«¯ â†” å¾®æœåŠ¡é›†ç¾¤ä¹‹é—´ï¼ˆ<strong>å—åŒ—å‘æµé‡</strong>ï¼‰</td>
<td style="text-align:left">å¯¹å¤–ç»Ÿä¸€å…¥å£ï¼Œå°†ç”¨æˆ·è¯·æ±‚åˆ†å‘åˆ°åç«¯å¤šä¸ªå¾®æœåŠ¡å®ä¾‹ï¼ˆå¦‚ <code>user-service</code> çš„å¤šä¸ªèŠ‚ç‚¹ï¼‰</td>
</tr>
<tr>
<td style="text-align:left"><strong>Spring Cloud LoadBalancer</strong></td>
<td style="text-align:left"><strong>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ï¼ˆå†…éƒ¨/æœåŠ¡é—´ï¼‰</strong></td>
<td style="text-align:left">å¾®æœåŠ¡å†…éƒ¨ï¼ˆ<strong>ä¸œè¥¿å‘æµé‡</strong>ï¼‰</td>
<td style="text-align:left">å½“ Service A è°ƒç”¨ Service B æ—¶ï¼Œåœ¨ Service A å†…éƒ¨è‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¥åº·çš„ Service B å®ä¾‹</td>
</tr>
</tbody>
</table>
</div>
<p><strong>OpenFeignä¹Ÿæ˜¯å†…éƒ¨çš„ï¼Œnginxæ˜¯å®¢æˆ·ç«¯è°ƒç”¨å¾®æœåŠ¡é›†ç¾¤ä¹‹é—´çš„</strong></p>
<h4 id="èƒ½å¹²å˜›-4"><a href="#èƒ½å¹²å˜›-4" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h4><ul>
<li><strong>åå‘ä»£ç†</strong></li>
<li><strong>é‰´æƒ</strong></li>
<li><strong>æµé‡æ§åˆ¶</strong></li>
<li><strong>ç†”æ–­</strong></li>
<li><strong>æ—¥å¿—ç›‘æ§</strong></li>
</ul>
<h4 id="å°æ€»ç»“-3"><a href="#å°æ€»ç»“-3" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h4><p>Spring Cloud Gatewayç»„ä»¶çš„æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œé€šè¿‡è¿™äº›è¿‡æ»¤å™¨å¯ä»¥å°†å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚è½¬å‘(è·¯ç”±)åˆ°å¯¹åº”çš„å¾®æœåŠ¡ã€‚ Spring Cloud Gatewayæ˜¯åŠ åœ¨æ•´ä¸ªå¾®æœåŠ¡æœ€å‰æ²¿çš„é˜²ç«å¢™å’Œä»£ç†å™¨ï¼Œéšè—å¾®æœåŠ¡ç»“ç‚¹IPç«¯å£ä¿¡æ¯ï¼Œä»è€ŒåŠ å¼ºå®‰å…¨ä¿æŠ¤ã€‚Spring Cloud Gatewayæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¾®æœåŠ¡ï¼Œéœ€è¦æ³¨å†Œè¿›æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112191929165.png" alt="image-20260112191929165"></p>
<h3 id="Gatewayä¸‰å¤§æ ¸å¿ƒ"><a href="#Gatewayä¸‰å¤§æ ¸å¿ƒ" class="headerlink" title="Gatewayä¸‰å¤§æ ¸å¿ƒ"></a>Gatewayä¸‰å¤§æ ¸å¿ƒ</h3><h4 id="Route-ï¼ˆè·¯ç”±ï¼‰"><a href="#Route-ï¼ˆè·¯ç”±ï¼‰" class="headerlink" title="Route ï¼ˆè·¯ç”±ï¼‰"></a>Route ï¼ˆè·¯ç”±ï¼‰</h4><p>è·¯ç”±æ˜¯æ„å»ºç½‘å…³çš„åŸºæœ¬æ¨¡å—ï¼Œä»–ç”±IDï¼Œç›®æ ‡URIï¼Œä¸€ç³»åˆ—çš„æ–­è¨€å’Œè¿‡æ»¤å™¨ç»„æˆï¼Œå¦‚æœæ–­è¨€ä¸ºtrueåˆ™åŒ¹é…è¯¥è·¯ç”±</p>
<h4 id="Predicateï¼ˆæ–­è¨€ï¼‰"><a href="#Predicateï¼ˆæ–­è¨€ï¼‰" class="headerlink" title="Predicateï¼ˆæ–­è¨€ï¼‰"></a>Predicateï¼ˆæ–­è¨€ï¼‰</h4><p>å‚è€ƒçš„æ˜¯Java8çš„ <code>java.util.function.Predicate</code> å¼€å‘äººå‘˜å¯ä»¥åŒ¹é…HTTPè¯·æ±‚ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ˆä¾‹å¦‚è¯·æ±‚å¤´æˆ–è¯·æ±‚å‚æ•°ï¼‰ï¼Œå¦‚æœè¯·æ±‚ä¸æ–­è¨€ç›¸åŒ¹é…åˆ™è¿›è¡Œè·¯ç”±</p>
<h4 id="Filterï¼ˆè¿‡æ»¤ï¼‰"><a href="#Filterï¼ˆè¿‡æ»¤ï¼‰" class="headerlink" title="Filterï¼ˆè¿‡æ»¤ï¼‰"></a>Filterï¼ˆè¿‡æ»¤ï¼‰</h4><p>æŒ‡çš„æ˜¯Springæ¡†æ¶ä¸­GatewayFilterçš„å®ä¾‹ï¼Œä½¿ç”¨è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±å‰æˆ–è€…ä¹‹åå¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112193322894.png" alt="image-20260112193322894"></p>
<p>webå‰ç«¯è¯·æ±‚ï¼Œé€šè¿‡ä¸€äº›åŒ¹é…æ¡ä»¶ï¼Œå®šä½åˆ°çœŸæ­£çš„æœåŠ¡èŠ‚ç‚¹ã€‚å¹¶åœ¨è¿™ä¸ªè½¬å‘è¿‡ç¨‹çš„å‰åï¼Œè¿›è¡Œä¸€äº›ç²¾ç»†åŒ–æ§åˆ¶ã€‚</p>
<p>predicateå°±æ˜¯æˆ‘ä»¬çš„åŒ¹é…æ¡ä»¶ï¼›</p>
<p>filterï¼Œå°±å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ— æ‰€ä¸èƒ½çš„æ‹¦æˆªå™¨ã€‚æœ‰äº†è¿™ä¸¤ä¸ªå…ƒç´ ï¼Œå†åŠ ä¸Šç›®æ ‡uriï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªå…·ä½“çš„è·¯ç”±äº†</p>
<h3 id="Gatewayå·¥ä½œæµç¨‹"><a href="#Gatewayå·¥ä½œæµç¨‹" class="headerlink" title="Gatewayå·¥ä½œæµç¨‹"></a>Gatewayå·¥ä½œæµç¨‹</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112193513401.png" alt="image-20260112193513401"></p>
<p>å®¢æˆ·ç«¯å‘ Spring Cloud Gateway å‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨ Gateway Handler Mapping ä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ° Gateway Web Handlerã€‚Handler å†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚</p>
<p>è¿‡æ»¤å™¨ä¹‹é—´ç”¨è™šçº¿åˆ†å¼€æ˜¯å› ä¸ºè¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨å‘é€ä»£ç†è¯·æ±‚ä¹‹å‰(Pre)æˆ–ä¹‹å(Post)æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>åœ¨â€œpreâ€ç±»å‹çš„è¿‡æ»¤å™¨å¯ä»¥åšå‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡ç›‘æ§ã€æ—¥å¿—è¾“å‡ºã€åè®®è½¬æ¢ç­‰;</p>
<p>åœ¨â€œpostâ€ç±»å‹çš„è¿‡æ»¤å™¨ä¸­å¯ä»¥åšå“åº”å†…å®¹ã€å“åº”å¤´çš„ä¿®æ”¹ï¼Œæ—¥å¿—çš„è¾“å‡ºï¼Œæµé‡ç›‘æ§ç­‰æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨ã€‚</p>
<p><strong>æ ¸å¿ƒé€»è¾‘ï¼šè·¯ç”±è½¬å‘ + æ–­è¨€åˆ¤æ–­ + æ‰§è¡Œè¿‡æ»¤å™¨é“¾</strong></p>
<h3 id="å…¥é—¨é…ç½®"><a href="#å…¥é—¨é…ç½®" class="headerlink" title="å…¥é—¨é…ç½®"></a>å…¥é—¨é…ç½®</h3><p>å› ä¸ºè¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªå¾®æœåŠ¡ï¼Œæ‰€ä»¥å»ºModule ï¼Œæ”¹POMï¼Œå†™YMLï¼Œä¸»å¯åŠ¨ï¼Œä¸šåŠ¡ç±»ï¼Œæµ‹è¯•</p>
<p><strong>å»ºModule</strong></p>
<p><code>cloud-gateway9527</code></p>
<p><strong>æ”¹POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-gateway9527<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--gateway--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æœåŠ¡æ³¨å†Œå‘ç°consul discovery,ç½‘å…³ä¹Ÿè¦æ³¨å†Œè¿›æœåŠ¡æ³¨å†Œä¸­å¿ƒç»Ÿä¸€ç®¡æ§--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æŒ‡æ ‡ç›‘æ§å¥åº·æ£€æŸ¥çš„actuator,ç½‘å…³æ˜¯å“åº”å¼ç¼–ç¨‹åˆ é™¤æ‰spring-boot-starter-web dependency--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>å†™YML</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>ä¸»å¯åŠ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">//æœåŠ¡æ³¨å†Œå’Œå‘ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main9527</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main9527.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸šåŠ¡ç±»</strong></p>
<p>æ— ï¼Œä¸å†™ä»»ä½•ä¸šåŠ¡ä»£ç ï¼Œç½‘å…³å’Œä¸šåŠ¡æ— å…³</p>
<p><strong>æµ‹è¯•</strong></p>
<p>å…ˆå¯åŠ¨8500æœåŠ¡ä¸­å¿ƒConsulï¼Œåœ¨å¯åŠ¨9527ç½‘å…³å…¥é©»</p>
<h3 id="9527ç½‘å…³å¦‚ä½•åšè·¯ç”±æ˜ å°„"><a href="#9527ç½‘å…³å¦‚ä½•åšè·¯ç”±æ˜ å°„" class="headerlink" title="9527ç½‘å…³å¦‚ä½•åšè·¯ç”±æ˜ å°„"></a>9527ç½‘å…³å¦‚ä½•åšè·¯ç”±æ˜ å°„</h3><h4 id="å¦‚ä½•åšè·¯ç”±æ˜ å°„"><a href="#å¦‚ä½•åšè·¯ç”±æ˜ å°„" class="headerlink" title="å¦‚ä½•åšè·¯ç”±æ˜ å°„"></a>å¦‚ä½•åšè·¯ç”±æ˜ å°„</h4><p><strong>è¯‰æ±‚</strong></p>
<p>æˆ‘ä»¬ç›®å‰ä¸æƒ³æš´éœ²8001ç«¯å£ï¼Œå¸Œæœ›åœ¨8001çœŸæ­£çš„æ”¯ä»˜å¾®æœåŠ¡å¤–é¢å¥—ä¸€å±‚9527ç½‘å…³</p>
<h4 id="8001æ–°å»ºPayGateWayController"><a href="#8001æ–°å»ºPayGateWayController" class="headerlink" title="8001æ–°å»ºPayGateWayController"></a>8001æ–°å»ºPayGateWayController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayGateWayController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    PayService payService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/gateway/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;Pay&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Pay</span> <span class="variable">pay</span> <span class="operator">=</span> payService.getById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(pay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/gateway/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">getGatewayInfo</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ResultData.success(<span class="string">&quot;gateway info testï¼š&quot;</span>+ IdUtil.simpleUUID());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ç›´æ¥è®¿é—®8001ç«¯å£æµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜è°ƒç”¨æ²¡é—®é¢˜ï¼Œä¸‹é¢å¼€å§‹æ˜ å°„</p>
<h4 id="9527ç½‘å…³YMLæ–°å¢é…ç½®"><a href="#9527ç½‘å…³YMLæ–°å¢é…ç½®" class="headerlink" title="9527ç½‘å…³YMLæ–°å¢é…ç½®"></a>9527ç½‘å…³YMLæ–°å¢é…ç½®</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨é…å¥½ä¹‹åè®¿é—®gatewayå°±èƒ½æˆåŠŸè®¿é—®åˆ°æ”¯ä»˜æœåŠ¡äº†ã€‚</p>
<h4 id="æµ‹è¯•2"><a href="#æµ‹è¯•2" class="headerlink" title="æµ‹è¯•2"></a>æµ‹è¯•2</h4><p>ä¹‹å‰9527åˆ°8001å¯ä»¥äº†ï¼Œç°åœ¨è¦æµ‹è¯•80åˆ°9527</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260112235418865.png" alt="image-20260112235418865"></p>
<p>æˆ‘ä»¬å¯åŠ¨80è®¢å•å¾®æœåŠ¡ï¼Œå®ƒä»Consulæ³¨å†Œä¸­å¿ƒé€šè¿‡å¾®æœåŠ¡åç§°æ‰¾åˆ°8001æ”¯ä»˜å¾®æœåŠ¡è¿›è¡Œè°ƒç”¨ï¼Œ</p>
<p>80 â†’ 9527 â†’ 8001</p>
<p>è¦æ±‚è®¿é—®9527ç½‘å…³åæ‰èƒ½è®¿é—®8001ï¼Œå¦‚æœæˆ‘ä»¬æ­¤æ—¶å¯åŠ¨80è®¢å•ï¼Œå¯ä»¥åšåˆ°å—ï¼Ÿ</p>
<p><strong>ä¿®æ”¹PayFeignApiæ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GateWayè¿›è¡Œç½‘å…³æµ‹è¯•æ¡ˆä¾‹01</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/gateway/get/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResultData <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GateWayè¿›è¡Œç½‘å…³æµ‹è¯•æ¡ˆä¾‹02</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/gateway/info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">getGatewayInfo</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<p><strong>ä¿®æ”¹feign-order80</strong></p>
<p>æ–°å»ºOrderGateWayController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderGateWayController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PayFeignApi payFeignApi;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/feign/pay/gateway/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> payFeignApi.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/feign/pay/gateway/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">getGatewayInfo</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> payFeignApi.getGatewayInfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ä¹‹åå‘ç°feignæ˜¯é€šè¿‡æœåŠ¡åç›´æ¥åˆ°ï¼ŒæœåŠ¡å™¨é‡Œé¢äº†ï¼Œç»•å¼€äº†ç½‘å…³ã€‚</p>
<h4 id="æ­£ç¡®åšæ³•"><a href="#æ­£ç¡®åšæ³•" class="headerlink" title="æ­£ç¡®åšæ³•"></a>æ­£ç¡®åšæ³•</h4><p>åŒä¸€å®¶å…¬å¸è‡ªå·±äººï¼Œç³»ç»Ÿå†…ç¯å¢ƒï¼Œç›´æ¥æ‰¾å¾®æœåŠ¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-payment-service&quot;)</span><span class="comment">//è‡ªå·±äººå†…éƒ¨ï¼Œè‡ªå·±è®¿é—®è‡ªå·±ï¼Œå†™å¾®æœåŠ¡åå­—OK</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PayFeignApi</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GateWayè¿›è¡Œç½‘å…³æµ‹è¯•æ¡ˆä¾‹01</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/gateway/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GateWayè¿›è¡Œç½‘å…³æµ‹è¯•æ¡ˆä¾‹02</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/gateway/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">getGatewayInfo</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸åŒå®¶å…¬å¸æœ‰å¤–äººï¼Œç³»ç»Ÿå¤–è®¿é—®ï¼Œå…ˆæ‰¾ç½‘å…³å†æœåŠ¡</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113000344562.png" alt="image-20260113000344562"></p>
<p><strong>åˆ·æ–°feignæ¥å£jaråŒ…</strong></p>
<p>ä¹Ÿå°±æ˜¯æŠŠfeignApiæ¥å£æ”¹æˆç½‘å…³çš„æœåŠ¡å</p>
<p>ç„¶åé‡å¯80å¾®æœåŠ¡ï¼Œè¿™æ—¶å€™æ²¡æœ‰ç½‘å…³å°±ä¼šæŠ¥é”™äº†ã€‚</p>
<p><strong>è¿˜æœ‰é—®é¢˜ï¼šç½‘å…³9527çš„Ymlé…ç½®æ˜ å°„å†™æ­»é—®é¢˜</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113000813036.png" alt="image-20260113000813036"></p>
<h3 id="GateWayé«˜çº§ç‰¹æ€§"><a href="#GateWayé«˜çº§ç‰¹æ€§" class="headerlink" title="GateWayé«˜çº§ç‰¹æ€§"></a>GateWayé«˜çº§ç‰¹æ€§</h3><h4 id="Routeä»¥å¾®æœåŠ¡å-åŠ¨æ€è·å–æœåŠ¡URI"><a href="#Routeä»¥å¾®æœåŠ¡å-åŠ¨æ€è·å–æœåŠ¡URI" class="headerlink" title="Routeä»¥å¾®æœåŠ¡å-åŠ¨æ€è·å–æœåŠ¡URI"></a>Routeä»¥å¾®æœåŠ¡å-åŠ¨æ€è·å–æœåŠ¡URI</h4><p>è§£å†³ uri åœ°å€å†™æ­»é—®é¢˜</p>
<p>9527ä¿®æ”¹å‰YML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<p>9527ä¿®æ”¹åYML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<h4 id="Predicateæ–­è¨€"><a href="#Predicateæ–­è¨€" class="headerlink" title="Predicateæ–­è¨€"></a>Predicateæ–­è¨€</h4><h5 id="æ˜¯ä»€ä¹ˆ-10"><a href="#æ˜¯ä»€ä¹ˆ-10" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113023841002.png" alt="image-20260113023841002"></p>
<h5 id="æ•´ä½“æ¶æ„æ¦‚è¿°"><a href="#æ•´ä½“æ¶æ„æ¦‚è¿°" class="headerlink" title="æ•´ä½“æ¶æ„æ¦‚è¿°"></a>æ•´ä½“æ¶æ„æ¦‚è¿°</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113023950357.png" alt="image-20260113023950357"></p>
<h5 id="å¸¸ç”¨å†…ç½®Route-Predicate"><a href="#å¸¸ç”¨å†…ç½®Route-Predicate" class="headerlink" title="å¸¸ç”¨å†…ç½®Route Predicate"></a>å¸¸ç”¨å†…ç½®Route Predicate</h5><h6 id="é…ç½®è¯­æ³•æ€»ä½“æ¦‚è¿°"><a href="#é…ç½®è¯­æ³•æ€»ä½“æ¦‚è¿°" class="headerlink" title="é…ç½®è¯­æ³•æ€»ä½“æ¦‚è¿°"></a>é…ç½®è¯­æ³•æ€»ä½“æ¦‚è¿°</h6><p><strong>Shortcut</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113025622383.png" alt="image-20260113025622383"></p>
<p>ç”¨è¿‡æ»¤å™¨è¿‡æ»¤åå­—ï¼Œç„¶åç”¨å‡å·æ¥åŒºåˆ«å‚æ•°ï¼Œå‚æ•°å€¼ä¹‹é—´ç”¨ é€—å·åˆ†éš”</p>
<p><strong>Fully expanded</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113025704614.png" alt="image-20260113025704614"></p>
<p>ç”¨key value é”®å€¼å¯¹æ¥é…ç½®ï¼Œç„¶åç”¨argsæ¥ç¡®å®šå€¼</p>
<p><strong>å¸¸ç”¨çš„æ˜¯shortcut</strong></p>
<h6 id="å¸¸ç”¨æ–­è¨€Api"><a href="#å¸¸ç”¨æ–­è¨€Api" class="headerlink" title="å¸¸ç”¨æ–­è¨€Api"></a>å¸¸ç”¨æ–­è¨€Api</h6><ul>
<li><strong>After</strong> Route Predicate</li>
</ul>
<p>æ—¶é—´æ–­è¨€ï¼Œè¿™ä¸ªå¸¸ç”¨äºç§’æ€ï¼Œä»€ä¹ˆæ—¶é—´ä¹‹åå†æ”¾å¼€ç­‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113030644656.png" alt="image-20260113030644656"></p>
<p>æˆ‘ä»¬çš„é—®é¢˜æ˜¯ï¼šä¸Šè¿°è¿™ä¸ªAfterå¥½æ‡‚ï¼Œè¿™ä¸ªæ—¶é—´ä¸²ä¸²ï¼Ÿï¼Ÿï¼Ÿå¯¹åº”çš„æ ¼å¼å¦‚ä½•è·å¾—ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZonedDateTimeDemo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">ZonedDateTime</span> <span class="variable">zbj</span> <span class="operator">=</span> ZonedDateTime.now(); <span class="comment">// é»˜è®¤æ—¶åŒº</span></span><br><span class="line">              System.out.println(zbj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¿®æ”¹YMLé…ç½®ï¼Œæ¨¡ä»¿å®˜ç½‘å†™æ³•</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Before</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113030826356.png" alt="image-20260113030826356"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-11-27T15:25:06.424566300+08:00[Asia/Shanghai]</span> <span class="comment">#è¶…è¿‡è§„å®šæ—¶é—´ä¸å¯è®¿é—®</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Between</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113030852820.png" alt="image-20260113030852820"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Before=2023-11-20T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Cookie</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113030931599.png" alt="image-20260113030931599"></p>
<p>Cookie Route Predicateéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ Cookie name ,ä¸€ä¸ªæ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<p>è·¯ç”±è§„åˆ™ä¼šé€šè¿‡è·å–å¯¹åº”çš„ Cookie name å€¼å’Œæ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ä¸Šå°±ä¼šæ‰§è¡Œè·¯ç”±ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ä¸Šåˆ™ä¸æ‰§è¡Œ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Cookie=username,zzyy</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Header</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113031133107.png" alt="image-20260113031133107"></p>
<p>ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯å±æ€§åç§°å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™ä¸ªå±æ€§å€¼å’Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ™æ‰§è¡Œã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Header=X-Request-Id,</span> <span class="string">\d+</span>  <span class="comment"># è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Host</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113031803740.png" alt="image-20260113031803740"></p>
<p>Host Route Predicate æ¥æ”¶ä¸€ç»„å‚æ•°ï¼Œä¸€ç»„åŒ¹é…çš„åŸŸååˆ—è¡¨ï¼Œè¿™ä¸ªæ¨¡æ¿æ˜¯ä¸€ä¸ª ant åˆ†éš”çš„æ¨¡æ¿ï¼Œç”¨.å·ä½œä¸ºåˆ†éš”ç¬¦ã€‚</p>
<p>å®ƒé€šè¿‡å‚æ•°ä¸­çš„ä¸»æœºåœ°å€ä½œä¸ºåŒ¹é…è§„åˆ™ã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Host=**.bitzh.com</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Path</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113032515069.png" alt="image-20260113032515069"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Host=**.atguigu.com</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Query</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113032848031.png" alt="image-20260113032848031"></p>
<p>æ”¯æŒä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å±æ€§åï¼Œä¸€ä¸ªä¸ºå±æ€§å€¼ï¼Œå±æ€§å€¼å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Query=username,</span> <span class="string">\d+</span>  <span class="comment"># è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>RemoteAddr</strong> Route Predicate</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113161013704.png" alt="image-20260113161013704"></p>
<p>è¿œç¨‹åœ°å€è®¿é—®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113161044562.png" alt="image-20260113161044562"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoteAddr=192.168.124.1/24</span> <span class="comment"># å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Method</strong> Route Predicate</li>
</ul>
<p>é…ç½®æŸä¸ªè¯·æ±‚åœ°å€ï¼Œåªèƒ½ç”¨Get/Postæ–¹æ³•è®¿é—®ï¼Œè®¿é—®é™åˆ¶</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113161431546.png" alt="image-20260113161431546"></p>
<p><strong>All</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment"># - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<p><strong>Predicate</strong>å°±æ˜¯ä¸ºäº†å®ç°ä¸€ç»„åŒ¹é…è§„åˆ™ï¼Œè®©è¯·æ±‚è¿‡æ¥æ‰¾åˆ°å¯¹åº”çš„<strong>Route</strong>è¿›è¡Œå¤„ç†ã€‚</p>
<h5 id="è‡ªå®šä¹‰æ–­è¨€"><a href="#è‡ªå®šä¹‰æ–­è¨€" class="headerlink" title="è‡ªå®šä¹‰æ–­è¨€"></a>è‡ªå®šä¹‰æ–­è¨€</h5><p><strong>XXXRoutePredicateFactoryè§„åˆ™</strong></p>
<p>çœ‹çœ‹æºç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113162229685.png" alt="image-20260113162229685"></p>
<p>ç»“åˆæ¶æ„å›¾</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113162717781.png" alt="image-20260113162717781"></p>
<p>ç…§ç€æŠ„ä¸€ä¸ª</p>
<p><strong>æ¨¡æ¿å¥—è·¯</strong></p>
<ul>
<li>è¦ä¹ˆå®ç°AbstractRoutePredicateFactoryæŠ½è±¡ç±»</li>
<li>è¦ä¹ˆå®ç°RoutePredicateFactoryæ¥å£</li>
<li>å¼€å¤´ä»»æ„å–åï¼Œä½†æ˜¯å¿…é¡»ä»¥RoutePredicateFactoryåç¼€ç»“å°¾</li>
</ul>
<h6 id="è‡ªå®šä¹‰è·¯ç”±æ–­è¨€è§„åˆ™æ­¥éª¤å¥—è·¯"><a href="#è‡ªå®šä¹‰è·¯ç”±æ–­è¨€è§„åˆ™æ­¥éª¤å¥—è·¯" class="headerlink" title="è‡ªå®šä¹‰è·¯ç”±æ–­è¨€è§„åˆ™æ­¥éª¤å¥—è·¯"></a>è‡ªå®šä¹‰è·¯ç”±æ–­è¨€è§„åˆ™æ­¥éª¤å¥—è·¯</h6><p>ç¼–å†™æ­¥éª¤</p>
<ul>
<li>æ–°å»ºç±»åXXXéœ€è¦ä»¥RoutePredicateFactoryç»“å°¾å¹¶ç»§æ‰¿AbstractRoutePredicateFactoryç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>æ ‡æ³¨ä¸å¯å¿˜</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRoutePredicateFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractRoutePredicateFactory</span>&lt;MyRoutePredicateFactory.Config&gt;&#123;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é‡å†™applyæ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Predicate&lt;ServerWebExchange&gt; <span class="title function_">apply</span><span class="params">(MyRoutePredicateFactory.Config config)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ–°å»ºapplyæ–¹æ³•æ‰€éœ€è¦çš„é™æ€å†…éƒ¨ç±»MyRoutePredicateFactory.Configï¼ˆè¿™ä¸ªConfigç±»å°±æ˜¯æˆ‘ä»¬çš„è·¯ç”±æ–­è¨€è§„åˆ™ï¼Œé‡è¦ï¼‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span>&#123;</span><br><span class="line">    <span class="meta">@Setter</span></span><br><span class="line">    <span class="meta">@Getter</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="keyword">private</span> String userType; <span class="comment">//é’»ã€é‡‘ã€é“¶ç­‰ç”¨æˆ·ç­‰çº§</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç©ºå‚æ„é€ æ–¹æ³•ï¼Œå†…éƒ¨è°ƒç”¨super</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">MyRoutePredicateFactory</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">super</span>(MyRoutePredicateFactory.Config.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é‡å†™applyæ–¹æ³•ç¬¬äºŒç‰ˆ</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Predicate&lt;ServerWebExchange&gt; <span class="title function_">apply</span><span class="params">(MyRoutePredicateFactory.Config config)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Predicate</span>&lt;ServerWebExchange&gt;()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(ServerWebExchange serverWebExchange)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//æ£€æŸ¥requestçš„å‚æ•°é‡Œé¢ï¼ŒuserTypeæ˜¯å¦ä¸ºæŒ‡å®šçš„å€¼ï¼Œç¬¦åˆé…ç½®å°±é€šè¿‡</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">userType</span> <span class="operator">=</span> serverWebExchange.getRequest().getQueryParams().getFirst(<span class="string">&quot;userType&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (userType == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœè¯´å‚æ•°å­˜åœ¨ï¼Œå°±å’Œconfigçš„æ•°æ®è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">            <span class="keyword">if</span>(userType.equals(config.getUserType())) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>All</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRoutePredicateFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractRoutePredicateFactory</span>&lt;MyRoutePredicateFactory.Config&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyRoutePredicateFactory</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>(MyRoutePredicateFactory.Config.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Validated</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span>&#123;</span><br><span class="line">        <span class="meta">@Setter</span></span><br><span class="line">        <span class="meta">@Getter</span></span><br><span class="line">        <span class="meta">@NotEmpty</span></span><br><span class="line">        <span class="keyword">private</span> String userType; <span class="comment">//é’»ã€é‡‘ã€é“¶ç­‰ç”¨æˆ·ç­‰çº§</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Predicate&lt;ServerWebExchange&gt; <span class="title function_">apply</span><span class="params">(MyRoutePredicateFactory.Config config)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Predicate</span>&lt;ServerWebExchange&gt;()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(ServerWebExchange serverWebExchange)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//æ£€æŸ¥requestçš„å‚æ•°é‡Œé¢ï¼ŒuserTypeæ˜¯å¦ä¸ºæŒ‡å®šçš„å€¼ï¼Œç¬¦åˆé…ç½®å°±é€šè¿‡</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">userType</span> <span class="operator">=</span> serverWebExchange.getRequest().getQueryParams().getFirst(<span class="string">&quot;userType&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (userType == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å¦‚æœè¯´å‚æ•°å­˜åœ¨ï¼Œå°±å’Œconfigçš„æ•°æ®è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">                <span class="keyword">if</span>(userType.equals(config.getUserType())) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•å‘ç°æœ‰bugï¼Œä¸è¡Œäº†ï¼ŒæŠ¥é”™è¯´æ²¡æœ‰ç»‘å®šå±æ€§é”™è¯¯ã€‚</p>
<p>ç„¶åå‘ç°çŸ­ä¿ƒçš„å†™æ³•ä¸å¯¹è¦ç”¨fullçš„å†™æ³•ã€‚è¿™ä¸ªfully expanded arguments çš„æ ¼å¼å¯ä»¥</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment"># - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line">            <span class="comment">#- My=diamond</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">My</span></span><br><span class="line">              <span class="attr">args:</span></span><br><span class="line">                <span class="attr">userType:</span> <span class="string">diamond</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br></pre></td></tr></table></figure>
<p>åŸæ¥æƒ³è¦çŸ­ä¿ƒå†™æ³•ï¼Œæ˜¯ç¼ºå°‘shortcutFieldOrderæ–¹æ³•çš„è§†çº¿ï¼Œæ‰€ä»¥ä¸æ”¯æŒçŸ­æ ¼å¼</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113165745362.png" alt="image-20260113165745362"></p>
<p><strong>æœ€ç»ˆå®Œæ•´ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRoutePredicateFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractRoutePredicateFactory</span>&lt;MyRoutePredicateFactory.Config&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyRoutePredicateFactory</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>(MyRoutePredicateFactory.Config.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Validated</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span>&#123;</span><br><span class="line">        <span class="meta">@Setter</span></span><br><span class="line">        <span class="meta">@Getter</span></span><br><span class="line">        <span class="meta">@NotEmpty</span></span><br><span class="line">        <span class="keyword">private</span> String userType; <span class="comment">//é’»ã€é‡‘ã€é“¶ç­‰ç”¨æˆ·ç­‰çº§</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Predicate&lt;ServerWebExchange&gt; <span class="title function_">apply</span><span class="params">(MyRoutePredicateFactory.Config config)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Predicate</span>&lt;ServerWebExchange&gt;()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(ServerWebExchange serverWebExchange)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//æ£€æŸ¥requestçš„å‚æ•°é‡Œé¢ï¼ŒuserTypeæ˜¯å¦ä¸ºæŒ‡å®šçš„å€¼ï¼Œç¬¦åˆé…ç½®å°±é€šè¿‡</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">userType</span> <span class="operator">=</span> serverWebExchange.getRequest().getQueryParams().getFirst(<span class="string">&quot;userType&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (userType == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å¦‚æœè¯´å‚æ•°å­˜åœ¨ï¼Œå°±å’Œconfigçš„æ•°æ®è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">                <span class="keyword">if</span>(userType.equals(config.getUserType())) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">shortcutFieldOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.singletonList(<span class="string">&quot;userType&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è¿™æ ·é…ç½®å°±å¯ä»¥äº†</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment"># - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">My=diamond</span></span><br><span class="line">            <span class="comment">#- name: My</span></span><br><span class="line">            <span class="comment">#  args:</span></span><br><span class="line">            <span class="comment">#    userType: diamond</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Filterè¿‡æ»¤"><a href="#Filterè¿‡æ»¤" class="headerlink" title="Filterè¿‡æ»¤"></a>Filterè¿‡æ»¤</h4><p>SpringMVCé‡Œé¢çš„æ‹¦æˆªå™¨Interceptorï¼ŒServletçš„è¿‡æ»¤å™¨</p>
<p><code>pre</code>å’Œ<code>post</code>åˆ†åˆ«ä¼šåœ¨è¯·æ±‚è¢«æ‰§è¡Œå‰è°ƒç”¨å’Œè¢«æ‰§è¡Œåè°ƒç”¨ï¼Œç”¨æ¥ä¿®æ”¹è¯·æ±‚å’Œå“åº”ä¿¡æ¯</p>
<p><strong>æ–­è¨€ï¼ˆPredicateï¼‰å†³å®šâ€œè¿™ä¸ªè¯·æ±‚è¦ä¸è¦è·¯ç”±â€</strong><br><strong>è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å†³å®šâ€œè·¯ç”±å‰åå¯¹è¯·æ±‚/å“åº”åšä»€ä¹ˆå¤„ç†â€</strong></p>
<h5 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h5><h6 id="èƒ½å¹²å˜›-5"><a href="#èƒ½å¹²å˜›-5" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h6><p>è¯·æ±‚é‰´æƒï¼Œå¼‚å¸¸å¤„ç†ï¼Œè®°å½•æ¥å£è°ƒç”¨æ—¶é•¿ç»Ÿè®¡ï¼ˆå¤§å‚é¢è¯•è®¾è®¡é¢˜ï¼‰</p>
<h6 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h6><p>1ã€å…¨å±€é»˜è®¤è¿‡æ»¤å™¨ Global Filter</p>
<p>gatewayå‡ºå‚é»˜è®¤å·²æœ‰çš„ï¼Œç›´æ¥ç”¨å³å¯ï¼Œä¸»è¦ä½œç”¨äºæ‰€æœ‰çš„è·¯ç”±</p>
<p>ä¸éœ€è¦å†é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œä½œç”¨åœ¨æ‰€æœ‰çš„è·¯ç”±ä¸Šï¼Œå®ç°GlobalFilteræ¥å£å³å¯</p>
<p>2ã€å•ä¸€å†…ç½®è¿‡æ»¤å™¨GatewayFilter</p>
<p>ä¹Ÿå¯ä»¥æˆä¸ºç½‘å…³è¿‡æ»¤å™¨ï¼Œè¿™ç§è¿‡æ»¤å™¨ä¸»è¦æ˜¯ä½œç”¨äºå•ä¸€è·¯ç”±æˆ–è€…æŸä¸ªè·¯ç”±åˆ†ç»„</p>
<p>3ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨</p>
<h5 id="Gatewayå†…ç½®çš„è¿‡æ»¤å™¨"><a href="#Gatewayå†…ç½®çš„è¿‡æ»¤å™¨" class="headerlink" title="Gatewayå†…ç½®çš„è¿‡æ»¤å™¨"></a>Gatewayå†…ç½®çš„è¿‡æ»¤å™¨</h5><h6 id="æ˜¯ä»€ä¹ˆ-11"><a href="#æ˜¯ä»€ä¹ˆ-11" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h6><p>å•ä¸€å†…ç½®è¿‡æ»¤å™¨GatewayFilter</p>
<p>åªçœ‹å¸¸è§å’Œé€šç”¨çš„ï¼Œä¸æ˜¯å…¨éƒ¨ã€‚</p>
<h6 id="å¸¸ç”¨çš„å†…ç½®è¿‡æ»¤å™¨"><a href="#å¸¸ç”¨çš„å†…ç½®è¿‡æ»¤å™¨" class="headerlink" title="å¸¸ç”¨çš„å†…ç½®è¿‡æ»¤å™¨"></a>å¸¸ç”¨çš„å†…ç½®è¿‡æ»¤å™¨</h6><p><strong>1ã€è¯·æ±‚å¤´ï¼ˆRequestHeaderï¼‰ç›¸å…³ç»„</strong></p>
<p><code>The AddRequestHeader GatewayFilter Factory</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">æŒ‡å®šè¯·æ±‚å¤´å†…å®¹ByName</span><br><span class="line">8001å¾®æœåŠ¡PayGateWayControlleræ–°å¢æ–¹æ³•</span><br><span class="line">@RestController</span><br><span class="line">public class PayGateWayController</span><br><span class="line">&#123;</span><br><span class="line">    @Resource</span><br><span class="line">    PayService payService;</span><br><span class="line"></span><br><span class="line">    @GetMapping(value = &quot;/pay/gateway/get/&#123;id&#125;&quot;)</span><br><span class="line">    public ResultData&lt;Pay&gt; getById(@PathVariable(&quot;id&quot;) Integer id)</span><br><span class="line">    &#123;</span><br><span class="line">        Pay pay = payService.getById(id);</span><br><span class="line">        return ResultData.success(pay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(value = &quot;/pay/gateway/info&quot;)</span><br><span class="line">    public ResultData&lt;String&gt; getGatewayInfo()</span><br><span class="line">    &#123;</span><br><span class="line">        return ResultData.success(&quot;gateway info testï¼š&quot;+ IdUtil.simpleUUID());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(value = &quot;/pay/gateway/filter&quot;)</span><br><span class="line">    public ResultData&lt;String&gt; getGatewayFilter(HttpServletRequest request)</span><br><span class="line">    &#123;</span><br><span class="line">        String result = &quot;&quot;;</span><br><span class="line">        Enumeration&lt;String&gt; headers = request.getHeaderNames();</span><br><span class="line">        while(headers.hasMoreElements())</span><br><span class="line">        &#123;</span><br><span class="line">            String headName = headers.nextElement();</span><br><span class="line">            String headValue = request.getHeader(headName);</span><br><span class="line">            System.out.println(&quot;è¯·æ±‚å¤´å: &quot; + headName +&quot;\t\t\t&quot;+&quot;è¯·æ±‚å¤´å€¼: &quot; + headValue);</span><br><span class="line">            if(headName.equalsIgnoreCase(&quot;X-Request-atguigu1&quot;)</span><br><span class="line">                    || headName.equalsIgnoreCase(&quot;X-Request-atguigu2&quot;)) &#123;</span><br><span class="line">                result = result+headName + &quot;\t &quot; + headValue +&quot; &quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return ResultData.success(&quot;getGatewayFilter è¿‡æ»¤å™¨ testï¼š &quot;+result+&quot; \t &quot;+ DateUtil.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server:</span><br><span class="line">  port: 9527</span><br><span class="line"></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: cloud-gateway #ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span><br><span class="line">  cloud:</span><br><span class="line">    consul: #é…ç½®consulåœ°å€</span><br><span class="line">      host: localhost</span><br><span class="line">      port: 8500</span><br><span class="line">      discovery:</span><br><span class="line">        prefer-ip-address: true</span><br><span class="line">        service-name: $&#123;spring.application.name&#125;</span><br><span class="line">    gateway:</span><br><span class="line">      routes:</span><br><span class="line">        - id: pay_routh1 #pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span><br><span class="line">          #uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          uri: lb://cloud-payment-service                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/pay/gateway/get/**              # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span><br><span class="line">            - After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span><br><span class="line">            #- Cookie=username,zzyy</span><br><span class="line">            # - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">            #- Host=**.atguigu.com</span><br><span class="line">            #- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span><br><span class="line">            #- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span><br><span class="line">            - My=gold</span><br><span class="line">#            - name: My</span><br><span class="line">#              args:</span><br><span class="line">#                userType: diamond</span><br><span class="line"></span><br><span class="line">        - id: pay_routh2 #pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span><br><span class="line">          #uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          uri: lb://cloud-payment-service</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/pay/gateway/info/**              # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span><br><span class="line"></span><br><span class="line">        - id: pay_routh3 #pay_routh3</span><br><span class="line">          uri: lb://cloud-payment-service                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/pay/gateway/filter/**              # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span><br><span class="line">          filters:</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh1,bitzhValue1  # è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh2,bitzhValue2</span><br></pre></td></tr></table></figure>
<p><strong><code>The RemoveRequestHeader GatewayFilter Factory</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤è¯·æ±‚å¤´ByName</span><br><span class="line">9527YML</span><br><span class="line">- id: pay_routh3 #pay_routh3</span><br><span class="line">          uri: lb://cloud-payment-service                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/pay/gateway/filter/**              # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span><br><span class="line">          filters:</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh1,bitzhValue1  # è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh2,bitzhValue2</span><br><span class="line">            - RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span><br></pre></td></tr></table></figure>
<p><code>The SetRequestHeader GatewayFilter Factory</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹è¯·æ±‚å¤´ByName</span><br><span class="line">9527YML</span><br><span class="line">- id: pay_routh3 #pay_routh3</span><br><span class="line">          uri: lb://cloud-payment-service                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span><br><span class="line">          predicates:</span><br><span class="line">            - Path=/pay/gateway/filter/**              # æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span><br><span class="line">          filters:</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh1,bitzhValue1  # è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span><br><span class="line">            - AddRequestHeader=X-Request-bitzh2,bitzhValue2</span><br><span class="line">            - RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span><br><span class="line">            - SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span><br></pre></td></tr></table></figure>
<p><strong>2ã€è¯·æ±‚å‚æ•°ï¼ˆRequestParameterï¼‰ç›¸å…³ç»„</strong></p>
<p><code>The AddRequestParameter GatewayFilter Factory</code></p>
<p><code>The RemoveRequestParameter GatewayFilter Factory</code></p>
<p>ä¸Šè¿°ä¸¤ä¸ªåˆä¸€å—</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestHeader=sec-fetch-site</span>      <span class="comment"># åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetRequestHeader=sec-fetch-mode,</span> <span class="string">Blue-updatebyzzyy</span> <span class="comment"># å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestParameter=customerId,9527001</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestParameter=customerName</span>   <span class="comment"># åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/pay/gateway/filter&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResultData&lt;String&gt; <span class="title function_">getGatewayFilter</span><span class="params">(HttpServletRequest request)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    Enumeration&lt;String&gt; headers = request.getHeaderNames();</span><br><span class="line">    <span class="keyword">while</span>(headers.hasMoreElements())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">headName</span> <span class="operator">=</span> headers.nextElement();</span><br><span class="line">        <span class="type">String</span> <span class="variable">headValue</span> <span class="operator">=</span> request.getHeader(headName);</span><br><span class="line">        System.out.println(<span class="string">&quot;request headName:&quot;</span> + headName +<span class="string">&quot;---&quot;</span>+<span class="string">&quot;request headValue:&quot;</span> + headValue);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(headName.equalsIgnoreCase(<span class="string">&quot;X-Request-atguigu1&quot;</span>)</span><br><span class="line">                || headName.equalsIgnoreCase(<span class="string">&quot;X-Request-atguigu2&quot;</span>)) &#123;</span><br><span class="line">            result = result+headName + <span class="string">&quot;\t &quot;</span> + headValue +<span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;=============================================&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">customerId</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;customerId&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;request Parameter customerId: &quot;</span>+customerId);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">customerName</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;customerName&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;request Parameter customerName: &quot;</span>+customerName);</span><br><span class="line">    System.out.println(<span class="string">&quot;=============================================&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ResultData.success(<span class="string">&quot;getGatewayFilter è¿‡æ»¤å™¨ testï¼š &quot;</span>+result+<span class="string">&quot; \t &quot;</span>+ DateUtil.now());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>3ã€å›åº”å¤´ï¼ˆResponseHeaderï¼‰ç›¸å…³ç»„</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113231806088.png" alt="image-20260113231806088"></p>
<p>The AddResponseHeader GatewayFilter Factory</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestHeader=sec-fetch-site</span>      <span class="comment"># åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetRequestHeader=sec-fetch-mode,</span> <span class="string">Blue-updatebyzzyy</span> <span class="comment"># å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestParameter=customerId,9527001</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestParameter=customerName</span>   <span class="comment"># åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddResponseHeader=X-Response-atguigu,</span> <span class="string">BlueResponse</span> <span class="comment"># æ–°å¢å“åº”å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br></pre></td></tr></table></figure>
<p>The SetResponseHeader GatewayFilter Factory</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestHeader=sec-fetch-site</span>      <span class="comment"># åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetRequestHeader=sec-fetch-mode,</span> <span class="string">Blue-updatebyzzyy</span> <span class="comment"># å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestParameter=customerId,9527001</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestParameter=customerName</span>   <span class="comment"># åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddResponseHeader=X-Response-atguigu,</span> <span class="string">BlueResponse</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetResponseHeader=Date,2099-11-11</span> <span class="comment"># è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br></pre></td></tr></table></figure>
<p>The RemoveResponseHeader GatewayFilter Factory</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestHeader=sec-fetch-site</span>      <span class="comment"># åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetRequestHeader=sec-fetch-mode,</span> <span class="string">Blue-updatebyzzyy</span> <span class="comment"># å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestParameter=customerId,9527001</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveRequestParameter=customerName</span>   <span class="comment"># åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddResponseHeader=X-Response-atguigu,</span> <span class="string">BlueResponse</span> <span class="comment"># æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetResponseHeader=Date,2099-11-11</span> <span class="comment"># è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RemoveResponseHeader=Content-Type</span> <span class="comment"># å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br></pre></td></tr></table></figure>
<p><strong>4ã€å‰ç¼€å’Œè·¯å¾„ç›¸å…³ç»„</strong></p>
<p>The PrefixPath GatewayFilter Factory è‡ªåŠ¨æ·»åŠ è·¯å¾„å‰ç¼€</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="comment">#- Path=/pay/gateway/filter/**   # è¢«åˆ†æ‹†ä¸º: PrefixPath + Path</span></span><br><span class="line"></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œä¸ºé…åˆPrefixPathæµ‹è¯•è¿‡æ»¤ï¼Œæš‚æ—¶æ³¨é‡Šæ‰/pay</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment">#è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="comment">#- AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="comment">#- RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="comment">#- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="comment">#- AddRequestParameter=customerId,9527001 # æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="comment">#- RemoveRequestParameter=customerName   # åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="comment">#- AddResponseHeader=X-Response-atguigu, BlueResponse # æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="comment">#- SetResponseHeader=Date,2099-11-11 # è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="comment">#- RemoveResponseHeader=Content-Type # å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">PrefixPath=/pay</span> <span class="comment"># http://localhost:9527/pay/gateway/filter</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113235326569.png" alt="image-20260113235326569"></p>
<p>The SetPath GatewayFilter Factory è®¿é—®è·¯å¾„ä¿®æ”¹</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.1.196/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="comment">#- Path=/pay/gateway/filter/** # çœŸå®åœ°å€</span></span><br><span class="line">            <span class="comment">#- Path=/gateway/filter/**              # æ–­è¨€ï¼Œä¸ºé…åˆPrefixPathæµ‹è¯•è¿‡æ»¤ï¼Œæš‚æ—¶æ³¨é‡Šæ‰/pay</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/XYZ/abc/&#123;segment&#125;</span>           <span class="comment"># æ–­è¨€ï¼Œä¸ºé…åˆSetPathæµ‹è¯•ï¼Œ&#123;segment&#125;çš„å†…å®¹æœ€åè¢«SetPathå–ä»£</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment">#è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">                        <span class="comment">#- AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="comment">#- RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="comment">#- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="comment">#- AddRequestParameter=customerId,9527001 # æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="comment">#- RemoveRequestParameter=customerName   # åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="comment">#- AddResponseHeader=X-Response-atguigu, BlueResponse # æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="comment">#- SetResponseHeader=Date,2099-11-11 # è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="comment">#- RemoveResponseHeader=Content-Type # å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br><span class="line">                        <span class="comment">#- PrefixPath=/pay # http://localhost:9527/pay/gateway/filter</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">SetPath=/pay/gateway/&#123;segment&#125;</span>  <span class="comment"># &#123;segment&#125;è¡¨ç¤ºå ä½ç¬¦ï¼Œä½ å†™abcä¹Ÿè¡Œä½†è¦ä¸Šä¸‹ä¸€è‡´</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260113235450155.png" alt="image-20260113235450155"></p>
<p>The RedirectTo GatewayFilter Factory é‡å®šå‘åˆ°æŸä¸ªé¡µé¢</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>          <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="comment">#- After=2023-11-20T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Before=2023-12-29T17:58:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Between=2023-11-21T17:38:13.586918800+08:00[Asia/Shanghai],2023-11-22T17:38:13.586918800+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment">#- Header=X-Request-Id, \d+  # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.1.196/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span> <span class="comment"># çœŸå®åœ°å€</span></span><br><span class="line">            <span class="comment">#- Path=/gateway/filter/**              # æ–­è¨€ï¼Œä¸ºé…åˆPrefixPathæµ‹è¯•è¿‡æ»¤ï¼Œæš‚æ—¶æ³¨é‡Šæ‰/pay</span></span><br><span class="line">            <span class="comment">#- Path=/XYZ/abc/&#123;segment&#125;           # æ–­è¨€ï¼Œä¸ºé…åˆSetPathæµ‹è¯•ï¼Œ&#123;segment&#125;çš„å†…å®¹æœ€åè¢«SetPathå–ä»£</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment">#è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="comment">#- AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="comment">#- RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="comment">#- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="comment">#- AddRequestParameter=customerId,9527001 # æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="comment">#- RemoveRequestParameter=customerName   # åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="comment">#- AddResponseHeader=X-Response-atguigu, BlueResponse # æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="comment">#- SetResponseHeader=Date,2099-11-11 # è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="comment">#- RemoveResponseHeader=Content-Type # å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br><span class="line">            <span class="comment">#- PrefixPath=/pay # http://localhost:9527/pay/gateway/filter</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RedirectTo=302,</span> <span class="string">http://www.atguigu.com/</span> <span class="comment"># è®¿é—®http://localhost:9527/pay/gateway/filterè·³è½¬åˆ°http://www.atguigu.com/</span></span><br></pre></td></tr></table></figure>
<p><strong>5ã€å…¶ä»–</strong></p>
<p>Default Filters é…ç½®åœ¨æ­¤å¤„ç›¸å½“äºå…¨å±€é€šç”¨ï¼Œè‡ªå®šä¹‰ç§’å˜Global</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114000011177.png" alt="image-20260114000011177"></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment"># - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">My=gold</span></span><br><span class="line"><span class="comment">#            - name: My</span></span><br><span class="line"><span class="comment">#              args:</span></span><br><span class="line"><span class="comment">#                userType: diamond</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±ï¼Œé»˜è®¤æ­£ç¡®åœ°å€</span></span><br><span class="line">            <span class="comment">#- Path=/gateway/filter/**              # æ–­è¨€ï¼Œä¸ºé…åˆPrefixPathæµ‹è¯•è¿‡æ»¤ï¼Œæš‚æ—¶æ³¨é‡Šæ‰/pay</span></span><br><span class="line">            <span class="comment">#- Path=/XYZ/abc/&#123;segment&#125;           # æ–­è¨€ï¼Œä¸ºé…åˆSetPathæµ‹è¯•ï¼Œ&#123;segment&#125;çš„å†…å®¹æœ€åè¢«SetPathå–ä»£</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">RedirectTo=302,</span> <span class="string">http://www.atguigu.com/</span> <span class="comment"># è®¿é—®http://localhost:9527/pay/gateway/filterè·³è½¬åˆ°http://www.atguigu.com/</span></span><br><span class="line">            <span class="comment">#- SetPath=/pay/gateway/&#123;segment&#125;  # &#123;segment&#125;è¡¨ç¤ºå ä½ç¬¦ï¼Œä½ å†™abcä¹Ÿè¡Œä½†è¦ä¸Šä¸‹ä¸€è‡´</span></span><br><span class="line">            <span class="comment">#- PrefixPath=/pay # http://localhost:9527/pay/gateway/filter  è¢«åˆ†æ‹†ä¸º: PrefixPath + Path</span></span><br><span class="line">            <span class="comment">#- AddRequestHeader=X-Request-atguigu1,atguiguValue1  # è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="comment">#- AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="comment">#- RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="comment">#- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="comment">#- AddRequestParameter=customerId,9527001 # æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="comment">#- RemoveRequestParameter=customerName   # åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="comment">#- AddResponseHeader=X-Response-atguigu, BlueResponse # æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="comment">#- SetResponseHeader=Date,2099-11-11 # è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="comment">#- RemoveResponseHeader=Content-Type # å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br></pre></td></tr></table></figure>
<h5 id="Gatewayè‡ªå®šä¹‰è¿‡æ»¤å™¨"><a href="#Gatewayè‡ªå®šä¹‰è¿‡æ»¤å™¨" class="headerlink" title="Gatewayè‡ªå®šä¹‰è¿‡æ»¤å™¨"></a>Gatewayè‡ªå®šä¹‰è¿‡æ»¤å™¨</h5><h6 id="è‡ªå®šä¹‰å…¨å±€Filter"><a href="#è‡ªå®šä¹‰å…¨å±€Filter" class="headerlink" title="è‡ªå®šä¹‰å…¨å±€Filter"></a>è‡ªå®šä¹‰å…¨å±€Filter</h6><p><strong>é¢è¯•é¢˜</strong></p>
<p>ç»Ÿè®¡æ¥å£è°ƒç”¨è€—æ—¶æƒ…å†µï¼Œå¦‚ä½•è½åœ°ï¼Œè°ˆè°ˆè®¾è®¡æ€è·¯</p>
<p>é€šè¿‡è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨æå®šä¸Šè¿°éœ€æ±‚</p>
<p><strong>è‡ªå®šä¹‰æ¥å£è°ƒç”¨è€—æ—¶ç»Ÿè®¡çš„å…¨å±€è¿‡æ»¤å™¨</strong></p>
<p><strong>æ­¥éª¤</strong></p>
<p>æ–°å»ºç±»MyGlobalFilter å¹¶å®ç°GolbalFilterï¼ŒOrderedä¸¤ä¸ªæ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">//ä¸è¦å¿˜è®°</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGlobalFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span>, Ordered</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOrder</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é…ç½®YML,æŠŠéœ€è¦è®¡æ—¶çš„æœåŠ¡ï¼Œè¿›è¡Œæ–­è¨€è·¯ç”±åˆ°å¯¹åº”çš„åœ°å€</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±ï¼Œé»˜è®¤æ­£ç¡®åœ°å€</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br></pre></td></tr></table></figure>
<p><strong>å®Œæ•´çš„è¿‡æ»¤å™¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGlobalFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span>, Ordered</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOrder</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BEGIN_VISIT_TIME</span> <span class="operator">=</span> <span class="string">&quot;begin_visit_time&quot;</span>;<span class="comment">//å¼€å§‹è®¿é—®æ—¶é—´</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *ç¬¬2ç‰ˆï¼Œå„ç§ç»Ÿè®¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exchange</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">        <span class="comment">//å…ˆè®°å½•ä¸‹è®¿é—®æ¥å£çš„å¼€å§‹æ—¶é—´</span></span><br><span class="line">        exchange.getAttributes().put(BEGIN_VISIT_TIME, System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange).then(Mono.fromRunnable(()-&gt;&#123;</span><br><span class="line">            <span class="type">Long</span> <span class="variable">beginVisitTime</span> <span class="operator">=</span> exchange.getAttribute(BEGIN_VISIT_TIME);</span><br><span class="line">            <span class="keyword">if</span> (beginVisitTime != <span class="literal">null</span>)&#123;</span><br><span class="line">                log.info(<span class="string">&quot;è®¿é—®æ¥å£ä¸»æœº: &quot;</span> + exchange.getRequest().getURI().getHost());</span><br><span class="line">                log.info(<span class="string">&quot;è®¿é—®æ¥å£ç«¯å£: &quot;</span> + exchange.getRequest().getURI().getPort());</span><br><span class="line">                log.info(<span class="string">&quot;è®¿é—®æ¥å£URL: &quot;</span> + exchange.getRequest().getURI().getPath());</span><br><span class="line">                log.info(<span class="string">&quot;è®¿é—®æ¥å£URLå‚æ•°: &quot;</span> + exchange.getRequest().getURI().getRawQuery());</span><br><span class="line">                log.info(<span class="string">&quot;è®¿é—®æ¥å£æ—¶é•¿: &quot;</span> + (System.currentTimeMillis() - beginVisitTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">                log.info(<span class="string">&quot;æˆ‘æ˜¯ç¾ä¸½åˆ†å‰²çº¿: ###################################################&quot;</span>);</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="è‡ªå®šä¹‰æ¡ä»¶Filter"><a href="#è‡ªå®šä¹‰æ¡ä»¶Filter" class="headerlink" title="è‡ªå®šä¹‰æ¡ä»¶Filter"></a>è‡ªå®šä¹‰æ¡ä»¶Filter</h6><p>å…¨å±€æ˜¯æ‰€æœ‰éƒ½ç”Ÿæ•ˆï¼Œæ¡ä»¶æ˜¯ç¬¦åˆæ¡ä»¶çš„æ‰ä¼šç”Ÿæ•ˆ</p>
<p>å…ˆå‚è€ƒGateWayå†…ç½®å‡ºå‚é»˜è®¤çš„</p>
<p>ç„¶åå¼€å§‹è‡ªå®šä¹‰ç½‘å…³è¿‡æ»¤å™¨è§„åˆ™æ­¥éª¤å¥—è·¯</p>
<p>1ã€æ–°å»ºç±»åXXXéœ€è¦ä»¥GatewayFilterFactoryç»“å°¾ï¼Œå¹¶ç»§æ‰¿AbstractGatewayFilterFactoryç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>æ ‡æ³¨ä¸å¯å¿˜</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractGatewayFilterFactory</span>&lt;MyGatewayFilterFactory.Config&gt;&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2ã€æ–°å»ºXXXGatewayFilterFactory.Configå†…éƒ¨ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractGatewayFilterFactory</span>&lt;MyGatewayFilterFactory.Config&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">        <span class="meta">@Setter</span> <span class="meta">@Getter</span></span><br><span class="line">        <span class="keyword">private</span> String status;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€é‡å†™applyæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractGatewayFilterFactory</span>&lt;MyGatewayFilterFactory.Config&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> GatewayFilter <span class="title function_">apply</span><span class="params">(MyGatewayFilterFactory.Config config)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GatewayFilter</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">                <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span>  exchange.getRequest();</span><br><span class="line">                System.out.println(<span class="string">&quot;è¿›å…¥è‡ªå®šä¹‰ç½‘å…³è¿‡æ»¤å™¨MyGatewayFilterFactoryï¼Œstatus====&quot;</span>+config.getStatus());</span><br><span class="line">                <span class="keyword">if</span>(request.getQueryParams().containsKey(<span class="string">&quot;atguigu&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    exchange.getResponse().setStatusCode(HttpStatus.BAD_REQUEST);</span><br><span class="line">                    <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">        <span class="meta">@Setter</span> <span class="meta">@Getter</span></span><br><span class="line">        <span class="keyword">private</span> String status;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>4ã€é‡å†™shortcutFieldOrder</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">shortcutFieldOrder</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">    list.add(<span class="string">&quot;status&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5ã€ç©ºå‚æ„é€ æ–¹æ³•ï¼Œå†…éƒ¨è°ƒç”¨super</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">MyGatewayFilterFactory</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(MyGatewayFilterFactory.Config.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyGatewayFilterFactory</span> <span class="keyword">extends</span> <span class="title class_">AbstractGatewayFilterFactory</span>&lt;MyGatewayFilterFactory.Config&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyGatewayFilterFactory</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>(MyGatewayFilterFactory.Config.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> GatewayFilter <span class="title function_">apply</span><span class="params">(MyGatewayFilterFactory.Config config)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GatewayFilter</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> exchange.getRequest();</span><br><span class="line">                System.out.println(<span class="string">&quot;è¿›å…¥äº†è‡ªå®šä¹‰ç½‘å…³è¿‡æ»¤å™¨MyGatewayFilterFactoryï¼Œstatusï¼š&quot;</span>+config.getStatus());</span><br><span class="line">                <span class="keyword">if</span>(request.getQueryParams().containsKey(<span class="string">&quot;atguigu&quot;</span>))&#123;</span><br><span class="line">                    <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    exchange.getResponse().setStatusCode(HttpStatus.BAD_REQUEST);</span><br><span class="line">                    <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">shortcutFieldOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.asList(<span class="string">&quot;status&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Config</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">@Getter</span><span class="meta">@Setter</span></span><br><span class="line">        <span class="keyword">private</span> String status;<span class="comment">//è®¾å®šä¸€ä¸ªçŠ¶æ€å€¼/æ ‡å¿—ä½ï¼Œå®ƒç­‰äºå¤šå°‘ï¼ŒåŒ¹é…å’Œæ‰å¯ä»¥è®¿é—®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å•ä¸€å†…ç½®è¿‡æ»¤å™¨GatewayFilter</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è‡ªå®šä¹‰Filterè®¾ç½®å¥½äº†ï¼Œç°åœ¨å†™YMLæµ‹è¯•æ•ˆæœ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#ä»¥å¾®æœåŠ¡æ³¨å†Œè¿›consulæˆ–nacosæœåŠ¡åˆ—è¡¨å†…</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">consul:</span> <span class="comment">#é…ç½®consulåœ°å€</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh1</span> <span class="comment">#pay_routh1                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/get/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai]</span></span><br><span class="line">            <span class="comment">#- Cookie=username,zzyy</span></span><br><span class="line">            <span class="comment"># - Header=X-Request-Id, \d+ # è¯·æ±‚å¤´è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">            <span class="comment">#- Host=**.atguigu.com</span></span><br><span class="line">            <span class="comment">#- Query=username, \d+  # è¦æœ‰å‚æ•°åusernameå¹¶ä¸”å€¼è¿˜è¦æ˜¯æ•´æ•°æ‰èƒ½è·¯ç”±</span></span><br><span class="line">            <span class="comment">#- RemoteAddr=192.168.124.1/24 # å¤–éƒ¨è®¿é—®æˆ‘çš„IPé™åˆ¶ï¼Œæœ€å¤§è·¨åº¦ä¸è¶…è¿‡32ï¼Œç›®å‰æ˜¯1~24å®ƒä»¬æ˜¯ CIDR è¡¨ç¤ºæ³•ã€‚</span></span><br><span class="line">            <span class="comment">#- My=gold</span></span><br><span class="line"><span class="comment">#            - name: My</span></span><br><span class="line"><span class="comment">#              args:</span></span><br><span class="line"><span class="comment">#                userType: diamond</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh2</span> <span class="comment">#pay_routh2                #è·¯ç”±çš„ID(ç±»ä¼¼mysqlä¸»é”®ID)ï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment">#uri: http://localhost:8001                #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/info/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">pay_routh3</span> <span class="comment">#pay_routh3</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span>                <span class="comment">#åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/pay/gateway/filter/**</span>              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±ï¼Œé»˜è®¤æ­£ç¡®åœ°å€</span></span><br><span class="line">            <span class="comment">#- Path=/gateway/filter/**              # æ–­è¨€ï¼Œä¸ºé…åˆPrefixPathæµ‹è¯•è¿‡æ»¤ï¼Œæš‚æ—¶æ³¨é‡Šæ‰/pay</span></span><br><span class="line">            <span class="comment">#- Path=/XYZ/abc/&#123;segment&#125;           # æ–­è¨€ï¼Œä¸ºé…åˆSetPathæµ‹è¯•ï¼Œ&#123;segment&#125;çš„å†…å®¹æœ€åè¢«SetPathå–ä»£</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">My=atguigu</span></span><br><span class="line">            <span class="comment">#- RedirectTo=302, http://www.atguigu.com/ # è®¿é—®http://localhost:9527/pay/gateway/filterè·³è½¬åˆ°http://www.atguigu.com/</span></span><br><span class="line">            <span class="comment">#- SetPath=/pay/gateway/&#123;segment&#125;  # &#123;segment&#125;è¡¨ç¤ºå ä½ç¬¦ï¼Œä½ å†™abcä¹Ÿè¡Œä½†è¦ä¸Šä¸‹ä¸€è‡´</span></span><br><span class="line">            <span class="comment">#- PrefixPath=/pay # http://localhost:9527/pay/gateway/filter  è¢«åˆ†æ‹†ä¸º: PrefixPath + Path</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">AddRequestHeader=X-Request-atguigu1,atguiguValue1</span>  <span class="comment"># è¯·æ±‚å¤´kvï¼Œè‹¥ä¸€å¤´å«æœ‰å¤šå‚åˆ™é‡å†™ä¸€è¡Œè®¾ç½®</span></span><br><span class="line">            <span class="comment">#- AddRequestHeader=X-Request-atguigu2,atguiguValue2</span></span><br><span class="line">            <span class="comment">#- RemoveRequestHeader=sec-fetch-site      # åˆ é™¤è¯·æ±‚å¤´sec-fetch-site</span></span><br><span class="line">            <span class="comment">#- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # å°†è¯·æ±‚å¤´sec-fetch-modeå¯¹åº”çš„å€¼ä¿®æ”¹ä¸ºBlue-updatebyzzyy</span></span><br><span class="line">            <span class="comment">#- AddRequestParameter=customerId,9527001 # æ–°å¢è¯·æ±‚å‚æ•°Parameterï¼šk ï¼Œv</span></span><br><span class="line">            <span class="comment">#- RemoveRequestParameter=customerName   # åˆ é™¤urlè¯·æ±‚å‚æ•°customerNameï¼Œä½ ä¼ é€’è¿‡æ¥ä¹Ÿæ˜¯null</span></span><br><span class="line">            <span class="comment">#- AddResponseHeader=X-Response-atguigu, BlueResponse # æ–°å¢è¯·æ±‚å‚æ•°X-Response-atguiguå¹¶è®¾å€¼ä¸ºBlueResponse</span></span><br><span class="line">            <span class="comment">#- SetResponseHeader=Date,2099-11-11 # è®¾ç½®å›åº”å¤´Dateå€¼ä¸º2099-11-11</span></span><br><span class="line">            <span class="comment">#- RemoveResponseHeader=Content-Type # å°†é»˜è®¤è‡ªå¸¦Content-Typeå›åº”å±æ€§åˆ é™¤</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114005134341.png" alt="image-20260114005134341"></p>
<h3 id="Gatewayæ•´åˆé˜¿é‡Œå·´å·´Sentinelå®ç°å®¹é”™"><a href="#Gatewayæ•´åˆé˜¿é‡Œå·´å·´Sentinelå®ç°å®¹é”™" class="headerlink" title="Gatewayæ•´åˆé˜¿é‡Œå·´å·´Sentinelå®ç°å®¹é”™"></a>Gatewayæ•´åˆé˜¿é‡Œå·´å·´Sentinelå®ç°å®¹é”™</h3><h1 id="10ã€SpringCloud-Alibabaå…¥é—¨ç®€ä»‹"><a href="#10ã€SpringCloud-Alibabaå…¥é—¨ç®€ä»‹" class="headerlink" title="10ã€SpringCloud Alibabaå…¥é—¨ç®€ä»‹"></a>10ã€SpringCloud Alibabaå…¥é—¨ç®€ä»‹</h1><p>SpringCloud Alibabaæ˜¯SpringCloudçš„Alibabaç‰ˆæœ¬ï¼Œå’Œé˜¿é‡Œäº‘èåˆå¾ˆå¥½ã€‚</p>
<p>é‡Œé¢æ•´åˆäº†ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠå¿…é¡»ç»„ä»¶ã€‚ä»€ä¹ˆæ˜¯å¿…é¡»ç»„ä»¶</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114022229904.png" alt="image-20260114022229904"></p>
<p>åé¢SchedulerXç›¸å½“äºxxl-job</p>
<h2 id="èƒ½å¹²å˜›-6"><a href="#èƒ½å¹²å˜›-6" class="headerlink" title="èƒ½å¹²å˜›"></a>èƒ½å¹²å˜›</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114024833283.png" alt="image-20260114024833283"></p>
<h2 id="æ€ä¹ˆç©-2"><a href="#æ€ä¹ˆç©-2" class="headerlink" title="æ€ä¹ˆç©"></a>æ€ä¹ˆç©</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114033032993.png" alt="image-20260114033032993"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114033048524.png" alt="image-20260114033048524"></p>
<h1 id="11ã€SpringCloudAlibaba-NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ"><a href="#11ã€SpringCloudAlibaba-NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ" class="headerlink" title="11ã€SpringCloudAlibaba NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ"></a>11ã€SpringCloudAlibaba NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114033423983.png" alt="image-20260114033423983"></p>
<h2 id="Nacosç®€ä»‹"><a href="#Nacosç®€ä»‹" class="headerlink" title="Nacosç®€ä»‹"></a>Nacosç®€ä»‹</h2><p>å°±æ˜¯æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡é…ç½®ä¸­å¿ƒ</p>
<h2 id="Nacosä¸‹è½½å®‰è£…"><a href="#Nacosä¸‹è½½å®‰è£…" class="headerlink" title="Nacosä¸‹è½½å®‰è£…"></a>Nacosä¸‹è½½å®‰è£…</h2><p><a target="_blank" rel="noopener" href="https://nacos.io/docs/v2.5/quickstart/quick-start/?spm=5238cd80.2ef5001f.0.0.3f613b7c5OLJo6">Nacos å¿«é€Ÿå¼€å§‹ | Nacos å®˜ç½‘</a></p>
<p><strong>å„ç§æ³¨å†Œä¸­å¿ƒæ¯”è¾ƒ</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114034606155.png" alt="image-20260114034606155"></p>
<p>æ®è¯´ Nacos åœ¨é˜¿é‡Œå·´å·´å†…éƒ¨æœ‰è¶…è¿‡ 10 ä¸‡çš„å®ä¾‹è¿è¡Œï¼Œå·²ç»è¿‡äº†ç±»ä¼¼åŒåä¸€ç­‰å„ç§å¤§å‹æµé‡çš„è€ƒéªŒï¼ŒNacosé»˜è®¤æ˜¯APæ¨¡å¼ï¼Œä½†ä¹Ÿå¯ä»¥è°ƒæ•´åˆ‡æ¢ä¸ºCPï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨é»˜è®¤APå³å¯ã€‚</p>
<h3 id="å…ˆä»å®˜ç½‘ä¸‹è½½Nacos"><a href="#å…ˆä»å®˜ç½‘ä¸‹è½½Nacos" class="headerlink" title="å…ˆä»å®˜ç½‘ä¸‹è½½Nacos"></a>å…ˆä»å®˜ç½‘ä¸‹è½½Nacos</h3><p>è¿™é‡Œå…ˆ2.2.3ç‰ˆæœ¬çš„</p>
<p>è§£å‹å®‰è£…åŒ…ç„¶åè¿è¡Œbinç›®å½•ä¸‹çš„startup.cmd</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startup.cmd -m standalone</span><br></pre></td></tr></table></figure>
<p>ç„¶åè®¿é—®<code>localhost:8848/nacos</code> é»˜è®¤è´¦å·å¯†ç éƒ½æ˜¯nacosç„¶åå°±èƒ½è¿›å…¥é¡µé¢äº†</p>
<p>å…³é—­æœåŠ¡å™¨</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown.cmd</span><br></pre></td></tr></table></figure>
<h2 id="Nacos-Discovery-æœåŠ¡æ³¨å†Œä¸­å¿ƒ"><a href="#Nacos-Discovery-æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="Nacos Discovery æœåŠ¡æ³¨å†Œä¸­å¿ƒ"></a>Nacos Discovery æœåŠ¡æ³¨å†Œä¸­å¿ƒ</h2><p>é€šè¿‡Nacos Server å’Œ <code>spring-cloud-starter-alibaba-nacos-discovery</code> å®ç°æœåŠ¡çš„æ³¨å†Œä¸å‘ç°</p>
<h3 id="åŸºäºNacosçš„æœåŠ¡æä¾›è€…"><a href="#åŸºäºNacosçš„æœåŠ¡æä¾›è€…" class="headerlink" title="åŸºäºNacosçš„æœåŠ¡æä¾›è€…"></a>åŸºäºNacosçš„æœåŠ¡æä¾›è€…</h3><p>æ–°å»ºModule <code>cloudalibaba-provider-payment9001</code></p>
<p>æ”¹POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloudalibaba-provider-payment9001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--nacos-discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté€šç”¨ä¾èµ–æ¨¡å—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å†™YML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9001</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-payment-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#é…ç½®Nacosåœ°å€</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114205311592.png" alt="image-20260114205311592"></p>
<p>ä¸»å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main9001</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main9001.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸šåŠ¡ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PayAlibabaController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/pay/nacos/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPayInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;nacos registry, serverPort: &quot;</span>+ serverPort+<span class="string">&quot;\t id&quot;</span>+id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•</p>
<h3 id="åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…"><a href="#åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…"></a>åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…</h3><p>æ–°å»ºModule <code>cloudalibaba-consumer-nacos-order83</code></p>
<p><strong>POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloudalibaba-consumer-nacos-order83<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--nacos-discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--loadbalancer--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--web + actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>YML</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">83</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-order-consumer</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line"><span class="comment">#æ¶ˆè´¹è€…å°†è¦å»è®¿é—®çš„å¾®æœåŠ¡åç§°(nacoså¾®æœåŠ¡æä¾›è€…å«ä»€ä¹ˆä½ å†™ä»€ä¹ˆ)</span></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">nacos-user-service:</span> <span class="string">http://nacos-payment-provider</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260114211755546.png" alt="image-20260114211755546"></p>
<p><strong>ä¸»å¯åŠ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main83</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main83.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é…ç½®config</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span> <span class="comment">// èµ‹äºˆRestTemplateè´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸šåŠ¡ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderNacosController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;service-url.nacos-user-service&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverURL;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/pay/nacos/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">paymentInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> restTemplate.getForObject(serverURL + <span class="string">&quot;/pay/nacos/&quot;</span> + id, String.class);</span><br><span class="line">        <span class="keyword">return</span> result+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;    æˆ‘æ˜¯OrderNacosController83è°ƒç”¨è€…ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p><strong>å‚ç…§9001æ–°å»º9002</strong></p>
<p>è¦ä¹ˆè€å®æ–°å»ºï¼Œè¦ä¹ˆå–å·§ï¼Œç›´æ¥æ‹·è´è™šæ‹Ÿç«¯å£æ˜ å°„ï¼Œä¹‹å‰ç”¨çš„æ˜¯è€å®æ–¹æ³•ï¼Œè¿™æ¬¡ç”¨æ‹·è´è™šæ‹Ÿç«¯å£æ˜ å°„çš„æ–¹æ³•</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115093810797.png" alt="image-20260115093810797"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115094207432.png" alt="image-20260115094207432"></p>
<p>ç„¶åæ·»åŠ <code>-DServer.port=9002</code></p>
<p>ç„¶åå°±æœ‰ä¸ªè™šæ‹Ÿçš„serviceæ˜¯9002äº†</p>
<p>ç„¶åæµ‹è¯•ï¼Œå‘ç°9001å’Œ9002äº¤æ›¿å‡ºç°ï¼Œè´Ÿè½½å‡è¡¡è¾¾åˆ°</p>
<h2 id="Nacos-ConfigæœåŠ¡é…ç½®ä¸­å¿ƒ"><a href="#Nacos-ConfigæœåŠ¡é…ç½®ä¸­å¿ƒ" class="headerlink" title="Nacos ConfigæœåŠ¡é…ç½®ä¸­å¿ƒ"></a>Nacos ConfigæœåŠ¡é…ç½®ä¸­å¿ƒ</h2><p>ä¹‹å‰æ¡ˆä¾‹Consul8500æœåŠ¡é…ç½®åŠ¨æ€å˜æ›´åŠŸèƒ½å¯ä»¥è¢«Nacoså–ä»£</p>
<p>é€šè¿‡Nacoså’Œ<code>spring-cloud-starter-alibaba-nacos-config</code>å®ç°ä¸­å¿ƒåŒ–å…¨å±€é…ç½®çš„åŠ¨æ€å˜æ›´</p>
<h3 id="Nacosä½œä¸ºé…ç½®ä¸­å¿ƒé…ç½®æ­¥éª¤"><a href="#Nacosä½œä¸ºé…ç½®ä¸­å¿ƒé…ç½®æ­¥éª¤" class="headerlink" title="Nacosä½œä¸ºé…ç½®ä¸­å¿ƒé…ç½®æ­¥éª¤"></a>Nacosä½œä¸ºé…ç½®ä¸­å¿ƒé…ç½®æ­¥éª¤</h3><p>å»ºModule <code>cloudalibaba-config-nacos-client3377</code></p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloudalibaba-config-nacos-client3377<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bootstrap--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--nacos-config--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--nacos-discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--web + actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¼•å…¥<code>bootstrap</code>ï¼Œè®°å¾—ä¹‹å‰çš„<code>bootstrap.yml</code>å°±çŸ¥é“è¿™ä¸ªä¾èµ–æ˜¯åšä»€ä¹ˆçš„äº†ã€‚</p>
<p><strong>YML</strong></p>
<p>é…ç½®ä¸¤ä¸ªï¼Œä¸ºå•¥è¦é…ç½®ä¸¤ä¸ª</p>
<p>NacosåŒConsulä¸€æ ·ï¼Œåœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶ï¼Œè¦ä¿è¯å…ˆä»é…ç½®ä¸­å¿ƒè¿›è¡Œé…ç½®æ‹‰å–ï¼Œ</p>
<p>æ‹‰å–é…ç½®ä¹‹åï¼Œæ‰èƒ½ä¿è¯é¡¹ç›®çš„æ­£å¸¸å¯åŠ¨ï¼Œä¸ºäº†æ»¡è¶³åŠ¨æ€åˆ·æ–°å’Œå…¨å±€å¹¿æ’­é€šçŸ¥</p>
<p> springbootä¸­é…ç½®æ–‡ä»¶çš„åŠ è½½æ˜¯å­˜åœ¨ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œbootstrapä¼˜å…ˆçº§é«˜äºapplication</p>
<p><strong>bootstrap</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nacosé…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config-client</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#Nacosä½œä¸ºé…ç½®ä¸­å¿ƒåœ°å€</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span> <span class="comment">#æŒ‡å®šyamlæ ¼å¼çš„é…ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nacosç«¯é…ç½®æ–‡ä»¶DataIdçš„å‘½åè§„åˆ™æ˜¯ï¼š</span></span><br><span class="line"><span class="comment"># $&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;</span></span><br><span class="line"><span class="comment"># æœ¬æ¡ˆä¾‹çš„DataIDæ˜¯:nacos-config-client-dev.yaml</span></span><br></pre></td></tr></table></figure>
<p><strong>application.yml</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">3377</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span> <span class="comment"># è¡¨ç¤ºå¼€å‘ç¯å¢ƒ</span></span><br><span class="line">       <span class="comment">#active: prod # è¡¨ç¤ºç”Ÿäº§ç¯å¢ƒ</span></span><br><span class="line">       <span class="comment">#active: test # è¡¨ç¤ºæµ‹è¯•ç¯å¢ƒ</span></span><br></pre></td></tr></table></figure>
<p><strong>ä¸»å¯åŠ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NacosConfigClient3377</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(NacosConfigClient3377.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸šåŠ¡ç±»</strong></p>
<p><strong>NacosConfigClientController</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RefreshScope</span> <span class="comment">//åœ¨æ§åˆ¶å™¨ç±»åŠ å…¥@RefreshScopeæ³¨è§£ä½¿å½“å‰ç±»ä¸‹çš„é…ç½®æ”¯æŒNacosçš„åŠ¨æ€åˆ·æ–°åŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NacosConfigClientController</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;config.info&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String configInfo;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/config/info&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getConfigInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> configInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Nacosçš„æ•°æ®ä¼šæŒä¹…åŒ–åˆ°å†…åµŒæ•°æ®åº“derbyä¸­ï¼Œå¯ä»¥è‡ªè¡Œé…ç½®æŒä¹…åŒ–åˆ°MySQLä¸­ã€‚æ­¤å¤–ï¼ŒNacosä¸æƒ³ConsulæŒä¹…åŒ–åèƒ½å¤Ÿå¼€æœºè‡ªå¯åŠ¨ï¼Œåœ¨æœåŠ¡åˆ—è¡¨æ²¡æœ‰NacosæœåŠ¡</strong></p>
<h3 id="Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯"><a href="#Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯" class="headerlink" title="Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯"></a>Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯</h3><h4 id="Nacosä¸­çš„åŒ¹é…è§„åˆ™"><a href="#Nacosä¸­çš„åŒ¹é…è§„åˆ™" class="headerlink" title="Nacosä¸­çš„åŒ¹é…è§„åˆ™"></a>Nacosä¸­çš„åŒ¹é…è§„åˆ™</h4><h5 id="è®¾ç½®DataIdç†è®º"><a href="#è®¾ç½®DataIdç†è®º" class="headerlink" title="è®¾ç½®DataIdç†è®º"></a>è®¾ç½®DataIdç†è®º</h5><p><strong>å…¬å¼ï¼š</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nacosç«¯é…ç½®æ–‡ä»¶DataIdçš„å‘½åè§„åˆ™æ˜¯ï¼š</span></span><br><span class="line"><span class="comment"># $&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;</span></span><br><span class="line"><span class="comment"># æœ¬æ¡ˆä¾‹çš„DataIDæ˜¯:nacos-config-client-dev.yaml</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115104955157.png" alt="image-20260115104955157"></p>
<h5 id="é…ç½®DataIdå®æ“"><a href="#é…ç½®DataIdå®æ“" class="headerlink" title="é…ç½®DataIdå®æ“"></a>é…ç½®DataIdå®æ“</h5><p>åˆ›å»ºé…ç½®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115105114743.png" alt="image-20260115105114743"></p>
<p>æµ‹è¯•ä¸€ä¸‹ï¼Œç„¶åä¹Ÿæ˜¯åŠ¨æ€åˆ·æ–°çš„ã€‚</p>
<p><strong>å†å²é…ç½®</strong></p>
<p>Nacosä¼šè®°å½•é…ç½®æ–‡ä»¶çš„å†å²ç‰ˆæœ¬ï¼Œé»˜è®¤ä¿ç•™30å¤©ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€é”®å›æ»šåŠŸèƒ½ï¼Œå›æ»šä¼šè§¦å‘é…ç½®æ›´æ–°ã€‚</p>
<h2 id="Nacosæ•°æ®æ¨¡å‹ä¹‹Namespace-Group-DataId"><a href="#Nacosæ•°æ®æ¨¡å‹ä¹‹Namespace-Group-DataId" class="headerlink" title="Nacosæ•°æ®æ¨¡å‹ä¹‹Namespace-Group-DataId"></a>Nacosæ•°æ®æ¨¡å‹ä¹‹Namespace-Group-DataId</h2><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>å¤šç¯å¢ƒå¤šé¡¹ç›®ç®¡ç†</p>
<p>é—®é¢˜1ï¼š</p>
<p>å®é™…å¼€å‘ä¸­ï¼Œé€šå¸¸ä¸€ä¸ªç³»ç»Ÿä¼šå‡†å¤‡</p>
<p>devå¼€å‘ç¯å¢ƒ</p>
<p>testæµ‹è¯•ç¯å¢ƒ</p>
<p>prodç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>å¦‚ä½•ä¿è¯æŒ‡å®šç¯å¢ƒå¯åŠ¨æ—¶æœåŠ¡èƒ½æ­£ç¡®è¯»å–åˆ°Nacosä¸Šç›¸åº”ç¯å¢ƒçš„é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ</p>
<p>é—®é¢˜2ï¼š</p>
<p>ä¸€ä¸ªå¤§å‹åˆ†å¸ƒå¼å¾®æœåŠ¡ç³»ç»Ÿä¼šæœ‰å¾ˆå¤šå¾®æœåŠ¡å­é¡¹ç›®ï¼Œ</p>
<p>æ¯ä¸ªå¾®æœåŠ¡é¡¹ç›®åˆéƒ½ä¼šæœ‰ç›¸åº”çš„å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€é¢„å‘ç¯å¢ƒã€æ­£å¼ç¯å¢ƒâ€¦â€¦</p>
<p>é‚£æ€ä¹ˆå¯¹è¿™äº›å¾®æœåŠ¡é…ç½®è¿›è¡Œåˆ†ç»„å’Œå‘½åç©ºé—´ç®¡ç†å‘¢ï¼Ÿ</p>
<h3 id="Namespace-Group-DataIdä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡"><a href="#Namespace-Group-DataIdä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡" class="headerlink" title="Namespace+Group+DataIdä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡"></a>Namespace+Group+DataIdä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115162246779.png" alt="image-20260115162246779"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">æ¦‚å¿µ</th>
<th style="text-align:center">æ ¸å¿ƒè§£é‡Š</th>
<th style="text-align:center">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Namespace</td>
<td style="text-align:center">ç±»ä¼¼ Java çš„ package å / ç±»åï¼Œæœ€å¤–å±‚ç»´åº¦ï¼Œç”¨äºåŒºåˆ†éƒ¨ç½²ç¯å¢ƒï¼ˆå¦‚å¼€å‘ / æµ‹è¯• / ç”Ÿäº§ï¼‰ï¼Œå®ç°ç¯å¢ƒéš”ç¦»</td>
<td style="text-align:center">public</td>
</tr>
<tr>
<td style="text-align:center">Group</td>
<td style="text-align:center">é€»è¾‘ä¸ŠåŒºåˆ†ç›®æ ‡å¯¹è±¡ï¼Œå¯å°†ä¸åŒå¾®æœåŠ¡åˆ’åˆ†åˆ°åŒä¸€ä¸ªåˆ†ç»„ä¸­</td>
<td style="text-align:center">DEFAULT_GROUP</td>
</tr>
<tr>
<td style="text-align:center">DataID</td>
<td style="text-align:center">ä¸ Namespaceã€Group é…åˆï¼Œé€»è¾‘ä¸ŠåŒºåˆ†ä¸¤ä¸ªç›®æ ‡å¯¹è±¡ï¼ˆè¡¥å……è‡ªæ¦‚å¿µ 1 çš„æè¿°ï¼‰</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">Service</td>
<td style="text-align:center">å³å¾®æœåŠ¡ï¼Œæ˜¯ Nacos æœåŠ¡æ³¨å†Œå‘ç°çš„æ ¸å¿ƒå¯¹è±¡</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">Cluster</td>
<td style="text-align:center">å¯¹æŒ‡å®šå¾®æœåŠ¡çš„è™šæ‹Ÿåˆ’åˆ†ï¼Œä¸€ä¸ª Service å¯åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª Cluster</td>
<td style="text-align:center">DEFAULT</td>
</tr>
</tbody>
</table>
</div>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115162407441.png" alt="image-20260115162407441"></p>
<p>Namespace æ ¸å¿ƒä»·å€¼æ˜¯<strong>ç¯å¢ƒéš”ç¦»</strong>ï¼šå¦‚åˆ›å»º dev/test/prod ä¸‰ä¸ª Namespaceï¼Œä¸åŒç¯å¢ƒçš„é…ç½® / æœåŠ¡äº’ç›¸éš”ç¦»ï¼›</p>
<p>Group æ ¸å¿ƒä»·å€¼æ˜¯<strong>ä¸šåŠ¡åˆ†ç»„</strong>ï¼šå¦‚å°†è®¢å•ã€æ”¯ä»˜å¾®æœåŠ¡å½’åˆ° â€œBUSINESS_GROUPâ€ï¼Œå°†åŸºç¡€ç»„ä»¶å½’åˆ° â€œBASE_GROUPâ€ï¼›</p>
<p>Cluster æ ¸å¿ƒä»·å€¼æ˜¯<strong>å¾®æœåŠ¡é›†ç¾¤åˆ’åˆ†</strong>ï¼šå¦‚ä¸€ä¸ª Service ä¸‹çš„ Cluster å¯åŒºåˆ†ååŒ—é›†ç¾¤ã€åå—é›†ç¾¤ç­‰ã€‚</p>
<p>dataIDæœ‰å…·ä½“çš„å‘½åè§„åˆ™ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸åŒã€‚</p>
<h3 id="ä¸‰ç§æ–¹æ¡ˆåŠ è½½é…ç½®"><a href="#ä¸‰ç§æ–¹æ¡ˆåŠ è½½é…ç½®" class="headerlink" title="ä¸‰ç§æ–¹æ¡ˆåŠ è½½é…ç½®"></a>ä¸‰ç§æ–¹æ¡ˆåŠ è½½é…ç½®</h3><h4 id="1ã€DataIDæ–¹æ¡ˆ"><a href="#1ã€DataIDæ–¹æ¡ˆ" class="headerlink" title="1ã€DataIDæ–¹æ¡ˆ"></a>1ã€DataIDæ–¹æ¡ˆ</h4><p><strong>æŒ‡å®š<code>spring.profile.activeå’Œé…ç½®æ–‡ä»¶çš„DataIDæ¥ä½¿ä¸åŒç¯å¢ƒä¸‹è¯»å–ä¸åŒçš„é…ç½®</code></strong></p>
<p><strong>é»˜è®¤ç©ºé—´Public+é»˜è®¤åˆ†ç»„DEFAULT_GROUP+æ–°å»ºDataID</strong></p>
<p>æ–°å»ºtesté…ç½®DataID <code>nacos-config-client-test.yaml</code></p>
<p>ä¿®æ”¹application.yml</p>
<h4 id="2ã€Groupæ–¹æ¡ˆ"><a href="#2ã€Groupæ–¹æ¡ˆ" class="headerlink" title="2ã€Groupæ–¹æ¡ˆ"></a>2ã€Groupæ–¹æ¡ˆ</h4><p>é€šè¿‡Groupå®ç°ç¯å¢ƒåŒºåˆ†</p>
<p><strong>é»˜è®¤ç©ºé—´public+æ–°å»ºPROD_GROUP+æ–°å»ºDataID</strong></p>
<p>æ–°å»ºprodé…ç½®DataID <code>nacos-config-client-prod.yaml</code></p>
<p>æ–°å»ºGroup PROD_GROUP</p>
<p>ä¿®æ”¹YML</p>
<p>åœ¨configä¸‹æ–°å¢ä¸€æ¡groupé…ç½®å³å¯</p>
<h4 id="3ã€Namespaceæ–¹æ¡ˆ"><a href="#3ã€Namespaceæ–¹æ¡ˆ" class="headerlink" title="3ã€Namespaceæ–¹æ¡ˆ"></a>3ã€Namespaceæ–¹æ¡ˆ</h4><p>é€šè¿‡Namespaceå®ç°æ˜æ˜ç©ºé—´ç¯å¢ƒåŒºåˆ†</p>
<p>æ–°å»ºNamespace: Prod_Namespace<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260115164604201.png" alt="image-20260115164604201"></p>
<p><strong>Prod_Namespace+PROD_GROUP+DataIDï¼ˆnacos-config-client-prod.yamlï¼‰</strong></p>
<p>ç„¶åé€‰å®šProd_Namespaceåæ–°å»ºé…ç½®</p>
<p>ç„¶åä¿®æ”¹YMLï¼Œåœ¨configä¸‹é¢æ–°å¢ä¸€æ¡namespace</p>
<h1 id="12ã€SpringCloud-Alibaba-Sentinelå®ç°ç†”æ–­å’Œé™æµ"><a href="#12ã€SpringCloud-Alibaba-Sentinelå®ç°ç†”æ–­å’Œé™æµ" class="headerlink" title="12ã€SpringCloud Alibaba Sentinelå®ç°ç†”æ–­å’Œé™æµ"></a>12ã€SpringCloud Alibaba Sentinelå®ç°ç†”æ–­å’Œé™æµ</h1><h2 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260116002259267.png" alt="image-20260116002259267"></p>
<p>ä»æµé‡è·¯ç”±ã€æµé‡æ§åˆ¶ã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”è¿‡è½½ä¿æŠ¤ã€çƒ­ç‚¹æµé‡é˜²æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥å¸®åŠ©å¼€å‘è€…ä¿éšœå¾®æœåŠ¡çš„ç¨³å®šæ€§</p>
<h3 id="æ€ä¹ˆç©-3"><a href="#æ€ä¹ˆç©-3" class="headerlink" title="æ€ä¹ˆç©"></a>æ€ä¹ˆç©</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260116063050116.png" alt="image-20260116063050116"></p>
<p><strong>é¢è¯•é¢˜</strong></p>
<p>ç¼“å­˜ç©¿é€+ç¼“å­˜å‡»ç©¿+ç¼“å­˜é›ªå´©å¦‚ä½•è§£å†³ã€‚å›é¡¾redis</p>
<p>è¿™é‡Œå¤§æ¦‚è®²è®²ã€‚</p>
<p>ç¼“å­˜ç©¿é€å°±æ˜¯è®¿é—®ä¸å­˜åœ¨çš„å€¼ç›´æ¥æ‰“åˆ°mysqlé‡Œé¢ã€‚è§£å†³æ–¹æ¡ˆä¸€å°±æ˜¯å­˜ç©ºç™½æˆ–è€…ä¸å­˜åœ¨çš„å€¼ï¼Œæ–¹æ¡ˆäºŒå°±æ˜¯å¸ƒéš†è¿‡æ»¤å™¨ï¼Œè®©è¿‡æ»¤å™¨å……å½“é»‘åå•ï¼Œä¸å­˜åœ¨çš„å€¼å­˜å…¥è¿‡æ»¤å™¨é‡Œç›´æ¥è¿‡æ»¤å¤§éƒ¨åˆ†éæ³•è¯·æ±‚ã€‚</p>
<p>å‡»ç©¿å°±æ˜¯çƒ­ç‚¹keyå¤±æ•ˆï¼Œè¿™é‡Œå•æœºç‰ˆå°±ç”¨jvmé”ï¼Œåˆ†å¸ƒå¼å°±ç”¨redisåˆ†å¸ƒå¼é”ï¼Œç„¶åæ¥è¿›è¡ŒåŒæ£€åŠ é”ã€‚å¤§æ¦‚ï¼›æ„æ€å°±æ˜¯æ›´æ–°çƒ­ç‚¹keyçš„æ—¶å€™å…ˆæŠŠçƒ­ç‚¹keyç¼“å­˜ï¼Œå†æ”¾é”ï¼Œå¦åˆ™å°±ç­‰å¾…ï¼Œé˜²æ­¢æš´æ‰“mysqlã€‚</p>
<p>ç¼“å­˜é›ªå´©å°±æ˜¯å¤§é¢ç§¯redisç¼“å­˜å¤±æ•ˆã€‚redis ä¸­ key è®¾ç½®ä¸ºæ°¸ä¸è¿‡æœŸ or è¿‡æœŸæ—¶é—´é”™å¼€</p>
<p>redis ç¼“å­˜é›†ç¾¤å®ç°é«˜å¯ç”¨ </p>
<p>â€‹    ä¸»ä» + å“¨å…µ</p>
<p>â€‹    Redis Cluster</p>
<p>â€‹    å¼€å¯RedisæŒä¹…åŒ–æœºåˆ¶aof / rdb ï¼Œå°½å¿«å›å¤ç¼“å­˜é›†ç¾¤    </p>
<p>å¤šç¼“å­˜ç»“åˆé¢„é˜²é›ªå´©</p>
<p>â€‹    caffeineæˆ–è€…ehcacheæœ¬åœ°ç¼“å­˜ + redisç¼“å­˜</p>
<p>æœåŠ¡é™çº§</p>
<p>â€‹    Hystrix æˆ–è€… é˜¿é‡Œsentinelé™æµ &amp; é™çº§</p>
<p><strong>äººæ°‘å¸ç©å®¶</strong>   é˜¿é‡Œäº‘-äº‘æ•°æ®åº“Redisç‰ˆä¸Šé¢å…¨éƒ¨éƒ½æä¾›æœåŠ¡</p>
<h4 id="æœåŠ¡é›ªå´©"><a href="#æœåŠ¡é›ªå´©" class="headerlink" title="æœåŠ¡é›ªå´©"></a>æœåŠ¡é›ªå´©</h4><p>AæœåŠ¡è°ƒç”¨BæœåŠ¡ï¼Œç„¶åå„ç§è°ƒç”¨ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡å‡ºé”™ï¼Œæ•´ä¸ªé“¾ä¸Šçš„æœåŠ¡å…¨éƒ¨å¤±è´¥ï¼Œè¿™å°±æ˜¯æœåŠ¡é›ªå´©ã€‚</p>
<h4 id="æœåŠ¡é™çº§-1"><a href="#æœåŠ¡é™çº§-1" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h4><p>æœåŠ¡é™çº§ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ç§æœåŠ¡æ‰˜åº•æ–¹æ¡ˆï¼Œå¦‚æœæœåŠ¡æ— æ³•å®Œæˆæ­£å¸¸çš„è°ƒç”¨æµç¨‹ï¼Œå°±ä½¿ç”¨é»˜è®¤çš„æ‰˜åº•æ–¹æ¡ˆæ¥è¿”å›æ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨å•†å“è¯¦æƒ…é¡µä¸€èˆ¬éƒ½ä¼šå±•ç¤ºå•†å“çš„ä»‹ç»ä¿¡æ¯ï¼Œä¸€æ—¦å•†å“è¯¦æƒ…é¡µç³»ç»Ÿå‡ºç°æ•…éšœæ— æ³•è°ƒç”¨æ—¶ï¼Œä¼šç›´æ¥è·å–ç¼“å­˜ä¸­çš„å•†å“ä»‹ç»ä¿¡æ¯è¿”å›ç»™å‰ç«¯é¡µé¢ã€‚</p>
<h4 id="æœåŠ¡ç†”æ–­-1"><a href="#æœåŠ¡ç†”æ–­-1" class="headerlink" title="æœåŠ¡ç†”æ–­"></a>æœåŠ¡ç†”æ–­</h4><p>åœ¨åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸‹æ¸¸æœåŠ¡å› ä¸ºè®¿é—®å‹åŠ›è¿‡å¤§å¯¼è‡´å“åº”å¾ˆæ…¢æˆ–è€…ä¸€ç›´è°ƒç”¨å¤±è´¥æ—¶ï¼Œä¸Šæ¸¸æœåŠ¡ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„æ•´ä½“å¯ç”¨æ€§ï¼Œä¼šæš‚æ—¶æ–­å¼€ä¸ä¸‹æ¸¸æœåŠ¡çš„è°ƒç”¨è¿æ¥ã€‚è¿™ç§æ–¹å¼å°±æ˜¯ç†”æ–­ã€‚ç±»æ¯”ä¿é™©ä¸è¾¾åˆ°æœ€å¤§æœåŠ¡è®¿é—®åï¼Œç›´æ¥æ‹’ç»è®¿é—®ï¼Œæ‹‰é—¸é™ç”µï¼Œç„¶åè°ƒç”¨æœåŠ¡é™çº§çš„æ–¹æ³•å¹¶è¿”å›å‹å¥½æç¤ºã€‚</p>
<p>æœåŠ¡ç†”æ–­ä¸€èˆ¬æƒ…å†µä¸‹ä¼šæœ‰ä¸‰ç§çŠ¶æ€ï¼šé—­åˆã€å¼€å¯å’ŒåŠç†”æ–­;</p>
<p>é—­åˆçŠ¶æ€(ä¿é™©ä¸é—­åˆé€šç”µOK)ï¼šæœåŠ¡ä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰æ•…éšœæ—¶ï¼Œä¸Šæ¸¸æœåŠ¡è°ƒç”¨ä¸‹æ¸¸æœåŠ¡æ—¶ï¼Œä¸ä¼šæœ‰ä»»ä½•é™åˆ¶ã€‚</p>
<p> å¼€å¯çŠ¶æ€(ä¿é™©ä¸æ–­å¼€é€šç”µError)ï¼šä¸Šæ¸¸æœåŠ¡ä¸å†è°ƒç”¨ä¸‹æ¸¸æœåŠ¡çš„æ¥å£ï¼Œä¼šç›´æ¥è¿”å›ä¸Šæ¸¸æœåŠ¡ä¸­é¢„å®šçš„æ–¹æ³•ã€‚</p>
<p> åŠç†”æ–­çŠ¶æ€ï¼šå¤„äºå¼€å¯çŠ¶æ€æ—¶ï¼Œä¸Šæ¸¸æœåŠ¡ä¼šæ ¹æ®ä¸€å®šçš„è§„åˆ™ï¼Œå°è¯•æ¢å¤å¯¹ä¸‹æ¸¸æœåŠ¡çš„è°ƒç”¨ã€‚æ­¤æ—¶ï¼Œä¸Šæ¸¸æœåŠ¡ä¼šä»¥æœ‰é™çš„æµé‡æ¥è°ƒç”¨ä¸‹æ¸¸æœåŠ¡ï¼ŒåŒæ—¶ï¼Œä¼šç›‘æ§è°ƒç”¨çš„æˆåŠŸç‡ã€‚å¦‚æœæˆåŠŸç‡è¾¾åˆ°é¢„æœŸï¼Œåˆ™è¿›å…¥å…³é—­çŠ¶æ€ã€‚å¦‚æœæœªè¾¾åˆ°é¢„æœŸï¼Œä¼šé‡æ–°è¿›å…¥å¼€å¯çŠ¶æ€ã€‚</p>
<h4 id="æœåŠ¡é™æµ-1"><a href="#æœåŠ¡é™æµ-1" class="headerlink" title="æœåŠ¡é™æµ"></a>æœåŠ¡é™æµ</h4><p>æœåŠ¡é™æµå°±æ˜¯é™åˆ¶è¿›å…¥ç³»ç»Ÿçš„æµé‡ï¼Œä»¥é˜²æ­¢è¿›å…¥ç³»ç»Ÿçš„æµé‡è¿‡å¤§è€Œå‹å®ç³»ç»Ÿã€‚å…¶ä¸»è¦çš„ä½œç”¨å°±æ˜¯ä¿æŠ¤æœåŠ¡èŠ‚ç‚¹æˆ–è€…é›†ç¾¤åé¢çš„æ•°æ®èŠ‚ç‚¹ï¼Œé˜²æ­¢ç¬æ—¶æµé‡è¿‡å¤§ä½¿æœåŠ¡å’Œæ•°æ®å´©æºƒï¼ˆå¦‚å‰ç«¯ç¼“å­˜å¤§é‡å®æ•ˆï¼‰ï¼Œé€ æˆä¸å¯ç”¨ï¼›è¿˜å¯ç”¨äºå¹³æ»‘è¯·æ±‚ï¼Œç±»ä¼¼ç§’æ€é«˜å¹¶å‘ç­‰æ“ä½œï¼Œä¸¥ç¦ä¸€çªèœ‚çš„è¿‡æ¥æ‹¥æŒ¤ï¼Œå¤§å®¶æ’é˜Ÿï¼Œä¸€ç§’é’ŸNä¸ªï¼Œæœ‰åºè¿›è¡Œã€‚</p>
<p>é™æµç®—æ³•æœ‰ä¸¤ç§ï¼Œ<strong>ä¸€ç§å°±æ˜¯ç®€å•çš„è¯·æ±‚æ€»é‡è®¡æ•°ï¼Œä¸€ç§å°±æ˜¯æ—¶é—´çª—å£é™æµ</strong>ï¼ˆä¸€èˆ¬ä¸º1sï¼‰ï¼Œå¦‚ä»¤ç‰Œæ¡¶ç®—æ³•å’Œæ¼ç‰Œæ¡¶ç®—æ³•å°±æ˜¯æ—¶é—´çª—å£çš„é™æµç®—æ³•ã€‚æ¼æ¡¶æ— æ³•åº”å¯¹çªå‘çŠ¶å†µä½†æ˜¯èƒ½æ§åˆ¶é€Ÿç‡ï¼Œé€Ÿç‡éå¸¸ç¨³å®šï¼Œå°±æ˜¯åªèƒ½å›ºå®šè®¾ç½®æ¡¶å¤§å°å’Œæµé€Ÿï¼Œä»¤ç‰Œæ¡¶ç”¨çš„æ˜¯é¢„å­˜ä»¤ç‰Œï¼Œä¸€ä¸ªè¯·æ±‚æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œï¼Œæœ‰ä»¤ç‰Œçš„æ‰èƒ½è¿›å…¥ï¼Œå¦åˆ™å°±æ’é˜Ÿè€Œä¸æ˜¯è¶…å‡ºå°±ç«‹åˆ»æ‹’ç»ã€‚</p>
<h4 id="æœåŠ¡éš”ç¦»"><a href="#æœåŠ¡éš”ç¦»" class="headerlink" title="æœåŠ¡éš”ç¦»"></a>æœåŠ¡éš”ç¦»</h4><p>æœ‰ç‚¹ç±»ä¼¼äºç³»ç»Ÿçš„å‚ç›´æ‹†åˆ†ï¼Œå°±æŒ‰ç…§ä¸€å®šçš„è§„åˆ™å°†ç³»ç»Ÿåˆ’åˆ†æˆå¤šä¸ªæœåŠ¡æ¨¡å—ï¼Œå¹¶ä¸”æ¯ä¸ªæœåŠ¡æ¨¡å—ä¹‹é—´æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œä¸ä¼šå­˜åœ¨å¼ºä¾èµ–çš„å…³ç³»ã€‚å¦‚æœæŸä¸ªæ‹†åˆ†åçš„æœåŠ¡å‘ç”Ÿæ•…éšœåï¼Œèƒ½å¤Ÿå°†æ•…éšœäº§ç”Ÿçš„å½±å“é™åˆ¶åœ¨æŸä¸ªå…·ä½“çš„æœåŠ¡å†…ï¼Œä¸ä¼šå‘å…¶ä»–æœåŠ¡æ‰©æ•£ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ä¼šå¯¹æ•´ä½“æœåŠ¡äº§ç”Ÿè‡´å‘½çš„å½±å“ã€‚</p>
<p>äº’è”ç½‘è¡Œä¸šå¸¸ç”¨çš„æœåŠ¡éš”ç¦»æ–¹å¼æœ‰ï¼šçº¿ç¨‹æ± éš”ç¦»å’Œä¿¡å·é‡éš”ç¦»ã€‚</p>
<p><strong>ä¿¡å·é‡èˆ±å£å°±æ˜¯åˆ©ç”¨è°ƒç”¨æ–¹çš„çº¿ç¨‹ï¼Œå¯¹å¹¶å‘é‡é™åˆ¶ï¼Œå›ºå®šçº¿ç¨‹æ± èˆ±å£å°±æ˜¯æœåŠ¡å™¨é‡Œé¢ä¸“å±çº¿ç¨‹æ± ï¼Œå’Œè°ƒç”¨æ–¹çº¿ç¨‹éš”ç¦»</strong></p>
<h4 id="æœåŠ¡è¶…æ—¶"><a href="#æœåŠ¡è¶…æ—¶" class="headerlink" title="æœåŠ¡è¶…æ—¶"></a>æœåŠ¡è¶…æ—¶</h4><p>æ•´ä¸ªç³»ç»Ÿé‡‡ç”¨åˆ†å¸ƒå¼å’Œå¾®æœåŠ¡æ¶æ„åï¼Œç³»ç»Ÿè¢«æ‹†åˆ†æˆä¸€ä¸ªä¸ªå°æœåŠ¡ï¼Œå°±ä¼šå­˜åœ¨æœåŠ¡ä¸æœåŠ¡ä¹‹é—´äº’ç›¸è°ƒç”¨çš„ç°è±¡ï¼Œä»è€Œå½¢æˆä¸€ä¸ªä¸ªè°ƒç”¨é“¾ã€‚</p>
<p>å½¢æˆè°ƒç”¨é“¾å…³ç³»çš„ä¸¤ä¸ªæœåŠ¡ä¸­ï¼Œä¸»åŠ¨è°ƒç”¨å…¶ä»–æœåŠ¡æ¥å£çš„æœåŠ¡å¤„äºè°ƒç”¨é“¾çš„ä¸Šæ¸¸ï¼Œæä¾›æ¥å£ä¾›å…¶ä»–æœåŠ¡è°ƒç”¨çš„æœåŠ¡å¤„äºè°ƒç”¨é“¾çš„ä¸‹æ¸¸ã€‚æœåŠ¡è¶…æ—¶å°±æ˜¯åœ¨ä¸Šæ¸¸æœåŠ¡è°ƒç”¨ä¸‹æ¸¸æœåŠ¡æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªæœ€å¤§å“åº”æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæœ€å¤§å“åº”æ—¶é—´ä¸‹æ¸¸æœåŠ¡è¿˜æœªè¿”å›ç»“æœï¼Œåˆ™æ–­å¼€ä¸Šæ¸¸æœåŠ¡ä¸ä¸‹æ¸¸æœåŠ¡ä¹‹é—´çš„è¯·æ±‚è¿æ¥ï¼Œé‡Šæ”¾èµ„æºã€‚</p>
<h3 id="å®‰è£…Sentinel"><a href="#å®‰è£…Sentinel" class="headerlink" title="å®‰è£…Sentinel"></a>å®‰è£…Sentinel</h3><h4 id="sentinelç»„ä»¶ç”±2éƒ¨åˆ†æ„æˆ"><a href="#sentinelç»„ä»¶ç”±2éƒ¨åˆ†æ„æˆ" class="headerlink" title="sentinelç»„ä»¶ç”±2éƒ¨åˆ†æ„æˆ"></a>sentinelç»„ä»¶ç”±2éƒ¨åˆ†æ„æˆ</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260116082446478.png" alt="image-20260116082446478"></p>
<p>åå°8719é»˜è®¤</p>
<p>å‰å°8080å¼€å¯</p>
<h4 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h4><p>å…ˆä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶åè¿è¡Œå‘½ä»¤ï¼Œå‰æ8080ç«¯å£ä¸èƒ½è¢«å ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar sentinel-dashboard-1.8.6.jar</span><br></pre></td></tr></table></figure>
<p>è´¦å·å¯†ç éƒ½ä¸ºsentinel</p>
<h3 id="å¾®æœåŠ¡8401æ•´åˆSentinelå…¥é—¨æ¡ˆä¾‹"><a href="#å¾®æœåŠ¡8401æ•´åˆSentinelå…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å¾®æœåŠ¡8401æ•´åˆSentinelå…¥é—¨æ¡ˆä¾‹"></a>å¾®æœåŠ¡8401æ•´åˆSentinelå…¥é—¨æ¡ˆä¾‹</h3><h4 id="å¯åŠ¨Nacos8848æˆåŠŸ"><a href="#å¯åŠ¨Nacos8848æˆåŠŸ" class="headerlink" title="å¯åŠ¨Nacos8848æˆåŠŸ"></a>å¯åŠ¨Nacos8848æˆåŠŸ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startup.cmd -m standalone</span><br></pre></td></tr></table></figure>
<h4 id="å¯åŠ¨Sentinel8080æˆåŠŸ"><a href="#å¯åŠ¨Sentinel8080æˆåŠŸ" class="headerlink" title="å¯åŠ¨Sentinel8080æˆåŠŸ"></a>å¯åŠ¨Sentinel8080æˆåŠŸ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar sentinel-dashboard-1.8.6.jar</span><br></pre></td></tr></table></figure>
<h4 id="æ–°å»ºå¾®æœåŠ¡8401"><a href="#æ–°å»ºå¾®æœåŠ¡8401" class="headerlink" title="æ–°å»ºå¾®æœåŠ¡8401"></a>æ–°å»ºå¾®æœåŠ¡8401</h4><p><code>cloudalibaba-sentinel-service8401</code> å°†è¢«å“¨å…µçº³å…¥ç®¡æ§çš„8401å¾®æœåŠ¡æä¾›è€…</p>
<p>POM</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2024<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloudalibaba-sentinel-service8401<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringCloud alibaba sentinel --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--nacos-discovery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ… --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.bitzh.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SpringBooté€šç”¨ä¾èµ–æ¨¡å—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hutool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>YML</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8401</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloudalibaba-sentinel-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span>         <span class="comment">#NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">transport:</span></span><br><span class="line">        <span class="attr">dashboard:</span> <span class="string">localhost:8080</span> <span class="comment">#é…ç½®Sentinel dashboardæ§åˆ¶å°æœåŠ¡åœ°å€</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">8719</span> <span class="comment">#é»˜è®¤8719ç«¯å£ï¼Œå‡å¦‚è¢«å ç”¨ä¼šè‡ªåŠ¨ä»8719å¼€å§‹ä¾æ¬¡+1æ‰«æ,ç›´è‡³æ‰¾åˆ°æœªè¢«å ç”¨çš„ç«¯å£</span></span><br></pre></td></tr></table></figure>
<p>ä¸»å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main8401</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SpringApplication.run(Main8401.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>ä¸šåŠ¡ç±»<code>FlowLimitController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlowLimitController</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testA&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testA</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testA&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testB&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testB</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testB&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h4 id="å¯åŠ¨åæŸ¥çœ‹æ§åˆ¶å°"><a href="#å¯åŠ¨åæŸ¥çœ‹æ§åˆ¶å°" class="headerlink" title="å¯åŠ¨åæŸ¥çœ‹æ§åˆ¶å°"></a>å¯åŠ¨åæŸ¥çœ‹æ§åˆ¶å°</h4><p>å‘ç°ç©ºç©ºå¦‚ä¹Ÿå•¥ä¹Ÿæ²¡æœ‰ã€‚</p>
<p>Sentinelé‡‡ç”¨çš„<strong>æ‡’åŠ è½½</strong>è¯´æ˜ã€‚</p>
<p><strong>æ³¨æ„</strong> æƒ³è¦ä½¿ç”¨Sentinelå¯¹æŸä¸ªæ¥å£è¿›è¡Œé™æµå’Œé™çº§ç­‰æ“ä½œï¼Œä¸€å®šè¦å…ˆè®¿é—®ä¸‹æ¥å£ï¼Œä½¿ç”¨Sentinelæ£€æµ‹å‡ºç›¸åº”çš„æ¥å£ã€‚è®¿é—®ä¸€æ¬¡æ¥å£å³å¯ã€‚</p>
<p>ç„¶åçœ‹åˆ°ä¸€äº›æŒ‡æ ‡</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">æŒ‡æ ‡</th>
<th style="text-align:left">å…¨ç§°</th>
<th style="text-align:left">å«ä¹‰</th>
<th style="text-align:left">ä¸ QPS çš„å…³ç³»</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>QPS</strong></td>
<td style="text-align:left">Queries Per Second</td>
<td style="text-align:left">æ¯ç§’å¤„ç†è¯·æ±‚æ•°</td>
<td style="text-align:left"><strong>ååé‡çš„æ ¸å¿ƒä½“ç°</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>RT</strong></td>
<td style="text-align:left">Response Time</td>
<td style="text-align:left">å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td>
<td style="text-align:left">QPS â†‘ é€šå¸¸ RT â†‘ï¼ˆèµ„æºç«äº‰ï¼‰</td>
</tr>
<tr>
<td style="text-align:left"><strong>å¹¶å‘æ•°ï¼ˆConcurrencyï¼‰</strong></td>
<td style="text-align:left">â€”</td>
<td style="text-align:left">åŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°</td>
<td style="text-align:left">è¿‘ä¼¼å…¬å¼ï¼š<strong>å¹¶å‘æ•° â‰ˆ QPS Ã— å¹³å‡ RTï¼ˆç§’ï¼‰</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>TPS</strong></td>
<td style="text-align:left">Transactions Per Second</td>
<td style="text-align:left">æ¯ç§’äº‹åŠ¡æ•°</td>
<td style="text-align:left">åœ¨æ•°æ®åº“/æ”¯ä»˜åœºæ™¯æ›´å¸¸ç”¨ï¼Œ1 äº‹åŠ¡å¯èƒ½å«å¤šä¸ªæŸ¥è¯¢</td>
</tr>
<tr>
<td style="text-align:left"><strong>RPS</strong></td>
<td style="text-align:left">Requests Per Second</td>
<td style="text-align:left">æ¯ç§’è¯·æ±‚æ•°</td>
<td style="text-align:left">ä¸ QPS å¸¸æ··ç”¨ï¼Œä½† RPS å¯åŒ…å«å¤±è´¥è¯·æ±‚</td>
</tr>
</tbody>
</table>
</div>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://oyy0v0.top">oyy0v0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://oyy0v0.top/2026/01/06/2026-1-5%20SpringCloud/">https://oyy0v0.top/2026/01/06/2026-1-5%20SpringCloud/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://oyy0v0.top" target="_blank">oyy0v0ğŸ˜¼</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring%E5%85%A8%E5%AE%B6%E6%A1%B6/">-Springå…¨å®¶æ¡¶</a></div><div class="post_share"><div class="social-share" data-image="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025/12/16/2025-12-16%20Java%E6%B3%A8%E8%A7%A3/" title="Javaæ³¨è§£"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Javaæ³¨è§£</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2025/10/12/2025-10-13%20mybatis%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86/" title="Mybatisçš„æ‰§è¡ŒåŸç†"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-12</div><div class="title">Mybatisçš„æ‰§è¡ŒåŸç†</div></div></a></div><div><a href="/2024/08/07/2024-8-7%20Springboot/" title="Springboot"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-07</div><div class="title">Springboot</div></div></a></div><div><a href="/2024/07/20/2025-10-20%20Mybatis/" title="Mybatis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-20</div><div class="title">Mybatis</div></div></a></div><div><a href="/2025/10/30/2025-10-30%20Spring%E6%89%A9%E5%B1%95%E7%82%B9%E6%A1%88%E4%BE%8B/" title="Springæ‰©å±•ç‚¹æ¡ˆä¾‹"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-30</div><div class="title">Springæ‰©å±•ç‚¹æ¡ˆä¾‹</div></div></a></div><div><a href="/2025/11/23/2025-11-22%20Spring%E6%94%B6%E5%BD%95%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Springé¢è¯•"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-23</div><div class="title">Springé¢è¯•</div></div></a></div><div><a href="/2025/10/23/2025-10-23%20Spring/" title="Spring"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-23</div><div class="title">Spring</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">oyy0v0</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/oyy0v0"><i class="fab fa-github"></i><span>ğŸ’•å‰å¾€å°å®¶</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/assets/QRCode.jpg" target="_blank" title="icon-weixin"><i class="å¾®ä¿¡" style="color: faa-tada;"></i></a><a class="social-icon" href="https://github.com/oyy0v0" target="_blank" title="icon-github"><i class="Github" style="color: faa-tade;"></i></a><a class="social-icon" href="mailto:2925886492@qq.com" target="_blank" title="icon-youxiang"><i class="QQé‚®ç®±" style="color: faa-tada;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥æ¥åˆ°æˆ‘çš„åšå®¢</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E4%BB%8Eboot%E5%92%8Ccloud%E7%89%88%E6%9C%AC%E9%80%89%E5%9E%8B%E5%BC%80%E5%A7%8B"><span class="toc-text">1ã€ä»bootå’Œcloudç‰ˆæœ¬é€‰å‹å¼€å§‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E9%80%89%E5%9E%8B"><span class="toc-text">æœ€ç»ˆé€‰å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A8%E6%BC%94%E8%BF%87%E7%A8%8B"><span class="toc-text">æ¨æ¼”è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81%E5%85%B3%E4%BA%8ECloud%E5%90%84%E7%A7%8D%E7%BB%84%E4%BB%B6%E7%9A%84%E5%81%9C%E6%9B%B4-%E5%8D%87%E7%BA%A7-%E6%9B%BF%E6%8D%A2"><span class="toc-text">2ã€å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´&#x2F;å‡çº§&#x2F;æ›¿æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86%E5%85%A5%E9%97%A8"><span class="toc-text">å¾®æœåŠ¡ç†è®ºçŸ¥è¯†å…¥é—¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%BC%96%E7%A0%81Base%E5%B7%A5%E7%A8%8B%E6%A8%A1%E5%9D%97%E6%9E%84%E5%BB%BA"><span class="toc-text">3ã€å¾®æœåŠ¡æ¶æ„ç¼–ç Baseå·¥ç¨‹æ¨¡å—æ„å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-text">éœ€æ±‚è¯´æ˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E5%AE%9A-gt-%E9%85%8D%E7%BD%AE-gt-%E7%BC%96%E7%A0%81"><span class="toc-text">çº¦å®š &gt; é…ç½® &gt; ç¼–ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA%E6%96%B0%E5%BB%BAProject%E5%92%8CMaven%E7%88%B6%E5%B7%A5%E7%A8%8B"><span class="toc-text">IDEAæ–°å»ºProjectå’ŒMavençˆ¶å·¥ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1cloud%E6%95%B4%E4%BD%93%E8%81%9A%E5%90%88Maven%E7%88%B6%E5%B7%A5%E7%A8%8BProject"><span class="toc-text">å¾®æœåŠ¡cloudæ•´ä½“èšåˆMavençˆ¶å·¥ç¨‹Project</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81New-Project"><span class="toc-text">1ã€New Project</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%81%9A%E5%90%88%E6%80%BB%E7%88%B6%E5%B7%A5%E7%A8%8B%E5%90%8D%E5%AD%97"><span class="toc-text">2ã€èšåˆæ€»çˆ¶å·¥ç¨‹åå­—</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="toc-text">3ã€å­—ç¬¦ç¼–ç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B3%A8%E8%A7%A3%E7%94%9F%E6%95%88%E6%BF%80%E6%B4%BB"><span class="toc-text">4ã€æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81java%E7%BC%96%E8%AF%91%E7%89%88%E6%9C%AC%E9%80%8917"><span class="toc-text">5ã€javaç¼–è¯‘ç‰ˆæœ¬é€‰17</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81File-Type%E8%BF%87%E6%BB%A4%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AE%E8%87%AA%E5%B7%B1%E7%9A%84Maven"><span class="toc-text">6ã€File Typeè¿‡æ»¤ä»¥åŠé…ç½®è‡ªå·±çš„Maven</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E5%B7%A5%E7%A8%8BPOM%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-text">çˆ¶å·¥ç¨‹POMæ–‡ä»¶å†…å®¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Maven%E5%B7%A5%E7%A8%8B%E8%90%BD%E5%9C%B0%E7%BB%86%E8%8A%82%E5%A4%8D%E4%B9%A0"><span class="toc-text">Mavenå·¥ç¨‹è½åœ°ç»†èŠ‚å¤ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Maven%E4%B8%AD%E7%9A%84DependencyManagement%E5%92%8CDependencies"><span class="toc-text">Mavenä¸­çš„DependencyManagementå’ŒDependencies</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#maven%E4%B8%AD%E8%B7%B3%E8%BF%87%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-text">mavenä¸­è·³è¿‡å•å…ƒæµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mysql%E9%A9%B1%E5%8A%A8%E8%AF%B4%E6%98%8E"><span class="toc-text">mysqlé©±åŠ¨è¯´æ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Mysql5"><span class="toc-text">Mysql5</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Mysql8"><span class="toc-text">Mysql8</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper4%E4%B9%8B%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90"><span class="toc-text">Mapper4ä¹‹ä¸€é”®ç”Ÿæˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mybatis-generator"><span class="toc-text">mybatis-generator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MyBatis%E9%80%9A%E7%94%A8Mapper4%E5%AE%98%E7%BD%91"><span class="toc-text">MyBatisé€šç”¨Mapper4å®˜ç½‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E6%AD%A5%E9%AA%A4"><span class="toc-text">ä¸€é”®ç”Ÿæˆæ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SQL"><span class="toc-text">SQL</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Module"><span class="toc-text">Module</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POM"><span class="toc-text">POM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-text">é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90"><span class="toc-text">ä¸€é”®ç”Ÿæˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rest%E9%80%9A%E7%94%A8Base%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BA"><span class="toc-text">Resté€šç”¨Baseå·¥ç¨‹æ„å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8BV1"><span class="toc-text">å·¥ç¨‹V1</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81cloud-provider-payment8001%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%85%E6%94%AF%E4%BB%98Module%E6%A8%A1%E5%9D%97"><span class="toc-text">1ã€cloud-provider-payment8001å¾®æœåŠ¡æä¾›è€…æ”¯ä»˜Moduleæ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%B0%8F%E5%8F%A3%E8%AF%80"><span class="toc-text">å¾®æœåŠ¡å°å£è¯€</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-text">æ­¥éª¤</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E4%B8%8A%E9%9D%A2%E6%A8%A1%E5%9D%97%E8%BF%98%E6%9C%89%E5%93%AA%E4%BA%9B%E9%97%AE%E9%A2%98"><span class="toc-text">2ã€ä¸Šé¢æ¨¡å—è¿˜æœ‰å“ªäº›é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E9%97%AE%E9%A2%98"><span class="toc-text">1ã€æ—¶é—´æ ¼å¼é—®é¢˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81Java%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1API%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%BB%9F%E4%B8%80%E6%A0%BC%E5%BC%8F%E8%BF%94%E5%9B%9E%EF%BC%9F"><span class="toc-text">2ã€Javaå¦‚ä½•è®¾è®¡APIæ¥å£å®ç°ç»Ÿä¸€æ ¼å¼è¿”å›ï¼Ÿ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E4%BB%8B%E5%85%A5%E8%BF%94%E5%9B%9E%E7%9A%84%E6%A0%87%E5%87%86%E6%A0%BC%E5%BC%8F"><span class="toc-text">3ã€å…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8BV2"><span class="toc-text">å·¥ç¨‹V2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E9%97%AE%E9%A2%98"><span class="toc-text">è§£å†³æ—¶é—´æ ¼å¼é—®é¢˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">è§£å†³ç»Ÿä¸€è¿”å›å€¼</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-text">æ€è·¯</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-1"><span class="toc-text">æ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9PayController"><span class="toc-text">ä¿®æ”¹PayController</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%EF%BC%9A%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E4%BB%8B%E5%85%A5%E8%BF%94%E5%9B%9E%E7%9A%84%E6%A0%87%E5%87%86%E6%A0%BC%E5%BC%8F"><span class="toc-text">è§£å†³ï¼šå…¨å±€å¼‚å¸¸ä»‹å…¥è¿”å›çš„æ ‡å‡†æ ¼å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">ä¸ºä»€ä¹ˆéœ€è¦å…¨å±€å¼‚å¸¸å¤„ç†å™¨</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E7%B1%BB"><span class="toc-text">æ–°å»ºå…¨å±€å¼‚å¸¸ç±»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%90%86%E5%BF%B5%EF%BC%8C%E4%BB%8E%E8%BF%99%E9%87%8C%E5%BC%80%E5%A7%8B"><span class="toc-text">å¼•å…¥å¾®æœåŠ¡ç†å¿µï¼Œä»è¿™é‡Œå¼€å§‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E5%BE%AE%E6%9C%8D%E5%8A%A180%E5%A6%82%E4%BD%95%E6%89%8D%E8%83%BD%E8%B0%83%E7%94%A8%E5%88%B0%E6%94%AF%E4%BB%98%E5%BE%AE%E6%9C%8D%E5%8A%A18001%EF%BC%9F"><span class="toc-text">è®¢å•å¾®æœåŠ¡80å¦‚ä½•æ‰èƒ½è°ƒç”¨åˆ°æ”¯ä»˜å¾®æœåŠ¡8001ï¼Ÿ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cloud-consumer-order80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E8%80%85%E8%AE%A2%E5%8D%95Module%E6%A8%A1%E5%9D%97"><span class="toc-text">cloud-consumer-order80å¾®æœåŠ¡è°ƒç”¨è€…è®¢å•Moduleæ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-cloud-consumer-order80"><span class="toc-text">å»ºç«‹ cloud-consumer-order80</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%94%B9POM"><span class="toc-text">æ”¹POM</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%86%99YML"><span class="toc-text">å†™YML</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E7%B1%BB"><span class="toc-text">ä¸šåŠ¡ç±»</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8B%E9%87%8D%E6%9E%84"><span class="toc-text">å·¥ç¨‹é‡æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F%E9%97%AE%E9%A2%98"><span class="toc-text">è§‚å¯Ÿé—®é¢˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B0%E5%BB%BAModule"><span class="toc-text">æ–°å»ºModule</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%94%B9POM-1"><span class="toc-text">æ”¹POM</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#entities"><span class="toc-text">entities</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%AE%E5%89%8D%E5%B7%A5%E7%A8%8B%E6%A0%B7%E5%9B%BE"><span class="toc-text">ç›®å‰å·¥ç¨‹æ ·å›¾</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%BC%95%E5%85%A5%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">ä¸ºä»€ä¹ˆè¦å¼•å…¥å¾®æœåŠ¡</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81Consul%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0"><span class="toc-text">4ã€ConsulæœåŠ¡æ³¨å†Œä¸å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%BC%95%E5%85%A5%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="toc-text">ä¸ºä»€ä¹ˆè¦å¼•å…¥æœåŠ¡æ³¨å†Œä¸­å¿ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%86%8D%E4%BD%BF%E7%94%A8%E8%80%81%E7%89%8C%E7%9A%84Eureka"><span class="toc-text">ä¸ºä»€ä¹ˆä¸å†ä½¿ç”¨è€ç‰Œçš„Eureka</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#consul%E7%AE%80%E4%BB%8B"><span class="toc-text">consulç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B"><span class="toc-text">èƒ½å¹²å˜›</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0"><span class="toc-text">æœåŠ¡å‘ç°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%81%A5%E5%BA%B7%E6%A3%80%E6%B5%8B"><span class="toc-text">å¥åº·æ£€æµ‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KV%E5%AD%98%E5%82%A8"><span class="toc-text">KVå­˜å‚¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83"><span class="toc-text">å¤šæ•°æ®ä¸­å¿ƒ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96Web%E7%95%8C%E9%9D%A2"><span class="toc-text">å¯è§†åŒ–Webç•Œé¢</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E5%93%AA%E9%87%8C%E4%B8%8B"><span class="toc-text">å»å“ªé‡Œä¸‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%8E%A9"><span class="toc-text">æ€ä¹ˆç©</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B9%B6%E8%BF%90%E8%A1%8Cconsul"><span class="toc-text">å®‰è£…å¹¶è¿è¡Œconsul</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0"><span class="toc-text">æœåŠ¡æ³¨å†Œä¸å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%858001"><span class="toc-text">æœåŠ¡æä¾›è€…8001</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E6%9C%8D%E5%8A%A1provider8001%E6%B3%A8%E5%86%8C%E8%BF%9Bconsul"><span class="toc-text">æ”¯ä»˜æœåŠ¡provider8001æ³¨å†Œè¿›consul</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POM-1"><span class="toc-text">POM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#YML"><span class="toc-text">YML</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E5%90%AF%E5%8A%A8"><span class="toc-text">ä¸»å¯åŠ¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A88001%E5%B9%B6%E6%9F%A5%E7%9C%8Bconsul%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-text">å¯åŠ¨8001å¹¶æŸ¥çœ‹consulæ§åˆ¶å°</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%8580"><span class="toc-text">æœåŠ¡æ¶ˆè´¹è€…80</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#POM-2"><span class="toc-text">POM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#YML-1"><span class="toc-text">YML</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E5%90%AF%E5%8A%A8-1"><span class="toc-text">ä¸»å¯åŠ¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Controller"><span class="toc-text">Controller</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%B9%B6%E6%9F%A5%E7%9C%8Bconsul%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-text">å¯åŠ¨å¹¶æŸ¥çœ‹consulæ§åˆ¶å°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95%E5%9C%B0%E5%9D%80"><span class="toc-text">è®¿é—®æµ‹è¯•åœ°å€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9RestTemplateConfig"><span class="toc-text">é…ç½®ä¿®æ”¹RestTemplateConfig</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E4%B8%AA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%BC%82%E5%90%8C%E7%82%B9"><span class="toc-text">ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒå¼‚åŒç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CAP%E7%90%86%E8%AE%BA%E7%9A%84%E6%A0%B8%E5%BF%83%E6%98%AF"><span class="toc-text">CAPç†è®ºçš„æ ¸å¿ƒæ˜¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%88%B7%E6%96%B0"><span class="toc-text">æœåŠ¡é…ç½®ä¸åˆ·æ–°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-text">åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E8%AF%B4%E6%98%8E"><span class="toc-text">å®˜ç½‘è¯´æ˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">æœåŠ¡é…ç½®æ¡ˆä¾‹æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-text">éœ€æ±‚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9cloud-provider-payment8001"><span class="toc-text">ä¿®æ”¹cloud-provider-payment8001</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POM-3"><span class="toc-text">POM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#YML-2"><span class="toc-text">YML</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%A7%84%E5%88%99%E8%AF%B4%E6%98%8E"><span class="toc-text">é…ç½®è§„åˆ™è¯´æ˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6bootstrap-yml"><span class="toc-text">æ–°å¢é…ç½®æ–‡ä»¶bootstrap.yml</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#application-yml"><span class="toc-text">application.yml</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#consul%E6%9C%8D%E5%8A%A1%E5%99%A8key-value%E9%85%8D%E7%BD%AE%E5%A1%AB%E5%86%99"><span class="toc-text">consulæœåŠ¡å™¨key&#x2F;valueé…ç½®å¡«å†™</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%A7%84%E5%88%99"><span class="toc-text">å‚è€ƒè§„åˆ™</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAconfig%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E4%BB%A5-%E7%BB%93%E5%B0%BE"><span class="toc-text">åˆ›å»ºconfigæ–‡ä»¶å¤¹ï¼Œä»¥ &#x2F; ç»“å°¾</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#controller"><span class="toc-text">controller</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%88%B7%E6%96%B0%E6%A1%88%E4%BE%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">åŠ¨æ€åˆ·æ–°æ¡ˆä¾‹æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-2"><span class="toc-text">æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#RefreshScope-%E4%B8%BB%E5%90%AF%E5%8A%A8%E7%B1%BB%E6%B7%BB%E5%8A%A0"><span class="toc-text">@RefreshScope ä¸»å¯åŠ¨ç±»æ·»åŠ </span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#bootstrap-yml%E4%BF%AE%E6%94%B9%E4%B8%8B%E7%AD%89%E5%BE%85%E6%97%B6%E9%97%B4"><span class="toc-text">bootstrap.ymlä¿®æ”¹ä¸‹ç­‰å¾…æ—¶é—´</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%80%83"><span class="toc-text">æ€è€ƒ</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81LoadBalancer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8"><span class="toc-text">5ã€LoadBalancerè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%BA%AB%E6%98%AFRibbon%EF%BC%8C%E7%9B%AE%E5%89%8D%E8%BF%9B%E5%85%A5%E7%BB%B4%E6%8A%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">å‰èº«æ˜¯Ribbonï¼Œç›®å‰è¿›å…¥ç»´æŠ¤æ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-1"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ribbon%E6%9C%AA%E6%9D%A5%E6%9B%BF%E6%8D%A2%E6%96%B9%E6%A1%88"><span class="toc-text">Ribbonæœªæ¥æ›¿æ¢æ–¹æ¡ˆ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring-cloud-loadbalancer%E6%A6%82%E8%BF%B0"><span class="toc-text">spring-cloud-loadbalanceræ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-2"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%B4%9F%E8%BD%BD-vs-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%B4%9F%E8%BD%BD%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">å®¢æˆ·ç«¯è´Ÿè½½ vs æœåŠ¡ç«¯è´Ÿè½½çš„åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring-cloud-loadbalancer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E8%A7%A3%E6%9E%90"><span class="toc-text">spring-cloud-loadbalancerè´Ÿè½½å‡è¡¡è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-%E7%90%86%E8%AE%BA"><span class="toc-text">è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-ç†è®º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-%E5%AE%9E%E6%93%8D"><span class="toc-text">è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å®æ“</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%8F%82%E8%80%83%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8"><span class="toc-text">å®˜ç½‘å‚è€ƒå¦‚ä½•ä½¿ç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E7%85%A78001%E6%8B%B7%E8%B4%9D%E5%90%8E%E6%96%B0%E5%BB%BA8002%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">æŒ‰ç…§8001æ‹·è´åæ–°å»º8002å¾®æœåŠ¡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8Consul-%E5%B0%868001-8002%E5%90%AF%E5%8A%A8%E5%90%8E%E6%B3%A8%E5%86%8C%E8%BF%9B%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">å¯åŠ¨Consul,å°†8001&#x2F;8002å¯åŠ¨åæ³¨å†Œè¿›å¾®æœåŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Consul%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E9%85%8D%E7%BD%AE"><span class="toc-text">Consulæ•°æ®æŒä¹…åŒ–é…ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%9580%E6%A8%A1%E5%9D%97%E4%BF%AE%E6%94%B9POM%E5%B9%B6%E6%B3%A8%E5%86%8C%E8%BF%9Bconsul%EF%BC%8C%E6%96%B0%E5%A2%9ELoadBalancer%E7%BB%84%E4%BB%B6"><span class="toc-text">è®¢å•80æ¨¡å—ä¿®æ”¹POMå¹¶æ³¨å†Œè¿›consulï¼Œæ–°å¢LoadBalancerç»„ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B-%E5%B0%8F%E6%80%BB%E7%BB%93"><span class="toc-text">è´Ÿè½½å‡è¡¡æ¼”ç¤ºæ¡ˆä¾‹-å°æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E4%BD%BF%E7%94%A8DiscoverClient%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E4%B8%8A%E7%BA%BF%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%88%97%E8%A1%A8"><span class="toc-text">ç¼–ç ä½¿ç”¨DiscoverClientåŠ¨æ€è·å–æ‰€æœ‰ä¸Šçº¿çš„æœåŠ¡åˆ—è¡¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-text">è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%AE%97%E6%B3%95%E6%98%AF%E4%BB%80%E4%B9%88%E6%9C%89%E5%87%A0%E7%A7%8D%EF%BC%9F"><span class="toc-text">é»˜è®¤ç®—æ³•æ˜¯ä»€ä¹ˆæœ‰å‡ ç§ï¼Ÿ</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81OpenFeign%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8"><span class="toc-text">6ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-3"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-1"><span class="toc-text">èƒ½å¹²å˜›</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E6%8F%92%E6%8B%94%E7%9A%84%E6%B3%A8%E8%A7%A3%E6%94%AF%E6%8C%81%EF%BC%8C%E5%8C%85%E6%8B%ACFeign%E6%B3%A8%E8%A7%A3%E5%92%8CJAX-RS%E6%B3%A8%E8%A7%A3"><span class="toc-text">å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬Feignæ³¨è§£å’ŒJAX-RSæ³¨è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E5%8F%AF%E6%8F%92%E6%8B%94%E7%9A%84HTTP%E7%BC%96%E7%A0%81%E5%99%A8%E5%92%8C%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-text">æ”¯æŒå¯æ’æ‹”çš„HTTPç¼–ç å™¨å’Œè§£ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81Sentinel%E5%92%8C%E4%BB%96%E7%9A%84Fallback"><span class="toc-text">æ”¯æŒSentinelå’Œä»–çš„Fallback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81SpringCloudLoadBalancer%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-text">æ”¯æŒSpringCloudLoadBalancerçš„è´Ÿè½½å‡è¡¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E7%9A%84%E5%8E%8B%E7%BC%A9"><span class="toc-text">æ”¯æŒHTTPè¯·æ±‚å’Œå“åº”çš„å‹ç¼©</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%8E%A9-1"><span class="toc-text">æ€ä¹ˆç©</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3-%E6%B3%A8%E8%A7%A3"><span class="toc-text">æ¥å£+æ³¨è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">æµç¨‹æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BAMoudle"><span class="toc-text">å»ºMoudle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9POM-2"><span class="toc-text">æ”¹POM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99YML-1"><span class="toc-text">å†™YML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%90%AF%E5%8A%A8-2"><span class="toc-text">ä¸»å¯åŠ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E7%B1%BB-1"><span class="toc-text">ä¸šåŠ¡ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9cloud-api-commons%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="toc-text">ä¿®æ”¹cloud-api-commonsé€šç”¨æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%95%E5%85%A5openfeign%E4%BE%9D%E8%B5%96"><span class="toc-text">å¼•å…¥openfeignä¾èµ–</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3PayFeignApi-%E5%A4%B4%E4%B8%8A%E9%85%8D%E7%BD%AE-FeignClient%E6%B3%A8%E8%A7%A3"><span class="toc-text">æ–°å»ºæœåŠ¡æ¥å£PayFeignApi,å¤´ä¸Šé…ç½®@FeignClientæ³¨è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%BE%AE%E6%9C%8D%E5%8A%A18001%E7%9A%84Controller%E5%B1%82%EF%BC%8C%E6%96%B0%E5%BB%BAPayFeignApi%E6%8E%A5%E5%8F%A3"><span class="toc-text">å‚è€ƒå¾®æœåŠ¡8001çš„Controllerå±‚ï¼Œæ–°å»ºPayFeignApiæ¥å£</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-2"><span class="toc-text">æµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%80%BB%E7%BB%93"><span class="toc-text">å°æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-text">é«˜çº§ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81OpenFeign%E8%B6%85%E6%97%B6%E6%8E%A7%E5%88%B6"><span class="toc-text">1ã€OpenFeignè¶…æ—¶æ§åˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%85%E6%84%8F%E8%AE%BE%E7%BD%AE%E8%B6%85%E6%97%B6%E9%94%99%E8%AF%AF"><span class="toc-text">æ•…æ„è®¾ç½®è¶…æ—¶é”™è¯¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E6%96%B98001%E5%86%99%E6%9A%82%E5%81%9C62%E7%A7%92%E7%A8%8B%E5%BA%8F"><span class="toc-text">æœåŠ¡æä¾›æ–¹8001å†™æš‚åœ62ç§’ç¨‹åº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%96%B980%E5%86%99%E5%A5%BD%E6%8D%95%E6%8D%89%E8%B6%85%E6%97%B6%E5%BC%82%E5%B8%B8"><span class="toc-text">æœåŠ¡è°ƒç”¨æ–¹80å†™å¥½æ•æ‰è¶…æ—¶å¼‚å¸¸</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-3"><span class="toc-text">æµ‹è¯•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">ç»“è®º</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E8%A7%A3%E9%87%8A-%E9%85%8D%E7%BD%AE%E5%A4%84%E7%90%86"><span class="toc-text">å®˜ç½‘è§£é‡Š+é…ç½®å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE"><span class="toc-text">å…¨å±€é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E9%85%8D%E7%BD%AE"><span class="toc-text">æŒ‡å®šé…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81OpenFeign%E9%87%8D%E8%AF%95%E6%9C%BA%E5%88%B6"><span class="toc-text">2ã€OpenFeigné‡è¯•æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-3"><span class="toc-text">æ­¥éª¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E9%87%8D%E8%AF%95%E6%98%AF%E5%85%B3%E9%97%AD%E7%9A%84%EF%BC%8C%E7%BB%99%E4%BA%86%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-text">é»˜è®¤é‡è¯•æ˜¯å…³é—­çš„ï¼Œç»™äº†é»˜è®¤å€¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E9%87%8D%E8%AF%95%E5%8A%9F%E8%83%BD"><span class="toc-text">å¼€å¯é‡è¯•åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AE%E7%B1%BBFeignConfig%E5%B9%B6%E4%BF%AE%E6%94%B9Retryer%E9%85%8D%E7%BD%AE"><span class="toc-text">æ–°å¢é…ç½®ç±»FeignConfigå¹¶ä¿®æ”¹Retryeré…ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81OpenFeign%E9%BB%98%E8%AE%A4HttpClient%E4%BF%AE%E6%94%B9"><span class="toc-text">3ã€OpenFeigné»˜è®¤HttpClientä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-4"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache-HttpClient5%E6%9B%BF%E6%8D%A2"><span class="toc-text">Apache HttpClient5æ›¿æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88"><span class="toc-text">ä¸ºä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%BE%AE%E6%9C%8D%E5%8A%A1feign90"><span class="toc-text">ä¿®æ”¹å¾®æœåŠ¡feign90</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#FeignConfig%E7%B1%BB%E9%87%8C%E9%9D%A2%E5%B0%86Retryer%E5%B1%9E%E6%80%A7%E4%BF%AE%E6%94%B9%E4%B8%BA%E9%BB%98%E8%AE%A4"><span class="toc-text">FeignConfigç±»é‡Œé¢å°†Retryerå±æ€§ä¿®æ”¹ä¸ºé»˜è®¤</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#POM%E4%BF%AE%E6%94%B9"><span class="toc-text">POMä¿®æ”¹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-1"><span class="toc-text">é…ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81OpenFeign%E8%AF%B7%E6%B1%82-%E5%93%8D%E5%BA%94%E5%8E%8B%E7%BC%A9"><span class="toc-text">4ã€OpenFeignè¯·æ±‚&#x2F;å“åº”å‹ç¼©</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-5"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-2"><span class="toc-text">é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81OpenFeign%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E5%8A%9F%E8%83%BD"><span class="toc-text">5ã€OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-6"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB"><span class="toc-text">æ—¥å¿—çº§åˆ«</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-3"><span class="toc-text">é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#YML%E6%96%87%E4%BB%B6%E9%87%8C%E9%9C%80%E8%A6%81%E5%BC%80%E5%90%AF%E6%97%A5%E5%BF%97%E7%9A%84Feign%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">YMLæ–‡ä»¶é‡Œéœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B"><span class="toc-text">åå°æ—¥å¿—æŸ¥çœ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%A6%E7%9D%80%E5%8E%8B%E7%BC%A9%E8%B0%83%E7%94%A8"><span class="toc-text">å¸¦ç€å‹ç¼©è°ƒç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%BB%E6%8E%89%E5%8E%8B%E7%BC%A9%E8%B0%83%E7%94%A8"><span class="toc-text">å»æ‰å‹ç¼©è°ƒç”¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E5%AE%9E%E9%AA%8C%EF%BC%8C%E9%87%8D%E8%AF%95%E6%9C%BA%E5%88%B6%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%9C%8B%E5%88%B03%E6%AC%A1%E8%BF%87%E7%A8%8B"><span class="toc-text">è¡¥å……å®éªŒï¼Œé‡è¯•æœºåˆ¶æ§åˆ¶å°çœ‹åˆ°3æ¬¡è¿‡ç¨‹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenFeign%E5%92%8CSentinel%E9%9B%86%E6%88%90%E5%AE%9E%E7%8E%B0fallback%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7"><span class="toc-text">OpenFeignå’ŒSentinelé›†æˆå®ç°fallbackæœåŠ¡é™çº§</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E3%80%81CircuitBreaker%E6%96%AD%E8%B7%AF%E5%99%A8"><span class="toc-text">7ã€CircuitBreakeræ–­è·¯å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hystrix%E7%9B%AE%E5%89%8D%E4%B9%9F%E8%BF%9B%E5%85%A5%E7%BB%B4%E6%8A%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">Hystrixç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9C%80%E6%B1%82-1"><span class="toc-text">éœ€æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98"><span class="toc-text">å¦‚ä½•è§£å†³é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD"><span class="toc-text">æœåŠ¡ç†”æ–­</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7"><span class="toc-text">æœåŠ¡é™çº§</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%90%E6%B5%81"><span class="toc-text">æœåŠ¡é™æµ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%90%E6%97%B6"><span class="toc-text">æœåŠ¡é™æ—¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%A2%84%E7%83%AD"><span class="toc-text">æœåŠ¡é¢„çƒ­</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8E%A5%E8%BF%91%E5%AE%9E%E6%97%B6%E7%9A%84%E7%9B%91%E6%8E%A7"><span class="toc-text">æ¥è¿‘å®æ—¶çš„ç›‘æ§</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%9C%E5%BA%95%E7%9A%84%E5%A4%84%E7%90%86%E5%8A%A8%E4%BD%9C"><span class="toc-text">å…œåº•çš„å¤„ç†åŠ¨ä½œ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Circuit-Breaker%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">Circuit Breakeræ˜¯ä»€ä¹ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-text">å®ç°åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D"><span class="toc-text">ä¸€å¥è¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Resilience4J"><span class="toc-text">Resilience4J</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-7"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-2"><span class="toc-text">èƒ½å¹²å˜›</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98"><span class="toc-text">æ¡ˆä¾‹å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%86%94%E6%96%AD-CircuitBreaker%EF%BC%88%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD-%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%EF%BC%89"><span class="toc-text">ç†”æ–­ CircuitBreakerï¼ˆæœåŠ¡ç†”æ–­ + æœåŠ¡é™çº§ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%AD%E8%B7%AF%E5%99%A83%E5%A4%A7%E7%8A%B6%E6%80%81"><span class="toc-text">æ–­è·¯å™¨3å¤§çŠ¶æ€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%AD%E8%B7%AF%E5%99%A83%E5%A4%A7%E7%8A%B6%E6%80%81%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">æ–­è·¯å™¨3å¤§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%AD%E8%B7%AF%E5%99%A8%E6%89%80%E6%9C%89%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%8F%82%E8%80%83"><span class="toc-text">æ–­è·¯å™¨æ‰€æœ‰é…ç½®å‚æ•°å‚è€ƒ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%86%94%E6%96%AD-%E9%99%8D%E7%BA%A7%E6%A1%88%E4%BE%8B%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-text">ç†”æ–­+é™çº§æ¡ˆä¾‹éœ€æ±‚è¯´æ˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E7%85%A7COUNT-BASED-%E8%AE%A1%E6%95%B0%E7%9A%84%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3"><span class="toc-text">æŒ‰ç…§COUNT_BASED è®¡æ•°çš„æ»‘åŠ¨çª—å£</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9cloud-provider-payment8001-1"><span class="toc-text">ä¿®æ”¹cloud-provider-payment8001</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E7%85%A7TIME-BASED-%E6%97%B6%E9%97%B4%E7%9A%84%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3"><span class="toc-text">æŒ‰ç…§TIME_BASED æ—¶é—´çš„æ»‘åŠ¨çª—å£</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9cloud-consumer-feign-order80"><span class="toc-text">ä¿®æ”¹cloud-consumer-feign-order80</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%88%E6%85%A2%E6%9F%A5%E8%AF%A2%EF%BC%89"><span class="toc-text">æµ‹è¯•ï¼ˆæ…¢æŸ¥è¯¢ï¼‰</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B0%8F%E6%80%BB%E7%BB%93-1"><span class="toc-text">å°æ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%EF%BC%88BulkHead%EF%BC%89"><span class="toc-text">éš”ç¦»ï¼ˆBulkHeadï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-8"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-3"><span class="toc-text">èƒ½å¹²å˜›</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Resilience4J%E6%8F%90%E4%BE%9B%E4%BA%86%E5%A6%82%E4%B8%8B%E4%B8%A4%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%99%90%E5%88%B6%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8C%E7%9A%84%E6%95%B0%E9%87%8F"><span class="toc-text">Resilience4Jæä¾›äº†å¦‚ä¸‹ä¸¤ç§éš”ç¦»çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„æ•°é‡</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0SemaphoreBulkhead%EF%BC%88%E4%BF%A1%E5%8F%B7%E9%87%8F%E8%88%B1%E5%A3%81%EF%BC%89"><span class="toc-text">å®ç°SemaphoreBulkheadï¼ˆä¿¡å·é‡èˆ±å£ï¼‰</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0FixedThreadPoolBulkhead%EF%BC%88%E5%9B%BA%E5%AE%9A%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%88%B1%E5%A3%81%EF%BC%89"><span class="toc-text">å®ç°FixedThreadPoolBulkheadï¼ˆå›ºå®šçº¿ç¨‹æ± èˆ±å£ï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%90%E6%B5%81"><span class="toc-text">é™æµ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95"><span class="toc-text">å¸¸è§çš„é™æµç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%BC%8F%E6%96%97%E7%AE%97%E6%B3%95"><span class="toc-text">æ¼æ–—ç®—æ³•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-text">ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆé‡ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E6%97%B6%E9%97%B4%E7%AA%97%E5%8F%A3"><span class="toc-text">æ»šåŠ¨æ—¶é—´çª—å£</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E6%97%B6%E9%97%B4%E7%AA%97%E5%8F%A3"><span class="toc-text">æ»‘åŠ¨æ—¶é—´çª—å£</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-text">å®æˆ˜</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8%E3%80%81Sleuth-Micrometer-ZipKin%E5%88%86%E5%B8%83%E5%BC%8F%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA"><span class="toc-text">8ã€Sleuth(Micrometer)+ZipKinåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9D%8C%EF%B8%8FSleuth%E7%9B%AE%E5%89%8D%E4%B9%9F%E8%BF%9B%E5%85%A5%E7%BB%B4%E6%8A%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">âŒï¸Sleuthç›®å‰ä¹Ÿè¿›å…¥ç»´æŠ¤æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA%E6%A6%82%E8%BF%B0"><span class="toc-text">åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªæ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Micrometer-Tracing"><span class="toc-text">Micrometer Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zipkin%E6%98%AF%E5%95%A5"><span class="toc-text">zipkinæ˜¯å•¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%80%BB%E7%BB%93-2"><span class="toc-text">å°æ€»ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA%E5%8E%9F%E7%90%86"><span class="toc-text">åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zipkin"><span class="toc-text">Zipkin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD-%E5%AE%89%E8%A3%85-%E8%BF%90%E8%A1%8C"><span class="toc-text">ä¸‹è½½+å®‰è£…+è¿è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E8%81%8C%E4%B8%9A"><span class="toc-text">ä¸‹è½½èŒä¸š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Micrometer-ZipKin%E6%90%AD%E5%BB%BA%E9%93%BE%E8%B7%AF%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">Micrometer+ZipKinæ­å»ºé“¾è·¯ç›‘æ§æ¡ˆä¾‹æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-4"><span class="toc-text">æ­¥éª¤</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9%E3%80%81Gateway%E6%96%B0%E4%B8%80%E4%BB%A3%E7%BD%91%E5%85%B3"><span class="toc-text">9ã€Gatewayæ–°ä¸€ä»£ç½‘å…³</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-9"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%93%E7%B3%BB%E5%AE%9A%E4%BD%8D"><span class="toc-text">ä½“ç³»å®šä½</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%BD%91%E5%85%B3%E5%9C%A8%E5%93%AA"><span class="toc-text">å¾®æœåŠ¡æ¶æ„ä¸­ç½‘å…³åœ¨å“ª</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-4"><span class="toc-text">èƒ½å¹²å˜›</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E6%80%BB%E7%BB%93-3"><span class="toc-text">å°æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gateway%E4%B8%89%E5%A4%A7%E6%A0%B8%E5%BF%83"><span class="toc-text">Gatewayä¸‰å¤§æ ¸å¿ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Route-%EF%BC%88%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-text">Route ï¼ˆè·¯ç”±ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Predicate%EF%BC%88%E6%96%AD%E8%A8%80%EF%BC%89"><span class="toc-text">Predicateï¼ˆæ–­è¨€ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Filter%EF%BC%88%E8%BF%87%E6%BB%A4%EF%BC%89"><span class="toc-text">Filterï¼ˆè¿‡æ»¤ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gateway%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">Gatewayå·¥ä½œæµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">å…¥é—¨é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9527%E7%BD%91%E5%85%B3%E5%A6%82%E4%BD%95%E5%81%9A%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84"><span class="toc-text">9527ç½‘å…³å¦‚ä½•åšè·¯ç”±æ˜ å°„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%81%9A%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84"><span class="toc-text">å¦‚ä½•åšè·¯ç”±æ˜ å°„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8001%E6%96%B0%E5%BB%BAPayGateWayController"><span class="toc-text">8001æ–°å»ºPayGateWayController</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9527%E7%BD%91%E5%85%B3YML%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AE"><span class="toc-text">9527ç½‘å…³YMLæ–°å¢é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%952"><span class="toc-text">æµ‹è¯•2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E5%81%9A%E6%B3%95"><span class="toc-text">æ­£ç¡®åšæ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GateWay%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-text">GateWayé«˜çº§ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Route%E4%BB%A5%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%90%8D-%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E6%9C%8D%E5%8A%A1URI"><span class="toc-text">Routeä»¥å¾®æœåŠ¡å-åŠ¨æ€è·å–æœåŠ¡URI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Predicate%E6%96%AD%E8%A8%80"><span class="toc-text">Predicateæ–­è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-10"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E6%A6%82%E8%BF%B0"><span class="toc-text">æ•´ä½“æ¶æ„æ¦‚è¿°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%86%85%E7%BD%AERoute-Predicate"><span class="toc-text">å¸¸ç”¨å†…ç½®Route Predicate</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%AF%AD%E6%B3%95%E6%80%BB%E4%BD%93%E6%A6%82%E8%BF%B0"><span class="toc-text">é…ç½®è¯­æ³•æ€»ä½“æ¦‚è¿°</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%AD%E8%A8%80Api"><span class="toc-text">å¸¸ç”¨æ–­è¨€Api</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%AD%E8%A8%80"><span class="toc-text">è‡ªå®šä¹‰æ–­è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1%E6%96%AD%E8%A8%80%E8%A7%84%E5%88%99%E6%AD%A5%E9%AA%A4%E5%A5%97%E8%B7%AF"><span class="toc-text">è‡ªå®šä¹‰è·¯ç”±æ–­è¨€è§„åˆ™æ­¥éª¤å¥—è·¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Filter%E8%BF%87%E6%BB%A4"><span class="toc-text">Filterè¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-text">æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-5"><span class="toc-text">èƒ½å¹²å˜›</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-text">ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Gateway%E5%86%85%E7%BD%AE%E7%9A%84%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">Gatewayå†…ç½®çš„è¿‡æ»¤å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-11"><span class="toc-text">æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%86%85%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">å¸¸ç”¨çš„å†…ç½®è¿‡æ»¤å™¨</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Gateway%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">Gatewayè‡ªå®šä¹‰è¿‡æ»¤å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80Filter"><span class="toc-text">è‡ªå®šä¹‰å…¨å±€Filter</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9D%A1%E4%BB%B6Filter"><span class="toc-text">è‡ªå®šä¹‰æ¡ä»¶Filter</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gateway%E6%95%B4%E5%90%88%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4Sentinel%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99"><span class="toc-text">Gatewayæ•´åˆé˜¿é‡Œå·´å·´Sentinelå®ç°å®¹é”™</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10%E3%80%81SpringCloud-Alibaba%E5%85%A5%E9%97%A8%E7%AE%80%E4%BB%8B"><span class="toc-text">10ã€SpringCloud Alibabaå…¥é—¨ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B-6"><span class="toc-text">èƒ½å¹²å˜›</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%8E%A9-2"><span class="toc-text">æ€ä¹ˆç©</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11%E3%80%81SpringCloudAlibaba-Nacos%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="toc-text">11ã€SpringCloudAlibaba NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos%E7%AE%80%E4%BB%8B"><span class="toc-text">Nacosç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-text">Nacosä¸‹è½½å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E4%BB%8E%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BDNacos"><span class="toc-text">å…ˆä»å®˜ç½‘ä¸‹è½½Nacos</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos-Discovery-%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="toc-text">Nacos Discovery æœåŠ¡æ³¨å†Œä¸­å¿ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8ENacos%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%85"><span class="toc-text">åŸºäºNacosçš„æœåŠ¡æä¾›è€…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8ENacos%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%85"><span class="toc-text">åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-text">è´Ÿè½½å‡è¡¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos-Config%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="toc-text">Nacos ConfigæœåŠ¡é…ç½®ä¸­å¿ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nacos%E4%BD%9C%E4%B8%BA%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E9%85%8D%E7%BD%AE%E6%AD%A5%E9%AA%A4"><span class="toc-text">Nacosä½œä¸ºé…ç½®ä¸­å¿ƒé…ç½®æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nacos%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="toc-text">Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Nacos%E4%B8%AD%E7%9A%84%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99"><span class="toc-text">Nacosä¸­çš„åŒ¹é…è§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEDataId%E7%90%86%E8%AE%BA"><span class="toc-text">è®¾ç½®DataIdç†è®º</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEDataId%E5%AE%9E%E6%93%8D"><span class="toc-text">é…ç½®DataIdå®æ“</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nacos%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E4%B9%8BNamespace-Group-DataId"><span class="toc-text">Nacosæ•°æ®æ¨¡å‹ä¹‹Namespace-Group-DataId</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Namespace-Group-DataId%E4%B8%89%E8%80%85%E5%85%B3%E7%B3%BB%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%99%E4%B9%88%E8%AE%BE%E8%AE%A1"><span class="toc-text">Namespace+Group+DataIdä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%96%B9%E6%A1%88%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE"><span class="toc-text">ä¸‰ç§æ–¹æ¡ˆåŠ è½½é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81DataID%E6%96%B9%E6%A1%88"><span class="toc-text">1ã€DataIDæ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81Group%E6%96%B9%E6%A1%88"><span class="toc-text">2ã€Groupæ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81Namespace%E6%96%B9%E6%A1%88"><span class="toc-text">3ã€Namespaceæ–¹æ¡ˆ</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12%E3%80%81SpringCloud-Alibaba-Sentinel%E5%AE%9E%E7%8E%B0%E7%86%94%E6%96%AD%E5%92%8C%E9%99%90%E6%B5%81"><span class="toc-text">12ã€SpringCloud Alibaba Sentinelå®ç°ç†”æ–­å’Œé™æµ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Sentinel"><span class="toc-text">Sentinel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%8E%A9-3"><span class="toc-text">æ€ä¹ˆç©</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%9B%AA%E5%B4%A9"><span class="toc-text">æœåŠ¡é›ªå´©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7-1"><span class="toc-text">æœåŠ¡é™çº§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD-1"><span class="toc-text">æœåŠ¡ç†”æ–­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%90%E6%B5%81-1"><span class="toc-text">æœåŠ¡é™æµ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%9A%94%E7%A6%BB"><span class="toc-text">æœåŠ¡éš”ç¦»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B6%85%E6%97%B6"><span class="toc-text">æœåŠ¡è¶…æ—¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Sentinel"><span class="toc-text">å®‰è£…Sentinel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sentinel%E7%BB%84%E4%BB%B6%E7%94%B12%E9%83%A8%E5%88%86%E6%9E%84%E6%88%90"><span class="toc-text">sentinelç»„ä»¶ç”±2éƒ¨åˆ†æ„æˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4"><span class="toc-text">å®‰è£…æ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A18401%E6%95%B4%E5%90%88Sentinel%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">å¾®æœåŠ¡8401æ•´åˆSentinelå…¥é—¨æ¡ˆä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8Nacos8848%E6%88%90%E5%8A%9F"><span class="toc-text">å¯åŠ¨Nacos8848æˆåŠŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8Sentinel8080%E6%88%90%E5%8A%9F"><span class="toc-text">å¯åŠ¨Sentinel8080æˆåŠŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%BE%AE%E6%9C%8D%E5%8A%A18401"><span class="toc-text">æ–°å»ºå¾®æœåŠ¡8401</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%90%8E%E6%9F%A5%E7%9C%8B%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-text">å¯åŠ¨åæŸ¥çœ‹æ§åˆ¶å°</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2026 By oyy0v0</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script><script async src="//at.alicdn.com/t/c/font_4658720_723un29n3vn.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '8b4e8faa226f49ff851d67d0354499b7';
  var gaud_map_key = '85e43a6ba1ebb38fd12b0d8a886ecb9b';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg);"> <a class="categoryBar-list-link" href="categories/javaå…¥é—¨/">javaå…¥é—¨</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">java</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg);"> <a class="categoryBar-list-link" href="categories/åšå®¢/">åšå®¢</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">ç®—æ³•</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg);"> <a class="categoryBar-list-link" href="categories/GitHub/">GitHub</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">åšå®¢</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg);"> <a class="categoryBar-list-link" href="categories/å‰ç«¯/">å‰ç«¯</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">AI</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg);"> <a class="categoryBar-list-link" href="categories/ç®—æ³•/">ç®—æ³•</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr">å‰ç«¯</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg);"> <a class="categoryBar-list-link" href="categories/é¢è¯•é›†åˆ/">é¢è¯•é›†åˆ</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">GitHub</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg);"> <a class="categoryBar-list-link" href="categories/AI/">AI</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">å…«è‚¡æ–‡</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg);"> <a class="categoryBar-list-link" href="categories/java/">java</a><span class="categoryBar-list-count">32</span><span class="categoryBar-list-descr">é¢è¯•é›†åˆ</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg);"> <a class="categoryBar-list-link" href="categories/Goè¯­è¨€/">Goè¯­è¨€</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">Goè¯­è¨€</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg);"> <a class="categoryBar-list-link" href="categories/æ“ä½œç³»ç»Ÿ/">æ“ä½œç³»ç»Ÿ</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">Linux</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg);"> <a class="categoryBar-list-link" href="categories/è®¡ç®—æœºç½‘ç»œ/">è®¡ç®—æœºç½‘ç»œ</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">æ“ä½œç³»ç»Ÿ</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg);"> <a class="categoryBar-list-link" href="categories/è¸©å‘æ‚è®°/">è¸©å‘æ‚è®°</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">è®¡ç®—æœºç½‘ç»œ</span></li></ul></div></div>';
      console.log('å·²æŒ‚è½½butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯æ‰˜ç®¡äº4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-28</span><a class="blog-slider__title" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt="">å…«è‚¡æ–‡é›†åˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-14</span><a class="blog-slider__title" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt="">Javaçº¿ç¨‹æ± çš„åŸç†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/29/2024-8-29 Solr/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-29</span><a class="blog-slider__title" href="2024/08/29/2024-8-29 Solr/" alt="">Solr</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/29/2024-8-29 Solr/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-24</span><a class="blog-slider__title" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt="">è™šæ‹Ÿæœº</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt="">è®¾è®¡æ¨¡å¼</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-22 é¢è¯•/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-22 é¢è¯•/" alt="">é¢è¯•é›†åˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/11/26/2024-11-22 é¢è¯•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2026/01/06/2026-1-5 SpringCloud/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2026-01-06</span><a class="blog-slider__title" href="2026/01/06/2026-1-5 SpringCloud/" alt="">SpringCloud</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2026/01/06/2026-1-5 SpringCloud/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt="">å¼€å‘æµç¨‹åŒ–</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 JSP/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 JSP/" alt="">JSP</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 JSP/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt="">Servletå…¥é—¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt="">Servletè¿›é˜¶</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/14/2025-12-14 SpringBoot3/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-14</span><a class="blog-slider__title" href="2025/12/14/2025-12-14 SpringBoot3/" alt="">Springboot3</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/14/2025-12-14 SpringBoot3/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt="">å¸¸ç”¨æ³¨è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-03</span><a class="blog-slider__title" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt="">redis é«˜çº§ç¯‡</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt="">Maven</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2025-11-26 Redis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2025-11-26 Redis/" alt="">redis</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/23/2025-11-26 Redis/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/23/2025-11-23 SpringMVC/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-23</span><a class="blog-slider__title" href="2025/11/23/2025-11-23 SpringMVC/" alt="">SpringMVC</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/23/2025-11-23 SpringMVC/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/23/2025-10-23 Spring/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-23</span><a class="blog-slider__title" href="2025/10/23/2025-10-23 Spring/" alt="">Spring</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/23/2025-10-23 Spring/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-23</span><a class="blog-slider__title" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt="">Springé¢è¯•</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/28/2025-10-28 JavaEE/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-28</span><a class="blog-slider__title" href="2025/10/28/2025-10-28 JavaEE/" alt="">JavaEE</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/28/2025-10-28 JavaEE/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-22</span><a class="blog-slider__title" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt="">Sentinelé™æµå’Œç†”æ–­</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-30</span><a class="blog-slider__title" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt="">Springæ‰©å±•ç‚¹æ¡ˆä¾‹</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/20/2025-10-20 Mybatis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-20</span><a class="blog-slider__title" href="2024/07/20/2025-10-20 Mybatis/" alt="">Mybatis</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/07/20/2025-10-20 Mybatis/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-22</span><a class="blog-slider__title" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt="">Netty</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2025-10-21 Dubbo/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2025-10-21 Dubbo/" alt="">Dubbo</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/14/2025-10-21 Dubbo/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 Springboot/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 Springboot/" alt="">Springboot</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 Springboot/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-12</span><a class="blog-slider__title" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt="">Mybatisçš„æ‰§è¡ŒåŸç†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt="">è¸©å‘è®°å½•</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt="">å›ºå®šæ€è·¯è¯¦è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt="">Nginx+lua+OpenRestyé«˜æ€§èƒ½å®è·µ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-16</span><a class="blog-slider__title" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt="">å‰ç«¯é€Ÿé€š</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt="">RPCè¿œç¨‹æœåŠ¡è°ƒç”¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-24</span><a class="blog-slider__title" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt="">ç®—æ³•åˆé›†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt="">é“¾è¡¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-10</span><a class="blog-slider__title" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt="">é˜Ÿåˆ—å’Œæ ˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt="">ç®—æ³•é—®é¢˜åˆé›†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-02-23</span><a class="blog-slider__title" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt="">æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-16</span><a class="blog-slider__title" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt="">Javaæ³¨è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt="">java8æ–°ç‰¹æ€§</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-04</span><a class="blog-slider__title" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt="">ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-07</span><a class="blog-slider__title" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt="">åŠ¨æ€ä»£ç†å’Œåå°„</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-20</span><a class="blog-slider__title" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt="">RPCäº†è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/13/2024-7-2 Vue2/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-13</span><a class="blog-slider__title" href="2024/07/13/2024-7-2 Vue2/" alt="">Vue2</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/07/13/2024-7-2 Vue2/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-15</span><a class="blog-slider__title" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt="">æ•°æ®åº“</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/23.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-05-14</span><a class="blog-slider__title" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt="">è®¡ç®—æœºç½‘ç»œ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-18 JDBC/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-18 JDBC/" alt="">JDBC</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/18/2024-4-18 JDBC/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt="">æ“ä½œç³»ç»Ÿ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-28</span><a class="blog-slider__title" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt="">Goè¯­è¨€</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/07/06/2023-7-1Javaå°è®°/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-07-06</span><a class="blog-slider__title" href="2023/07/06/2023-7-1Javaå°è®°/" alt="">Javaå°è®°</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/07/06/2023-7-1Javaå°è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-15</span><a class="blog-slider__title" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt="">AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-08</span><a class="blog-slider__title" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt="">å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-18</span><a class="blog-slider__title" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt="">å‰ç«¯å°è®°</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-06-23</span><a class="blog-slider__title" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt="">Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-12</span><a class="blog-slider__title" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt="">å»ºç«‹åšå®¢</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-27</span><a class="blog-slider__title" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt="">javaseå…¥é—¨ï¼ˆæšä¸¾1ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/about/'|| '/about/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://github-api.oyy0v0.top//api?oyy0v0",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'oyy0v0')
    }
  </script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>