<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Springboot3 | oyy0v0ğŸ˜¼</title><meta name="author" content="oyy0v0"><meta name="copyright" content="oyy0v0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="çŸ¥è¯†åˆ†äº«">
<meta property="og:type" content="article">
<meta property="og:title" content="Springboot3">
<meta property="og:url" content="https://oyy0v0.top/2025/12/14/2025-12-14%20SpringBoot3/index.html">
<meta property="og:site_name" content="oyy0v0ğŸ˜¼">
<meta property="og:description" content="çŸ¥è¯†åˆ†äº«">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg">
<meta property="article:published_time" content="2025-12-14T13:40:00.000Z">
<meta property="article:modified_time" content="2026-01-04T20:58:50.723Z">
<meta property="article:author" content="oyy0v0">
<meta property="article:tag" content="-Springå…¨å®¶æ¡¶">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg"><link rel="shortcut icon" href="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E7%8C%AB.svg"><link rel="canonical" href="https://oyy0v0.top/2025/12/14/2025-12-14%20SpringBoot3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Springboot3',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-01-05 04:58:50'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4658720_723un29n3vn.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/readPercent.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="oyy0v0ğŸ˜¼"><span class="site-name">oyy0v0ğŸ˜¼</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw icon-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw icon-fenlei"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw icon-guanyu"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Springboot3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-12-14T13:40:00.000Z" title="å‘è¡¨äº 2025-12-14 21:40:00">2025-12-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2026-01-04T20:58:50.723Z" title="æ›´æ–°äº 2026-01-05 04:58:50">2026-01-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">57.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>222åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Springboot3"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="SpringBoot3"><a href="#SpringBoot3" class="headerlink" title="SpringBoot3"></a>SpringBoot3</h1><p>ä»SpringBoot2å¼€å§‹webç¼–ç¨‹åˆ†ä¸ºäº†ä¸¤ä¸ªæµæ´¾ï¼Œ</p>
<p>ä¸€ä¸ªä½¿ç”¨ServletæŠ€æœ¯æ ˆï¼Œå¯ä»¥ç§°ä¸ºä¼ ç»Ÿæ´¾ï¼Œä¸€ä¸ªä½¿ç”¨ReactiveæŠ€æœ¯æ ˆï¼Œä¹Ÿå°±æ˜¯å“åº”å¼æŠ€æœ¯æ ˆï¼Œä½¿ç”¨Servletç¼–ç¨‹çš„è¯ï¼Œä¼šä½¿ç”¨ServletAPIè§„èŒƒï¼Œé…ä¸ŠServletå®¹å™¨ï¼Œæ¯”å¦‚Tomcatå†é…åˆSpringä¸€ç³»åˆ—æŠ€æœ¯æ ˆï¼Œæ¯”å¦‚Spring MVC,SpringSecurityï¼ŒSpringDataæ¥æ„å»ºwebåº”ç”¨ï¼Œè¿™ç§ç§°ä¸ºé˜»å¡åŒæ­¥çš„BIOæ¨¡å‹ã€‚</p>
<p>ä¸€ä¸ªä½¿ç”¨å“åº”å¼æŠ€æœ¯æ ˆï¼ŒæŒ‰ç…§Reactiveå’ŒStreamè§„èŒƒï¼Œæ­é…ä¸ŠNettyå’ŒTomcatåœ¨Servlet3.1+æ ‡å‡†ä¸Šä¹Ÿæ”¯æŒå¼‚æ­¥è¯·æ±‚ã€‚æœ‰äº†è¿™äº›å®¹å™¨æ­é…Spring SecurityReactiveæ¡†æ¶åšå®‰å…¨éªŒè¯ï¼ŒSpringWebFluxæ¡†æ¶åšMVCï¼ŒSpringDataReactiveåšæ•°æ®å¤„ç†ã€‚è¿™æ ·å°±èƒ½æŒ–æ˜CPUçš„èƒ½åŠ›å¤„ç†å¤§é‡å¹¶å‘</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251214211421617.png" alt="image-20251214211421617"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/deepseek_mermaid_20251221_ccefed.png" alt="deepseek_mermaid_20251221_ccefed" style="zoom:25%;" /></p>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ul>
<li>java17</li>
<li>Springã€SpringMVCã€MyBatis</li>
<li>Mavenã€IDEA</li>
</ul>
<p><strong>ç¯å¢ƒè¦æ±‚</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ç¯å¢ƒ&amp;å·¥å…·</th>
<th>ç‰ˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>SpringBoot</td>
<td>3.0.4+</td>
</tr>
<tr>
<td>IDEA</td>
<td>2021+</td>
</tr>
<tr>
<td>jAVA</td>
<td>17+</td>
</tr>
<tr>
<td>Maven</td>
<td>3.5+</td>
</tr>
<tr>
<td>Tomcat</td>
<td>10.0+</td>
</tr>
<tr>
<td>Servlet</td>
<td>5.0+</td>
</tr>
<tr>
<td>GraalVM Community</td>
<td>22.3+</td>
</tr>
<tr>
<td>Native Build Tools</td>
<td>0.9.19+</td>
</tr>
</tbody>
</table>
</div>
<p><strong>SpringBootæ˜¯ä»€ä¹ˆ</strong></p>
<p>SpringBootå¸®æˆ‘ä»¬ç®€å•ã€å¿«é€Ÿçš„åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ã€ç”Ÿäº§çº§åˆ«çš„Springåº”ç”¨ï¼Œå¤§å¤šæ•°SpringBootåº”ç”¨åªéœ€è¦ç¼–å†™å°‘é‡é…ç½®ï¼Œæ•´åˆSpringå¹³å°ä»¥åŠç¬¬ä¸‰æ–¹æŠ€æœ¯ã€‚</p>
<p><strong>ç‰¹æ€§</strong></p>
<ul>
<li><strong>å¿«é€Ÿåˆ›å»º</strong>ç‹¬ç«‹Springåº”ç”¨<ul>
<li>SSMï¼šå¯¼åŒ…ã€å†™é…ç½®ã€å¯åŠ¨è¿è¡Œ</li>
</ul>
</li>
<li><p>ç›´æ¥åµŒå…¥Tomcatã€Jetty or Undertowï¼ˆæ— éœ€éƒ¨ç½²waråŒ…ï¼‰ã€Servletå®¹å™¨ã€‘</p>
<ul>
<li>linux java tomcat mysqlï¼šwaræ”¾åˆ°tomcatçš„webappä¸‹</li>
<li>ç°åœ¨åº”ç”¨é‡ŒåµŒå…¥è¿™äº›å®¹å™¨æ‰“åŒ…æˆjaråŒ…ï¼Œç„¶åè¿è¡Œjava -jarå°±å¥½äº†ï¼Œå‰ææ˜¯éƒ½è¦æœ‰javaç¯å¢ƒå•Š</li>
</ul>
</li>
<li><p>æä¾›å¯é€‰çš„ <strong>starter</strong>ï¼Œç®€åŒ–åº”ç”¨ <strong>æ•´åˆ</strong></p>
<ul>
<li>åœºæ™¯å¯åŠ¨å™¨ï¼ˆstarterï¼‰ï¼šwebã€jsonã€é‚®ä»¶ã€ossï¼ˆå¯¹è±¡å­˜å‚¨ï¼‰ã€å¼‚æ­¥ã€å®šæ—¶ä»»åŠ¡ã€ç¼“å­˜</li>
<li>ä»¥å‰å¼€å‘å¯¼åŒ…ä¸€å †ï¼Œæ§åˆ¶å¥½ç‰ˆæœ¬ã€‚</li>
<li>ä¸ºæ¯ä¸€ç§åœºæ™¯å‡†å¤‡äº†ä¸€ä¸ªä¾èµ–åæ ‡ï¼Œæ¯”å¦‚å¯¼å…¥web-starterã€mybatis-starterè¿™äº›ä¾èµ–ï¼Œç›¸å…³çš„éƒ½ä¾èµ–ä¸Šäº†ã€‚</li>
</ul>
</li>
<li>æŒ‰éœ€è‡ªåŠ¨é…ç½®Spring ä»¥åŠ ç¬¬ä¸‰æ–¹åº“<ul>
<li>å¦‚æœè¿™äº›åœºæ™¯æˆ‘ä»¬è¦ä½¿ç”¨ï¼ˆç”Ÿæ•ˆï¼‰ï¼Œè¿™ä¸ªåœºæ™¯çš„æ‰€æœ‰é…ç½®éƒ½ä¼šè‡ªåŠ¨é…ç½®å¥½ã€‚</li>
<li><strong>çº¦å®šå¤§äºé…ç½®</strong>ï¼šæ¯ä¸ªåœºæ™¯éƒ½æœ‰å¾ˆå¤šé»˜è®¤é…ç½®ã€‚</li>
<li>è‡ªå®šä¹‰ï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å‡ é¡¹å°±å¯ä»¥ã€‚</li>
</ul>
</li>
<li>æä¾› <strong>ç”Ÿäº§çº§åˆ«ç‰¹æ€§</strong>ï¼šå¦‚ ç›‘æ§æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ã€å¤–éƒ¨åŒ–é…ç½®ç­‰ã€‚<ul>
<li>ç›‘æ§æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ï¼ˆk8sï¼‰ã€å¤–éƒ¨åŒ–é…ç½®ï¼ˆä¹Ÿå°±æ˜¯è¯´é…ç½®å¯ä»¥ä¸ç”¨å†™åœ¨jaråŒ…é‡Œé¢ï¼Œåªç”¨é‡å¯å°±èƒ½è¯»å–åˆ°é…ç½®äº†ï¼‰</li>
</ul>
</li>
<li>æ— ä»£ç ç”Ÿæˆã€æ— xmlã€‚</li>
</ul>
<p>æ€»ç»“ï¼šç®€åŒ–å¼€å‘ã€ç®€åŒ–é…ç½®ã€ç®€åŒ–æ•´åˆã€ç®€åŒ–éƒ¨ç½²ã€ç®€åŒ–ç›‘æ§ã€ç®€åŒ–è¿ç»´ã€‚</p>
<h2 id="SpringBoot3æ ¸å¿ƒç‰¹æ€§"><a href="#SpringBoot3æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="SpringBoot3æ ¸å¿ƒç‰¹æ€§"></a>SpringBoot3æ ¸å¿ƒç‰¹æ€§</h2><p>å¦‚æœæƒ³è¦Springboot2å°±<code>https://start.aliyun.com</code>è¿™ä¸ªç½‘å€</p>
<p>å¦‚æœæƒ³è¦Springboot3å°±<code>https://start.spring.io</code></p>
<p>å…¶æ¬¡åˆ›å»ºä¹‹åè¯¥Mavené…ç½®</p>
<h3 id="1ã€å¿«é€Ÿå…¥é—¨"><a href="#1ã€å¿«é€Ÿå…¥é—¨" class="headerlink" title="1ã€å¿«é€Ÿå…¥é—¨"></a><strong>1ã€å¿«é€Ÿå…¥é—¨</strong></h3><p>ç¬¬ä¸€æ­¥é¦–å…ˆåˆ›å»ºPOMæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ‰€æœ‰çš„spring-booté¡¹ç›®éƒ½éœ€è¦ç»§æ‰¿spring-boot-starter-parent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--webç›¸å…³çš„ä¾èµ–--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ æ”¹YML è¿™é‡Œä¸ç”¨</p>
<p>ç¬¬ä¸‰æ­¥ä¸»å¯åŠ¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬å››æ­¥ ä¸šåŠ¡ç±» è¿™é‡Œä¹Ÿä¸ç”¨</p>
<p>ç¬¬äº”æ­¥ æ§åˆ¶ç±» è¿™é‡Œå†™ä¸ªdemoController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span> <span class="comment">//@Controller + @ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Spring Boot!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¿™é‡Œå°±éƒ¨ç½²å¥½äº†</strong></p>
<p>ç„¶åSpringBootç»™æˆ‘ä»¬æä¾›äº†æ‰“åŒ…jarçš„æ’ä»¶ï¼Œç„¶åæ”¹POMæ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨å³è¾¹Mavenç„¶åè¿è¡Œpackageå°±èƒ½æ‰“åŒ…äº†ã€‚</p>
<p>æ‰“åŒ…å¥½åè¿è¡Œjava -jarå°±èƒ½è¿è¡Œäº†ã€‚</p>
<p>ç°åœ¨å‡è®¾æƒ³è¦æ”¹ç«¯å£å·ï¼Œä»¥å‰è¦æ‰“å¼€é¡¹ç›®ç„¶åä¿®æ”¹YMLç„¶åé‡æ–°æ‰“åŒ…ï¼Œé‡æ–°å‘å¸ƒï¼Œç„¶åé‡æ–°å¯åŠ¨ã€‚</p>
<p>ç°åœ¨åªç”¨åœ¨å¤–é¢æ–°å»ºä¸ªapplication.properties</p>
<p>ç„¶ååœ¨é‡Œé¢ç¼–å†™é…ç½®<code>server.port=8888</code></p>
<p>ç„¶åé‡æ–°å¯åŠ¨å°±å¯ä»¥æ›´æ¢ç«¯å£å·äº†</p>
<p>ç„¶åå®˜æ–¹å’Œç¬¬ä¸‰æ–¹æ”¯æŒå¾ˆå¤šåœºæ™¯äº†å®˜æ–¹æä¾›çš„åœºæ™¯ä¸€èˆ¬å‘½åä¸º</p>
<p>spring-boot-starter-xxxå•¥çš„ã€‚</p>
<p>ç¬¬ä¸‰æ–¹æä¾›çš„åœºæ™¯ä¸€èˆ¬å‘½åä¸º*.spring-boot-starter</p>
<h4 id="SpringBootä¸¤ä¸ªæœºåˆ¶"><a href="#SpringBootä¸¤ä¸ªæœºåˆ¶" class="headerlink" title="SpringBootä¸¤ä¸ªæœºåˆ¶"></a>SpringBootä¸¤ä¸ªæœºåˆ¶</h4><p>Springbootèƒ½è¿™ä¹ˆæ–¹ä¾¿é…ç½®ä¸»è¦æ˜¯ä¸¤ä¸ªæœºåˆ¶</p>
<h5 id="1ã€ä¾èµ–ç®¡ç†æœºåˆ¶"><a href="#1ã€ä¾èµ–ç®¡ç†æœºåˆ¶" class="headerlink" title="1ã€ä¾èµ–ç®¡ç†æœºåˆ¶"></a>1ã€ä¾èµ–ç®¡ç†æœºåˆ¶</h5><p>ä¸ºä»€ä¹ˆå¯¼å…¥starter-webæ‰€æœ‰å…³è”çš„ä¾èµ–éƒ½å¯¼å…¥è¿›æ¥ï¼Ÿ</p>
<ul>
<li>å¼€å‘ä»€ä¹ˆåœºæ™¯ï¼Œå¯¼å…¥ä»€ä¹ˆ <strong>åœºæ™¯å¯åŠ¨å™¨å°±å¥½</strong></li>
<li><strong>mavenä¾èµ–ä¼ é€’åŸåˆ™ï¼ŒAä¾èµ–Bï¼ŒBä¾èµ–Cï¼Œé‚£ä¹ˆAå°±ä¾èµ–C</strong></li>
</ul>
<p>ä¸ºä»€ä¹ˆç‰ˆæœ¬å·éƒ½ä¸ç”¨å†™ï¼Ÿ</p>
<ul>
<li>æ¯ä¸ªbooté¡¹ç›®æœ‰ä¸€ä¸ªçˆ¶é¡¹ç›®<code>spring-boot-starter-parent</code></li>
<li>parentçˆ¶é¡¹ç›®æ˜¯ <code>spring-boot-dependencies</code></li>
<li>çˆ¶é¡¹ç›® ç‰ˆæœ¬ä»²è£ä¸­å¿ƒï¼ŒæŠŠæ‰€æœ‰å¸¸è§çš„ä¾èµ–ç‰ˆæœ¬éƒ½å£°æ˜å¥½äº†ã€‚</li>
</ul>
<p>è‡ªå®šä¹‰ç‰ˆæœ¬å·</p>
<ul>
<li>åˆ©ç”¨mavençš„å°±è¿‘åŸåˆ™ï¼Œæœ‰å°±ç”¨è‡ªå®šä¹‰çš„ï¼Œæ²¡æœ‰å°±é»˜è®¤çš„ã€‚</li>
<li>ç„¶ååœ¨åŸæœ¬çš„POMé‡Œé¢è‡ªå®šä¹‰æˆ–è€…ç”¨<code>&lt;properties/&gt;</code>ä¸­å£°æ˜ç‰ˆæœ¬</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251215002318795.png" alt="image-20251215002318795"></p>
<h5 id="2ã€è‡ªåŠ¨é…ç½®æœºåˆ¶"><a href="#2ã€è‡ªåŠ¨é…ç½®æœºåˆ¶" class="headerlink" title="2ã€è‡ªåŠ¨é…ç½®æœºåˆ¶"></a>2ã€<strong>è‡ªåŠ¨é…ç½®æœºåˆ¶</strong></h5><p>åˆæ­¥ç†è§£åé¢å†ç†è§£å®Œæ•´æµç¨‹ã€‚</p>
<ul>
<li><p>è‡ªåŠ¨é…ç½®çš„Tomcatã€SpringMVCç­‰ã€‚</p>
<ul>
<li>ä»¥å‰ï¼šå†™DispatcherServletæ¥æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼ŒViewResolverå¤„ç†é¡µé¢è·³è½¬ï¼ŒCharacterEncodingFilterå¤„ç†å­—ç¬¦ç¼–ç </li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251123235925402.png" alt="image-20251123235925402"></p>
<ul>
<li>ç°åœ¨ï¼šè‡ªåŠ¨é…ç½®å¥½çš„è¿™äº›ç»„ä»¶</li>
<li>éªŒè¯ï¼šåœ¨ä¸»å…¥å£é‡Œé¢çš„<code>SpringApplication.run</code>è¿›å»çœ‹ï¼Œç„¶åå‘ç°è¿™ä¸ªæ–¹æ³•ç»™æˆ‘ä»¬è¿”å›<code>ConfigurableApplicationContext</code>,è¿™ä¸ªå…¶å®æ˜¯IOCå®¹å™¨ï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦éªŒè¯è¿™ä¸ªIOCå®¹å™¨é‡Œé¢æœ‰æ²¡æœ‰è¿™äº›ç»„ä»¶å°±å¯ä»¥äº†ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//java10 æ–°ç‰¹æ€§ï¼šå±€éƒ¨å˜é‡ç±»å‹çš„è‡ªåŠ¨æ¨æ–­</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">ioc</span> <span class="operator">=</span> SpringApplication.run(MainApplication.class, args);</span><br><span class="line">        <span class="comment">//1ã€æ‰“å°IOCå®¹å™¨ä¸­çš„æ‰€æœ‰Beanå®šä¹‰åç§°</span></span><br><span class="line">        String[] beanDefinitionNames = ioc.getBeanDefinitionNames();</span><br><span class="line">        <span class="keyword">for</span> (String beanDefinitionName : beanDefinitionNames) &#123;</span><br><span class="line">            System.out.println(beanDefinitionName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç°åœ¨å¯¼å…¥åœºæ™¯ï¼Œå®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨é…ç½®å¥½è¿™ä¸ªåœºæ™¯çš„æ ¸å¿ƒç»„ä»¶ã€‚è‡³äºä¸ºä»€ä¹ˆåé¢è¯´ã€‚</strong></p>
<ul>
<li><p>é»˜è®¤çš„åŒ…æ‰«æè§„åˆ™</p>
<ul>
<li>@SpringBootApplication æ ‡æ³¨çš„ç±»å°±æ˜¯ä¸»ç¨‹åºç±»</li>
<li>SpringBootåªä¼šæ‰«æä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…åŠå…¶ä¸‹é¢çš„å­åŒ…</li>
<li>@SpringBootApplication</li>
<li>è¿™ä¸ªåŠŸèƒ½å°±ç±»ä¼¼å¸®æˆ‘ä»¬å†™äº†component-scanï¼Œå¦‚æœæƒ³è¦é…ç½®æ‰«æ@SpringBootApplicationé‡Œé¢é…ç½®<code>@SpringBootApplication(scanBasePackages = &quot;com.bitzh&quot;</code>ï¼‰ï¼Œæˆ–è€…ç”¨<code>@ComponentScan(&quot;com.bitzh&quot;)æ³¨è§£</code></li>
</ul>
</li>
<li><p>é…ç½®é»˜è®¤å€¼</p>
<ul>
<li><strong>é…ç½®æ–‡ä»¶</strong>çš„æ‰€æœ‰é…ç½®é¡¹æ˜¯å’ŒæŸä¸ª<strong>ç±»çš„å¯¹è±¡</strong>å€¼è¿›è¡Œä¸€ ä¸€ç»‘å®šçš„</li>
<li>ç»‘å®šäº†é…ç½®æ–‡ä»¶ä¸­æ¯ä¸€é¡¹å€¼çš„ç±»ï¼š<strong>é…ç½®å±æ€§ç±»</strong></li>
<li>æ¯”å¦‚ï¼š<code>ServerProperties</code>ç»‘å®šäº†æ‰€æœ‰TomcatæœåŠ¡å™¨æœ‰å…³çš„é…ç½®</li>
<li><code>MultipartProperties</code>ç»‘å®šäº†æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é…ç½®å…¶ä»–çš„å‚ç…§å®˜æ–¹æ–‡æ¡£</li>
</ul>
</li>
<li><p>æŒ‰éœ€åŠ è½½è‡ªåŠ¨é…ç½®</p>
<ul>
<li>å¯¼å…¥åœºæ™¯<code>spring-boot-starter-web</code></li>
<li>åœºæ™¯å¯åŠ¨å™¨é™¤äº†ä¼šå¯¼å…¥ç›¸å…³åŠŸèƒ½ä¾èµ–ä»¥å¤–è¿˜å¯¼å…¥äº†<code>spring-boot-starter</code>ï¼Œæ˜¯æ‰€æœ‰starterçš„starterï¼ŒåŸºç¡€æ ¸å¿ƒstarterï¼Œè¿™ä¸ªæœ‰ä¸ªåŒ…é‡Œé¢æœ‰ä¸ªä¾èµ–<code>spring-boot-autoconfigure</code>ï¼Œç„¶åè¿™ä¸ªåŒ…é‡Œé¢éƒ½æ˜¯å„ç§åœºæ™¯çš„<code>autoconfigure</code>ï¼Œ<strong>è‡ªåŠ¨é…ç½®ç±»</strong></li>
<li>è™½ç„¶å…¨åœºæ™¯çš„è‡ªåŠ¨é…ç½®éƒ½åœ¨<code>spring-boot-autoconfigure</code>è¿™ä¸ªåŒ…ï¼Œä½†æ˜¯ä¸æ˜¯å…¨éƒ½å¼€å¯çš„ã€‚<ul>
<li>å¯¼å…¥å“ªä¸ªåœºæ™¯å°±å¼€å¯å“ªä¸ªåœºæ™¯ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æ€»ç»“ï¼š</strong>å¯¼å…¥åœºæ™¯å¯åŠ¨å™¨ã€è§¦å‘<code>spring-boot-autoconfigure</code>è¿™ä¸ªåŒ…çš„è‡ªåŠ¨é…ç½®ç”Ÿæ•ˆï¼Œå®¹å™¨ä¸­å°±ä¼šå…·æœ‰ç›¸å…³åœºæ™¯çš„åŠŸèƒ½</p>
</li>
</ul>
</li>
</ul>
<h4 id="æ ¸å¿ƒæŠ€èƒ½"><a href="#æ ¸å¿ƒæŠ€èƒ½" class="headerlink" title="æ ¸å¿ƒæŠ€èƒ½"></a>æ ¸å¿ƒæŠ€èƒ½</h4><p><strong>å¸¸ç”¨æ³¨è§£</strong></p>
<p>SpringBootæ‘’å¼ƒxmlé…ç½®æ–¹å¼ï¼Œæ”¹ä¸º<strong>å…¨æ³¨è§£é©±åŠ¨</strong></p>
<p>é‚£ä¹ˆå°±ä¼šæœ‰å¤§é‡çš„æ³¨è§£äº†ã€‚</p>
<h5 id="1ã€ç»„ä»¶æ³¨å†Œ"><a href="#1ã€ç»„ä»¶æ³¨å†Œ" class="headerlink" title="1ã€ç»„ä»¶æ³¨å†Œ"></a><strong>1ã€ç»„ä»¶æ³¨å†Œ</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Configuration ã€ @SpringBootConfiguration</span><br><span class="line">@Bean</span><br><span class="line">@Controllerã€@Servoceã€@Repositoryã€@Component</span><br><span class="line">@import</span><br><span class="line">@Componment</span><br></pre></td></tr></table></figure>
<p><strong>ä»¥å‰å†™ç»„ä»¶</strong></p>
<p>å…ˆåˆ›å»ºä¸ªbeanæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//ç„¶åç”Ÿæˆsetå’Œgetæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†™XMLé…ç½®æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ç„¶åé€šè¿‡beanæ ‡ç­¾æ³¨å†Œåˆ°å®¹å™¨ä¸­</span><br><span class="line">&lt;bean id=&quot;user&quot; class=&quot;com.bitzh.bean.User&quot;&gt;</span><br><span class="line">	&lt;property name=&quot;id&quot; value = &quot;1&quot;&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name=&quot;name&quot; value = &quot;zs&quot;&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p><strong>ç°åœ¨å†™ç»„ä»¶</strong></p>
<p>åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶ï¼Œä»¥å‰çš„é…ç½®æ–‡ä»¶ï¼Œå˜æˆäº†ä¸€ä¸ªé…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span><span class="comment">//è¿™ä¸ªæ³¨è§£è·Ÿä¸‹é¢çš„ä¸€æ ·</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">//æ›¿ä»£ä»¥å‰çš„é…ç½®æ–‡ä»¶,é…ç½®ç±»æœ¬èº«ä¹Ÿæ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span>&#123;</span><br><span class="line">	<span class="comment">//ç»„ä»¶é»˜è®¤æ˜¯å•å®ä¾‹çš„</span></span><br><span class="line">    <span class="meta">@Scope(&quot;prototype&quot;)</span><span class="comment">//å¯ä»¥é€šè¿‡è¿™ä¸ªæ³¨è§£æ¥ä»å•å®ä¾‹ç¼–ç¨‹åŸå‹æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡newéƒ½æ˜¯æ–°å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean(&quot;userHaHa&quot;)</span> <span class="comment">//æ›¿ä»£beanæ ‡ç­¾ï¼Œç»„ä»¶åœ¨å®¹å™¨ä¸­çš„åå­—é»˜è®¤æ˜¯æ–¹æ³•åï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‚æ•°é…ç½®åå­—</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">1L</span>);</span><br><span class="line">        user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å°±æŠŠUseræ³¨å†Œåˆ°å®¹å™¨ä¸­äº†ã€‚</p>
<p><strong>é‚£ä¹ˆæƒ³è¦æŠŠç¬¬ä¸‰æ–¹åŒ…çš„ç»„ä»¶æ³¨å…¥åˆ°å®¹å™¨ä¸­</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§ï¼šå…ˆå¯¼å…¥POMç„¶ååœ¨Configurationç±»é‡Œé¢</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FastSqlException <span class="title function_">fastSqlException</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FastSqlException</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æœ€å¿«é€Ÿçš„ç¬¬äºŒç§ï¼Œåœ¨é…ç½®ç±»é‡Œé¢ç”¨@Importæ³¨è§£</span></span><br><span class="line"><span class="meta">@Import(FastSqlException.class)</span><span class="comment">//ç»™å®¹å™¨ä¸­æ”¾åˆ¶å®šç±»å‹çš„ç»„ä»¶ï¼Œç»„ä»¶çš„åå­—é»˜è®¤æ˜¯ç±»å</span></span><br></pre></td></tr></table></figure>
<p><strong>æ€»ç»“å°†beanæ³¨å…¥åˆ°å®¹å™¨çš„æµç¨‹</strong></p>
<p>1ã€@Configura ç¼–å†™ä¸€ä¸ªé…ç½®ç±»</p>
<p>2ã€åœ¨é…ç½®ç±»ä¸­ï¼Œè‡ªå®šä¹‰æ–¹æ³•ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ã€‚é…åˆ@Beanæ³¨è§£</p>
<p>3ã€ä½¿ç”¨@Importæ³¨è§£å¯¼å…¥ç¬¬ä¸‰æ–¹Bean</p>
<h5 id="2ã€æ¡ä»¶æ³¨è§£"><a href="#2ã€æ¡ä»¶æ³¨è§£" class="headerlink" title="2ã€æ¡ä»¶æ³¨è§£"></a><strong>2ã€æ¡ä»¶æ³¨è§£</strong></h5><p>å¦‚æœæ³¨è§£åˆ¶å®šçš„æ¡ä»¶æˆç«‹ï¼Œåˆ™å‡ºå‘æŒ‡å®šè¡Œä¸º</p>
<p>@ConfitionalOnXxx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@ConditionalOnClass:å¦‚æœç±»è·¯å¾„ä¸­å­˜åœ¨è¿™ä¸ªç±»ï¼Œåˆ™å‡ºå‘æŒ‡å®šè¡Œä¸º</span><br><span class="line">@ConditionalOnMissingClass:å¦‚æœç±»è·¯å¾„ä¸­ä¸å­˜åœ¨è¿™ä¸ªç±»ï¼Œåˆ™å‡ºå‘æŒ‡å®šè¡Œä¸º</span><br><span class="line">@ConditionalOnBeanï¼šå¦‚æœå®¹å™¨ä¸­å­˜åœ¨Beanï¼Œåˆ™è§¦å‘æŒ‡å®šè¡Œä¸º</span><br><span class="line">@ConditionalOnMissingBean ç­‰ç­‰å¤§æ¦‚éƒ½æ˜¯è¿™ä¸ªæ„æ€</span><br></pre></td></tr></table></figure>
<p>åœºæ™¯ï¼šå¦‚æœå­˜åœ¨FastsqlExceptionè¿™ä¸ªç±»ï¼Œå°±ç»™å®¹å™¨ä¸­æ”¾ä¸€ä¸ªUserç»„ä»¶ï¼Œå«user01ï¼Œå¦åˆ™ç»™å®¹å™¨ä¸­æ”¾ä¸€ä¸ªUserç»„ä»¶ï¼Œå«user02ã€‚å¦‚æœç³»ç»Ÿä¸­æœ‰user02è¿™ä¸ªç»„ä»¶å°±ç»™å®¹å™¨ä¸­æ”¾å¦å¤–ä¸€ä¸ªuser03ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig02</span>&#123;</span><br><span class="line">    <span class="meta">@ConditionalOnClass(name=&quot;com.alibaba.druid.FastsqlException&quot;)</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user01</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ConditionalOnMissiongClass(value=&quot;com.alibaba.druid.FastsqlException&quot;)</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user02</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@ConditionalOnBean(value = User.class)</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user03</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3ã€å±æ€§ç»‘å®š"><a href="#3ã€å±æ€§ç»‘å®š" class="headerlink" title="3ã€å±æ€§ç»‘å®š"></a><strong>3ã€å±æ€§ç»‘å®š</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@ConfigurationPropertiesï¼šå£°æ˜ç»„ä»¶çš„å±æ€§å’Œé…ç½®æ–‡ä»¶å“ªäº›å‰ç¼€å¼€å§‹é¡¹è¿›è¡Œç»‘å®š</span><br><span class="line">@EnableConfigurationPropertiesï¼šå¿«é€Ÿæ³¨å†Œç»„ä»¶æ³¨è§£ï¼Œç”¨äºå¯¼å…¥ç¬¬ä¸‰æ–¹åŒ…çš„ç»„ä»¶è¿›è¡Œå±æ€§ç»‘å®š</span><br><span class="line">SpringBooté»˜è®¤åªæ‰«æè‡ªå·±ä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…ï¼Œå¦‚æœå¯¼å…¥ç¬¬ä¸‰æ–¹åŒ…ï¼Œå³ä½¿@Component\@ConfigurationPropertiesä¹Ÿæ²¡ç”¨</span><br><span class="line"></span><br><span class="line">å°†å®¹å™¨ä¸­ä»»æ„ç»„ä»¶çš„å±æ€§å€¼å’Œé…ç½®æ–‡ä»¶çš„é…ç½®é¡¹è¿›è¡Œç»‘å®šã€‚</span><br><span class="line">1ã€ç»™å®¹å™¨æ³¨å†Œç»„ä»¶ ç”¨@Bean+@Configuration</span><br><span class="line">2ã€ä½¿ç”¨@ConfigurationProperties å£°æ˜ç»„ä»¶å’Œé…ç½®æ–‡ä»¶çš„å“ªäº›é…ç½®é¡¹è¿›è¡Œç»‘å®š</span><br><span class="line">ç¬¬ä¸€ç§ï¼šç”¨@Component</span><br><span class="line">é¦–å…ˆåœ¨é…ç½®æ–‡ä»¶application.propertiesé‡Œé¢ç¼–å†™</span><br><span class="line">å‡å¦‚</span><br><span class="line">user.id=1</span><br><span class="line">user.name=zs</span><br><span class="line">ç„¶åå†™Userç±»</span><br><span class="line">@Component</span><br><span class="line">@ConfigurationProperties(prefix = &quot;user&quot;)</span><br><span class="line">public class UserProperties &#123;</span><br><span class="line">    private Long id;</span><br><span class="line">    private String name;</span><br><span class="line">    ç„¶åä¸€å †setå’Œgetæ–¹æ³•</span><br><span class="line">&#125;</span><br><span class="line">ç¬¬äºŒç§ï¼šç”¨@EnableConfigurationProperties</span><br><span class="line">user.id=1</span><br><span class="line">user.name=zs</span><br><span class="line">ç„¶ååœ¨ç±»ä¸­åªç”¨åŠ </span><br><span class="line">@ConfigurationProperties(prefix = &quot;user&quot;)</span><br><span class="line">public class UserProperties &#123;</span><br><span class="line">    private Long id;</span><br><span class="line">    private String name;</span><br><span class="line">    ç„¶åä¸€å †setå’Œgetæ–¹æ³•</span><br><span class="line">&#125;</span><br><span class="line">æœ€ååœ¨é…ç½®ç±»æˆ–è€…ä¸»å¯åŠ¨ç”¨@EnableConfigurationProperties()</span><br><span class="line">@EnableConfigurationProperties(User.class)</span><br><span class="line">public class AppConfig &#123;</span><br><span class="line">    // å¯ä»¥æ”¾å…¶ä»–@Bean</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Springbootå¯¼å…¥å®Œæ•´æµç¨‹"><a href="#Springbootå¯¼å…¥å®Œæ•´æµç¨‹" class="headerlink" title="Springbootå¯¼å…¥å®Œæ•´æµç¨‹"></a>Springbootå¯¼å…¥å®Œæ•´æµç¨‹</h4><p>1ã€SpringBootæ€ä¹ˆå®ç°å¯¼å…¥ä¸€ä¸ªstarterã€å†™ä¸€äº›ç®€å•é…ç½®ï¼Œåº”ç”¨å°±èƒ½è·‘èµ·æ¥ï¼Œæˆ‘ä»¬æ— éœ€å…³å¿ƒæ•´åˆã€‚</p>
<p>2ã€ä¸ºä»€ä¹ˆTomcatçš„ç«¯å£å·å¯ä»¥é…ç½®åœ¨application.propertiesä¸­ï¼Œå¹¶ä¸”tomcatèƒ½å¯åŠ¨æˆåŠŸ</p>
<p>3ã€å¯¼å…¥åœºæ™¯åå“ªäº›è‡ªåŠ¨é…ç½®èƒ½ç”Ÿæ•ˆï¼Ÿ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251216185522689.png" alt="image-20251216185522689"></p>
<p><strong>æµç¨‹ï¼š</strong></p>
<h5 id="1ã€å¯¼å…¥starter-webï¼šå¯¼å…¥äº†webå¼€å‘åœºæ™¯"><a href="#1ã€å¯¼å…¥starter-webï¼šå¯¼å…¥äº†webå¼€å‘åœºæ™¯" class="headerlink" title="1ã€å¯¼å…¥starter-webï¼šå¯¼å…¥äº†webå¼€å‘åœºæ™¯"></a><strong>1ã€å¯¼å…¥<code>starter-web</code>ï¼šå¯¼å…¥äº†webå¼€å‘åœºæ™¯</strong></h5><ul>
<li>1ã€åœºæ™¯å¯åŠ¨å™¨å¯¼å…¥äº†ç›¸å…³åœºæ™¯çš„æ‰€æœ‰ä¾èµ–ï¼š<code>starter-json</code>ã€<code>starter-tomcat</code>ã€<code>springmvc</code></li>
<li>2ã€æ¯ä¸ªåœºæ™¯å¯åŠ¨å™¨éƒ½å¼•å…¥äº†ä¸€ä¸ª<code>spring-boot-starter</code>ï¼Œ<strong>æ ¸å¿ƒåœºæ™¯å¯åŠ¨å™¨</strong></li>
<li>3ã€<strong>æ ¸å¿ƒåœºæ™¯å¯åŠ¨å™¨</strong>å¼•å…¥äº†<code>springb-boot-autoconfiguration</code>åŒ…ã€‚</li>
<li>4ã€<code>springb-boot-autoconfiguration</code>é‡Œé¢å›Šæ‹¬äº†æ‰€æœ‰åœºæ™¯çš„æ‰€æœ‰é…ç½®ã€‚</li>
<li>5ã€åªè¦è¿™ä¸ªåŒ…ä¸‹çš„æ‰€æœ‰ç±»éƒ½èƒ½ç”Ÿæ•ˆï¼Œé‚£ä¹ˆç›¸å½“äºSpringBootå®˜æ–¹å†™å¥½çš„æ•´åˆåŠŸèƒ½å°±èƒ½ç”Ÿæ•ˆã€‚</li>
<li>6ã€SpringBooté»˜è®¤æ‰«æä¸åˆ°<code>springb-boot-autoconfiguration</code>ä¸‹å†™å¥½çš„æ‰€æœ‰é…ç½®ç±»ã€‚ï¼ˆè¿™äº›é…ç½®ç±»ç»™æˆ‘ä»¬åšäº†æ•´åˆæ“ä½œï¼‰</li>
</ul>
<p>æ€»ç»“ï¼šå¯¼åŒ…çš„è¿‡ç¨‹å°±æ˜¯å¯¼å…¥äº†<code>springb-boot-autoconfiguration</code>ï¼Œç„¶åé‡Œé¢çš„é…ç½®ç±»éƒ½å¼•å…¥äº†ï¼Œè‡³äºç”Ÿä¸ç”Ÿæ•ˆçœ‹åé¢çš„ã€‚</p>
<h5 id="2ã€ä¸»ç¨‹åºï¼š-SpringBootApplication"><a href="#2ã€ä¸»ç¨‹åºï¼š-SpringBootApplication" class="headerlink" title="2ã€ä¸»ç¨‹åºï¼š@SpringBootApplication"></a><strong>2ã€ä¸»ç¨‹åºï¼š@SpringBootApplication</strong></h5><ul>
<li>1ã€<code>@SpringBootApplication</code>ç”±ä¸‰ä¸ªæ³¨è§£ç»„æˆ<code>@SpringBootConfiguration</code>ã€<code>@EnableAutoConfiguration</code>ã€<code>@ComponentScan</code></li>
<li>2ã€SpringBooté»˜è®¤åªèƒ½æ‰«æè‡ªå·±ä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…åŠå…¶ä¸‹é¢çš„å­åŒ…ï¼Œæ‰«æä¸åˆ°<code>spring-boot-autoconfigure</code>åŒ…ä¸­å®˜æ–¹å†™å¥½çš„é…ç½®ç±»ã€‚</li>
<li>3ã€<code>@EnableAutoConfiguration</code>è¿™ä¸ªæ³¨è§£å°±æ˜¯SpringBootå¼€å¯è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒï¼Œ<ul>
<li>1ã€æ˜¯ç”±<code>@Import(AutoConfigurationImportSelector.class)æä¾›åŠŸèƒ½</code>æ‰¹é‡ç»™å®¹å™¨ä¸­å¯¼å…¥ç»„ä»¶ã€‚</li>
<li>2ã€SpringBootå¯åŠ¨ä¼šé»˜è®¤åŠ è½½152ä¸ªé…ç½®ç±»ã€‚</li>
<li>3ã€è¿™152ä¸ªé…ç½®ç±»ï¼Œæ¥è‡ªäº<code>MET-IF</code>ä¸€ä¸ªè·¯å¾„ä¸­çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å¯¼å…¥çš„åŒ…çš„ï¼Œç„¶åé‡Œé¢æœ‰æ–‡ä»¶é…ç½®å¥½152ä¸ªæ–‡ä»¶æŒ‡å®š</li>
<li>é¡¹ç›®å¯åŠ¨çš„æ—¶å€™åˆ©ç”¨<code>@Import</code>æ‰¹é‡å¯¼å…¥ç»„ä»¶æœºåˆ¶æŠŠautoconfigureåŒ…ä¸‹çš„152ä¸ªè‡ªåŠ¨å¯¼å…¥ç±»å¯¼å…¥è¿›æ¥</li>
<li>è¿™äº›è‡ªåŠ¨é…ç½®ç±»é‡Œé¢ä¼šæœ‰@Beanæ”¾ä¸€å †ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å°±èƒ½å·¥ä½œäº†</li>
</ul>
</li>
</ul>
<p>æ€»ç»“ï¼šSpringBooté»˜è®¤åªæ‰«æä¸»ç¨‹åºçš„é…ç½®ç±»ï¼Œç„¶ååˆ©ç”¨<code>@SpringBootApplication</code>æ³¨è§£é‡Œé¢çš„<code>@EnableAutoConfiguration</code>æ³¨è§£é‡Œé¢çš„<code>@Import</code>æ³¨è§£å¯¼å…¥çš„152ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¹Ÿæ‰«æäº†ã€‚è‡ªåŠ¨é…ç½®ç±»éƒ½å¯¼å…¥äº†ä½†æ˜¯ä¸ä¸€å®šç”Ÿæ•ˆï¼Œé‡Œé¢æœ‰<code>@ConditionalOnClass</code>åˆ¤æ–­ï¼Œå¦‚æœæœ‰è¿™äº›ç±»ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚</p>
<h5 id="3ã€è‡ªåŠ¨é…ç½®ç±»"><a href="#3ã€è‡ªåŠ¨é…ç½®ç±»" class="headerlink" title="3ã€è‡ªåŠ¨é…ç½®ç±»"></a>3ã€è‡ªåŠ¨é…ç½®ç±»</h5><ul>
<li>1ã€<strong>ç»™å®¹å™¨ä¸­ä½¿ç”¨@Beanæ”¾ä¸€å †ç»„ä»¶</strong></li>
<li>2ã€æ¯ä¸ª <strong>è‡ªåŠ¨é…ç½®ç±»</strong>éƒ½å¯èƒ½æœ‰è¿™ä¸ªæ³¨è§£<code>@EnableAutoConfiguration(ServerProperties.class)</code>ç”¨æ¥æŠŠé…ç½®æ–‡ä»¶ä¸­é…çš„æŒ‡å®šå‰ç½®å±æ€§å°è£…åˆ°<code>xxxProperties</code> <strong>å±æ€§ç±»</strong>ä¸­ã€</li>
<li>ä»¥Tomcatä¸ºä¾‹å­ï¼šæŠŠæœåŠ¡å™¨çš„æ‰€æœ‰é…ç½®éƒ½æ˜¯ä»¥<code>server</code>å¼€å¤´çš„ï¼Œé…ç½®éƒ½å°è£…åˆ°äº†å±æ€§ç±»ä¸­ã€‚</li>
</ul>
<h5 id="4ã€å†™ä¸šåŠ¡ï¼Œå…¨ç¨‹æ— éœ€å…³å¿ƒå„ç§æ•´åˆï¼ˆåº•å±‚æŠŠæ•´åˆå†™å¥½äº†ï¼Œè€Œä¸”ä¹Ÿç”Ÿæ•ˆäº†ï¼‰ã€‚"><a href="#4ã€å†™ä¸šåŠ¡ï¼Œå…¨ç¨‹æ— éœ€å…³å¿ƒå„ç§æ•´åˆï¼ˆåº•å±‚æŠŠæ•´åˆå†™å¥½äº†ï¼Œè€Œä¸”ä¹Ÿç”Ÿæ•ˆäº†ï¼‰ã€‚" class="headerlink" title="4ã€å†™ä¸šåŠ¡ï¼Œå…¨ç¨‹æ— éœ€å…³å¿ƒå„ç§æ•´åˆï¼ˆåº•å±‚æŠŠæ•´åˆå†™å¥½äº†ï¼Œè€Œä¸”ä¹Ÿç”Ÿæ•ˆäº†ï¼‰ã€‚"></a>4ã€å†™ä¸šåŠ¡ï¼Œå…¨ç¨‹æ— éœ€å…³å¿ƒå„ç§æ•´åˆï¼ˆåº•å±‚æŠŠæ•´åˆå†™å¥½äº†ï¼Œè€Œä¸”ä¹Ÿç”Ÿæ•ˆäº†ï¼‰ã€‚</h5><p><strong>æ ¸å¿ƒæµç¨‹ï¼š</strong></p>
<p>1ã€å¯¼å…¥starterï¼Œç„¶åå°±ä¼šå¯¼å…¥<code>autoconfigure</code>åŒ…ã€‚</p>
<p>2ã€<code>autoconfigure</code>åŒ…é‡Œé¢æœ‰ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢æŒ‡å®šäº†æ‰€æœ‰å¯åŠ¨è¦åŠ è½½çš„<strong>è‡ªåŠ¨é…ç½®ç±»</strong>ã€‚</p>
<p>3ã€<code>@EnableAutoConfiguration</code>ä¼šè‡ªåŠ¨çš„æŠŠä¸Šé¢è‡ªåŠ¨é…ç½®ç±»æ–‡ä»¶é‡Œé¢å†™çš„æ‰€æœ‰<strong>è‡ªåŠ¨é…ç½®ç±»éƒ½å¯¼å…¥è¿›æ¥</strong>ã€‚<strong>xxxAutoConfigureation</strong> æ˜¯æœ‰æ¡ä»¶æ³¨è§£è¿›è¡ŒæŒ‰éœ€åŠ è½½</p>
<p>4ã€è¿™äº›å¯¼å…¥çš„<strong>xxxAutoConfigureation</strong> åˆç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€å †ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶æœ‰152ä¸ªï¼Œç»„ä»¶éƒ½æ˜¯ä»<code>xxxProperties</code>ä¸­æå–å±æ€§å€¼</p>
<p>5ã€<code>xxxProperties</code>åˆæ˜¯å’Œé…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®šã€‚</p>
<p>æ•ˆæœï¼šå¯¼å…¥staterã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°±èƒ½ä¿®æ”¹åº•å±‚è¡Œä¸ºã€‚</p>
<p><strong>å¦‚ä½•å­¦å¥½SpringBoot</strong></p>
<p>æ¡†æ¶çš„æ¡†æ¶ï¼Œåº•å±‚åŸºäºSpringã€‚èƒ½è°ƒæ•´æ¯ä¸€ä¸ªåœºæ™¯çš„åº•å±‚è¡Œä¸ºã€‚100%é¡¹ç›®ä¸€å®šä¼šç”¨åˆ°åº•å±‚è‡ªå®šä¹‰</p>
<p>ç±»ä¼¼äºæ‘„å½±ï¼š</p>
<p>å‚»ç“œç…§ç›¸æœºï¼šè‡ªåŠ¨é…ç½®å¥½</p>
<p>å•åï¼šæ•™å…·ã€å…‰åœˆã€å¿«é—¨ã€æ„Ÿå…‰åº¦â€¦.</p>
<p>å‚»ç“œ+å•åï¼š</p>
<p>1ã€ç†è§£ <strong>è‡ªåŠ¨é…ç½®åŸç†</strong></p>
<p>â€‹    a.å¯¼å…¥starter -&gt; ç”Ÿæ•ˆxxxAutoConfiguration -&gt; ç»„ä»¶ -&gt; xxxProperties -&gt; é…ç½®æ–‡ä»¶</p>
<p>2ã€ç†è§£ <strong>å…¶ä»–æ¡†æ¶åº•å±‚</strong></p>
<p>â€‹    a.æ‹¦æˆªå™¨</p>
<p>3ã€å¯ä»¥éšæ—¶ <strong>å®šåˆ¶åŒ–ä»»ä½•ç»„ä»¶</strong></p>
<p>â€‹    a.é…ç½®æ–‡ä»¶</p>
<p>â€‹    b.è‡ªå®šä¹‰ç»„ä»¶</p>
<p><strong>æ ¸å¿ƒï¼š</strong>è¿™ä¸ªåœºæ™¯è‡ªåŠ¨é…ç½®å¯¼å…¥äº†å“ªäº›ç»„ä»¶ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½Autowiredè¿›æ¥ä½¿ç”¨ï¼Œå¦‚æœç”¨ä¸äº†ï¼Œèƒ½ä¸èƒ½é€šè¿‡ä¿®æ”¹é…ç½®ï¼Œæ”¹å˜ç»„ä»¶çš„ä¸€äº›é»˜è®¤å‚æ•°ï¼Œéœ€ä¸éœ€è¦è‡ªå·±å®Œå…¨å®šä¹‰è¿™ä¸ªç»„ä»¶ï¼Œ<strong>åœºæ™¯å®šåˆ¶åŒ–</strong>éå¸¸é‡è¦ã€‚</p>
<p><strong>æœ€ä½³å®æˆ˜ï¼š</strong></p>
<ul>
<li>é€‰åœºæ™¯ï¼šå¯¼å…¥åˆ°é¡¹ç›®<ul>
<li>å®˜æ–¹ï¼šstarter</li>
<li>ç¬¬ä¸‰æ–¹ï¼šå»ä»“åº“æœ</li>
</ul>
</li>
<li>å†™é…ç½®ï¼šæ”¹é…ç½®æ–‡ä»¶å…³é”®é¡¹<ul>
<li>æ•°æ®åº“å‚æ•°ï¼ˆé“¾æ¥åœ°å€ï¼Œè´¦å·å¯†ç ç­‰ï¼‰</li>
</ul>
</li>
<li>åˆ†æè¿™ä¸ªåœºæ™¯ç»™æˆ‘ä»¬å¯¼å…¥äº†å“ªäº›èƒ½ç”¨çš„ç»„ä»¶<ul>
<li>è‡ªåŠ¨è£…é…è¿™äº›ç»„ä»¶è¿›è¡Œåç»­ä½¿ç”¨</li>
<li>ä¸æ»¡æ„Bootæä¾›çš„è‡ªåŠ¨é…å¥½çš„ç»„ä»¶<ul>
<li>å®šåˆ¶åŒ–<ul>
<li>æ”¹é…ç½®</li>
<li>è‡ªå®šä¹‰ç»„ä»¶</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>æ•´åˆredisä¸ºæ¡ˆä¾‹</strong></p>
<ul>
<li><p>é€‰åœºæ™¯ï¼šå®˜æ–¹æä¾›äº†ï¼Œç›´æ¥å¯¼å…¥<code>spring-boot-starter-date-redis</code></p>
</li>
<li><p>å†™é…ç½®ï¼šç„¶åå»çœ‹RedisAutoConfigurationé‡Œé¢ç„¶åçœ‹åˆ°é‡Œé¢çš„EnableConfigurationPropertiesï¼Œç„¶åå‘ç°é‡Œé¢çš„é…ç½®éƒ½å†™åœ¨RedisProperties.classé‡Œé¢ï¼Œç„¶åè¿›å»é…ç½®æ–‡ä»¶çœ‹çœ‹æœ‰å“ªäº›é…ç½®ã€‚</p>
</li>
<li><p>åˆ†æç»„ä»¶</p>
<ul>
<li>åˆ†æåˆ°RedisAutoConfigurationç»™å®¹å™¨ä¸­æ”¾äº†<code>StringRedisTemplete</code></li>
<li>ç»™ä¸šåŠ¡ä»£ç ä¸­è‡ªåŠ¨è£…é…<code>StringRedisTemplete</code></li>
</ul>
</li>
<li><p>å®šåˆ¶åŒ–</p>
<ul>
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li>
<li>è‡ªå®šä¹‰ç»„ä»¶ï¼Œè‡ªå·±ç»™å®¹å™¨ä¸­æ”¾ä¸€ä¸ª<code>StringRedisTemplete</code></li>
</ul>
</li>
</ul>
<h4 id="YAMLé…ç½®æ–‡ä»¶"><a href="#YAMLé…ç½®æ–‡ä»¶" class="headerlink" title="YAMLé…ç½®æ–‡ä»¶"></a><strong>YAMLé…ç½®æ–‡ä»¶</strong></h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#k: v #è¿™ä¸ªæ˜¯æ³¨é‡Šï¼Œå¤§å°å†™æ•æ„Ÿï¼Œk: vä¸­é—´æœ‰ç©ºæ ¼ï¼Œå±æ€§æœ‰å±‚çº§å…³ç³»ï¼Œä¸‹ä¸€è¡Œå°±æ˜¯å­å±æ€§</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9999</span></span><br></pre></td></tr></table></figure>
<p>æ”¯æŒçš„å†™æ³•ï¼š</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Dog dog; <span class="comment">//åµŒå¥—å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> Date birthDay;<span class="comment">//æ—¥æœŸç±»</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; text;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Dog&gt; dogs;<span class="comment">//æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Dog&gt; cats;<span class="comment">//è¡¨ç¤ºMap</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸ªæƒ³è¦ç”¨YMLç»‘å®š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">	<span class="attr">name:</span> <span class="string">å¼ ä¸‰</span></span><br><span class="line">	<span class="attr">age:</span> <span class="number">18</span></span><br><span class="line">	<span class="attr">birthDay:</span> <span class="number">2010</span><span class="string">/10/12</span> <span class="number">12</span><span class="string">:12:12</span></span><br><span class="line">	<span class="attr">text:</span> [<span class="string">&quot;abcx&quot;</span>,<span class="string">&quot;der&quot;</span>]</span><br><span class="line">	<span class="attr">dog:</span></span><br><span class="line">		<span class="attr">name:</span> <span class="string">lisi</span></span><br><span class="line">		<span class="attr">age:</span> <span class="number">12</span></span><br><span class="line">     <span class="attr">dogs:</span></span><br><span class="line">     	<span class="bullet">-</span> <span class="attr">name:</span> <span class="string">dog1</span></span><br><span class="line">     	  <span class="attr">age:</span> <span class="number">1</span></span><br><span class="line">     	<span class="bullet">-</span> <span class="attr">name:</span> <span class="string">dog2</span></span><br><span class="line">     	  <span class="attr">age:</span> <span class="number">2</span></span><br><span class="line">     <span class="attr">cats:</span></span><br><span class="line">     	<span class="attr">d1:</span> </span><br><span class="line">     		<span class="attr">name:</span> <span class="string">å°è“</span></span><br><span class="line">     		<span class="attr">age:</span> <span class="number">3</span></span><br><span class="line">     	<span class="attr">d2:</span> &#123;<span class="attr">name:</span> <span class="string">å°ç»¿</span>,<span class="attr">age:</span> <span class="number">4</span>&#125;	</span><br></pre></td></tr></table></figure>
<p><strong>å°ç»†èŠ‚</strong></p>
<p>1ã€ç¬¦åˆé©¼å³°å‘½åçš„åå­—æ¨èå†™æˆï¼šbirth-day</p>
<p>2ã€æ–‡æœ¬ï¼šå•å¼•å·ä¸ä¼šè½¬ä¹‰æ¯”å¦‚\nå°±æ˜¯æ™®é€šå­—ç¬¦ï¼Œä½†æ˜¯åŒå¼•å·ä¼šè½¬ä¹‰ä¼šè¯†åˆ«æˆæ¢è¡Œç¬¦</p>
<p>3ã€çŸ­ç«–çº¿ä¸‹é¢çš„æ–‡æœ¬å¯ä»¥å­˜å‚¨å¤§æ–‡æœ¬ | ä¼šä¿ç•™æ–‡æœ¬æ ¼å¼</p>
<p>4ã€ç”¨&gt; è¡¨ç¤ºå¤§æ–‡æœ¬ï¼Œä¼šå‹ç¼© æ¢è¡Œå˜æˆç©ºæ ¼</p>
<p>5ã€ç”¨ä¸‰ä¸ª - å¯ä»¥åˆ†éš”æ–‡æ¡£æ›´ç¾è§‚</p>
<h4 id="æ—¥å¿—é…ç½®"><a href="#æ—¥å¿—é…ç½®" class="headerlink" title="æ—¥å¿—é…ç½®"></a><strong>æ—¥å¿—é…ç½®</strong></h4><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ¢³ç†æ¸…æ¥šå¸‚é¢ä¸Šçš„æ—¥å¿—æ¡†æ¶ï¼Œç„¶åè¦ç†æ¸…è§„èŒƒï¼Œ <strong>é¡¹ç›®å¼€å‘ä¸è¦ç¼–å†™soutï¼Œåº”è¯¥ç”¨æ—¥å¿—è®°å½•ä¿¡æ¯</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251217194550374.png" alt="image-20251217194550374"></p>
<p><strong>æ—¥å¿—é—¨é¢</strong>ï¼Œå°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªâ€œæ¥å£å±‚â€æˆ–â€œç»Ÿä¸€å…¥å£â€ï¼Œå®ƒ<strong>ä¸è´Ÿè´£å®é™…çš„æ—¥å¿—è¾“å‡º</strong>ï¼Œè€Œæ˜¯æä¾›ä¸€å¥—<strong>æ ‡å‡†çš„ API</strong>ï¼Œè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨ä¸€è‡´çš„æ–¹å¼å†™æ—¥å¿—ä»£ç ã€‚</p>
<p><strong>æ—¥å¿—å®ç°</strong>å°±æ˜¯çœŸæ­£å¹²æ´»çš„ç»„ä»¶ï¼Œå®ƒè´Ÿè´£ï¼š</p>
<ul>
<li>æŠŠæ—¥å¿—æ¶ˆæ¯æ ¼å¼åŒ–</li>
<li>å†³å®šè¾“å‡ºåˆ°æ§åˆ¶å°ã€æ–‡ä»¶ã€ç½‘ç»œç­‰</li>
<li>æ§åˆ¶æ—¥å¿—çº§åˆ«ï¼ˆdebug/info/warn/errorï¼‰</li>
<li>ç®¡ç†æ—¥å¿—æ»šåŠ¨ã€å½’æ¡£ç­‰</li>
</ul>
<p>Springä½¿ç”¨commons-loggingä½œä¸ºå†…éƒ¨æ—¥å¿—ï¼Œä½†åº•å±‚æ—¥å¿—å®ç°æ˜¯å¼€æ”¾çš„ã€‚å¯å¯¹æ¥å…¶ä»–æ—¥å¿—æ¡†æ¶ã€‚</p>
<p><strong>Spring5ä»¥åcommons-loggingè¢«springç›´æ¥è‡ªå·±å†™äº†</strong>ã€‚åº•å±‚æ˜¯æœ‰åˆ¤æ–­é€»è¾‘çš„ï¼Œå¦‚æœå¯¼å…¥Log4jå°±ç”¨Log4jç­‰ç­‰ã€‚</p>
<p>Springboog3æ”¯æŒjulï¼Œlog4j2ï¼Œlogbackã€‚SpringBootæä¾›äº†é»˜è®¤çš„æ§åˆ¶å°è¾“å‡ºé…ç½®ï¼Œä¹Ÿå¯ä»¥é…ç½®è¾“å‡ºä¸ºæ–‡ä»¶ã€‚Logbackæ˜¯é»˜è®¤ä½¿ç”¨çš„ã€‚</p>
<p>è™½ç„¶æ—¥å¿—æ¡†æ¶å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨SpringBootçš„é»˜è®¤é…ç½®å°±èƒ½å·¥ä½œçš„å¾ˆå¥½ã€‚</p>
<p><strong>SpringBootæ˜¯æ€ä¹ˆæŠŠæ—¥å¿—é»˜è®¤é…ç½®å¥½çš„</strong></p>
<p>é¦–å…ˆpomä¾èµ–ä¼šå¯¼å…¥åœºæ™¯ï¼Œæ¯”å¦‚webåœºæ™¯ï¼Œç„¶åæ¯ä¸ªåœºæ™¯å¯åŠ¨å™¨éƒ½ä¼šæœ‰spring-boot-starterã€‚</p>
<p>ç„¶ååœ¨æ ¸å¿ƒåœºæ™¯é‡Œé¢ï¼Œå¼•å…¥äº†æ—¥å¿—çš„æ‰€æœ‰åŠŸèƒ½spring-boot-starter-logging</p>
<p>é»˜è®¤ä½¿ç”¨Logback + sl4j ç»„åˆä½œä¸ºé»˜è®¤åº•å±‚æ—¥å¿—</p>
<p>ä»¥å‰è¯´è‡ªåŠ¨é…ç½®éƒ½åœ¨AutoConfigureé‡Œé¢ï¼Œä½†æ˜¯æ—¥å¿—æ˜¯ç³»ç»Ÿä¸€å¯åŠ¨å°±è¦ç”¨çš„ï¼Œè€ŒxxxAutoConfigureationæ˜¯ç³»ç»Ÿå¯åŠ¨å¥½äº†ä»¥åæ”¾å¥½çš„ç»„ä»¶ï¼Œåæ¥ç”¨çš„ã€‚</p>
<p>æ—¥å¿—æ˜¯åˆ©ç”¨ç›‘å¬å™¨æœºåˆ¶é…ç½®å¥½çš„ã€‚<code>ApplicationListener</code>ã€‚</p>
<p>æ—¥å¿—æ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶å®ç°ã€‚ä»¥loggingå¼€å§‹çš„æ‰€æœ‰é…ç½®éƒ½æ˜¯æ—¥å¿—çš„é…ç½®ã€‚</p>
<p><strong>æ ¸å¿ƒçš„ç›‘å¬å™¨æœºåˆ¶åé¢è¯¦ç»†è¯´</strong></p>
<h5 id="æ—¥å¿—æ ¼å¼"><a href="#æ—¥å¿—æ ¼å¼" class="headerlink" title="æ—¥å¿—æ ¼å¼"></a><strong>æ—¥å¿—æ ¼å¼</strong></h5><p>é»˜è®¤è¾“å‡ºæ ¼å¼ï¼š</p>
<ul>
<li>æ—¶é—´å’Œæ—¥æœŸï¼šæ¯«ç§’çº§ç²¾åº¦</li>
<li>æ—¥å¿—çº§åˆ«ï¼šERRORã€WARNã€INFOã€DEBUGã€or TRACE</li>
<li>è¿›ç¨‹ID</li>
<li><code>---</code>ï¼šæ¶ˆæ¯åˆ†éš”ç¬¦</li>
<li>çº¿ç¨‹åï¼šä½¿ç”¨ã€ã€‘åŒ…å«</li>
<li>Loggeråï¼šé€šå¸¸æ˜¯äº§ç”Ÿæ—¥å¿—çš„ç±»å</li>
<li>æ¶ˆæ¯ï¼šæ—¥å¿—è®°å½•çš„å†…å®¹</li>
</ul>
<p>æ³¨æ„ï¼šLogbackæ²¡æœ‰FATALçº§åˆ«ï¼Œå¯¹åº”çš„æ˜¯ERROR</p>
<p>é»˜è®¤å€¼ï¼šå‚ç…§<code>spring-boot</code>åŒ…<code>additional-spring-configuration-metadata.json</code>æ–‡ä»¶</p>
<p>å¯ä¿®æ”¹ä¸ºï¼š<code>%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5level [%thread] %logger&#123;15&#125; ===&gt; %msg%n</code></p>
<p>æˆ–è€…åœ¨cmdå‘½ä»¤é‡Œé¢åˆ©ç”¨javaçš„jdkå‘½ä»¤jpsä¹Ÿèƒ½çœ‹è¿è¡Œçš„è¿›ç¨‹</p>
<h5 id="å›å½’åˆ°ä½¿ç”¨"><a href="#å›å½’åˆ°ä½¿ç”¨" class="headerlink" title="å›å½’åˆ°ä½¿ç”¨"></a><strong>å›å½’åˆ°ä½¿ç”¨</strong></h5><p>å¦‚æœæƒ³åœ¨ä¸šåŠ¡é‡Œé¢å†™æ—¥å¿—</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span>&#123;</span><br><span class="line">    <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(getClass());<span class="comment">//æ—¥å¿—è®°å½•å™¨</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/h&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        logger.info(<span class="string">&quot;hahaha,æ–¹æ³•è¿›æ¥äº†&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æˆ–è€…å¯¼å…¥lombokç„¶åç”¨æ³¨è§£ç›´æ¥è·å¾—æ—¥å¿—è®°å½•å™¨</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/h&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;hahaha,æ–¹æ³•è¿›æ¥äº†&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æ—¥å¿—çº§åˆ«"><a href="#æ—¥å¿—çº§åˆ«" class="headerlink" title="æ—¥å¿—çº§åˆ«"></a><strong>æ—¥å¿—çº§åˆ«</strong></h5><p>ç”±ä½åˆ°é«˜ï¼šALLã€TRACEã€DEBUGã€INFOã€WARNã€ERRORã€FATALã€OFF</p>
<ul>
<li>åªä¼šæ‰“å°åˆ¶å®šçº§åˆ«ä»¥åŠä»¥ä¸Šçº§åˆ«çš„æ—¥å¿—</li>
<li>ALLï¼šæ‰“å°æ‰€æœ‰æ—¥å¿—</li>
<li>TRACEï¼šè¿½è¸ªæ¡†æ¶è¯¦ç»†æµç¨‹æ—¥å¿—ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨</li>
<li>DEBUGï¼šå¼€å‘è°ƒè¯•ç»†èŠ‚æ—¥å¿—</li>
<li>INFOï¼šå…³é”®ï¼Œæ„Ÿå…´è¶£ä¿¡æ¯æ—¥å¿—</li>
<li>WARNï¼šè­¦å‘Šä½†ä¸æ˜¯é”™è¯¯çš„ä¿¡æ¯æ—¥å¿—ï¼Œæ¯”å¦‚ï¼šç‰ˆæœ¬è¿‡æ—¶</li>
<li>ERRORï¼šä¸šåŠ¡é”™è¯¯æ—¥å¿—ï¼Œæ¯”å¦‚å‡ºç°å„ç§å¼‚å¸¸</li>
<li>FATALï¼šä¹‹å‘½é”™è¯¯æ—¥å¿—ï¼Œæ¯”å¦‚jvmç³»ç»Ÿå´©æºƒ</li>
<li>OFFï¼šå…³é—­æ‰€æœ‰æ—¥å¿—è®°å½•</li>
</ul>
<p>ä¸æŒ‡å®šçº§åˆ«çš„æ‰€æœ‰ç±»ï¼Œéƒ½æ˜¯ç”¨rootåˆ¶å®šçš„çº§åˆ«ä½œä¸ºé»˜è®¤çº§åˆ«</p>
<p>SpringBootæ—¥å¿—é»˜è®¤çº§åˆ«æ˜¯INFO</p>
<p>1ã€åœ¨application.ymlä¸­é…ç½®logging.levelåˆ¶å®šæ—¥å¿—çº§åˆ«</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é»˜è®¤æ‰€æœ‰æ—¥å¿—æ²¡æœ‰ç²¾ç¡®æŒ‡å®šçº§åˆ«å°±ä½¿ç”¨rootçš„é»˜è®¤çº§åˆ«</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">	<span class="attr">level:</span></span><br><span class="line">		<span class="attr">root:</span> <span class="string">info</span> <span class="comment">#é»˜è®¤info</span></span><br><span class="line"><span class="comment">#å¦‚æœæƒ³ç²¾ç¡®æŒ‡å®šå“ªä¸ªåŒ…æŒ‡å®šå“ªä¸ªçº§åˆ«</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">	<span class="attr">level:</span></span><br><span class="line">		<span class="attr">com.bitzh.logging.controller:</span> <span class="string">warn</span></span><br><span class="line"><span class="comment">#åç»­å¤ªç²¾ç¡®æ¯ä¸ªåŒ…è®¾è®¡æ—¥å¿—çº§åˆ«ä¼šå¤ªéº»çƒ¦ï¼Œæ‰€ä»¥æä¾›åˆ†ç»„</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">	<span class="attr">group:</span></span><br><span class="line">		<span class="attr">abc:</span> <span class="string">com.bitzh.logging.controller,com.bitzh.logging.service</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">	<span class="attr">level:</span></span><br><span class="line">		<span class="attr">abc:</span> <span class="string">info</span></span><br><span class="line"><span class="comment">#springbootè¿˜ç»™æˆ‘ä»¬åˆ†äº†sqlå’Œwebç»„</span></span><br></pre></td></tr></table></figure>
<p>2ã€levelå¯å–å€¼èŒƒå›´</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/h&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(String a)</span>&#123;</span><br><span class="line">        log.trace(<span class="string">&quot;traceæ—¥å¿—&quot;</span>)</span><br><span class="line">        log.debug(<span class="string">&quot;debugæ—¥å¿—&quot;</span>);</span><br><span class="line">        <span class="comment">//SpringBootåº•å±‚é»˜è®¤çš„æ—¥å¿—çº§åˆ«æ˜¯infoï¼Œåªä¼šæ‰“å°infoåŠä»¥åçš„</span></span><br><span class="line">        log.info(<span class="string">&quot;hahaha,æ–¹æ³•è¿›æ¥äº†&quot;</span>);</span><br><span class="line">        log.warn(<span class="string">&quot;warnæ—¥å¿—&quot;</span>);</span><br><span class="line">        log.error(<span class="string">&quot;erroræ—¥å¿—&quot;</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœæƒ³çœ‹açš„å‚æ•°</span></span><br><span class="line">        log.info(<span class="string">&quot;a&#123;&#125;&quot;</span>,a);<span class="comment">//è¿™æ ·å°±èƒ½çœ‹åˆ°açš„å‚æ•°</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3ã€åˆ¶å®šæ—¥å¿—æ–‡ä»¶</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">	<span class="attr">file:</span></span><br><span class="line">		<span class="attr">path:</span> <span class="string">D:\\demo.log</span> <span class="comment">#æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„è·¯å¾„,å¦‚æœpathå’Œnameéƒ½æœ‰å°±ä¼šéµå¾ªnameï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨name</span></span><br><span class="line">		<span class="attr">name:</span> <span class="string">demo.log</span>     <span class="comment">#æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„åï¼ŒåªæŒ‡å®šæ–‡ä»¶åå°±ä¼šæŠŠæ–‡ä»¶æ”¾åœ¨è·Ÿé¡¹ç›®åŒä½ç½®çš„ç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure>
<p>4ã€æ–‡ä»¶å½’æ¡£ä¸æ»šåŠ¨åˆ‡å‰²</p>
<p>é¦–å…ˆæ—¥å¿—æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæ‰€ä»¥å°±å‡ºç°äº†è¿™ä¸ªåŠŸèƒ½</p>
<blockquote>
<p>å½’æ¡£ï¼šæ¯å¤©çš„æ—¥å¿—å•ç‹¬å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­</p>
<p>åˆ‡å‰²ï¼šæ¯ä¸ªæ–‡ä»¶10MBï¼Œè¶…è¿‡å¤§å°åˆ‡å‰²æˆå¦å¤–ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
</blockquote>
<p>1ã€æ¯å¤©çš„æ—¥å¿—åº”è¯¥ç‹¬ç«‹åˆ†å‰²å‡ºæ¥å­˜æ¡£ã€‚å¦‚æœä½¿ç”¨logback ï¼ˆSpringBooté»˜è®¤æ•´åˆï¼‰ã€‚å¯ä»¥é€šè¿‡ymlæ–‡ä»¶æŒ‡å®šæ—¥å¿—æ»šåŠ¨è§„åˆ™ã€‚</p>
<p>2ã€å¦‚æœæ˜¯å…¶ä»–æ—¥å¿—ç³»ç»Ÿï¼Œéœ€è¦è‡ªè¡Œé…ç½®ï¼Œæ¯”å¦‚æ·»åŠ log4j2.xmlæˆ–è€…log4j2-spring.xml</p>
<p>3ã€æ”¯æŒçš„æ»šåŠ¨è§„åˆ™è®¾ç½®å¦‚ä¸‹</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>logging.logback.rollingpolicy.file-name-pattern</code></td>
<td><strong>å¿…å¡«</strong>ã€‚å®šä¹‰å½’æ¡£æ—¥å¿—æ–‡ä»¶çš„å‘½åæ¨¡å¼ï¼Œæ”¯æŒæ—¶é—´ï¼ˆå¦‚ <code>%d&#123;yyyy-MM-dd&#125;</code>ï¼‰å’Œç´¢å¼•ï¼ˆå¦‚ <code>%i</code>ï¼‰ã€‚ä¾‹å¦‚ï¼š<code>$&#123;LOG_FILE&#125;.%d&#123;yyyy-MM-dd&#125;.%i.gz</code>ã€‚è¯¥æ¨¡å¼å†³å®šäº†æ—¥å¿—å¦‚ä½•æŒ‰æ—¶é—´æˆ–å¤§å°æ»šåŠ¨å¹¶å‹ç¼©ã€‚</td>
</tr>
<tr>
<td><code>logging.logback.rollingpolicy.max-file-size</code></td>
<td>å•ä¸ªæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼Œè¶…è¿‡åè§¦å‘æ»šåŠ¨ï¼ˆä»…åœ¨æ–‡ä»¶åæ¨¡å¼ä¸­åŒ…å« <code>%i</code> æ—¶ç”Ÿæ•ˆï¼‰ã€‚ä¾‹å¦‚ï¼š<code>10MB</code>ã€‚</td>
</tr>
<tr>
<td><code>logging.logback.rollingpolicy.max-history</code></td>
<td>ä¿ç•™çš„å½’æ¡£æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤©æ•°ï¼ˆæˆ–å‘¨æœŸæ•°ï¼‰ã€‚è¶…è¿‡æ­¤å¤©æ•°çš„æ—§æ—¥å¿—ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚ä¾‹å¦‚ï¼š<code>30</code> è¡¨ç¤ºä¿ç•™æœ€è¿‘30å¤©çš„æ—¥å¿—ã€‚</td>
</tr>
<tr>
<td><code>logging.logback.rollingpolicy.total-size-cap</code></td>
<td>æ‰€æœ‰å½’æ¡£æ—¥å¿—æ–‡ä»¶çš„æ€»å¤§å°ä¸Šé™ã€‚è¶…è¿‡åä¼šåˆ é™¤æœ€æ—§çš„å½’æ¡£æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š<code>1GB</code>ã€‚</td>
</tr>
<tr>
<td><code>logging.logback.rollingpolicy.clean-history-on-start</code></td>
<td>åº”ç”¨å¯åŠ¨æ—¶æ˜¯å¦æ¸…ç†è¿‡æœŸçš„å½’æ¡£æ—¥å¿—ï¼ˆ<code>true</code>/<code>false</code>ï¼‰ã€‚é»˜è®¤ä¸º <code>false</code>ã€‚</td>
</tr>
</tbody>
</table>
</div>
<h5 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a><strong>è‡ªå®šä¹‰é…ç½®</strong></h5><p>é€šå¸¸æˆ‘ä»¬é…ç½®ymlå°±å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦ç”¨ä»¥å‰çš„è‡ªå®šä¹‰logbacké…ç½®ï¼Œå°±ç›´æ¥æŠŠlogback.xmlæ”¾åˆ°resourcesä¸‹é¢ï¼Œç„¶åspringbootå°±ä¼šç”¨è‡ªå·±çš„logbcakçš„é…ç½®äº†ã€‚</p>
<p>ä½†æ˜¯æ–‡ä»¶åspringæ›´æ¨è<code>logback-spring.xml</code>è¿™ç§æ ¼å¼ï¼Œè¿™æ ·springå°±èƒ½æ§åˆ¶çš„äº†ã€‚</p>
<p>å¦‚æœæ”¾log4j2ï¼Œå¯ä»¥æ”¹æ–‡ä»¶åä¸º<code>log4j2-spring.xml</code></p>
<p>æœ€ä½³å®æˆ˜ï¼šè‡ªå·±è¦å†™é…ç½®ï¼Œé…ç½®æ–‡ä»¶ååŠ ä¸Š<code>xx-spring.xml</code></p>
<h5 id="åˆ‡æ¢æ—¥å¿—ç»„åˆ"><a href="#åˆ‡æ¢æ—¥å¿—ç»„åˆ" class="headerlink" title="åˆ‡æ¢æ—¥å¿—ç»„åˆ"></a><strong>åˆ‡æ¢æ—¥å¿—ç»„åˆ</strong></h5><p>å¦‚æœä¸æƒ³è¦logbackæƒ³è¦åˆ‡æ¢log4j2ï¼Œé‚£ä¹ˆéœ€è¦åˆ©ç”¨mavençš„å°±è¿‘åŸåˆ™ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ä¹‹å‰å¯¼å…¥<code>spring-boot-starter-web</code>é‡Œé¢æœ‰æ ¸å¿ƒåœºæ™¯ï¼Œä½†æ˜¯æˆ‘ä»¬å†å¯¼å…¥<code>spring-boot-starter</code>ç„¶åæˆ‘ä»¬åˆ©ç”¨æ’é™¤<code>&lt;exclusions&gt;</code>æ’é™¤æ‰logback</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span><span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span><span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span><span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> <span class="comment">&lt;!-- è¿™é‡Œå†™logbackï¼Œç„¶åä¸‹é¢å†å¯¼å…¥æ–°çš„æ—¥å¿—å®ç°æ¡†æ¶ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span><span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2ã€Webå¼€å‘"><a href="#2ã€Webå¼€å‘" class="headerlink" title="2ã€Webå¼€å‘"></a><strong>2ã€Webå¼€å‘</strong></h3><blockquote>
<p>SpringBootçš„Webå¼€å‘èƒ½åŠ›ï¼Œç”±SpringMVCæä¾›ã€‚</p>
</blockquote>
<h4 id="1ã€Webåœºæ™¯"><a href="#1ã€Webåœºæ™¯" class="headerlink" title="1ã€Webåœºæ™¯"></a>1ã€Webåœºæ™¯</h4><p>æˆ‘ä»¬è¦å­¦å¥½æ•´ä¸ªwebå¼€å‘åœºæ™¯ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£springbootå¯¹springmvcæä¾›äº†å“ªäº›åœºæ™¯ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹å¦‚ä½•çµæ´»é…ç½®ï¼Œå¦‚ä½•å®šåˆ¶ç»„ä»¶ç­‰ç­‰ã€‚</p>
<p>é¦–å…ˆè¦äº†è§£è‡ªåŠ¨é…ç½®äº†ä»€ä¹ˆ</p>
<p>1ã€æ•´åˆé…ç½®åœºæ™¯</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€å¼•å…¥äº†autoconfigureåŠŸèƒ½</p>
<p>3ã€<code>@EnableAutoConfiguration</code>æ³¨è§£ä½¿ç”¨<code>@Import(AutoConfigurationImportSelector.class)</code>æ‰¹é‡å¯¼å…¥ç»„ä»¶ï¼ŒåŠ è½½<code>META-INF/spring/%s.imports</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ–¹æ³•åº•å±‚å†™äº†ä¸€ä¸ª%sçš„å ä½ç¬¦ï¼Œè¿™ä¸ªå ä½ç¬¦å¯ä»¥é€šè¿‡æºå…¥çš„å½¢å‚æ¥è·å–å€¼ï¼Œå¹¶æ›¿æ¢æ‰è¿™ä¸ªå ä½ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¼å…¥äº†webåŒ…ï¼Œå®é™…ä¸ŠåŠ è½½äº†</p>
<p>4ã€<code>META-INF/spring/org.springframwork.boot.autoconfigure.AutoConfiguration.imports</code>æ–‡ä»¶ä¸­é…ç½®çš„æ‰€æœ‰ç»„ä»¶ã€‚ç„¶åè¿›å»çœ‹è¿™ä¸ªæ–‡ä»¶é‡Œé¢å†™äº†å¾ˆå¤šè‡ªåŠ¨é…ç½®çš„åŒ…åã€‚</p>
<p>5ã€æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»å¦‚ä¸‹</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è‡ªåŠ¨é…ç½®ç±»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration</code></td>
<td>è‡ªåŠ¨é…ç½®å†…åµŒ Servlet å®¹å™¨ï¼ˆTomcat/Jetty/Undertowï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration</code></td>
<td>é…ç½® <code>DispatcherServlet</code>ï¼ˆSpring MVC æ ¸å¿ƒï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration</code></td>
<td>è‡ªåŠ¨é…ç½® Spring Web MVCï¼ˆè§†å›¾è§£æã€é™æ€èµ„æºã€æ‹¦æˆªå™¨ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration</code></td>
<td>é…ç½®å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼ˆè§£å†³ä¸­æ–‡ä¹±ç ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration</code></td>
<td>æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼ˆ<code>multipart/form-data</code>ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration</code></td>
<td>é…ç½® MVC é”™è¯¯é¡µé¢å’Œå¼‚å¸¸å¤„ç†</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration</code></td>
<td>Servlet ç¯å¢ƒä¸‹çš„ WebSocket æ”¯æŒ</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration</code></td>
<td>WebSocket + STOMP æ¶ˆæ¯ä»£ç†æ”¯æŒ</td>
</tr>
</tbody>
</table>
</div>
<p>ç„¶åè¿˜æœ‰å“åº”å¼çš„ç±»</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è‡ªåŠ¨é…ç½®ç±»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration</code></td>
<td>é…ç½®å“åº”å¼å†…åµŒæœåŠ¡å™¨ï¼ˆNetty/Tomcat/Jetty/Undertow Reactiveï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration</code></td>
<td>é…ç½® <code>HttpHandler</code>ï¼ˆWebFlux åº•å±‚å…¥å£ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration</code></td>
<td>è‡ªåŠ¨é…ç½® Spring WebFluxï¼ˆè·¯ç”±ã€ç¼–è§£ç ã€é™æ€èµ„æºç­‰ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.ReactiveMultipartAutoConfiguration</code></td>
<td>å“åº”å¼æ–‡ä»¶ä¸Šä¼ æ”¯æŒ</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.WebSessionIdResolverAutoConfiguration</code></td>
<td>é…ç½® WebSession ID è§£æ</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration</code></td>
<td>WebFlux çš„å…¨å±€é”™è¯¯å¤„ç†</td>
</tr>
<tr>
<td><code>org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration</code></td>
<td>å“åº”å¼ WebSocket æ”¯æŒ</td>
</tr>
</tbody>
</table>
</div>
<p>6ã€è¿™äº›è‡ªåŠ¨é…ç½®ç±»åˆç»‘å®šäº†é…ç½®æ–‡ä»¶çš„ä¸€å †é…ç½®é¡¹</p>
<ul>
<li>1ã€SpringMVCçš„æ‰€æœ‰é…ç½®ä»¥spring.mvcå¼€å¤´</li>
<li>2ã€Webåœºæ™¯çš„é€šç”¨é…ç½®ä»¥<code>spring.web</code>å¼€å¤´</li>
<li>3ã€æ–‡ä»¶ä¸Šä¼ é…ç½®ä»¥<code>spring.servlet.multipart</code>å¼€å¤´</li>
<li>4ã€æœåŠ¡å™¨çš„é…ç½®ä»¥<code>server</code>å¼€å¤´ æ¯”å¦‚ï¼šç¼–ç æ–¹å¼</li>
</ul>
<p>7ã€é»˜è®¤é…ç½®Webæ•ˆæœ</p>
<p>Spring Boot çš„è‡ªåŠ¨é…ç½®æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>æ³¨å…¥ <code>ContentNegotiatingViewResolver</code> å’Œ <code>BeanNameViewResolver</code> çš„ Beanï¼Œæ–¹ä¾¿è§†å›¾è§£æã€‚</li>
<li>æ”¯æŒé™æ€èµ„æºçš„è®¿é—®ï¼Œé™æ€èµ„æºæ”¾åœ¨staticæ–‡ä»¶å¤¹ä¸‹å³å¯ç›´æ¥è®¿é—®ã€‚</li>
<li>è‡ªåŠ¨æ³¨å†Œ <code>Converter</code>ã€<code>GenericConverter</code> å’Œ <code>Formatter</code> çš„ Beanï¼Œé€‚é…å¸¸è§çš„æ•°æ®ç±»å‹è½¬æ¢å’Œæ ¼å¼åŒ–éœ€æ±‚ã€‚</li>
<li>æ”¯æŒ <code>HttpMessageConverters</code>ï¼Œæ–¹ä¾¿è¿”å›jsonç­‰æ•°æ®ç±»å‹ï¼ˆæ–¹æ³•åªè¦æ˜¯å¯¹è±¡å°±è½¬æ¢ä¸ºjsonï¼‰ã€‚</li>
<li>è‡ªåŠ¨æ³¨å†Œ <code>MessageCodesResolver</code>ï¼Œæ–¹ä¾¿å›½é™…åŒ–åŠé”™è¯¯æ¶ˆæ¯å¤„ç†ã€‚</li>
<li>æ”¯æŒé™æ€çš„ <code>index.html</code> é¡µé¢ã€‚</li>
<li>è‡ªåŠ¨ä½¿ç”¨ <code>ConfigurableWebBindingInitializer</code> Beanï¼Œå®ç°æ¶ˆæ¯å¤„ç†ï¼Œæ•°æ®ç»‘å®šï¼ˆå°±æ¯”å¦‚æ¥å—å‰ç«¯ä¼ æ¥çš„è¶…æ–‡æœ¬æ•°æ®æ”¾åœ¨å¯¹è±¡é‡Œé¢ï¼‰ï¼Œç±»å‹è½¬åŒ–ã€æ•°æ®æ ¡éªŒ ç­‰åŠŸèƒ½ã€‚</li>
</ul>
<hr>
<blockquote>
<p>é‡è¦ï¼š</p>
<ul>
<li>å¦‚æœæƒ³è¦ä¿æŒ boot mvc çš„é»˜è®¤é…ç½®ï¼Œå¹¶ä¸”è‡ªå®šä¹‰æ›´å¤šçš„mvcé…ç½®ï¼Œå¦‚ï¼šinterceptorsï¼Œformatters,view controllersç­‰ã€‚å¯ä»¥ä½¿ç”¨@Configurationæ³¨è§£æ·»åŠ ä¸€ä¸ªWebMvcConfigurerç±»å‹çš„é…ç½®ç±»ï¼Œå¹¶ä¸è¦æ ‡æ³¨@EnableWebMvc</li>
<li>å¦‚æœæƒ³è¦ä¿æŒboot mvcçš„é»˜è®¤é…ç½®ï¼Œä½†è¦è‡ªå®šä¹‰æ ¸å¿ƒç»„ä»¶å®ä¾‹ï¼Œæ¯”å¦‚ï¼šRequestMappingHandlerMappingï¼ŒRequestMappingHandlerAdapteræˆ–ExceptionHandlerExceptionResolverï¼Œç»™å®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcRegistrationsç»„ä»¶å³å¯</li>
<li>å¦‚æœæƒ³å…¨é¢æ¥ç®¡Spring MVC,@Configurationæ ‡æ³¨ä¸€ä¸ªé…ç½®ç±»ï¼Œå¹¶åŠ ä¸Š@EnableWebMvcæ³¨è§£ï¼Œå®ç°WebMvcConfigureræ¥å£</li>
</ul>
</blockquote>
<p>æ‰€ä»¥ç”¨springbootè¿›è¡Œwebå¼€å‘æœ‰ä¸‰ç§æ–¹å¼</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å…¨è‡ªåŠ¨</th>
<th>ç›´æ¥ç¼–å†™æ§åˆ¶å™¨é€»è¾‘</th>
<th></th>
<th>å…¨éƒ¨ä½¿ç”¨è‡ªåŠ¨é…ç½®é»˜è®¤æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ‰‹è‡ªä¸€ä½“</td>
<td>@Configuration + é…ç½® WebMvcConfigurer + é…ç½®WebMvcRegistrations</td>
<td>ä¸è¦æ ‡æ³¨@EnableWebMvc</td>
<td>è‡ªåŠ¨é…ç½®æ•ˆæœï¼Œæ‰‹åŠ¨è®¾ç½®éƒ¨åˆ†åŠŸèƒ½ï¼Œå®šä¹‰MVCåº•å±‚ç»„ä»¶</td>
</tr>
<tr>
<td>å…¨æ‰‹åŠ¨</td>
<td>@Configuration + é…ç½® WebMvcConfigurer</td>
<td>æ ‡æ³¨@EnableWebMvc</td>
<td>ç¦ç”¨è‡ªåŠ¨é…ç½®æ•ˆæœï¼Œå…¨æ‰‹åŠ¨è®¾ç½®</td>
</tr>
</tbody>
</table>
</div>
<p>æ€»ç»“ï¼š<strong>ç»™å®¹å™¨ä¸­å†™ä¸€ä¸ªé…ç½®ç±» <code>@Configuration</code> ç»§æ‰¿ <code>WebMvcConfigurer</code> ä½†æ˜¯ä¸è¦æ ‡æ³¨ <code>@EnableWebMvc</code>ï¼Œå®ç°æ‰‹è‡ªä¸€ä½“çš„æ•ˆæœ</strong></p>
<p><strong>ç°åœ¨å¼€å§‹äº†è§£è§„åˆ™</strong></p>
<h4 id="2ã€é™æ€èµ„æº"><a href="#2ã€é™æ€èµ„æº" class="headerlink" title="2ã€é™æ€èµ„æº"></a><strong>2ã€é™æ€èµ„æº</strong></h4><h5 id="0ã€ä¸»è¦ç ”ç©¶WebMvcConfigurationåŸç†"><a href="#0ã€ä¸»è¦ç ”ç©¶WebMvcConfigurationåŸç†" class="headerlink" title="0ã€ä¸»è¦ç ”ç©¶WebMvcConfigurationåŸç†"></a><strong>0ã€ä¸»è¦ç ”ç©¶<code>WebMvcConfiguration</code>åŸç†</strong></h5><h6 id="1ã€ç”Ÿæ•ˆæ¡ä»¶"><a href="#1ã€ç”Ÿæ•ˆæ¡ä»¶" class="headerlink" title="1ã€ç”Ÿæ•ˆæ¡ä»¶"></a><strong>1ã€ç”Ÿæ•ˆæ¡ä»¶</strong></h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfiguration(</span></span><br><span class="line"><span class="meta">    after = &#123;DispatcherServletAutoConfiguration.class, TaskExecutionAutoConfiguration.class, ValidationAutoConfiguration.class&#125;</span></span><br><span class="line"><span class="meta">)</span><span class="comment">//åœ¨è¿™äº›è‡ªåŠ¨é…ç½®ä¹‹å</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(</span></span><br><span class="line"><span class="meta">    type = Type.SERVLET</span></span><br><span class="line"><span class="meta">)</span><span class="comment">//åªæœ‰æ˜¯webåº”ç”¨ç”Ÿæ•ˆï¼Œå¿…é¡»æ˜¯servletç±»å‹ï¼Œreactiveå“åº”å¼</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123;Servlet.class, DispatcherServlet.class, WebMvcConfigurer.class&#125;)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(&#123;WebMvcConfigurationSupport.class&#125;)</span><span class="comment">//å®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªBean</span></span><br><span class="line"><span class="meta">@AutoConfigureOrder(-2147483638)</span><span class="comment">//ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="meta">@ImportRuntimeHints(&#123;WebResourcesRuntimeHints.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_SUFFIX</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SERVLET_LOCATION</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span>;</span><br></pre></td></tr></table></figure>
<h6 id="2ã€æ•ˆæœ"><a href="#2ã€æ•ˆæœ" class="headerlink" title="2ã€æ•ˆæœ"></a><strong>2ã€æ•ˆæœ</strong></h6><p>1ã€æ”¾äº†ä¸¤ä¸ªFilterï¼š</p>
<p><code>HiddenHttpMethodFilter</code>ï¼šé¡µé¢è¡¨å•æäº¤Restè¯·æ±‚ï¼ˆGETã€POSTã€PUTã€DELETEï¼‰</p>
<p><code>FromContentFilter</code>ï¼šè¡¨å•å†…å®¹Filter,GETï¼ˆæ•°å»æ”¾URLåé¢ï¼‰ã€POSTï¼ˆæ•°æ®æ”¾è¯·æ±‚ä½“å†…ï¼‰è¯·æ±‚å¯ä»¥æºå¸¦æ•°æ®ï¼ŒPUTã€DELETEçš„è¯·æ±‚ä½“æ•°æ®ä¼šè¢«å¿½ç•¥</p>
<p>2ã€ç»™å®¹å™¨ä¸­æ”¾äº†<code>WebMvcConfigurer</code>ç»„ä»¶ï¼Œç»™SpringMVCæ·»åŠ å„ç§å®šåˆ¶åŠŸèƒ½ã€‚</p>
<p>è¿™é‡Œæ”¾äº†å¾ˆå¤šåº•å±‚è§„åˆ™ï¼Œæ‰€æœ‰çš„ åŠŸèƒ½æœ€ç»ˆä¼šå’Œé…ç½®æ–‡ä»¶ç»‘å®š</p>
<p><code>WebMvcProperties.class</code>: <code>spring.mvcå¼€å¤´é…ç½®æ–‡ä»¶</code></p>
<p><code>WebProperties.class</code>ï¼š <code>spring.webå¼€å¤´é…ç½®æ–‡ä»¶</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(</span></span><br><span class="line"><span class="meta">        proxyBeanMethods = false</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="meta">@Import(&#123;EnableWebMvcConfiguration.class&#125;)</span><span class="comment">//é¢å¤–å¯¼å…¥äº†å…¶ä»–é…ç½®</span></span><br><span class="line">    <span class="meta">@EnableConfigurationProperties(&#123;WebMvcProperties.class, WebProperties.class&#125;)</span><span class="comment">//è¿™é‡Œå±æ€§ç»‘å®š</span></span><br><span class="line">    <span class="meta">@Order(0)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfigurationAdapter</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span>, ServletContextAware &#123;</span><br></pre></td></tr></table></figure>
<h6 id="3ã€WebMvcConfigureræ¥å£"><a href="#3ã€WebMvcConfigureræ¥å£" class="headerlink" title="3ã€WebMvcConfigureræ¥å£"></a>3ã€WebMvcConfigureræ¥å£</h6><p>æä¾›äº†é…ç½®SpringMVCåº•å±‚çš„æ‰€æœ‰ç»„ä»¶å…¥å£</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251218113429282.png" alt="image-20251218113429282"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•°è§£æå™¨ï¼ˆcontrollerä¸Šçš„æ‰€æœ‰å‚æ•°éƒ½è¦è§£æï¼‰</span><br><span class="line">è·¨åŸŸ</span><br><span class="line">æ ¼å¼åŒ–å™¨</span><br><span class="line">æ‹¦æˆªå™¨</span><br><span class="line">æ·»åŠ èµ„æºå¤„ç†å™¨ï¼Œå¤„ç†é™æ€èµ„æºè§„åˆ™</span><br><span class="line">è¿”å›å€¼å¤„ç†å™¨</span><br><span class="line">è§†å›¾æ§åˆ¶å™¨ï¼š/a ç›´æ¥è·³è½¬åˆ°xxx.htmlé¡µé¢ã€‚</span><br><span class="line">å¼‚æ­¥æ”¯æŒ</span><br><span class="line">å†…å®¹åå•†</span><br><span class="line">é»˜è®¤å¤„ç†ï¼Œé»˜è®¤æ¥å—/ è¯·æ±‚</span><br><span class="line">é…ç½®å¼‚å¸¸è§£æå™¨</span><br><span class="line">æ¶ˆæ¯è½¬åŒ–å™¨</span><br><span class="line">è·¯å¾„åŒ¹é…</span><br><span class="line">è§†å›¾è§£æ</span><br><span class="line">æ‰©å±•ï¼šå¼‚å¸¸è§£æå™¨</span><br><span class="line">æ‰©å±•ï¼šæ¶ˆæ¯è½¬æ¢</span><br><span class="line">åé¢ä¸¤ä¸ªgetæ˜¯è·å–çš„</span><br></pre></td></tr></table></figure>
<h6 id="4ã€é™æ€èµ„æºè§„åˆ™æºç "><a href="#4ã€é™æ€èµ„æºè§„åˆ™æºç " class="headerlink" title="4ã€é™æ€èµ„æºè§„åˆ™æºç "></a>4ã€é™æ€èµ„æºè§„åˆ™æºç </h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">        logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getWebjarsPathPattern(), <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getStaticPathPattern(), (Consumer)((registration) -&gt; &#123;</span><br><span class="line">            registration.addResourceLocations(<span class="built_in">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.servletContext != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">ServletContextResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextResource</span>(<span class="built_in">this</span>.servletContext, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">                registration.addResourceLocations(<span class="keyword">new</span> <span class="title class_">Resource</span>[]&#123;resource&#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå¯ä»¥çœ‹åˆ°è¿™ä¸ªæºç é‡Œé¢addResourceHandlerè°ƒç”¨äº†ä¸¤æ¬¡ï¼Œæ·»åŠ äº†ä¸¤ç§é™æ€èµ„æºè§„åˆ™ã€‚</p>
<h6 id="5ã€-EnableWebMvcConfiguration-æºç "><a href="#5ã€-EnableWebMvcConfiguration-æºç " class="headerlink" title="5ã€ EnableWebMvcConfiguration æºç "></a>5ã€ <strong>EnableWebMvcConfiguration æºç </strong></h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SpringBoot ç»™å®¹å™¨ä¸­æ”¾ WebMvcConfigurationSupport ç»„ä»¶ã€‚</span></span><br><span class="line"><span class="comment">//æˆ‘ä»¬å¦‚æœâ¾ƒâ¼°æ”¾äº†WebMvcConfigurationSupport ç»„ä»¶ï¼ŒBootçš„WebMvcAutoConfigurationéƒ½ä¼šå¤±æ•ˆã€‚</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(WebProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EnableWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title class_">DelegatingWebMvcConfiguration</span> <span class="keyword">implements</span> <span class="title class_">ResourceLoaderAware</span> </span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>HandlerMapping  ï¼š æ ¹æ®è¯·æ±‚è·¯å¾„  /a  æ‰¾é‚£ä¸ªhandlerèƒ½å¤„ç†è¯·æ±‚ </p>
<p>a. WelcomePageHandlerMapping  ï¼š  </p>
<p>â…°.  è®¿é—®  /**  è·¯å¾„ä¸‹çš„æ‰€æœ‰è¯·æ±‚ï¼Œéƒ½åœ¨ä»¥å‰å››ä¸ªé™æ€èµ„æºè·¯å¾„ä¸‹æ‰¾ï¼Œæ¬¢è¿â»šä¹Ÿâ¼€æ · </p>
<p>â…±.  æ‰¾ index.html  ï¼šåªè¦é™æ€èµ„æºçš„ä½ç½®æœ‰â¼€ä¸ª  index.html  â»šâ¾¯ï¼Œé¡¹â½¬å¯åŠ¨é»˜è®¤è®¿é—®</p>
</li>
</ol>
<h6 id="6ã€ä¸ºä»€ä¹ˆå®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcConfigurerå°±èƒ½ç”Ÿæ•ˆ"><a href="#6ã€ä¸ºä»€ä¹ˆå®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcConfigurerå°±èƒ½ç”Ÿæ•ˆ" class="headerlink" title="6ã€ä¸ºä»€ä¹ˆå®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcConfigurerå°±èƒ½ç”Ÿæ•ˆ"></a>6ã€ä¸ºä»€ä¹ˆå®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcConfigurerå°±èƒ½ç”Ÿæ•ˆ</h6><ol>
<li>WebMvcAutoConfiguration æ˜¯â¼€ä¸ªâ¾ƒåŠ¨é…ç½®ç±»ï¼Œå®ƒâ¾¥â¾¯æœ‰â¼€ä¸ª  EnableWebMvcConfiguration  </li>
<li>EnableWebMvcConfiguration  ç»§æ‰¿ä¸  DelegatingWebMvcConfiguration  ï¼Œè¿™ä¸¤ä¸ªéƒ½ â½£æ•ˆ</li>
<li><code>DelegatingWebMvcConfiguration</code>  åˆ©â½¤ DI æŠŠå®¹å™¨ä¸­ æ‰€æœ‰ <code>WebMvcConfigurer</code>æ³¨â¼Šè¿›æ¥</li>
<li>åˆ«â¼ˆè°ƒâ½¤ <code>DelegatingWebMvcConfiguration</code> çš„â½…æ³•é…ç½®åº•å±‚è§„åˆ™ï¼Œâ½½å®ƒè°ƒâ½¤æ‰€æœ‰  WebMvcConfigurer  çš„é…ç½®åº•å±‚â½…æ³•ã€‚</li>
</ol>
<p><strong>æ€»ç»“ï¼šSpring Boot é€šè¿‡ä¸€ä¸ªâ€œå§”æ‰˜ä»£ç†ç±»â€è‡ªåŠ¨èšåˆæ‰€æœ‰ <code>WebMvcConfigurer</code> å®ç°ï¼Œå¹¶ç»Ÿä¸€è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ã€‚</strong></p>
<p>ç¬¬ä¸€æ­¥ï¼šè‡ªåŠ¨é…ç½®å…¥å£ â€”â€” <code>WebMvcAutoConfiguration</code></p>
<ul>
<li>Spring Boot å¯åŠ¨æ—¶ï¼Œä¼šåŠ è½½ <code>WebMvcAutoConfiguration</code>ï¼ˆæ¡ä»¶æ»¡è¶³æ—¶ï¼‰ã€‚</li>
<li>è¿™ä¸ªç±»æ˜¯ <strong>Spring MVC çš„è‡ªåŠ¨é…ç½®ç±»</strong>ï¼Œè´Ÿè´£è®¾ç½®é»˜è®¤çš„è§†å›¾è§£æå™¨ã€æ¶ˆæ¯è½¬æ¢å™¨ã€é™æ€èµ„æºå¤„ç†ç­‰ã€‚</li>
</ul>
<p>ç¬¬äºŒæ­¥ï¼šå…³é”®è§’è‰² â€”â€” <code>DelegatingWebMvcConfiguration</code></p>
<p>åœ¨ <code>WebMvcAutoConfiguration</code> å†…éƒ¨ï¼Œæœ‰ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼šè€Œ<code>DelegatingWebMvcConfiguration</code> æ˜¯çœŸæ­£çš„æ ¸å¿ƒï¼š</p>
<p>ç¬¬ä¸‰æ­¥ï¼šä¾èµ–æ³¨å…¥èšåˆæ‰€æœ‰ <code>WebMvcConfigurer</code></p>
<ul>
<li><code>@Autowired List&lt;WebMvcConfigurer&gt; configurers</code><br>â†’ Spring å®¹å™¨ä¼š<strong>è‡ªåŠ¨æŠŠæ‰€æœ‰ç±»å‹ä¸º <code>WebMvcConfigurer</code> çš„ Bean æ”¶é›†åˆ°ä¸€ä¸ª List ä¸­</strong>ã€‚</li>
<li>ç„¶åäº¤ç»™ <code>WebMvcConfigurerComposite</code>ï¼ˆä¸€ä¸ªç»„åˆå™¨ï¼‰ç®¡ç†ã€‚</li>
</ul>
<p><strong>é™æ€èµ„æºæ˜ å°„è§„åˆ™</strong></p>
<h5 id="1ã€é»˜è®¤è§„åˆ™"><a href="#1ã€é»˜è®¤è§„åˆ™" class="headerlink" title="1ã€é»˜è®¤è§„åˆ™"></a><strong>1ã€é»˜è®¤è§„åˆ™</strong></h5><p>1ã€é™æ€èµ„æºæ˜ å°„è§„åˆ™åœ¨<code>WebMvcConfiguration</code>ä¸­è¿›è¡Œäº†å®šä¹‰ï¼š</p>
<p>è§„åˆ™ä¸€ï¼šè®¿é—® <code>/webjars/**</code> è·¯å¾„å°±å»<code>classpath:/META-INF/resources/webjars/</code>ä¸‹æ‰¾èµ„æº</p>
<p>mavenå¯¼å…¥ä¾èµ–æ¯”å¦‚å¯¼å…¥vueç›¸å…³jsï¼Œç›¸å…³çš„jså°±è¿›æ¥äº†ï¼Œï¼Œç„¶åè®¿é—®webjarså¯¹åº”è·¯å¾„å°±èƒ½è®¿é—®å¯¹åº”jsäº†ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªä¸å¸¸ç”¨</p>
<p>è§„åˆ™äºŒï¼šè®¿é—®ï¼š<code>/**</code>è·¯å¾„å°±å»<code>é™æ€èµ„æºé»˜è®¤çš„å››ä¸ªä½ç½®æ‰¾èµ„æº</code></p>
<p><code>&quot;classpath:/META-INF/resources/&quot;,</code></p>
<p><code>&quot;classpath:/resources/&quot;,</code> </p>
<p><code>&quot;classpath:/static/&quot;,</code></p>
<p><code>&quot;classpath:/public/&quot;</code></p>
<p>ä¹Ÿå°±æ˜¯æ”¾åœ¨ç±»è·¯å¾„ä¸‹çš„è¿™å››ä¸ªä½ç½®å°±èƒ½è®¿é—®é™æ€èµ„æºã€‚</p>
<p>ç±»è·¯å¾„å°±æ˜¯javaåŒ…ä¸‹é¢æˆ–è€…resoutcesåŒ…ä¸‹é¢å°±æ˜¯ä¸¤ä¸ªç±»è·¯å¾„ã€‚</p>
<p><strong>2ã€é™æ€èµ„æºç¼“å­˜è§„åˆ™</strong></p>
<p>3ã€è§„åˆ™ä¸‰ï¼šé™æ€èµ„æºé»˜è®¤éƒ½æœ‰ç¼“å­˜è§„åˆ™çš„è®¾ç½®ã€‚</p>
<p>a. æ‰€æœ‰ç¼“å­˜çš„è®¾ç½®ï¼Œç›´æ¥é€šè¿‡é…ç½®æ–‡ä»¶ï¼š <code>spring.web</code></p>
<p>b. cachePeriodï¼šç¼“å­˜å‘¨æœŸï¼Œå¤šä¹…ä¸ç”¨æ‰¾æœåŠ¡å™¨è¦æ–°çš„ã€‚<strong>é»˜è®¤æ²¡æœ‰</strong>ï¼Œä»¥ç§’ä¸ºå•ä½</p>
<p>c. cacheControlï¼šHTTPç¼“å­˜æ§åˆ¶ï¼Œ<strong>é»˜è®¤æ— </strong>ï¼Œç¼“å­˜å¤§ä½“åˆ†ä¸ºç§æœ‰ç¼“å­˜å’Œå…±äº«ç¼“å­˜ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Guides/Caching">HTTP ç¼“å­˜ - HTTP | MDN</a></p>
<p>d. useLastModifiedï¼šæ˜¯å¦ä½¿ç”¨æœ€åä¸€æ¬¡ä¿®æ”¹ã€‚æ³¨æ„ï¼šLast-Modifiedé¦–éƒ¨ï¼Œåªæ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼Œè¦æƒ³ä½¿ç”¨ç¼“å­˜ï¼Œå¿…é¡»æ¯æ¬¡å¸¦è¯¥é¦–éƒ¨å»æœåŠ¡å™¨éªŒè¯ï¼Œé€šè¿‡å°±å“åº”304ï¼Œä¸é€šè¿‡å°±è¿”å›å®Œæ•´èµ„æºï¼Œå¹¶é‡å†™è®¾ç½®Last-Modified</p>
<blockquote>
<p>å¦‚æœæµè§ˆå™¨è®¿é—®äº†ä¸€ä¸ªé™æ€èµ„æº<code>index.js</code>ï¼Œå¦‚æœè¿™ä¸ªèµ„æºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä¸‹æ¬¡è®¿é—®çš„è§†ä¹å°±å¯ä»¥ç›´æ¥è®©æµè§ˆå™¨ç”¨è‡ªå·±ç¼“å­˜ä¸­çš„ä¸œè¥¿ï¼Œè€Œä¸ç”¨ç»™æœåŠ¡å™¨å‘è¯·æ±‚ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">registration.setCachePeriod(<span class="built_in">this</span>.getSeconds(<span class="built_in">this</span>.resourceProperties.getCache().getPeriod()));</span><br><span class="line">                registration.setCacheControl(<span class="built_in">this</span>.resourceProperties.getCache().getCachecontrol().toHttpCacheControl());</span><br><span class="line">                registration.setUseLastModified(<span class="built_in">this</span>.resourceProperties.getCache().isUseLastModified());</span><br></pre></td></tr></table></figure>
<p><strong>æ¬¢è¿é¡µ</strong></p>
<p>æ¬¢è¿é¡µè§„åˆ™åœ¨ <code>WebMvcAutoConfiguration</code>ä¸­è¿›è¡Œäº†å®šä¹‰ï¼š</p>
<p>1ã€åœ¨é™æ€èµ„æºç›®å½•ä¸‹æ‰¾index.html</p>
<p>2ã€æ²¡æœ‰å°±åœ¨templatesä¸‹æ‰¾indexæ¨¡ç‰ˆé¡µ</p>
<p><strong>Favicon</strong></p>
<ol>
<li>åœ¨é™æ€èµ„æºâ½¬å½•ä¸‹æ‰¾  favicon.ico</li>
</ol>
<p><strong>ç¼“å­˜å®éªŒ</strong></p>
<p>ä¸Šé¢è®²è§£äº†ä¸‰ç§é™æ€èµ„æºè§„åˆ™ï¼Œæ— è®ºå“ªç§è§„åˆ™éƒ½é…äº†ä¸‰ä¸ªæ–¹æ³•æ¥æ§åˆ¶ç¼“å­˜ï¼Œ</p>
<p>ä¸€ä¸ªæ˜¯setCacheControlï¼Œ</p>
<p>ä¸€ä¸ªæ˜¯SetCachePeriodï¼Œ</p>
<p>ä¸€ä¸ªæ˜¯setUseLastModifiedï¼Œ</p>
<p>ç„¶åè¿™ä¸‰ä¸ªæ–¹æ³•éƒ½è¦é€šè¿‡resourcePropertiesæ¥ç»‘å®šé…ç½®é¡¹ï¼Œ</p>
<p>é‚£ä¹ˆå°±å»é‡Œé¢çœ‹æœ‰ä»€ä¹ˆé…ç½®é¡¹ï¼Œ</p>
<p>ç„¶åçœ‹åˆ°é‡Œé¢çš„é…ç½®é¡¹æ˜¯spring.webå¼€å¤´çš„ï¼Œ</p>
<p>ç„¶åçœ‹è¿™ä¸ªç±»é…ä»€ä¹ˆä¿¡æ¯ï¼Œ</p>
<p>å¯ä»¥é…localeå›½é™…åŒ–ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªé…resources,ç„¶åresourceé‡Œé¢é…ç½®é™æ€èµ„æºç­–ç•¥ï¼Œç„¶åresourcesé‡Œé¢å¯ä»¥é…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">staticLocations é™æ€èµ„æºçš„è·¯å¾„</span><br><span class="line">addMappings     æ˜¯å¦å¼€å¯é™æ€èµ„æºçš„æ˜ å°„</span><br><span class="line">Chain           é™æ€èµ„æºå¤„ç†é“¾</span><br><span class="line">Cache           ç¼“å­˜è§„åˆ™</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬çœ‹äº†æºç ä¹‹åå°±ä¼šé…ç½®,ç„¶åæˆ‘ä»¬æƒ³è¦é…ç½®cacheï¼Œåˆå¯ä»¥ç‚¹è¿›å»çœ‹æºç ï¼Œçœ‹cacheé‡Œé¢éœ€è¦é…ä»€ä¹ˆ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">	  <span class="attr">add-mappings:</span> <span class="literal">true</span>	<span class="comment">#è¿™æ ·å°±å¼€å¯äº†é™æ€èµ„æºæ˜ å°„äº†</span></span><br><span class="line">	  <span class="attr">cache:</span></span><br><span class="line">	    <span class="attr">period:</span> <span class="number">3600</span>        <span class="comment">#ç¼“å­˜3600ç§’ï¼Œä¸€å°æ—¶åé¢å¦‚æœéœ€è¦æ›´è¯¦ç»†çš„é…ç½®ï¼Œå¯ä»¥ç»§ç»­çœ‹</span></span><br><span class="line">	    <span class="attr">cachecontrol:</span>       <span class="comment">#ç¼“å­˜è¯¦ç»†åˆå¹¶é¡¹æ§åˆ¶ï¼Œè¦†ç›–Periodé…ç½®</span></span><br><span class="line">	    	<span class="attr">max-age:</span> <span class="number">7200</span>   <span class="comment">#æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨æ­¤èµ„æºç¼“å­˜7200ç§’ã€‚     </span></span><br></pre></td></tr></table></figure>
<p><strong>ä¸Šé¢å°±äº†è§£äº†é»˜è®¤è§„åˆ™å¦‚ä½•äº†è§£ä»¥åŠé…ç½®äº†ï¼Œä¸‹é¢å¼€å§‹è‡ªå®šä¹‰è§„åˆ™äº†</strong></p>
<h5 id="2ã€è‡ªå®šä¹‰é™æ€èµ„æºè§„åˆ™"><a href="#2ã€è‡ªå®šä¹‰é™æ€èµ„æºè§„åˆ™" class="headerlink" title="2ã€è‡ªå®šä¹‰é™æ€èµ„æºè§„åˆ™"></a><strong>2ã€è‡ªå®šä¹‰é™æ€èµ„æºè§„åˆ™</strong></h5><blockquote>
<p>è‡ªå®šä¹‰é™æ€èµ„æºè·¯å¾„ï¼Œè‡ªå®šä¹‰ç¼“å­˜è§„åˆ™</p>
</blockquote>
<p>æœ‰ä¸¤ç§è‡ªå®šä¹‰é™æ€èµ„æºçš„æ–¹å¼ï¼Œä»¥é™æ€èµ„æºä¸ºä¾‹çœ‹æºç ï¼Œä»–ç»‘å®šäº†ä¸¤ä¸ªä¸€ä¸ªæ˜¯ä¸Šé¢çš„webPropertiesï¼Œä¸€ä¸ªæ˜¯webMvc</p>
<h6 id="1ã€é…ç½®æ–¹å¼"><a href="#1ã€é…ç½®æ–¹å¼" class="headerlink" title="1ã€é…ç½®æ–¹å¼"></a>1ã€é…ç½®æ–¹å¼</h6><p>æ‰€ä»¥è¯´ä»¥åæƒ³è¦è‡ªå®šä¹‰è§„åˆ™ä¸€ä¸ªå°±æ˜¯æ”¹spring.webçš„è·Ÿä¸Šé¢ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯ä¿®æ”¹spring.mvcçš„é…ç½®ã€‚</p>
<p>ç°åœ¨è¿™é‡Œææ¸…æ¥šï¼Œè¿™ä¸¤ä¸ªèƒ½é…å“ªäº›ï¼Ÿ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1spring.web</span></span><br><span class="line"><span class="comment"># 1.é…ç½®å›½é™…åŒ–çš„åŒºåŸŸä¿¡æ¯</span></span><br><span class="line"><span class="comment"># 2.é™æ€èµ„æºç­–ç•¥(å¼€å¯ã€å¤„ç†é“¾ã€ç¼“å­˜)</span></span><br><span class="line"><span class="comment">#å¼€å¯é™æ€èµ„æºæ˜ å°„è§„åˆ™</span></span><br><span class="line"><span class="attr">spring.web.resources.add-mappings</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#è®¾ç½®ç¼“å­˜</span></span><br><span class="line"><span class="comment">#spring.web.resources.cache.period=3600</span></span><br><span class="line"><span class="comment">##ç¼“å­˜è¯¦ç»†åˆå¹¶é¡¹æ§åˆ¶ï¼Œè¦†ç›–periodé…ç½®ï¼š</span></span><br><span class="line"><span class="comment">## æµè§ˆå™¨ç¬¬â¼€æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨æ­¤èµ„æºç¼“å­˜7200ç§’ï¼Œ7200ç§’ä»¥å†…çš„æ‰€æœ‰æ­¤èµ„æºè®¿é—®ä¸â½¤å‘ç»™æœåŠ¡å™¨è¯·æ±‚ï¼Œ7200ç§’ä»¥åå‘è¯·æ±‚ç»™æœåŠ¡å™¨</span></span><br><span class="line"><span class="attr">spring.web.resources.cache.cachecontrol.max-age</span>=<span class="string">7200</span></span><br><span class="line"><span class="comment">## å…±äº«ç¼“å­˜</span></span><br><span class="line"><span class="attr">spring.web.resources.cache.cachecontrol.cache-public</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#ä½¿â½¤èµ„æºlast-modified æ—¶é—´ï¼Œæ¥å¯¹â½æœåŠ¡å™¨å’Œæµè§ˆå™¨çš„èµ„æºæ˜¯å¦ç›¸åŒæ²¡æœ‰å˜åŒ–ã€‚ç›¸åŒè¿”å›304</span></span><br><span class="line"><span class="attr">spring.web.resources.cache.use-last-modified</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#â¾ƒå®šä¹‰é™æ€èµ„æºâ½‚ä»¶å¤¹ä½ç½®,è¿™ä¸ªæ˜¯èµ„æºä½ç½®è·¯å¾„ï¼Œå…¶ä»–ä¸¤ä¸ªæ˜¯è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="attr">spring.web.resources.static-locations</span>=<span class="string">classpath:/a/,classpath:/b/,classpath:/static/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#2ã€spring.mvc</span></span><br><span class="line"><span class="comment">## 2.1.â¾ƒå®šä¹‰webjarsè·¯å¾„å‰ç¼€</span></span><br><span class="line"><span class="attr">spring.mvc.webjars-path-pattern</span>=<span class="string">/wj/**</span></span><br><span class="line"><span class="comment">## 2.2. é™æ€èµ„æºè®¿é—®è·¯å¾„å‰ç¼€</span></span><br><span class="line"><span class="attr">spring.mvc.static-path-pattern</span>=<span class="string">/static/**</span></span><br></pre></td></tr></table></figure>
<p>å°æç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spring.web.resources.static-locations=classpath:/a/,classpath:/b/,classpath:/static/</span><br><span class="line">è¡¨ç¤º Spring ä¼šä»ä»¥ä¸‹ä¸‰ä¸ª classpath ç›®å½•ä¸­æŸ¥æ‰¾é™æ€èµ„æºã€‚</span><br><span class="line">spring.mvc.static-path-pattern=/static/**</span><br><span class="line">è¡¨ç¤ºï¼šæ‰€æœ‰ä»¥ /static/ å¼€å¤´çš„è¯·æ±‚ï¼Œéƒ½ä¼šè¢«å½“ä½œé™æ€èµ„æºå¤„ç†ã€‚</span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">ç”¨æˆ·è®¿é—® http://localhost:8080/static/logo.png</span><br><span class="line">Spring ä¼šå» a/, b/, static/ è¿™äº›ç›®å½•ä¸‹æ‰¾ logo.png</span><br></pre></td></tr></table></figure>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>spring.mvc : é…ç½®é™æ€èµ„æºè®¿é—®å‰ç¼€è·¯å¾„</p>
<p>spring.webï¼šé…ç½®</p>
<ul>
<li><p>é™æ€èµ„æºç›®å½•</p>
</li>
<li><p>é™æ€èµ„æºç¼“å­˜ç­–ç•¥</p>
</li>
</ul>
<h6 id="2ã€ä»£ç æ–¹å¼"><a href="#2ã€ä»£ç æ–¹å¼" class="headerlink" title="2ã€ä»£ç æ–¹å¼"></a>2ã€ä»£ç æ–¹å¼</h6><p>æ‰€æœ‰ä»£ç çš„æ–¹å¼ï¼Œéƒ½åº”è¯¥å†™ä¸€ä¸ªé…ç½®ç±»ï¼Œç„¶åæ”¾åˆ°ä¸€ä¸ªåŒ…ä¸‹ã€‚</p>
<blockquote>
<p> å®¹å™¨ä¸­åªè¦æœ‰â¼€ä¸ª WebMvcConfigurer ç»„ä»¶ã€‚é…ç½®çš„åº•å±‚â¾ä¸ºéƒ½ä¼šâ½£æ•ˆ</p>
<p> @EnableWebMvc //ç¦â½¤bootçš„é»˜è®¤é…ç½®</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§å†™æ³•åˆ©ç”¨å®ç°ï¼Œé‡å†™</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">//è¿™æ˜¯â¼€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="comment">//ä¿ç•™ä»¥å‰è§„åˆ™</span></span><br><span class="line">    WebMvcConfigurer.<span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">    <span class="comment">//â¾ƒâ¼°å†™æ–°çš„è§„åˆ™ã€‚</span></span><br><span class="line">    registry.addResourceHandler(<span class="string">&quot;/static/**&quot;</span>)</span><br><span class="line">    		.addResourceLocations(<span class="string">&quot;classpath:/a/&quot;</span>,<span class="string">&quot;classpath:/b/&quot;</span>)</span><br><span class="line">    		.setCacheControl(CacheControl.maxAge(<span class="number">1180</span>, TimeUnit.SECONDS));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§å†™æ³•ï¼Œç›´æ¥é‡å†™åˆ©ç”¨return,</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WebMvcConfigurer <span class="title function_">webMvcConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurer</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">                <span class="comment">// å°† /static/** çš„è¯·æ±‚æ˜ å°„åˆ°å¤šä¸ª classpath èµ„æºä½ç½®</span></span><br><span class="line">                registry.addResourceHandler(<span class="string">&quot;/static/**&quot;</span>)</span><br><span class="line">                        .addResourceLocations(<span class="string">&quot;classpath:/a/&quot;</span>, <span class="string">&quot;classpath:/b/&quot;</span>)</span><br><span class="line">                        .setCacheControl(CacheControl.maxAge(<span class="number">1180</span>, TimeUnit.SECONDS)); <span class="comment">// æ³¨æ„ï¼šå•ä½æ˜¯ç§’ï¼Œä¸æ˜¯åˆ†é’Ÿ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3ã€è·¯å¾„åŒ¹é…"><a href="#3ã€è·¯å¾„åŒ¹é…" class="headerlink" title="3ã€è·¯å¾„åŒ¹é…"></a>3ã€è·¯å¾„åŒ¹é…</h4><blockquote>
<p>Spring5.3 ä¹‹ååŠ â¼Šäº†æ›´å¤šçš„ è¯·æ±‚è·¯å¾„åŒ¹é…çš„å®ç°ç­–ç•¥ï¼›</p>
<p>ä»¥å‰åªâ½€æŒ AntPathMatcher ç­–ç•¥, ç°åœ¨æä¾›äº† PathPatternParser ç­–ç•¥ã€‚å¹¶ä¸”å¯ä»¥è®©æˆ‘ä»¬æŒ‡å®š åˆ°åº•ä½¿â½¤é‚£ç§ç­–ç•¥ã€‚</p>
</blockquote>
<h5 id="1ã€Anté£æ ¼è·¯å¾„ç”¨æ³•"><a href="#1ã€Anté£æ ¼è·¯å¾„ç”¨æ³•" class="headerlink" title="1ã€Anté£æ ¼è·¯å¾„ç”¨æ³•"></a>1ã€Anté£æ ¼è·¯å¾„ç”¨æ³•</h5><p>Ant â»›æ ¼çš„è·¯å¾„æ¨¡å¼è¯­æ³•å…·æœ‰ä»¥ä¸‹è§„åˆ™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">*ï¼šè¡¨ç¤ºä»»æ„æ•°é‡çš„å­—ç¬¦ã€‚</span><br><span class="line">?ï¼šè¡¨ç¤ºä»»æ„â¼€ä¸ªå­—ç¬¦ã€‚</span><br><span class="line">**ï¼šè¡¨ç¤ºä»»æ„æ•°é‡çš„â½¬å½•ã€‚</span><br><span class="line">&#123;&#125;ï¼šè¡¨ç¤ºâ¼€ä¸ªå‘½åçš„æ¨¡å¼å ä½ç¬¦ã€‚</span><br><span class="line">[]ï¼šè¡¨ç¤ºå­—ç¬¦é›†åˆï¼Œä¾‹å¦‚[a-z]è¡¨ç¤ºâ¼©å†™å­—âºŸã€‚</span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">*.html åŒ¹é…ä»»æ„åç§°ï¼Œæ‰©å±•åä¸º.htmlçš„â½‚ä»¶ã€‚</span><br><span class="line">/folder1/*/*.java åŒ¹é…åœ¨folder1â½¬å½•ä¸‹çš„ä»»æ„ä¸¤çº§â½¬å½•ä¸‹çš„.javaâ½‚ä»¶ã€‚</span><br><span class="line">/folder2/**/*.jsp åŒ¹é…åœ¨folder2â½¬å½•ä¸‹ä»»æ„â½¬å½•æ·±åº¦çš„.jspâ½‚ä»¶ã€‚</span><br><span class="line">/&#123;type&#125;/&#123;id&#125;.html åŒ¹é…ä»»æ„â½‚ä»¶åä¸º&#123;id&#125;.htmlï¼Œåœ¨ä»»æ„å‘½åçš„&#123;type&#125;â½¬å½•ä¸‹çš„â½‚ä»¶ã€‚</span><br><span class="line">æ³¨æ„ï¼šAnt â»›æ ¼çš„è·¯å¾„æ¨¡å¼è¯­æ³•ä¸­çš„ç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰ï¼Œå¦‚ï¼š</span><br><span class="line">è¦åŒ¹é…â½‚ä»¶è·¯å¾„ä¸­çš„æ˜Ÿå·ï¼Œåˆ™éœ€è¦è½¬ä¹‰ä¸º\\*ã€‚</span><br><span class="line">è¦åŒ¹é…â½‚ä»¶è·¯å¾„ä¸­çš„é—®å·ï¼Œåˆ™éœ€è¦è½¬ä¹‰ä¸º\\?ã€‚</span><br></pre></td></tr></table></figure>
<h5 id="2ã€æ¨¡å¼åˆ‡æ¢"><a href="#2ã€æ¨¡å¼åˆ‡æ¢" class="headerlink" title="2ã€æ¨¡å¼åˆ‡æ¢"></a>2ã€æ¨¡å¼åˆ‡æ¢</h5><blockquote>
<p>AntPathMatcher ä¸  PathPatternParser </p>
<p>â— PathPatternParser åœ¨ jmh åŸºå‡†æµ‹è¯•ä¸‹ï¼Œæœ‰ 6~8 å€ååé‡æå‡ï¼Œé™ä½ 30%~40%ç©ºé—´åˆ†é… ç‡ </p>
<p>â— PathPatternParser å…¼å®¹ AntPathMatcherè¯­æ³•ï¼Œå¹¶â½€æŒæ›´å¤šç±»å‹çš„è·¯å¾„æ¨¡å¼ </p>
<p>â— PathPatternParser  â€œ**â€ å¤šæ®µåŒ¹é…çš„â½€æŒä»…å…è®¸åœ¨æ¨¡å¼æœ«å°¾ä½¿â½¤</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/a*/b?/&#123;p1:[a-f]+&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(HttpServletRequest request, <span class="meta">@PathVariable(&quot;p1&quot;)</span> String path)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;è·¯å¾„å˜é‡p1ï¼š&#123;&#125;&quot;</span>, path);</span><br><span class="line">    <span class="comment">//è·å–è¯·æ±‚è·¯å¾„</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">    <span class="keyword">return</span> uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š  </p>
<p>ä½¿â½¤é»˜è®¤çš„è·¯å¾„åŒ¹é…è§„åˆ™ï¼Œæ˜¯ç”±  PathPatternParser  æä¾›çš„</p>
<p>å¦‚æœè·¯å¾„ä¸­é—´éœ€è¦æœ‰ **ï¼Œæ›¿æ¢æˆantâ»›æ ¼è·¯å¾„</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ”¹å˜è·¯å¾„åŒ¹é…ç­–ç•¥ï¼š</span></span><br><span class="line"><span class="comment"># ant_path_matcher â½¼ç‰ˆç­–ç•¥ï¼›</span></span><br><span class="line"><span class="comment"># path_pattern_parser æ–°ç‰ˆç­–ç•¥ï¼›</span></span><br><span class="line"><span class="attr">spring.mvc.pathmatch.matching-strategy</span>=<span class="string">ant_path_matcher</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€å†…å®¹åå•†"><a href="#4ã€å†…å®¹åå•†" class="headerlink" title="4ã€å†…å®¹åå•†"></a>4ã€å†…å®¹åå•†</h4><blockquote>
<p>ä¸€å¥—ç³»ç»Ÿé€‚é…å¤šç«¯æ•°æ®è¿”å›</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220000446975.png" alt="image-20251220000446975"></p>
<h5 id="1ã€å¤šç«¯å†…å®¹é€‚é…"><a href="#1ã€å¤šç«¯å†…å®¹é€‚é…" class="headerlink" title="1ã€å¤šç«¯å†…å®¹é€‚é…"></a>1ã€å¤šç«¯å†…å®¹é€‚é…</h5><h6 id="1ã€é»˜è®¤è§„åˆ™-1"><a href="#1ã€é»˜è®¤è§„åˆ™-1" class="headerlink" title="1ã€é»˜è®¤è§„åˆ™"></a>1ã€é»˜è®¤è§„åˆ™</h6><p>åŸºäºè¯·æ±‚å¤´çš„å†…å®¹åå•†æ˜¯é»˜è®¤å¼€å¯çš„ï¼ŒåŸºäºè¯·æ±‚å‚æ•°çš„æ˜¯é»˜è®¤å…³é—­çš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220001519599.png" alt="image-20251220001519599"></p>
<h6 id="2ã€æ•ˆæœæ¼”ç¤º"><a href="#2ã€æ•ˆæœæ¼”ç¤º" class="headerlink" title="2ã€æ•ˆæœæ¼”ç¤º"></a>2ã€æ•ˆæœæ¼”ç¤º</h6><blockquote>
<p>è¯·æ±‚åŒä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è¿”å›jsonå’Œxmlä¸åŒæ ¼å¼æ•°æ®</p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬å¯¼å…¥webçš„å¯åŠ¨å™¨é‡Œé¢é»˜è®¤å¼•å…¥äº†jsonåŒ…ï¼Œç„¶åé»˜è®¤æ˜¯åˆ©ç”¨jacksonåŒ…çš„åŠŸèƒ½</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åé»˜è®¤æ˜¯è¿”å›jsonæ•°æ®çš„ï¼Œä½†æ˜¯å¦‚æœåŠ ä¸Šjacksonçš„æ³¨è§£å¹¶ä¸”å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†å°±èƒ½å®ç°å†…å®¹åå•†çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JacksonXmlRootElement</span>  <span class="comment">// å¯ä»¥å†™å‡ºä¸ºxmlâ½‚æ¡£</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="3ã€å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†"><a href="#3ã€å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†" class="headerlink" title="3ã€å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†"></a>3ã€å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†</h6><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"> #å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†åŠŸèƒ½ã€‚é»˜è®¤å‚æ•°åï¼šformatã€‚é»˜è®¤æ­¤åŠŸèƒ½ä¸å¼€å¯</span></span><br><span class="line"><span class="attr">spring.mvc.contentnegotiation.favor-parameter</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># æŒ‡å®šå†…å®¹åå•†æ—¶ä½¿â½¤çš„å‚æ•°åã€‚é»˜è®¤æ˜¯format</span></span><br><span class="line"><span class="attr">spring.mvc.contentnegotiation.parameter-name</span>=<span class="string">type</span></span><br></pre></td></tr></table></figure>
<p>é‚£å¦‚æœåé¢è¿˜æƒ³è¿”å›Ymlå‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦äº†è§£å†…å®¹åå•†çš„åº•å±‚åŸç†</p>
<h5 id="2ã€è‡ªå®šä¹‰å†…å®¹è¿”å›"><a href="#2ã€è‡ªå®šä¹‰å†…å®¹è¿”å›" class="headerlink" title="2ã€è‡ªå®šä¹‰å†…å®¹è¿”å›"></a>2ã€è‡ªå®šä¹‰å†…å®¹è¿”å›</h5><p><strong>ä¸‹é¢æ¼”ç¤ºå¦‚ä½•è‡ªå®šä¹‰ç»„ä»¶äº†</strong></p>
<h6 id="1ã€å¢åŠ Yamlè¿”å›æ”¯æŒ"><a href="#1ã€å¢åŠ Yamlè¿”å›æ”¯æŒ" class="headerlink" title="1ã€å¢åŠ Yamlè¿”å›æ”¯æŒ"></a>1ã€å¢åŠ Yamlè¿”å›æ”¯æŒ</h6><p>ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹<code>EnableWebMvcConfiguration</code>é‡Œé¢å†™äº†æ”¯æŒçš„è¿”å›æ ¼å¼é‡Œé¢æ²¡æœ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœè¦æ·»åŠ ï¼Œå°±å…ˆçœ‹<code>EnableWebMvcConfiguration</code>ï¼Œç„¶åå‘ç°<code>EnableWebMvcConfiguration</code>ç»§æ‰¿äº†<code>DelegatingWebMvcConfiguration</code>ï¼Œç„¶åè¿™ä¸ªåˆç»§æ‰¿äº†<code>WebMvcConfigurationSupport</code>ï¼ˆä¹Ÿå°±æ˜¯æœ€ç»ˆç»§æ‰¿çš„æ˜¯è¿™ä¸ªï¼‰ï¼Œç„¶åçœ‹äº†é‡Œé¢æ²¡æœ‰æ”¯æŒymlçš„ï¼Œæœ‰xmlæ‰€ä»¥ä¹‹å‰å¯¼ä¸ªåŒ…ï¼Œç„¶åé…ç½®ä¸€ä¸‹å°±èƒ½æ”¯æŒäº†ï¼Œä½†æ˜¯è¿™é‡Œåº•å±‚æ²¡æœ‰æ”¯æŒyamlï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰äº†ã€‚</p>
<p>é¦–å…ˆå¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-yaml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æŠŠå¯¹è±¡å†™å‡ºæˆYAML</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">	<span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setId(<span class="number">1L</span>);</span><br><span class="line">    person.setUserName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">    person.setEmail(<span class="string">&quot;aaa@qq.com&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="type">YAMLFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">YAMLFactory</span>().disable(YAMLGenerator.Feature.WRITE_DOC_START_MARKER);</span><br><span class="line">    <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>(factory);<span class="comment">//åœ¨åº•å±‚è½¬jsonæˆ–è€…å…¶ä»–éƒ½æ˜¯åˆ©ç”¨è¿™ä¸ªï¼Œç„¶åå‘ç°é‡Œé¢å¯ä»¥ä¼ å…¥å·¥å‚çš„æ–¹æ³•</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> mapper.writeValueAsString(person);</span><br><span class="line">    System.out.println(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨èƒ½åœ¨æµ‹è¯•ç±»é‡Œè¿›è¡Œè½¬åŒ–ï¼Œåé¢å°±æ˜¯è¦è¿›è¡Œé…ç½®ï¼Œå‘ŠçŸ¥springbootï¼Œå­˜åœ¨ä¸€ç§æ–°æ ¼å¼å«yaml</p>
<p>ç¼–å†™é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ–°å¢â¼€ç§åª’ä½“ç±»å‹</span></span><br><span class="line"><span class="attr">spring.mvc.contentnegotiation.media-types.yaml</span>=<span class="string">text/yaml</span></span><br></pre></td></tr></table></figure>
<p>å¢åŠ  <code>HttpMessageConverter</code> ç»„ä»¶ï¼Œä¸“â»”è´Ÿè´£æŠŠå¯¹è±¡å†™å‡ºä¸ºyamlæ ¼å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> WebMvcConfigurer <span class="title function_">webMvcConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurer</span>() &#123;</span><br><span class="line">	<span class="meta">@Override</span> <span class="comment">//é…ç½®â¼€ä¸ªèƒ½æŠŠå¯¹è±¡è½¬ä¸ºyamlçš„messageConverter</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt; &gt; converters)</span> &#123;</span><br><span class="line">			converters.add(<span class="keyword">new</span> <span class="title class_">MyYamlHttpMessageConverter</span>());<span class="comment">//è¿™é‡Œå°±æ˜¯å¢åŠ è‡ªå®šä¹‰çš„è½¬æ¢å™¨äº†</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyYamlHttpMessageConverter</span> <span class="keyword">extends</span> <span class="title class_">AbstractHttpMessageConverter</span>&lt;Object&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyYamlHttpMessageConverter</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//springbootä¸çŸ¥é“è¿™ä¸ªè½¬æ¢å™¨æ”¯æŒå“ªç§ç±»å‹ï¼Œæ‰€ä»¥è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œåˆšå¥½é‡Œé¢æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯å‘Šè¯‰springbootæ”¯æŒå“ªç§ç±»å‹çš„</span></span><br><span class="line">        <span class="built_in">super</span>(<span class="keyword">new</span> <span class="title class_">MediaType</span>(<span class="string">&quot;text&quot;</span>,<span class="string">&quot;yaml&quot;</span>,Charset.forName(<span class="string">&quot;UTF-8&quot;</span>)));<span class="comment">//è¿™é‡Œå…¶å®è·Ÿä¸Šé¢çš„é…ç½®æ˜¯è¦å¯¹åº”çš„</span></span><br><span class="line">    	<span class="built_in">this</span>.objectMapper = <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>(<span class="keyword">new</span> <span class="title class_">YAMLFactory</span>().disable(YAMLGenerator.Feature.WRITE_DOC_START_MARKER));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; clazz)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//è¿™é‡Œå¯ä»¥å†™åˆ¤æ–­ï¼Œä½†è¿™é‡Œçœç•¥äº†ï¼Œåªè¦æ˜¯å¯¹è±¡ç±»å‹éƒ½æ”¯æŒ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//@RequestBodyé…åˆï¼Œè¿™æ¬¡æˆ‘ä»¬çš„å®ä¾‹æ˜¯ResponseBodyï¼Œä¸ç”¨ç®¡å¦‚ä½•è¯»å–ï¼Œåªç”¨ç®¡è¿”å›å°±å¥½äº†ï¼Œæ‰€ä»¥è¿™ä¸ªä¸ç”¨å†™</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">readInternal</span><span class="params">(Class&lt;?&gt; clazz, HttpInputMessage inputMessage)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">writeInternal</span><span class="params">(Object methodReturnValue, HttpOutputMessage outputMessage)</span> </span><br><span class="line">            <span class="keyword">throws</span> IOException, HttpMessageNotWritableException &#123;</span><br><span class="line">        <span class="comment">//try-withè¯­æ³•</span></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> outputMessage.getBody())&#123;</span><br><span class="line">            <span class="comment">// å°†å¯¹è±¡è½¬æ¢ä¸ºYAMLå¹¶å†™å…¥è¾“å‡ºæµ</span></span><br><span class="line">            <span class="built_in">this</span>.objectMapper.writeValue(os, methodReturnValue);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="2ã€æ€è€ƒï¼šå¦‚ä½•å¢åŠ å…¶ä»–"><a href="#2ã€æ€è€ƒï¼šå¦‚ä½•å¢åŠ å…¶ä»–" class="headerlink" title="2ã€æ€è€ƒï¼šå¦‚ä½•å¢åŠ å…¶ä»–"></a><strong>2ã€æ€è€ƒï¼šå¦‚ä½•å¢åŠ å…¶ä»–</strong></h6><p>ç¬¬ä¸€æ­¥ï¼šé…ç½®åª’ä½“ç±»å‹çš„æ”¯æŒã€‚</p>
<p>â€‹    <code>spring.mvc.contentnegotiation.media-types.yaml=text/yaml</code></p>
<p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å¯¹åº”çš„HttpMessageConverterã€‚</p>
<p>â€‹    æŒ‰ç…§ä¸Šé¢çš„ç¤ºä¾‹</p>
<p>ç¬¬ä¸‰æ­¥ï¼šæŠŠ<code>MessageConverter</code>åŠ å…¥åˆ°åº•å±‚ã€‚</p>
<p>â€‹    å®¹å™¨ä¸­æ”¾ä¸€ä¸ª<code>webMvcConfigurer</code>ç»„ä»¶å¹¶é…ç½®åº•å±‚çš„<code>MessageConverter</code></p>
<h5 id="3ã€å†…å®¹åå•†åŸç†-HttpMessageConverter"><a href="#3ã€å†…å®¹åå•†åŸç†-HttpMessageConverter" class="headerlink" title="3ã€å†…å®¹åå•†åŸç†-HttpMessageConverter"></a>3ã€å†…å®¹åå•†åŸç†-HttpMessageConverter</h5><blockquote>
<p><code>HttpMessageConverter</code>æ€ä¹ˆå·¥ä½œï¼Ÿä½•æ—¶å·¥ä½œï¼Ÿ</p>
<p>å®šåˆ¶<code>HttpMessageConverter</code> æ¥å®ç°å¤šç«¯å†…å®¹åå•†</p>
<p>ç¼–å†™ <code>WebMvcConfigurer</code>  æä¾›çš„ <code>configureMessageConverters</code> åº•å±‚ï¼Œä¿®æ”¹åº•å±‚çš„<code>HttpMessageConverter</code> å°±è¡Œäº†ã€‚</p>
</blockquote>
<p>å®ç°ä¸Šæˆ‘ä»¬åˆ©ç”¨<code>WebMvcConfigurer</code>  æä¾›çš„ <code>configureMessageConverters</code> ï¼Œç„¶åè‡ªå®šä¹‰è¿™ä¸ª<code>configureMessageConverters</code> å°±èƒ½ä¿®æ”¹åº•å±‚çš„<code>HttpMessageConverter</code> å°±è¡Œäº†ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ<strong>é‚£ä¹ˆæˆ‘ä»¬å…ˆäº†è§£@ResponseBodyçš„åŸç†</strong></p>
<h6 id="1ã€-ReeponseBody-ç”±-HttpMessageConverter-å¤„ç†"><a href="#1ã€-ReeponseBody-ç”±-HttpMessageConverter-å¤„ç†" class="headerlink" title="1ã€@ReeponseBody ç”± HttpMessageConverter å¤„ç†"></a><strong>1ã€<code>@ReeponseBody</code> ç”± <code>HttpMessageConverter</code> å¤„ç†</strong></h6><blockquote>
<p>æ ‡æ³¨äº†<code>@ReeponseBody</code> çš„è¿”å›å€¼ å°†ä¼šç”±æ”¯æŒä»–çš„ <code>HttpMessageConverter</code> å†™ç»™æµè§ˆå™¨</p>
</blockquote>
<p>å¦‚æœ<code>controller</code>æ–¹æ³•çš„è¿”å›å€¼æ ‡æ³¨äº†<code>@RespomseBody</code>æ³¨è§£</p>
<p>æµç¨‹ï¼š</p>
<p>â€‹    1ã€è¯·æ±‚è¿›æ¥ï¼Œå…ˆåˆ°äº† <code>DispatcherServlet</code>çš„ <code>doDispatch()</code>è¿›è¡Œå¤„ç†</p>
<p>â€‹    2ã€æ‰¾åˆ°ä¸€ä¸ª <code>HandlerAdapter</code>é€‚é…å™¨</p>
<p>â€‹    3ã€ç„¶åæˆ‘ä»¬æ ‡æ³¨äº†GetMappingï¼Œç„¶ååŒ¹é…åˆ°äº† <code>RequestMappingHandlerAdapter</code> æ¥æ‰§è¡Œï¼Œè°ƒç”¨<code>invokeHandlerMethod()</code>æ–¹æ³•æ¥æ‰§è¡Œã€‚</p>
<p>â€‹    4ã€åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œå‡†å¤‡å¥½ä¸¤ä¸ªä¸œè¥¿</p>
<p>â€‹        a. <code>HandlerMethodArgumentResolver</code> ï¼š å‚æ•°è§£æå™¨ï¼Œç¡®å®šç›®æ ‡æ–¹æ³•æ¯ä¸ªå‚æ•°å€¼</p>
<p>â€‹        b. <code>HandlerMethodReturnValueHandler</code> ï¼š è¿”å›å€¼å¤„ç†å™¨ï¼Œç¡®å®šç›®æ ‡æ–¹æ³•çš„åè¿½åªè¯¥æ€ä¹ˆå†™å‡ºå»ã€‚</p>
<p>â€‹    5ã€<code>RequestMappingHandlerAdapter</code> é‡Œé¢çš„<code>invokeAndHandle(webReques,mavContainer)</code> çœŸæ­£æ‰§è¡Œç›®æ ‡æ–¹æ³•</p>
<p>â€‹    6ã€ç›®æ ‡æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œä¼šè¿”å› <strong>è¿”å›å€¼å¯¹è±¡</strong></p>
<p>â€‹    7ã€æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„è¿”å›å€¼å¤„ç†å™¨ <code>HandlerMethodReturnValueHandler</code></p>
<p>â€‹    8ã€æœ€ç»ˆæ‰¾åˆ° <code>RequestResponseBodyMethodProcessor</code>   èƒ½å¤„ç† æ ‡æ³¨äº† <code>@ResponseBody</code> æ³¨è§£çš„â½…æ³•</p>
<p>â€‹    9ã€<code>RequestResponseBodyMethodProcessor</code>è°ƒâ½¤ <code>writeWithMessageConverters</code> ï¼Œåˆ©ç”¨</p>
<p><code>MessageConverter</code>   æŠŠè¿”å›å€¼å†™å‡ºå»</p>
<blockquote>
<p>ä¸Šé¢è§£é‡Šï¼š<code>@ResponseBody</code> ç”± <code>HttpMessageConverter</code> å¤„ç†ï¼Œä¸‹é¢è§£é‡Š<code>HttpMessageConverter</code> å¦‚ä½•å¤„ç†çš„</p>
</blockquote>
<h6 id="2ã€HttpMessageConverter-ä¼šå…ˆè¿›è¡Œå†…å®¹åå•†"><a href="#2ã€HttpMessageConverter-ä¼šå…ˆè¿›è¡Œå†…å®¹åå•†" class="headerlink" title="2ã€HttpMessageConverter ä¼šå…ˆè¿›è¡Œå†…å®¹åå•†"></a>2ã€<code>HttpMessageConverter</code> ä¼šå…ˆè¿›è¡Œå†…å®¹åå•†</h6><p>â€‹    1ã€éå†æ‰€æœ‰çš„ <code>MessageConverter</code> çœ‹è°æ”¯æŒè¿™ç§å†…å®¹ç±»å‹çš„æ•°æ®</p>
<p>â€‹    2ã€é»˜è®¤çš„ <code>MessageConverter</code> æœ‰å¾ˆå¤šConverter</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220021951029.png" alt="image-20251220021951029"></p>
<p>â€‹    3ã€  æœ€ç»ˆå› ä¸ºè¦ json  æ‰€ä»¥ MappingJackson2HttpMessageConverter  â½€æŒå†™å‡ºjson </p>
<p>â€‹    4ã€  jacksonâ½¤ ObjectMapper  æŠŠå¯¹è±¡å†™å‡ºå»</p>
<h6 id="3ã€WebMvcAutoConfiguration-æä¾›å‡ ç§é»˜è®¤-HttpMessageConverters"><a href="#3ã€WebMvcAutoConfiguration-æä¾›å‡ ç§é»˜è®¤-HttpMessageConverters" class="headerlink" title="3ã€WebMvcAutoConfiguration æä¾›å‡ ç§é»˜è®¤ HttpMessageConverters"></a><strong>3ã€<code>WebMvcAutoConfiguration</code> æä¾›å‡ ç§é»˜è®¤ <code>HttpMessageConverters</code></strong></h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">EnableWebMvcConfiguration é€šè¿‡ addDefaultHttpMessageConverters æ·»åŠ äº†é»˜è®¤çš„ MessageConverter,å¦‚ä¸‹ï¼š</span><br><span class="line">ByteArrayHttpMessageConverter ï¼š â½€æŒå­—èŠ‚æ•°æ®è¯»å†™</span><br><span class="line">StringHttpMessageConverter ï¼š â½€æŒå­—ç¬¦ä¸²è¯»å†™</span><br><span class="line">ResourceHttpMessageConverter ï¼šâ½€æŒèµ„æºè¯»å†™</span><br><span class="line">ResourceRegionHttpMessageConverter : â½€æŒåˆ†åŒºèµ„æºå†™å‡º</span><br><span class="line">AllEncompassingFormHttpMessageConverter ï¼šâ½€æŒè¡¨å•xml/jsonè¯»å†™</span><br><span class="line">MappingJackson2HttpMessageConverter ï¼š â½€æŒè¯·æ±‚å“åº”ä½“Jsonè¯»å†™</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç³»ç»Ÿæä¾›é»˜è®¤çš„MessageConverter åŠŸèƒ½æœ‰é™ï¼Œä»…â½¤äºjsonæˆ–è€…æ™®é€šè¿”å›æ•°æ®ã€‚é¢å¤–å¢åŠ æ–°çš„å†…å®¹åå•† åŠŸèƒ½ï¼Œå¿…é¡»å¢åŠ æ–°çš„  HttpMessageConverter</p>
</blockquote>
<p>é‚£ä¹ˆå°±è‡ªç„¶æƒ³åˆ°ï¼Œå¯¼å…¥ç›¸å…³çš„POMåŒ…ç„¶åç¼–å†™é…ç½®ï¼Œå¢åŠ ç›¸åº”çš„Converterå°±å¯ä»¥äº†ã€‚</p>
<h6 id="4ã€WebMvcConfigurationSupport"><a href="#4ã€WebMvcConfigurationSupport" class="headerlink" title="4ã€WebMvcConfigurationSupport"></a>4ã€WebMvcConfigurationSupport</h6><p>æä¾›äº†å¾ˆå¤šçš„é»˜è®¤è®¾ç½®ã€‚</p>
<p>åˆ¤æ–­ç³»ç»Ÿä¸­æ˜¯å¦æœ‰ç›¸åº”çš„ç±»ï¼šå¦‚æœæœ‰ï¼Œå°±åŠ å…¥ç›¸åº”çš„<code>HttpMessageConverter</code></p>
<h4 id="5ã€æ¨¡æ¿å¼•æ“"><a href="#5ã€æ¨¡æ¿å¼•æ“" class="headerlink" title="5ã€æ¨¡æ¿å¼•æ“"></a>5ã€æ¨¡æ¿å¼•æ“</h4><blockquote>
<p>ç”±äº SpringBoot ä½¿â½¤äº†åµŒâ¼Šå¼ Servlet å®¹å™¨ã€‚æ‰€ä»¥ JSP é»˜è®¤æ˜¯ä¸èƒ½ä½¿â½¤çš„ã€‚ </p>
<p>å¦‚æœéœ€è¦æœåŠ¡ç«¯â»šâ¾¯æ¸²æŸ“ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿â½¤  æ¨¡æ¿å¼•æ“</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220043210589.png" alt="image-20251220043210589"></p>
<p>ä¸Šé¢æ˜¯å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œä¸‹é¢æ˜¯å‰åç«¯ä¸åˆ†ç¦»å¼€å‘ã€‚</p>
<p>æ¨¡æ¿å¼•æ“â»šâ¾¯é»˜è®¤æ”¾åœ¨  <code>src/main/resources/templates</code> </p>
<p>SpringBoot åŒ…å«ä»¥ä¸‹æ¨¡æ¿å¼•æ“çš„â¾ƒåŠ¨é…ç½® </p>
<p>FreeMarker </p>
<p>Groovy </p>
<p><strong>Thymeleaf</strong> </p>
<p>Mustache</p>
<h5 id="1ã€Thymeleafæ•´åˆ"><a href="#1ã€Thymeleafæ•´åˆ" class="headerlink" title="1ã€Thymeleafæ•´åˆ"></a>1ã€Thymeleafæ•´åˆ</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>â¾ƒåŠ¨é…ç½®åŸç† </p>
<ol>
<li>å¼€å¯äº†  <code>org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration</code>  â¾ƒåŠ¨é…ç½® </li>
<li>å±æ€§ç»‘å®šåœ¨  ThymeleafProperties ä¸­ï¼Œå¯¹åº”é…ç½®â½‚ä»¶  spring.thymeleaf å†…å®¹ </li>
<li>æ‰€æœ‰çš„æ¨¡æ¿â»šâ¾¯é»˜è®¤åœ¨  classpath:/templates  â½‚ä»¶å¤¹ä¸‹ </li>
<li>é»˜è®¤æ•ˆæœ<ol>
<li>æ‰€æœ‰çš„æ¨¡æ¿â»šâ¾¯åœ¨  classpath:/templates/  ä¸‹â¾¯æ‰¾</li>
<li>æ‰¾åç¼€åä¸º .html  çš„â»šâ¾¯</li>
</ol>
</li>
</ol>
<h5 id="2ã€åŸºç¡€è¯­æ³•"><a href="#2ã€åŸºç¡€è¯­æ³•" class="headerlink" title="2ã€åŸºç¡€è¯­æ³•"></a>2ã€åŸºç¡€è¯­æ³•</h5><h6 id="1ã€æ ¸å¿ƒç”¨æ³•"><a href="#1ã€æ ¸å¿ƒç”¨æ³•" class="headerlink" title="1ã€æ ¸å¿ƒç”¨æ³•"></a>1ã€æ ¸å¿ƒç”¨æ³•</h6><p><code>th:xxx</code> ï¼šåŠ¨æ€æ¸²æŸ“åˆ¶å®šçš„htmlæ ‡ç­¾å±æ€§å€¼æˆ–è€…thæŒ‡ä»¤ï¼ˆéå†ã€åˆ¤æ–­ç­‰ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">th:text æ ‡ç­¾å†…æ–‡æœ¬å€¼æ¸²æŸ“</span><br><span class="line">th:utext ä¸ä¼šè½¬ä¹‰ï¼Œæ˜¾ç¤ºä¸ºhtmlåŸæœ¬çš„æ ·å­</span><br><span class="line">th:å±æ€§ æ ‡ç­¾åˆ¶å®šå±æ€§æ¸²æŸ“</span><br><span class="line">th:attr æ ‡ç­¾ä»»æ„å±æ€§æ¸²æŸ“</span><br><span class="line">th:if</span><br><span class="line">th:eachç­‰</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;content&#125;&quot;</span>&gt;</span>åŸå†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../images/gtvglogo.png&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">th:attr</span>=<span class="string">&quot;src=@&#123;/images/gtvglogo.png&#125;,title=#&#123;logo&#125;,alt=#&#123;logo&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¡¨è¾¾å¼ï¼šç”¨æ¥åŠ¨æ€å–å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;&#125; å˜é‡å–å€¼ï¼Œä½¿ç”¨modelå…±äº«ç»™é¡µé¢çš„å€¼éƒ½ç›´æ¥ç”¨$&#123;&#125;</span><br><span class="line">@&#123;&#125; urlè·¯å¾„</span><br><span class="line">#&#123;&#125; å›½é™…åŒ–æ¶ˆæ¯</span><br><span class="line">~&#123;&#125; ç‰‡æ®µå¼•ç”¨</span><br><span class="line">*&#123;&#125; å˜é‡é€‰æ‹©ï¼Œéœ€è¦é…åˆth:objectç»‘å®šå¯¹è±¡</span><br></pre></td></tr></table></figure>
<p>ç³»ç»Ÿå·¥å…·&amp;å†…ç½®å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">param ï¼šè¯·æ±‚å‚æ•°å¯¹è±¡</span><br><span class="line">session ï¼šsessionå¯¹è±¡</span><br><span class="line">application ï¼šapplicationå¯¹è±¡</span><br><span class="line">#execInfo ï¼šæ¨¡æ¿æ‰§â¾ä¿¡æ¯</span><br><span class="line">#messages ï¼šå›½é™…åŒ–æ¶ˆæ¯</span><br><span class="line">#uris ï¼šuri/urlâ¼¯å…·</span><br><span class="line">#conversions ï¼šç±»å‹è½¬æ¢â¼¯å…·</span><br><span class="line">#dates ï¼šâ½‡æœŸâ¼¯å…·ï¼Œæ˜¯ava.util.Date å¯¹è±¡çš„â¼¯å…·ç±»</span><br><span class="line">#calendars ï¼šç±»ä¼¼#datesï¼Œåªä¸è¿‡æ˜¯java.util.Calendar å¯¹è±¡çš„â¼¯å…·ç±»</span><br><span class="line">#temporals ï¼š JDK8+ java.time API â¼¯å…·ç±»</span><br><span class="line">#numbers ï¼šæ•°å­—æ“ä½œâ¼¯å…·</span><br><span class="line">#strings ï¼šå­—ç¬¦ä¸²æ“ä½œ</span><br><span class="line">#objects ï¼šå¯¹è±¡æ“ä½œ</span><br><span class="line">#bools ï¼šboolæ“ä½œ</span><br><span class="line">#arrays ï¼šarrayâ¼¯å…·</span><br><span class="line">#lists ï¼šlistâ¼¯å…·</span><br><span class="line">#sets ï¼šsetâ¼¯å…·</span><br><span class="line">#maps ï¼šmapâ¼¯å…·</span><br><span class="line">#aggregates ï¼šé›†åˆèšåˆâ¼¯å…·ï¼ˆsumã€avgï¼‰</span><br><span class="line">#ids ï¼šidâ½£æˆå·¥å…·</span><br></pre></td></tr></table></figure>
<h6 id="2ã€è¯­æ³•ç¤ºä¾‹"><a href="#2ã€è¯­æ³•ç¤ºä¾‹" class="headerlink" title="2ã€è¯­æ³•ç¤ºä¾‹"></a>2ã€è¯­æ³•ç¤ºä¾‹</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">è¡¨è¾¾å¼ï¼š</span><br><span class="line">    å˜é‡å–å€¼ï¼š$&#123;...&#125;</span><br><span class="line">    url å–å€¼ï¼š@&#123;...&#125;</span><br><span class="line">    å›½é™…åŒ–æ¶ˆæ¯ï¼š#&#123;...&#125;</span><br><span class="line">    å˜é‡é€‰æ‹©ï¼š*&#123;...&#125;</span><br><span class="line">    â½šæ®µå¼•â½¤: ~&#123;...&#125;</span><br><span class="line"></span><br><span class="line">â½‚æœ¬æ“ä½œï¼š</span><br><span class="line">	æ‹¼ä¸²ï¼š +</span><br><span class="line">	â½‚æœ¬æ›¿æ¢ï¼š| The name is $&#123;name&#125; |</span><br><span class="line"></span><br><span class="line">å¸ƒå°”æ“ä½œï¼š</span><br><span class="line">    â¼†è¿›åˆ¶è¿ç®—ï¼š and,or</span><br><span class="line">    å–åï¼š!,not</span><br><span class="line"></span><br><span class="line">â½è¾ƒè¿ç®—ï¼š</span><br><span class="line">	â½è¾ƒï¼š &gt;ï¼Œ&lt;ï¼Œ&lt;=ï¼Œ&gt;=ï¼ˆgtï¼Œltï¼Œge,leï¼‰</span><br><span class="line">	ç­‰å€¼è¿ç®—ï¼š ==,!=ï¼ˆeqï¼Œneï¼‰</span><br><span class="line">æ¡ä»¶è¿ç®—ï¼š</span><br><span class="line">    if-thenï¼š (if)?(then)</span><br><span class="line">    if-then-else: (if)?(then):(else)</span><br><span class="line">    default: (value)?:(defaultValue)</span><br><span class="line">ç‰¹æ®Šè¯­æ³•ï¼š</span><br><span class="line">	â½†æ“ä½œï¼š_</span><br><span class="line"></span><br><span class="line">æ‰€æœ‰ä»¥ä¸Šéƒ½å¯ä»¥åµŒå¥—ç»„åˆ</span><br><span class="line">&#x27;User is of type &#x27; + ($&#123;user.isAdmin()&#125; ? &#x27;Administrator&#x27; : ($&#123;user.type&#125; ?: &#x27;Unknown&#x27;))</span><br></pre></td></tr></table></figure>
<h6 id="3ã€å±æ€§è®¾ç½®"><a href="#3ã€å±æ€§è®¾ç½®" class="headerlink" title="3ã€å±æ€§è®¾ç½®"></a>3ã€å±æ€§è®¾ç½®</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.th:href=&quot;@&#123;/product/list&#125;&quot;</span><br><span class="line">2.th:attr=&quot;class=$&#123;active&#125;&quot;</span><br><span class="line">3.th:attr=&quot;src=@&#123;/images/gtvglogo.png&#125;,title=$&#123;logo&#125;,alt=#&#123;logo&#125;&quot;</span><br><span class="line">4.th:checked=&quot;$&#123;user.active&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>æ¡ˆä¾‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;content&#125;&quot;</span>&gt;</span>åŸå†…å®¹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../images/gtvglogo.png&quot;</span> <span class="attr">th:attr</span>=<span class="string">&quot;src=@&#123;/images/gtvglogo.png&#125;,title=#&#123;logo&#125;,alt=#&#123;logo&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="4ã€éå†"><a href="#4ã€éå†" class="headerlink" title="4ã€éå†"></a>4ã€éå†</h6><blockquote>
<p>è¯­ æ³•ï¼š   th:each=â€ å…ƒç´ å , è¿­ä»£çŠ¶æ€ : ${ é›†åˆ }â€</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;prod : $&#123;prods&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.name&#125;&quot;</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.price&#125;&quot;</span>&gt;</span>2.41<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.inStock&#125;? #&#123;true&#125; : #&#123;false&#125;&quot;</span>&gt;</span>yes<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;prod,iterStat : $&#123;prods&#125;&quot;</span> <span class="attr">th:class</span>=<span class="string">&quot;$&#123;iterStat.odd&#125;? &#x27;odd&#x27;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.name&#125;&quot;</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.price&#125;&quot;</span>&gt;</span>2.41<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;prod.inStock&#125;? #&#123;true&#125; : #&#123;false&#125;&quot;</span>&gt;</span>yes<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        index: [[$&#123;iterStat.index&#125;]]</span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iterStat æœ‰ä»¥ä¸‹å±æ€§ï¼š</span><br><span class="line">    indexï¼šå½“å‰éå†å…ƒç´ çš„ç´¢å¼•ï¼Œä»0å¼€å§‹</span><br><span class="line">    countï¼šå½“å‰éå†å…ƒç´ çš„ç´¢å¼•ï¼Œä»1å¼€å§‹</span><br><span class="line">    sizeï¼šéœ€è¦éå†å…ƒç´ çš„æ€»æ•°é‡</span><br><span class="line">    currentï¼šå½“å‰æ­£åœ¨éå†çš„å…ƒç´ å¯¹è±¡</span><br><span class="line">    even/oddï¼šæ˜¯å¦å¶æ•°/å¥‡æ•°â¾</span><br><span class="line">    firstï¼šæ˜¯å¦ç¬¬â¼€ä¸ªå…ƒç´ </span><br><span class="line">    lastï¼šæ˜¯å¦æœ€åâ¼€ä¸ªå…ƒç´ </span><br></pre></td></tr></table></figure>
<h6 id="5ã€åˆ¤æ–­"><a href="#5ã€åˆ¤æ–­" class="headerlink" title="5ã€åˆ¤æ–­"></a>5ã€åˆ¤æ–­</h6><p><code>th:if</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag"><span class="attr">href</span>=<span class="string">&quot;comments.html&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">th:href</span>=<span class="string">&quot;@&#123;/product/comments(prodId=$&#123;prod.id&#125;)&#125;&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">th:if</span>=<span class="string">&quot;$&#123;not #lists.isEmpty(prod.comments)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span>view<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>th:switch</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">&quot;$&#123;user.role&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;&#x27;admin&#x27;&quot;</span>&gt;</span>User is an administrator<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;#&#123;roles.manager&#125;&quot;</span>&gt;</span>User is a manager<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;*&quot;</span>&gt;</span>User is some other thing<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="6ã€å±æ€§ä¼˜å…ˆçº§"><a href="#6ã€å±æ€§ä¼˜å…ˆçº§" class="headerlink" title="6ã€å±æ€§ä¼˜å…ˆçº§"></a>6ã€å±æ€§ä¼˜å…ˆçº§</h6><p>ç‰‡æ®µã€‹éå†ã€‹åˆ¤æ–­</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">th:each</span>=<span class="string">&quot;item : $&#123;items&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;item.description&#125;&quot;</span>&gt;</span>Item description here...<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220054531309.png" alt="image-20251220054531309"></p>
<h6 id="7ã€è¡Œå†…å†™æ³•"><a href="#7ã€è¡Œå†…å†™æ³•" class="headerlink" title="7ã€è¡Œå†…å†™æ³•"></a>7ã€è¡Œå†…å†™æ³•</h6><p><code>[[...]] or  [(...)]</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello, [[$&#123;session.user.name&#125;]]!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="8ã€å˜é‡é€‰æ‹©"><a href="#8ã€å˜é‡é€‰æ‹©" class="headerlink" title="8ã€å˜é‡é€‰æ‹©"></a>8ã€å˜é‡é€‰æ‹©</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;session.user&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;firstName&#125;&quot;</span>&gt;</span>Sebastian<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Surname: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;lastName&#125;&quot;</span>&gt;</span>Pepper<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Nationality: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;nationality&#125;&quot;</span>&gt;</span>Saturn<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç­‰åŒäº</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.user.firstName&#125;&quot;</span>&gt;</span>Sebastian<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Surname: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.user.lastName&#125;&quot;</span>&gt;</span>Pepper<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Nationality: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.user.nationality&#125;&quot;</span>&gt;</span>Saturn<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="9ã€æ¨¡æ¿å¸ƒå±€"><a href="#9ã€æ¨¡æ¿å¸ƒå±€" class="headerlink" title="9ã€æ¨¡æ¿å¸ƒå±€"></a>9ã€æ¨¡æ¿å¸ƒå±€</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å®šä¹‰æ¨¡æ¿ï¼š th:fragment </span><br><span class="line">å¼•â½¤æ¨¡æ¿ï¼š~&#123;templatename::selector&#125; </span><br><span class="line">æ’â¼Šæ¨¡æ¿ï¼šth:insert ã€th:replace </span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">th:fragment</span>=<span class="string">&quot;copy&quot;</span>&gt;</span><span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;footer :: copy&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;footer :: copy&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    ç»“æœï¼š</span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span> 2011 The Good Thymes Virtual Grocery<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="10ã€devtools"><a href="#10ã€devtools" class="headerlink" title="10ã€devtools"></a>10ã€devtools</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹â»šâ¾¯åï¼› ctrl+F9  åˆ·æ–°æ•ˆæœï¼› javaä»£ç çš„ä¿®æ”¹ï¼Œå¦‚æœ devtools  çƒ­å¯åŠ¨äº†ï¼Œå¯èƒ½ä¼šå¼•èµ·â¼€äº›bugï¼Œéš¾ä»¥æ’æŸ¥</p>
<h4 id="6ã€å›½é™…åŒ–"><a href="#6ã€å›½é™…åŒ–" class="headerlink" title="6ã€å›½é™…åŒ–"></a>6ã€å›½é™…åŒ–</h4><p>å›½é™…åŒ–çš„â¾ƒåŠ¨é…ç½®å‚ç…§ <code>MessageSourceAutoConfiguration</code></p>
<p>å®ç°æ­¥éª¤ï¼š </p>
<ol>
<li><p>Spring Boot åœ¨ç±»è·¯å¾„æ ¹ä¸‹æŸ¥æ‰¾ messagesèµ„æºç»‘å®šâ½‚ä»¶ã€‚â½‚ä»¶åä¸ºï¼š messages.properties</p>
</li>
<li><p>å¤šè¯­â¾”å¯ä»¥å®šä¹‰å¤šä¸ªæ¶ˆæ¯â½‚ä»¶ï¼Œå‘½åä¸º messages_ åŒºåŸŸä»£ç  .properties  ã€‚å¦‚ï¼š </p>
<p>a. messages.properties  ï¼šé»˜è®¤ </p>
<p>b. messages_zh_CN.properties  ï¼šä¸­â½‚ç¯å¢ƒ </p>
<p>c. messages_en_US.properties  ï¼šè‹±è¯­ç¯å¢ƒ</p>
</li>
<li><p>åœ¨ç¨‹åºä¸­å¯ä»¥â¾ƒåŠ¨æ³¨â¼Š  MessageSource  ç»„ä»¶ï¼Œè·å–å›½é™…åŒ–çš„é…ç½®é¡¹å€¼ </p>
</li>
<li>åœ¨â»šâ¾¯ä¸­å¯ä»¥ä½¿â½¤è¡¨è¾¾å¼  #{}  è·å–å›½é™…åŒ–çš„é…ç½®é¡¹å€¼</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span>  <span class="comment">//å›½é™…åŒ–å–æ¶ˆæ¯â½¤çš„ç»„ä»¶</span></span><br><span class="line">MessageSource messageSource;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/haha&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">haha</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">	<span class="type">Locale</span> <span class="variable">locale</span> <span class="operator">=</span> request.getLocale();</span><br><span class="line">    <span class="comment">//åˆ©â½¤ä»£ç çš„â½…å¼è·å–å›½é™…åŒ–é…ç½®â½‚ä»¶ä¸­æŒ‡å®šçš„é…ç½®é¡¹çš„å€¼</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">login</span> <span class="operator">=</span> messageSource.getMessage(<span class="string">&quot;login&quot;</span>, <span class="literal">null</span>, locale);</span><br><span class="line">    <span class="keyword">return</span> login;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šå¸¸æ˜¯å¼€å‘ä¸¤å¥—ç³»ç»Ÿï¼Œä¸ç„¶å°±æ˜¯é…ä¸¤å¥—propertiesï¼Œä¸€ä¸ªä¸­æ–‡ä¸€ä¸ªè‹±æ–‡ç„¶ååˆ†åˆ«ç»‘å®šã€‚</p>
<h4 id="7ã€é”™è¯¯å¤„ç†"><a href="#7ã€é”™è¯¯å¤„ç†" class="headerlink" title="7ã€é”™è¯¯å¤„ç†"></a>7ã€é”™è¯¯å¤„ç†</h4><h5 id="1ã€é»˜è®¤æœºåˆ¶"><a href="#1ã€é»˜è®¤æœºåˆ¶" class="headerlink" title="1ã€é»˜è®¤æœºåˆ¶"></a>1ã€é»˜è®¤æœºåˆ¶</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">é”™è¯¯å¤„ç†çš„â¾ƒåŠ¨é…ç½®éƒ½åœ¨ ErrorMvcAutoConfiguration ä¸­ï¼Œ</span><br><span class="line">ä¸¤â¼¤æ ¸â¼¼æœºåˆ¶ï¼š</span><br><span class="line">1. SpringBoot ä¼šâ¾ƒé€‚åº”å¤„ç†é”™è¯¯ï¼Œå“åº”â»šâ¾¯æˆ–JSONæ•°æ®</span><br><span class="line">2. SpringMVCçš„é”™è¯¯å¤„ç†æœºåˆ¶ä¾ç„¶ä¿ç•™ï¼ŒMVCå¤„ç†ä¸äº†ï¼Œæ‰ä¼šäº¤ç»™bootè¿›â¾å¤„ç†</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220055831325.png" alt="image-20251220055831325"></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨é…ç½®æ–‡ä»¶é‡Œé¢é…ç½®é”™è¯¯è·¯å¾„ï¼Œå½“å‘ç”Ÿé”™è¯¯ä»¥åï¼Œé”™è¯¯çš„è¯·æ±‚è½¬å‘çš„è·¯å¾„ã€‚</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.error.path</span>=<span class="string">/error</span></span><br></pre></td></tr></table></figure>
<p>å‘â½£é”™è¯¯ä»¥åï¼Œè½¬å‘ç»™/errorè·¯å¾„ï¼ŒSpringBootåœ¨åº•å±‚å†™å¥½â¼€ä¸ª BasicErrorControllerçš„ç»„ä»¶ï¼Œä¸“â»” å¤„ç†è¿™ä¸ªè¯·æ±‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(produces = MediaType.TEXT_HTML_VALUE)</span> <span class="comment">//è¿”å›HTML</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">errorHtml</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="type">HttpStatus</span> <span class="variable">status</span> <span class="operator">=</span> getStatus(request);</span><br><span class="line">	Map&lt;String, Object&gt; model = Collections.unmodifiableMap(getErrorAttributes(request, getErrorAttributeOptions(request, MediaType.TEXT_HTML)));</span><br><span class="line">	response.setStatus(status.value());</span><br><span class="line">	<span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> resolveErrorView(request, response, status, model);</span><br><span class="line">	<span class="keyword">return</span> (modelAndView != <span class="literal">null</span>) ? modelAndView : <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;error&quot;</span>, model);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>  <span class="comment">//è¿”å›ResponseEntity, JSON</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">error</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">	<span class="type">HttpStatus</span> <span class="variable">status</span> <span class="operator">=</span> getStatus(request);</span><br><span class="line">	<span class="keyword">if</span> (status == HttpStatus.NO_CONTENT) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(status);</span><br><span class="line">	&#125;</span><br><span class="line">	Map&lt;String, Object&gt; body = getErrorAttributes(request, getErrorAttributeOptions(request, MediaType.ALL));</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(body, status);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦å“åº”é¡µé¢ï¼Œé”™è¯¯é¡µé¢æ˜¯è¿™ä¹ˆè§£æåˆ°çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1ã€è§£æé”™è¯¯çš„â¾ƒå®šä¹‰è§†å›¾åœ°å€</span></span><br><span class="line"><span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> resolveErrorView(request, response, status, model);</span><br><span class="line"><span class="comment">//2ã€å¦‚æœè§£æä¸åˆ°é”™è¯¯â»šâ¾¯çš„åœ°å€ï¼Œé»˜è®¤çš„é”™è¯¯â»šå°±æ˜¯error</span></span><br><span class="line"><span class="keyword">return</span> (modelAndView != <span class="literal">null</span>) ? modelAndView : <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;error&quot;</span>, model);</span><br></pre></td></tr></table></figure>
<p>å®¹å™¨ä¸­ä¸“é—¨æœ‰â¼€ä¸ªé”™è¯¯è§†å›¾è§£æå™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnBean(DispatcherServlet.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(ErrorViewResolver.class)</span></span><br><span class="line">DefaultErrorViewResolver <span class="title function_">conventionErrorViewResolver</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DefaultErrorViewResolver</span>(<span class="built_in">this</span>.applicationContext, <span class="built_in">this</span>.resources);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SpringBootè§£æé”™è¯¯é¡µçš„é»˜è®¤è§„åˆ™</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">resolveErrorView</span><span class="params">(HttpServletRequest request, </span></span><br><span class="line"><span class="params">                                     HttpStatus status, </span></span><br><span class="line"><span class="params">                                     Map&lt;String, Object&gt; model)</span> &#123;</span><br><span class="line">    <span class="comment">// é¦–å…ˆå°è¯•é€šè¿‡çŠ¶æ€ç è§£æè§†å›¾</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> resolve(String.valueOf(status.value()), model);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœæ‰¾ä¸åˆ°å…·ä½“çš„çŠ¶æ€ç è§†å›¾ï¼Œå°è¯•é€šè¿‡çŠ¶æ€ç³»åˆ—æŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">if</span> (modelAndView == <span class="literal">null</span> &amp;&amp; SERIES_VIEWS.containsKey(status.series())) &#123;</span><br><span class="line">        modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ModelAndView <span class="title function_">resolve</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> &#123;</span><br><span class="line">    <span class="comment">// æ„å»ºé”™è¯¯è§†å›¾åç§°ï¼šerror/ + çŠ¶æ€ç </span></span><br><span class="line">    <span class="type">String</span> <span class="variable">errorViewName</span> <span class="operator">=</span> <span class="string">&quot;error/&quot;</span> + viewName;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ¨¡æ¿æ˜¯å¦å¯ç”¨</span></span><br><span class="line">    <span class="type">TemplateAvailabilityProvider</span> <span class="variable">provider</span> <span class="operator">=</span> <span class="built_in">this</span>.templateAvailabilityProviders</span><br><span class="line">            .getProvider(errorViewName, <span class="built_in">this</span>.applicationContext);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœæ¨¡æ¿å¯ç”¨ï¼Œè¿”å›ModelAndView</span></span><br><span class="line">    <span class="keyword">if</span> (provider != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(errorViewName, model);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦åˆ™å°è¯•è§£æé™æ€èµ„æº</span></span><br><span class="line">    <span class="keyword">return</span> resolveResource(errorViewName, model);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ModelAndView <span class="title function_">resolveResource</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> &#123;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é™æ€èµ„æºä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> (String location : <span class="built_in">this</span>.resources.getStaticLocations()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è·å–èµ„æºå¹¶æ„å»ºç›¸å¯¹è·¯å¾„</span></span><br><span class="line">            <span class="type">Resource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="built_in">this</span>.applicationContext.getResource(location);</span><br><span class="line">            resource = resource.createRelative(viewName + <span class="string">&quot;.html&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (resource.exists()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="keyword">new</span> <span class="title class_">HtmlResourceView</span>(resource), model);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            <span class="comment">// å¿½ç•¥èµ„æºè®¿é—®å¼‚å¸¸ï¼Œç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰€æœ‰ä½ç½®éƒ½æ‰¾ä¸åˆ°èµ„æºï¼Œè¿”å›null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®¹å™¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤çš„åä¸º error çš„ Viewï¼Œæä¾›äº†é»˜è®¤ç™½é¡µçš„åŠŸèƒ½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(name = &quot;error&quot;)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(name = &quot;error&quot;)</span></span><br><span class="line"><span class="keyword">public</span> View <span class="title function_">defaultErrorView</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">this</span>.defaultErrorView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°è£…äº†JSONæ ¼å¼çš„é”™è¯¯ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)</span></span><br><span class="line"><span class="keyword">public</span> DefaultErrorAttributes <span class="title function_">errorAttributes</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DefaultErrorAttributes</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§„åˆ™ï¼š</p>
<p>1ã€è§£æä¸€ä¸ªé”™è¯¯é¡µ</p>
<p>â€‹    a. å¦‚æœå‘ç”Ÿäº† 500ã€404ã€503ã€403 è¿™äº›é”™è¯¯</p>
<p>â€‹        å¦‚æœæœ‰æ¨¡æ¿å¼•æ“ï¼Œé»˜è®¤åœ¨ <code>classpath:/templates/error/ç²¾ç¡®ç .html</code> </p>
<p>â€‹        å¦‚æœæ²¡æœ‰æ¨¡æ¿å¼•æ“ï¼Œåœ¨é™æ€èµ„æºæ–‡ä»¶å¤¹ä¸‹æ‰¾ <code>ç²¾ç¡®ç .html</code>  </p>
<p>â€‹    b.å¦‚æœåŒ¹é…ä¸åˆ° <code>ç²¾ç¡®ç .html</code> ï¼Œè¿™äº›ç²¾ç¡®çš„é”™è¯¯é¡µé¢ï¼Œå°±å»æ‰¾<code>5xx.html</code>ï¼Œ<code>4xx.html</code> <strong>æ¨¡ç³ŠåŒ¹é…</strong></p>
<p>â€‹        å¦‚æœæœ‰æ¨¡æ¿å¼•æ“ï¼Œé»˜è®¤åœ¨ <code>classpath:/templates/error/5xx.html</code> </p>
<p>â€‹        å¦‚æœæ²¡æœ‰æ¨¡æ¿å¼•æ“ï¼Œåœ¨é™æ€èµ„æºæ–‡ä»¶å¤¹ä¸‹æ‰¾ <code>5xx.html</code></p>
<p>2ã€å¦‚æœæ¨¡æ¿å¼•æ“è·¯å¾„<code>templates</code>ä¸‹æœ‰<code>error.html</code>é¡µé¢ï¼Œå°±ç›´æ¥æ¸²æŸ“</p>
<h5 id="2ã€è‡ªå®šä¹‰é”™è¯¯å“åº”"><a href="#2ã€è‡ªå®šä¹‰é”™è¯¯å“åº”" class="headerlink" title="2ã€è‡ªå®šä¹‰é”™è¯¯å“åº”"></a>2ã€è‡ªå®šä¹‰é”™è¯¯å“åº”</h5><h6 id="1ã€è‡ªå®šä¹‰jsonå“åº”"><a href="#1ã€è‡ªå®šä¹‰jsonå“åº”" class="headerlink" title="1ã€è‡ªå®šä¹‰jsonå“åº”"></a>1ã€è‡ªå®šä¹‰jsonå“åº”</h6><blockquote>
<p>ä½¿ â½¤@ControllerAdvice + @ExceptionHandler è¿›â¾ç»Ÿâ¼€å¼‚å¸¸å¤„ç†</p>
</blockquote>
<h6 id="2ã€è‡ªå®šä¹‰é¡µé¢å“åº”"><a href="#2ã€è‡ªå®šä¹‰é¡µé¢å“åº”" class="headerlink" title="2ã€è‡ªå®šä¹‰é¡µé¢å“åº”"></a>2ã€è‡ªå®šä¹‰é¡µé¢å“åº”</h6><blockquote>
<p>æ ¹æ®bootçš„é”™è¯¯é¡µé¢è§„åˆ™ï¼Œè‡ªå®šä¹‰é¡µé¢æ¨¡æ¿</p>
</blockquote>
<h5 id="3ã€æœ€ä½³å®æˆ˜"><a href="#3ã€æœ€ä½³å®æˆ˜" class="headerlink" title="3ã€æœ€ä½³å®æˆ˜"></a>3ã€æœ€ä½³å®æˆ˜</h5><ul>
<li>å‰ååˆ†ç¦»<ul>
<li>åå°å‘ç”Ÿçš„æ‰€æœ‰é”™è¯¯ï¼Œä½¿ â½¤<code>@ControllerAdvice</code> + <code>@ExceptionHandler</code> è¿›â¾ç»Ÿâ¼€å¼‚å¸¸å¤„ç†</li>
</ul>
</li>
<li><p>æœåŠ¡ç«¯é¡µé¢æ¸²æŸ“</p>
<ul>
<li><p>ä¸å¯é¢„çŸ¥çš„ä¸€äº›HTTPç é”™è¯¯ï¼ŒæœåŠ¡å™¨æˆ–è€…å®¢æˆ·ç«¯çš„é”™è¯¯</p>
<ul>
<li>ç»™ <code>classpath:templates/error/</code> ä¸‹é¢ï¼Œæ”¾ä¸€ä¸ªç²¾ç¡®çš„é”™è¯¯ç é¡µé¢ï¼Œ<code>500.html</code>,<code>404.html</code></li>
<li>ç»™ <code>classpath:templates/error/</code> ä¸‹é¢ï¼Œæ”¾å¸¸ç”¨æ¨¡ç³ŠåŒ¹é…çš„é”™è¯¯ç é¡µé¢</li>
</ul>
</li>
<li><p>å‘ç”Ÿä¸šåŠ¡é”™è¯¯</p>
<ul>
<li>æ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯ä¸€ç§é”™è¯¯éƒ½åº”è¯¥ä»£ç æ§åˆ¶ï¼Œè·³è½¬åˆ°è‡ªå·±çš„é”™è¯¯é¡µã€‚</li>
<li>é€šç”¨ä¸šåŠ¡ï¼Œåˆ©ç”¨é€šç”¨é”™è¯¯é¡µé¢ï¼Œç›´æ¥è¿”å›é€šç”¨é”™è¯¯é¡µé¢</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>é¡µé¢ã€JSONï¼Œå¯ç”¨çš„Modelæ•°æ®å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251220220943114.png" alt="image-20251220220943114"></p>
<h4 id="8ã€åµŒå…¥å¼å®¹å™¨"><a href="#8ã€åµŒå…¥å¼å®¹å™¨" class="headerlink" title="8ã€åµŒå…¥å¼å®¹å™¨"></a>8ã€åµŒå…¥å¼å®¹å™¨</h4><blockquote>
<p>servletå®¹å™¨ï¼Œç®¡ç†ã€è¿è¡ŒServletç»„ä»¶ï¼ˆServletï¼ŒFilterï¼ŒListernerï¼‰çš„ç¯å¢ƒï¼Œä¸€èˆ¬æŒ‡æœåŠ¡å™¨</p>
</blockquote>
<h5 id="1ã€è‡ªåŠ¨é…ç½®åŸç†"><a href="#1ã€è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="1ã€è‡ªåŠ¨é…ç½®åŸç†"></a>1ã€è‡ªåŠ¨é…ç½®åŸç†</h5><blockquote>
<ul>
<li>SpringBoot é»˜è®¤åµŒâ¼ŠTomcatä½œä¸ºServletå®¹å™¨ã€‚ </li>
<li>â¾ƒåŠ¨é…ç½®ç±»æ˜¯  ServletWebServerFactoryAutoConfiguration  ï¼Œ  EmbeddedWebServer FactoryCustomizerAutoConfiguration </li>
<li>â¾ƒåŠ¨é…ç½®ç±»å¼€å§‹åˆ†æåŠŸèƒ½ã€‚<code>xxxxAutoConfiguration</code></li>
</ul>
</blockquote>
<p>é¦–å…ˆåˆ†æ<code>ServletWebServerFactoryAutoConfiguration</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfiguration</span></span><br><span class="line"><span class="meta">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)</span>  <span class="comment">// æœ€é«˜ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(ServletRequest.class)</span>        <span class="comment">// ä¾èµ–Servletç±»</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(type = Type.SERVLET)</span> <span class="comment">// Servletç±»å‹Webåº”ç”¨</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(ServerProperties.class)</span> <span class="comment">// ç»‘å®šæœåŠ¡å™¨é…ç½®</span></span><br><span class="line"><span class="meta">@Import(&#123;</span></span><br><span class="line"><span class="meta">    ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,</span></span><br><span class="line"><span class="meta">    ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,  // å¯¼å…¥Tomcat</span></span><br><span class="line"><span class="meta">    ServletWebServerFactoryConfiguration.EmbeddedJetty.class,   // å¯¼å…¥Jetty</span></span><br><span class="line"><span class="meta">    ServletWebServerFactoryConfiguration.EmbeddedUndertow.class // å¯¼å…¥Undertow</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletWebServerFactoryAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="comment">// è‡ªåŠ¨é…ç½®äº†åµŒå…¥å¼å®¹å™¨åœºæ™¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1ã€<code>ServletWebServerFactoryAutoConfiguration</code>è‡ªåŠ¨é…ç½®äº†åµŒå…¥å¼å®¹å™¨åœºæ™¯</p>
<p>2ã€ç»‘å®šäº† <code>ServerProperties</code>é…ç½®ç±»ï¼Œæ‰€æœ‰å’ŒæœåŠ¡å™¨æœ‰å…³çš„é…ç½® <code>server</code>å¼€å¤´çš„é…ç½®é‡Œé¢ã€‚ï¼ˆserverå¼€å§‹çš„éƒ½æ˜¯åµŒå…¥å¼å®¹å™¨ æœåŠ¡å™¨çš„é…ç½®ï¼‰</p>
<p>3ã€<code>ServletWebServerFactoryAutoConfiguration</code>  å¯¼â¼Šäº† åµŒâ¼Šå¼çš„ä¸‰â¼¤æœåŠ¡å™¨ <code>tomcat</code>ã€<code>Jetty</code> ã€ <code>Undertow</code></p>
<p>â€‹    a.  å¯¼â¼Š  <code>Tomcat</code>  ã€ <code>Jetty</code>  ã€ <code>Undertow</code>  éƒ½æœ‰æ¡ä»¶æ³¨è§£ã€‚ç³»ç»Ÿä¸­æœ‰è¿™ä¸ªç±»æ‰â¾ï¼ˆä¹Ÿå°±æ˜¯å¯¼äº† åŒ…ï¼‰</p>
<p>â€‹    b.  é»˜è®¤   <code>Tomcat</code>  é…ç½®â½£æ•ˆã€‚ç»™å®¹å™¨ä¸­æ”¾ <code>TomcatServletWebServerFactory</code> </p>
<p>â€‹    c.  éƒ½ç»™å®¹å™¨ä¸­  <code>ServletWebServerFactory</code> æ”¾äº†â¼€ä¸ª webæœåŠ¡å™¨â¼¯â¼šï¼ˆé€ webæœåŠ¡å™¨çš„ï¼‰</p>
<p>â€‹    d.  webæœåŠ¡å™¨â¼¯â¼š éƒ½æœ‰â¼€ä¸ªåŠŸèƒ½ï¼Œ <code>getWebServer</code>  è·å–webæœåŠ¡å™¨ </p>
<p>â€‹    e.  <code>TomcatServletWebServerFactory</code> åˆ›å»ºäº† <code>tomcat</code>ã€‚</p>
<ol>
<li><code>ServletWebServerFactory</code>ä»€ä¹ˆæ—¶å€™ä¼šåˆ›å»º <code>webServer</code>å‡ºæ¥ã€‚</li>
<li><code>ServletWebServerApplicationContext</code>iocå®¹å™¨ï¼Œå¯åŠ¨çš„æ—¶å€™ä¼šè°ƒâ½¤åˆ›å»ºwebæœåŠ¡å™¨ </li>
<li>Springå®¹å™¨åˆ·æ–°ï¼ˆå¯åŠ¨ï¼‰çš„æ—¶å€™ï¼Œä¼šé¢„ç•™â¼€ä¸ªæ—¶æœºï¼Œåˆ·æ–°â¼¦å®¹å™¨ã€‚ </li>
<li><code>refresh()</code> å®¹å™¨åˆ·æ–° ï¼ˆå®¹å™¨å¯åŠ¨ï¼‰ä¼šé¢„ç•™ä¸€ä¸ªæ—¶æœºï¼Œå®¹å™¨åˆ·æ–°åäºŒæ­¥åˆ·æ–°â¼¦å®¹å™¨ä¼šè°ƒâ½¤  <code>onRefresh()</code>  </li>
</ol>
<p>æ€»ç»“ï¼šWebåœºæ™¯çš„Springå®¹å™¨å¯åŠ¨ï¼Œåœ¨onRefreshçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åˆ›å»ºwebæœåŠ¡å™¨çš„æ–¹æ³•ã€‚</p>
<p>webæœåŠ¡å™¨çš„åˆ›å»ºæ˜¯é€šè¿‡webServerFactoryæå®šçš„ã€‚å®¹å™¨ä¸­ä¼šæ ¹æ®å¯¼äº†ä»€ä¹ˆåŒ…ï¼Œæ¡ä»¶æ³¨è§£ï¼Œå¯åŠ¨ç›¸å…³çš„æœåŠ¡å™¨é…ç½®ï¼Œæ¯”å¦‚é»˜è®¤åµŒå…¥å¼çš„tomcatå·¥å‚ï¼Œç„¶ååˆ›å»ºtomcatæœåŠ¡å™¨ã€‚</p>
<h5 id="2ã€è‡ªå®šä¹‰"><a href="#2ã€è‡ªå®šä¹‰" class="headerlink" title="2ã€è‡ªå®šä¹‰"></a>2ã€è‡ªå®šä¹‰</h5><p><strong>æ¡ˆä¾‹</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251221035229703.png" alt="image-20251221035229703"></p>
<blockquote>
<p>åˆ‡ æ¢æœåŠ¡å™¨</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-api.version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">servlet-api.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    	<span class="comment">&lt;!-- Exclude the Tomcat dependency --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Use Jetty instead --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="3ã€æœ€ä½³å®è·µ"><a href="#3ã€æœ€ä½³å®è·µ" class="headerlink" title="3ã€æœ€ä½³å®è·µ"></a>3ã€æœ€ä½³å®è·µ</h5><p>ç”¨æ³•ï¼š</p>
<ul>
<li>ä¿®æ”¹<code>server</code>ç›¸å…³é…ç½®å°±å¯ä»¥ä¿®æ”¹æœåŠ¡å™¨çš„å‚æ•°</li>
<li>é€šè¿‡ç»™å®¹å™¨ä¸­æ”¾ä¸€ä¸ª<code>ServletWebServerFactory</code>ï¼Œæ¥ç¦ç”¨æ‰SpringBooté»˜è®¤æ”¾çš„æœåŠ¡å™¨å·¥å‚ï¼Œå®ç°è‡ªå®šä¹‰åµŒå…¥ä»»æ„æœåŠ¡å™¨ã€‚</li>
</ul>
<h4 id="9ã€å…¨é¢æ¥ç®¡SpringMVC"><a href="#9ã€å…¨é¢æ¥ç®¡SpringMVC" class="headerlink" title="9ã€å…¨é¢æ¥ç®¡SpringMVC"></a>9ã€å…¨é¢æ¥ç®¡SpringMVC</h4><blockquote>
<p>SpringBoot é»˜è®¤é…ç½®å¥½äº† SpringMVC çš„æ‰€æœ‰å¸¸â½¤ç‰¹æ€§ã€‚ </p>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦å…¨â¾¯æ¥ç®¡SpringMVCçš„æ‰€æœ‰é…ç½®å¹¶ç¦â½¤é»˜è®¤é…ç½®ï¼Œä»…éœ€è¦ç¼–å†™â¼€ä¸ª  WebMvcConfigurer  é…ç½®ç±»ï¼Œå¹¶æ ‡æ³¨  @EnableWebMvc å³å¯ </p>
<p> å…¨â¼¿åŠ¨æ¨¡å¼ </p>
<ul>
<li><p>@EnableWebMvc : ç¦â½¤é»˜è®¤é…ç½® </p>
</li>
<li><p><strong>WebMvcConfigurer</strong>  ç»„ä»¶ï¼šå®šä¹‰MVCçš„åº•å±‚â¾ä¸º</p>
</li>
</ul>
</blockquote>
<h5 id="1ã€WebMvcAutoConfiguration-åˆ°åº•â¾ƒåŠ¨é…ç½®äº†å“ªäº›è§„åˆ™"><a href="#1ã€WebMvcAutoConfiguration-åˆ°åº•â¾ƒåŠ¨é…ç½®äº†å“ªäº›è§„åˆ™" class="headerlink" title="1ã€WebMvcAutoConfiguration åˆ°åº•â¾ƒåŠ¨é…ç½®äº†å“ªäº›è§„åˆ™"></a>1ã€WebMvcAutoConfiguration åˆ°åº•â¾ƒåŠ¨é…ç½®äº†å“ªäº›è§„åˆ™</h5><blockquote>
<p>SpringMVC â¾ƒåŠ¨é…ç½®åœºæ™¯ç»™æˆ‘ä»¬é…ç½®äº†å¦‚ä¸‹æ‰€æœ‰é»˜è®¤â¾ä¸º</p>
</blockquote>
<p>1ã€WebMvcAutoConfiguration  webåœºæ™¯çš„â¾ƒåŠ¨é…ç½®ç±» </p>
<p>â€‹    1.1.  â½€æŒRESTfulçš„filterï¼šHiddenHttpMethodFilter </p>
<p>â€‹    1.2.  â½€æŒâ¾®POSTè¯·æ±‚ï¼Œè¯·æ±‚ä½“æºå¸¦æ•°æ®ï¼šFormContentFilter </p>
<p>â€‹    1.3.  å¯¼â¼Š EnableWebMvcConfiguration  ï¼š </p>
<p>â€‹        1.3.1. RequestMappingHandlerAdapter  </p>
<p>â€‹        1.3.2. WelcomePageHandlerMapping  ï¼šæ¬¢è¿â»šåŠŸèƒ½â½€æŒï¼ˆæ¨¡æ¿å¼•æ“â½¬å½•ã€é™æ€èµ„æºâ½¬å½• æ”¾index.htmlï¼‰ï¼Œé¡¹â½¬è®¿é—®/ å°±é»˜è®¤å±•ç¤ºè¿™ä¸ªâ»šâ¾¯. </p>
<p>â€‹        1.3.3. RequestMappingHandlerMapping  ï¼šæ‰¾æ¯ä¸ªè¯·æ±‚ç”±è°å¤„ç†çš„æ˜ å°„å…³ç³» </p>
<p>â€‹        1.3.4. ExceptionHandlerExceptionResolver  ï¼šé»˜è®¤çš„å¼‚å¸¸è§£æå™¨  </p>
<p>â€‹        1.3.5. LocaleResolver  ï¼šå›½é™…åŒ–è§£æå™¨ </p>
<p>â€‹        1.3.6. ThemeResolver  ï¼šä¸»é¢˜è§£æå™¨ </p>
<p>â€‹        1.3.7. FlashMapManager  ï¼šä¸´æ—¶æ•°æ®å…±äº« </p>
<p>â€‹        1.3.8. FormattingConversionService  ï¼š æ•°æ®æ ¼å¼åŒ– ã€ç±»å‹è½¬åŒ– </p>
<p>â€‹        1.3.9. Validator  ï¼š æ•°æ®æ ¡éªŒ JSR303  æä¾›çš„æ•°æ®æ ¡éªŒåŠŸèƒ½ </p>
<p>â€‹        1.3.10. WebBindingInitializer  ï¼šè¯·æ±‚å‚æ•°çš„å°è£…ä¸ç»‘å®š </p>
<p>â€‹        1.3.11. ContentNegotiationManager  ï¼šå†…å®¹åå•†ç®¡ç†å™¨ </p>
<p>â€‹    1.4. WebMvcAutoConfigurationAdapter  é…ç½®â½£æ•ˆï¼Œå®ƒæ˜¯â¼€ä¸ª ä¹‰mvcåº•å±‚ç»„ä»¶ </p>
<p>â€‹        1.4.1.  å®šä¹‰å¥½  WebMvcConfigurer  ï¼Œå®š WebMvcConfigurer  åº•å±‚ç»„ä»¶é»˜è®¤åŠŸèƒ½ï¼›æ‰€æœ‰åŠŸèƒ½è¯¦â»…åˆ—è¡¨ </p>
<p>â€‹        1.4.2.  è§†å›¾è§£æå™¨ï¼š InternalResourceViewResolver  </p>
<p>â€‹        1.4.3.  è§†å›¾è§£æå™¨ï¼š BeanNameViewResolver  ,è§†å›¾åï¼ˆcontrollerâ½…æ³•çš„è¿”å›å€¼å­—ç¬¦ä¸²ï¼‰å°± æ˜¯ç»„ä»¶å </p>
<p>â€‹        1.4.4.  å†…å®¹åå•†è§£æå™¨ï¼š ContentNegotiatingViewResolver  </p>
<p>â€‹        1.4.5.  è¯·æ±‚ä¸Šä¸‹â½‚è¿‡æ»¤å™¨ï¼š RequestContextFilter  : ä»»æ„ä½ç½®ç›´æ¥è·å–å½“å‰è¯·æ±‚ </p>
<p>â€‹        1.4.6.  é™æ€èµ„æºé“¾è§„åˆ™ </p>
<p>â€‹        1.4.7. ProblemDetailsExceptionHandler  ï¼šé”™è¯¯è¯¦æƒ… </p>
<p>â€‹            1.4.7.1.  SpringMVCå†…éƒ¨åœºæ™¯å¼‚å¸¸è¢«å®ƒæ•è·ï¼š </p>
<p>â€‹     1.5. å®šä¹‰äº†MVCé»˜è®¤çš„åº•å±‚â¾ä¸º:  WebMvcConfigurer </p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">æ ¸å¿ƒå‚æ•°</th>
<th style="text-align:left">åŠŸèƒ½æè¿°</th>
<th style="text-align:left">Spring Boot é»˜è®¤æä¾›</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>addFormatters</strong></td>
<td style="text-align:left"><code>FormatterRegistry</code></td>
<td style="text-align:left"><strong>æ ¼å¼åŒ–å™¨</strong>ï¼šæ”¯æŒå±æ€§ä¸Š <code>@NumberFormat</code> å’Œ <code>@DateTimeFormat</code> çš„æ•°æ®ç±»å‹è½¬æ¢</td>
<td style="text-align:left"><code>GenericConversionService</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>getValidator</strong></td>
<td style="text-align:left">æ— </td>
<td style="text-align:left"><strong>æ•°æ®æ ¡éªŒ</strong>ï¼šæ ¡éªŒ <code>@Controller</code> ä¸Šä½¿ç”¨ <code>@Valid</code> æ ‡æ³¨çš„å‚æ•°åˆæ³•æ€§</td>
<td style="text-align:left">éœ€è¦å¯¼å…¥ <code>starter-validation</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>addInterceptors</strong></td>
<td style="text-align:left"><code>InterceptorRegistry</code></td>
<td style="text-align:left"><strong>æ‹¦æˆªå™¨</strong>ï¼šæ‹¦æˆªæ”¶åˆ°çš„æ‰€æœ‰è¯·æ±‚</td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>configureContentNegotiation</strong></td>
<td style="text-align:left"><code>ContentNegotiationConfigurer</code></td>
<td style="text-align:left"><strong>å†…å®¹åå•†</strong>ï¼šæ”¯æŒå¤šç§æ•°æ®æ ¼å¼è¿”å›ï¼Œéœ€è¦é…åˆæ”¯æŒè¿™ç§ç±»å‹çš„ <code>HttpMessageConverter</code></td>
<td style="text-align:left">æ”¯æŒ JSON</td>
</tr>
<tr>
<td style="text-align:left"><strong>configureMessageConverters</strong></td>
<td style="text-align:left"><code>List&lt;HttpMessageConverter&lt;?&gt;&gt;</code></td>
<td style="text-align:left"><strong>æ¶ˆæ¯è½¬æ¢å™¨</strong>ï¼šæ ‡æ³¨ <code>@ResponseBody</code> çš„è¿”å›å€¼ä¼šåˆ©ç”¨ <code>MessageConverter</code> ç›´æ¥å†™å‡ºå»</td>
<td style="text-align:left">8 ä¸ªï¼Œæ”¯æŒ byteã€stringã€multipartã€resourceã€json</td>
</tr>
<tr>
<td style="text-align:left"><strong>addViewControllers</strong></td>
<td style="text-align:left"><code>ViewControllerRegistry</code></td>
<td style="text-align:left"><strong>è§†å›¾æ˜ å°„</strong>ï¼šç›´æ¥å°†è¯·æ±‚è·¯å¾„ä¸ç‰©ç†è§†å›¾æ˜ å°„ï¼Œç”¨äºæ—  Java ä¸šåŠ¡é€»è¾‘çš„ç›´æ¥è§†å›¾é¡µæ¸²æŸ“</td>
<td style="text-align:left">æ—  <code>&lt;mvc:view-controller&gt;</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>configureViewResolvers</strong></td>
<td style="text-align:left"><code>ViewResolverRegistry</code></td>
<td style="text-align:left"><strong>è§†å›¾è§£æå™¨</strong>ï¼šé€»è¾‘è§†å›¾è½¬ä¸ºç‰©ç†è§†å›¾</td>
<td style="text-align:left"><code>ViewResolverComposite</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>addResourceHandlers</strong></td>
<td style="text-align:left"><code>ResourceHandlerRegistry</code></td>
<td style="text-align:left"><strong>é™æ€èµ„æºå¤„ç†</strong>ï¼šé™æ€èµ„æºè·¯å¾„æ˜ å°„ã€ç¼“å­˜æ§åˆ¶</td>
<td style="text-align:left"><code>ResourceHandlerRegistry</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>configureDefaultServletHandling</strong></td>
<td style="text-align:left"><code>DefaultServletHandlerConfigurer</code></td>
<td style="text-align:left"><strong>é»˜è®¤ Servlet</strong>ï¼šå¯ä»¥è¦†ç›– Tomcat çš„ DefaultServletï¼Œè®© <code>DispatcherServlet</code> æ‹¦æˆª <code>/</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>configurePathMatch</strong></td>
<td style="text-align:left"><code>PathMatchConfigurer</code></td>
<td style="text-align:left"><strong>è·¯å¾„åŒ¹é…</strong>ï¼šè‡ªå®šä¹‰ URL è·¯å¾„åŒ¹é…ï¼Œå¯ä»¥è‡ªåŠ¨ä¸ºæ‰€æœ‰è·¯å¾„åŠ ä¸ŠæŒ‡å®šå‰ç¼€ï¼Œæ¯”å¦‚ <code>/api</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>configureAsyncSupport</strong></td>
<td style="text-align:left"><code>AsyncSupportConfigurer</code></td>
<td style="text-align:left"><strong>å¼‚æ­¥æ”¯æŒ</strong>ï¼š</td>
<td style="text-align:left"><code>TaskExecutionAutoConfiguration</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>addCorsMappings</strong></td>
<td style="text-align:left"><code>CorsRegistry</code></td>
<td style="text-align:left"><strong>è·¨åŸŸ</strong>ï¼š</td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>addArgumentResolvers</strong></td>
<td style="text-align:left"><code>List&lt;HandlerMethodArgumentResolver&gt;</code></td>
<td style="text-align:left"><strong>å‚æ•°è§£æå™¨</strong>ï¼š</td>
<td style="text-align:left">MVC é»˜è®¤æä¾›</td>
</tr>
<tr>
<td style="text-align:left"><strong>addReturnValueHandlers</strong></td>
<td style="text-align:left"><code>List&lt;HandlerMethodReturnValueHandler&gt;</code></td>
<td style="text-align:left"><strong>è¿”å›å€¼è§£æå™¨</strong>ï¼š</td>
<td style="text-align:left">MVC é»˜è®¤æä¾›</td>
</tr>
<tr>
<td style="text-align:left"><strong>configureHandlerExceptionResolvers</strong></td>
<td style="text-align:left"><code>List&lt;HandlerExceptionResolver&gt;</code></td>
<td style="text-align:left"><strong>å¼‚å¸¸å¤„ç†å™¨</strong>ï¼š</td>
<td style="text-align:left">é»˜è®¤ 3 ä¸ªï¼š 1. <code>ExceptionHandlerExceptionResolver</code> 2. <code>ResponseStatusExceptionResolver</code> 3. <code>DefaultHandlerExceptionResolver</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>getMessageCodesResolver</strong></td>
<td style="text-align:left">æ— </td>
<td style="text-align:left"><strong>æ¶ˆæ¯ç è§£æå™¨</strong>ï¼šå›½é™…åŒ–ä½¿ç”¨</td>
<td style="text-align:left">æ— </td>
</tr>
</tbody>
</table>
</div>
<p><strong>æ•°æ®å¤„ç†ç±»</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åŠŸèƒ½</th>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">é»˜è®¤å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>æ•°æ®æ ¼å¼åŒ–</strong></td>
<td style="text-align:left"><code>addFormatters()</code></td>
<td style="text-align:left"><code>GenericConversionService</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>æ•°æ®æ ¡éªŒ</strong></td>
<td style="text-align:left"><code>getValidator()</code></td>
<td style="text-align:left">éœ€æ‰‹åŠ¨é…ç½®</td>
</tr>
<tr>
<td style="text-align:left"><strong>æ¶ˆæ¯è½¬æ¢</strong></td>
<td style="text-align:left"><code>configureMessageConverters()</code></td>
<td style="text-align:left">8 ç§è½¬æ¢å™¨</td>
</tr>
<tr>
<td style="text-align:left"><strong>å†…å®¹åå•†</strong></td>
<td style="text-align:left"><code>configureContentNegotiation()</code></td>
<td style="text-align:left">JSON æ”¯æŒ</td>
</tr>
</tbody>
</table>
</div>
<p><strong>è§†å›¾å¤„ç†ç±»</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åŠŸèƒ½</th>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">é»˜è®¤å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>è§†å›¾æ˜ å°„</strong></td>
<td style="text-align:left"><code>addViewControllers()</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>è§†å›¾è§£æ</strong></td>
<td style="text-align:left"><code>configureViewResolvers()</code></td>
<td style="text-align:left"><code>ViewResolverComposite</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>é™æ€èµ„æº</strong></td>
<td style="text-align:left"><code>addResourceHandlers()</code></td>
<td style="text-align:left"><code>ResourceHandlerRegistry</code></td>
</tr>
</tbody>
</table>
</div>
<p><strong>è¯·æ±‚å¤„ç†ç±»</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åŠŸèƒ½</th>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">é»˜è®¤å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>æ‹¦æˆªå™¨</strong></td>
<td style="text-align:left"><code>addInterceptors()</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>å‚æ•°è§£æ</strong></td>
<td style="text-align:left"><code>addArgumentResolvers()</code></td>
<td style="text-align:left">MVC é»˜è®¤</td>
</tr>
<tr>
<td style="text-align:left"><strong>è·¯å¾„åŒ¹é…</strong></td>
<td style="text-align:left"><code>configurePathMatch()</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>è·¨åŸŸæ”¯æŒ</strong></td>
<td style="text-align:left"><code>addCorsMappings()</code></td>
<td style="text-align:left">æ— </td>
</tr>
</tbody>
</table>
</div>
<p><strong>å¼‚å¸¸ä¸å›½é™…åŒ–</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åŠŸèƒ½</th>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">é»˜è®¤å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>å¼‚å¸¸å¤„ç†</strong></td>
<td style="text-align:left"><code>configureHandlerExceptionResolvers()</code></td>
<td style="text-align:left">3 ä¸ªè§£æå™¨</td>
</tr>
<tr>
<td style="text-align:left"><strong>å›½é™…åŒ–</strong></td>
<td style="text-align:left"><code>getMessageCodesResolver()</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>å¼‚æ­¥æ”¯æŒ</strong></td>
<td style="text-align:left"><code>configureAsyncSupport()</code></td>
<td style="text-align:left"><code>TaskExecutionAutoConfiguration</code><em>**</em></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Servlet å¤„ç†</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åŠŸèƒ½</th>
<th style="text-align:left">é…ç½®æ–¹æ³•</th>
<th style="text-align:left">é»˜è®¤å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>é»˜è®¤ Servlet</strong></td>
<td style="text-align:left"><code>configureDefaultServletHandling()</code></td>
<td style="text-align:left">æ— </td>
</tr>
<tr>
<td style="text-align:left"><strong>è¿”å›å€¼å¤„ç†</strong></td>
<td style="text-align:left"><code>addReturnValueHandlers()</code></td>
<td style="text-align:left">MVC é»˜è®¤</td>
</tr>
</tbody>
</table>
</div>
<h5 id="2ã€-EnableWebMvc-ç¦â½¤é»˜è®¤â¾ä¸º"><a href="#2ã€-EnableWebMvc-ç¦â½¤é»˜è®¤â¾ä¸º" class="headerlink" title="2ã€@EnableWebMvc ç¦â½¤é»˜è®¤â¾ä¸º"></a>2ã€@EnableWebMvc ç¦â½¤é»˜è®¤â¾ä¸º</h5><ol>
<li>@EnableWebMvc  ç»™å®¹å™¨ä¸­å¯¼â¼Š  DelegatingWebMvcConfiguration  ç»„ä»¶ï¼Œä»–æ˜¯  WebMvcConfigurationSupport  </li>
<li>WebMvcAutoConfiguration  æœ‰â¼€ä¸ªæ ¸â¼¼çš„æ¡ä»¶æ³¨è§£,  @ConditionalOnMissingBean(Web MvcConfigurationSupport.class)  ï¼Œå®¹å™¨ä¸­æ²¡æœ‰ WebMvcConfigurationSupport  ï¼Œ WebMvcAutoConfiguration  æ‰â½£æ•ˆ.</li>
<li>@EnableWebMvc å¯¼â¼Š  WebMvcConfigurationSupport  å¯¼è‡´  WebMvcAutoConfiguration  å¤±æ•ˆã€‚å¯¼è‡´ç¦â½¤äº†é»˜è®¤â¾ä¸º</li>
</ol>
<blockquote>
<p>@EnableWebMVC ç¦â½¤äº† Mvcçš„â¾ƒåŠ¨é…ç½® </p>
<p>WebMvcConfigurer å®šä¹‰SpringMVCåº•å±‚ç»„ä»¶çš„åŠŸèƒ½ç±»</p>
</blockquote>
<h4 id="10ã€æœ€ä½³å®æˆ˜"><a href="#10ã€æœ€ä½³å®æˆ˜" class="headerlink" title="10ã€æœ€ä½³å®æˆ˜"></a>10ã€æœ€ä½³å®æˆ˜</h4><p>æ‰€ä»¥ç”¨springbootè¿›è¡Œwebå¼€å‘æœ‰</p>
<h5 id="ä¸‰ç§æ–¹å¼"><a href="#ä¸‰ç§æ–¹å¼" class="headerlink" title="ä¸‰ç§æ–¹å¼"></a>ä¸‰ç§æ–¹å¼</h5><div class="table-container">
<table>
<thead>
<tr>
<th>å…¨è‡ªåŠ¨</th>
<th>ç›´æ¥ç¼–å†™æ§åˆ¶å™¨é€»è¾‘</th>
<th></th>
<th>å…¨éƒ¨ä½¿ç”¨è‡ªåŠ¨é…ç½®é»˜è®¤æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ‰‹è‡ªä¸€ä½“</td>
<td>@Configuration + é…ç½® WebMvcConfigurer + é…ç½®WebMvcRegistrations</td>
<td>ä¸è¦æ ‡æ³¨@EnableWebMvc</td>
<td>è‡ªåŠ¨é…ç½®æ•ˆæœï¼Œæ‰‹åŠ¨è®¾ç½®éƒ¨åˆ†åŠŸèƒ½ï¼Œå®šä¹‰MVCåº•å±‚ç»„ä»¶</td>
</tr>
<tr>
<td>å…¨æ‰‹åŠ¨</td>
<td>@Configuration + é…ç½® WebMvcConfigurer</td>
<td>æ ‡æ³¨@EnableWebMvc</td>
<td>ç¦ç”¨è‡ªåŠ¨é…ç½®æ•ˆæœï¼Œå…¨æ‰‹åŠ¨è®¾ç½®</td>
</tr>
</tbody>
</table>
</div>
<p>æ€»ç»“ï¼š<strong>ç»™å®¹å™¨ä¸­å†™ä¸€ä¸ªé…ç½®ç±» <code>@Configuration</code> ç»§æ‰¿ <code>WebMvcConfigurer</code> ä½†æ˜¯ä¸è¦æ ‡æ³¨ <code>@EnableWebMvc</code>ï¼Œå®ç°æ‰‹è‡ªä¸€ä½“çš„æ•ˆæœ</strong></p>
<h5 id="ä¸¤ç§æ¨¡å¼"><a href="#ä¸¤ç§æ¨¡å¼" class="headerlink" title="ä¸¤ç§æ¨¡å¼"></a>ä¸¤ç§æ¨¡å¼</h5><p>1ã€ å‰ååˆ†ç¦»æ¨¡å¼  ï¼š   @RestController   å“åº”JSONæ•°æ® </p>
<p>2ã€å‰åä¸åˆ†ç¦»æ¨¡å¼  ï¼š@Controller + Thymeleafæ¨¡æ¿å¼•æ“</p>
<h4 id="11ã€Webæ–°ç‰¹æ€§"><a href="#11ã€Webæ–°ç‰¹æ€§" class="headerlink" title="11ã€Webæ–°ç‰¹æ€§"></a>11ã€Webæ–°ç‰¹æ€§</h4><h5 id="1ã€Problemdetails"><a href="#1ã€Problemdetails" class="headerlink" title="1ã€Problemdetails"></a>1ã€Problemdetails</h5><blockquote>
<p>é”™è¯¯ä¿¡æ¯è¿”å›æ–°æ ¼å¼</p>
</blockquote>
<p>åŸç†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="comment">//é…ç½®è¿‡â¼€ä¸ªå±æ€§spring.mvc.problemdetails.enabled=true</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(prefix = &quot;spring.mvc.problemdetails&quot;, name = &quot;enabled&quot;, havingValue = &quot;true&quot;)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ProblemDetailsErrorHandlingConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean(ResponseEntityExceptionHandler.class)</span></span><br><span class="line">    ProblemDetailsExceptionHandler <span class="title function_">problemDetailsExceptionHandler</span><span class="params">()</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProblemDetailsExceptionHandler</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>ProblemDetailsExceptionHandler   æ˜¯â¼€ä¸ª  @ControllerAdvice  é›†ä¸­å¤„ç†ç³»ç»Ÿå¼‚å¸¸</li>
<li>å¤„ç†ä»¥ä¸‹å¼‚å¸¸ã€‚å¦‚æœç³»ç»Ÿå‡ºç°ä»¥ä¸‹å¼‚å¸¸ï¼Œä¼šè¢«SpringBootâ½€æŒä»¥  RFC 7807  è§„èŒƒâ½…å¼è¿”å›é”™è¯¯ æ•°æ®</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(&#123;</span></span><br><span class="line"><span class="meta">    HttpRequestMethodNotSupportedException.class, //è¯·æ±‚â½…å¼ä¸â½€æŒ</span></span><br><span class="line"><span class="meta">    HttpMediaTypeNotSupportedException.class,</span></span><br><span class="line"><span class="meta">    HttpMediaTypeNotAcceptableException.class,</span></span><br><span class="line"><span class="meta">    MissingPathVariableException.class,</span></span><br><span class="line"><span class="meta">    MissingServletRequestParameterException.class,</span></span><br><span class="line"><span class="meta">    MissingServletRequestPartException.class,</span></span><br><span class="line"><span class="meta">    ServletRequestBindingException.class,</span></span><br><span class="line"><span class="meta">    MethodArgumentNotValidException.class,</span></span><br><span class="line"><span class="meta">    NoHandlerFoundException.class,</span></span><br><span class="line"><span class="meta">    AsyncRequestTimeoutException.class,</span></span><br><span class="line"><span class="meta">    ErrorResponseException.class,</span></span><br><span class="line"><span class="meta">    ConversionNotSupportedException.class,</span></span><br><span class="line"><span class="meta">    TypeMismatchException.class,</span></span><br><span class="line"><span class="meta">    HttpMessageNotReadableException.class,</span></span><br><span class="line"><span class="meta">    HttpMessageNotWritableException.class,</span></span><br><span class="line"><span class="meta">    BindException.class</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ²¡å¼€å¯çš„æ•ˆæœï¼šé»˜è®¤å“åº”é”™è¯¯çš„jsonã€‚çŠ¶æ€ç 405.</p>
</blockquote>
<p>å¼€å¯ProblemDetailsè¿”å›, ä½¿â½¤æ–°çš„MediaType Content-Type: application/problem+json  + é¢å¤–æ‰©å±•è¿”å›</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251221142115532.png" alt="image-20251221142115532"></p>
<h5 id="2ã€å‡½æ•°å¼Web"><a href="#2ã€å‡½æ•°å¼Web" class="headerlink" title="2ã€å‡½æ•°å¼Web"></a>2ã€å‡½æ•°å¼Web</h5><p>ç”¨çš„ä¸å¤šï¼Œä»…åšäº†è§£ã€‚</p>
<blockquote>
<p>SpringMVC 5.2 ä»¥å å…è®¸æˆ‘ä»¬ä½¿â½¤å‡½æ•°å¼çš„â½…å¼ï¼Œå®šä¹‰Webçš„è¯·æ±‚å¤„ç†æµç¨‹ã€‚ </p>
<p>å‡½æ•°å¼æ¥â¼</p>
<p>Webè¯·æ±‚å¤„ç†çš„â½…å¼ï¼š </p>
<ol>
<li>@Controller + @RequestMapping  ï¼šè€¦åˆå¼ ï¼ˆè·¯ç”±ã€ä¸šåŠ¡è€¦åˆï¼‰ </li>
<li>å‡½æ•°å¼Webï¼šåˆ†ç¦»å¼ï¼ˆè·¯ç”±é›†ä¸­ç®¡ç†èµ·æ¥ã€å’Œä¸šåŠ¡åˆ†ç¦»ï¼‰</li>
</ol>
</blockquote>
<h6 id="1ã€åœºæ™¯"><a href="#1ã€åœºæ™¯" class="headerlink" title="1ã€åœºæ™¯"></a>1ã€åœºæ™¯</h6><blockquote>
<p>åœºæ™¯ï¼šUser RESTful - CRUD</p>
</blockquote>
<p>GET /user/1  è·å–1å·â½¤æˆ· </p>
<p>GET /users   è·å–æ‰€æœ‰â½¤æˆ· </p>
<p>POST /user  è¯·æ±‚ä½“æºå¸¦JSONï¼Œæ–°å¢â¼€ä¸ªâ½¤æˆ· </p>
<p>PUT /user/1 è¯·æ±‚ä½“æºå¸¦JSONï¼Œä¿®æ”¹1å·â½¤æˆ· </p>
<p>DELETE /user/1 åˆ é™¤1å·â½¤æˆ· </p>
<h6 id="2ã€æ ¸å¿ƒç±»"><a href="#2ã€æ ¸å¿ƒç±»" class="headerlink" title="2ã€æ ¸å¿ƒç±»"></a>2ã€æ ¸å¿ƒç±»</h6><ul>
<li>RouterFunction </li>
<li>RequestPredicate</li>
<li>ServerRequest</li>
<li>ServerResponse</li>
</ul>
<h6 id="3ã€ç¤ºä¾‹"><a href="#3ã€ç¤ºä¾‹" class="headerlink" title="3ã€ç¤ºä¾‹"></a>3ã€ç¤ºä¾‹</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.function.RequestPredicate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.function.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.function.ServerResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.web.servlet.function.RequestPredicates.accept;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.web.servlet.function.RouterFunctions.route;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡½æ•°å¼Webè·¯ç”±é…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ Spring 5.2+ å¼•å…¥çš„å‡½æ•°å¼Webæ¡†æ¶ï¼ˆSpring WebFluxé£æ ¼ï¼‰</span></span><br><span class="line"><span class="comment"> * æ›¿ä»£ä¼ ç»Ÿçš„ <span class="doctag">@Controller</span> + <span class="doctag">@RequestMapping</span> æ³¨è§£æ–¹å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Configuration</span>(proxyBeanMethods = false) ä¼˜åŒ–æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„ä»£ç†åˆ›å»º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRoutingConfiguration</span> &#123;  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚è°“è¯ï¼šå®šä¹‰åªæ¥å—JSONæ ¼å¼çš„è¯·æ±‚</span></span><br><span class="line"><span class="comment">     * é™æ€å¸¸é‡ï¼Œå¯ä»¥åœ¨å¤šä¸ªè·¯ç”±ä¸­å¤ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">RequestPredicate</span> <span class="variable">ACCEPT_JSON</span> <span class="operator">=</span> accept(MediaType.APPLICATION_JSON);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šä¹‰è·¯ç”±å‡½æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userHandler ç”¨æˆ·è¯·æ±‚å¤„ç†å™¨ï¼ˆSpringä¼šè‡ªåŠ¨æ³¨å…¥ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é…ç½®å¥½çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">routerFunction</span><span class="params">(MyUserHandler userHandler)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> route()</span><br><span class="line">                <span class="comment">// è·¯ç”±è§„åˆ™1: GET /&#123;user&#125; -&gt; è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">                .GET(<span class="string">&quot;/&#123;user&#125;&quot;</span>, ACCEPT_JSON, userHandler::getUser)</span><br><span class="line">                <span class="comment">// è·¯ç”±è§„åˆ™2: GET /&#123;user&#125;/customers -&gt; è·å–ç”¨æˆ·çš„å®¢æˆ·åˆ—è¡¨</span></span><br><span class="line">                .GET(<span class="string">&quot;/&#123;user&#125;/customers&quot;</span>, ACCEPT_JSON, userHandler::getUserCustomers)</span><br><span class="line">                <span class="comment">// è·¯ç”±è§„åˆ™3: DELETE /&#123;user&#125; -&gt; åˆ é™¤æŒ‡å®šç”¨æˆ·</span></span><br><span class="line">                .DELETE(<span class="string">&quot;/&#123;user&#125;&quot;</span>, ACCEPT_JSON, userHandler::deleteUser)</span><br><span class="line">                .build(); <span class="comment">// æ„å»ºè·¯ç”±å‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯·æ±‚å¤„ç†å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.function.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.function.ServerResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·è¯·æ±‚å¤„ç†å™¨</span></span><br><span class="line"><span class="comment"> * å¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œç±»ä¼¼äºä¼ ç»ŸControllerä¸­çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * ä½†ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹é£æ ¼ï¼Œæ›´åŠ æ¸…æ™°å’Œç±»å‹å®‰å…¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyUserHandler</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†è·å–ç”¨æˆ·è¯·æ±‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request æœåŠ¡å™¨è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«è¯·æ±‚å‚æ•°ã€è·¯å¾„å˜é‡ç­‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æœåŠ¡å™¨å“åº”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> ServerResponse <span class="title function_">getUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. ä»è¯·æ±‚ä¸­è·å–è·¯å¾„å˜é‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> request.pathVariable(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="comment">// 2. æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼ˆæŸ¥è¯¢æ•°æ®åº“ç­‰ï¼‰</span></span><br><span class="line">        <span class="comment">// User user = userService.findById(userId);</span></span><br><span class="line">        <span class="comment">// 3. æ„å»ºå“åº”</span></span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok()</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">                <span class="comment">// .body(user); // å®é™…åº”è¿”å›ç”¨æˆ·æ•°æ®</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†è·å–ç”¨æˆ·å®¢æˆ·åˆ—è¡¨è¯·æ±‚</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request æœåŠ¡å™¨è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æœåŠ¡å™¨å“åº”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> ServerResponse <span class="title function_">getUserCustomers</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–è·¯å¾„å˜é‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> request.pathVariable(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¯é€‰ï¼šè·å–æŸ¥è¯¢å‚æ•°</span></span><br><span class="line">        <span class="comment">// String page = request.param(&quot;page&quot;).orElse(&quot;1&quot;);</span></span><br><span class="line">        <span class="comment">// String size = request.param(&quot;size&quot;).orElse(&quot;20&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        <span class="comment">// List&lt;Customer&gt; customers = customerService.findByUserId(userId);</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok()</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">                <span class="comment">// .body(customers);</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†åˆ é™¤ç”¨æˆ·è¯·æ±‚</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request æœåŠ¡å™¨è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æœåŠ¡å™¨å“åº”ï¼ˆé€šå¸¸è¿”å›204 No Contentï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> ServerResponse <span class="title function_">deleteUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> request.pathVariable(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        <span class="comment">// userService.deleteById(userId);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ é™¤æˆåŠŸï¼Œè¿”å›204 No Content</span></span><br><span class="line">        <span class="keyword">return</span> ServerResponse.noContent().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3ã€æ•°æ®è®¿é—®"><a href="#3ã€æ•°æ®è®¿é—®" class="headerlink" title="3ã€æ•°æ®è®¿é—®"></a><strong>3ã€æ•°æ®è®¿é—®</strong></h3><h4 id="æ•´åˆSSMåœºæ™¯"><a href="#æ•´åˆSSMåœºæ™¯" class="headerlink" title="æ•´åˆSSMåœºæ™¯"></a>æ•´åˆSSMåœºæ™¯</h4><blockquote>
<p>SpringBoot  æ•´åˆ  Spring  ã€  SpringMVC  ã€  MyBatis è¿›â¾æ•°æ®è®¿é—®åœºæ™¯å¼€å‘</p>
</blockquote>
<h5 id="1ã€åˆ›å»ºSSMæ•´åˆé¡¹ç›®"><a href="#1ã€åˆ›å»ºSSMæ•´åˆé¡¹ç›®" class="headerlink" title="1ã€åˆ›å»ºSSMæ•´åˆé¡¹ç›®"></a>1ã€åˆ›å»ºSSMæ•´åˆé¡¹ç›®</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="2ã€é…ç½®æ•°æ®æº"><a href="#2ã€é…ç½®æ•°æ®æº" class="headerlink" title="2ã€é…ç½®æ•°æ®æº"></a>2ã€é…ç½®æ•°æ®æº</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://192.168.200.100:3306/demo</span></span><br><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.zaxxer.hikari.HikariDataSource</span></span><br></pre></td></tr></table></figure>
<p>å®‰è£…MyBatisX æ’ä»¶ï¼Œå¸®æˆ‘ä»¬â½£æˆMapperæ¥â¼çš„xmlâ½‚ä»¶å³å¯</p>
<h5 id="3ã€é…ç½®MyBatis"><a href="#3ã€é…ç½®MyBatis" class="headerlink" title="3ã€é…ç½®MyBatis"></a>3ã€é…ç½®MyBatis</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŒ‡å®šmapperæ˜ å°„â½‚ä»¶ä½ç½®</span></span><br><span class="line"><span class="attr">mybatis.mapper-locations</span>=<span class="string">classpath:/mapper/*.xml</span></span><br><span class="line"><span class="comment">#å‚æ•°é¡¹è°ƒæ•´</span></span><br><span class="line"><span class="attr">mybatis.configuration.map-underscore-to-camel-case</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<h5 id="4ã€CRUDç¼–å†™"><a href="#4ã€CRUDç¼–å†™" class="headerlink" title="4ã€CRUDç¼–å†™"></a>4ã€CRUDç¼–å†™</h5><p>ç¼–å†™Bean </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TUser</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String loginName;</span><br><span class="line">    <span class="keyword">private</span> String nickName;</span><br><span class="line">    <span class="keyword">private</span> String passwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™Mapper </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">//æ¯ä¸ªæ–¹æ³•éƒ½åœ¨Mapperæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªæ ‡ç­¾å¯¹åº”ï¼Œæ‰€æœ‰å‚æ•°éƒ½åº”è¯¥ç”¨@Paramè¿›è¡Œç­¾åï¼Œä»¥åä½¿ç”¨åˆ¶å®šçš„åå­—åœ¨SQLä¸­å–å€¼</span></span><br><span class="line">    <span class="keyword">public</span> TUser <span class="title function_">getUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿â½¤ mybatisx  æ’ä»¶ï¼Œ</p>
<p>å¿«é€Ÿâ½£æˆMapperXML </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ä¸Šé¢æ¥å£çš„å…¨ç±»åå’Œnamespaceå¯¹åº”å¥½--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.bitzh.bean.TUser&quot;</span>&gt;</span></span><br><span class="line">    select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å½“ç„¶å¦‚æœæ•°æ®åº“åå­—å’Œç±»åä¸ä¸€è‡´æ¯”å¦‚æ•°æ®åº“ä¸­æ˜¯nick_nameç±»ä¸­åå­—æ˜¯nickNameé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™åˆ«å</span></span><br><span class="line"><span class="comment">	select nick_name nickName from t_userè¿™æ ·ã€‚</span></span><br><span class="line"><span class="comment">	æˆ–è€…åœ¨é…ç½®propertiesæ–‡ä»¶ä¸­å¼€å¯é©¼å³°å‘½åï¼Œä¹Ÿå°±æ˜¯è¯´ _n = N</span></span><br><span class="line"><span class="comment">#å‚æ•°é¡¹è°ƒæ•´</span></span><br><span class="line"><span class="comment">mybatis.configuration.map-underscore-to-camel-case=true</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ç°åœ¨SpringBootè¿˜ä¸çŸ¥é“æˆ‘ä»¬çš„Mapperæ¥å£æ˜¯è®©MyBatisæ¥åšä»£ç†å¯¹è±¡è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„ã€‚</p>
<p>æ‰€ä»¥åœ¨ä¸»å¯åŠ¨ç±»é‡Œé¢ä½¿ç”¨æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(basePackages = &quot;com.bitzh.mapper&quot;)</span><span class="comment">//1ã€å‘Šè¯‰MyBatis,æ‰«æå“ªä¸ªæ¥å£</span></span><br><span class="line"><span class="comment">//2ã€å‘Šè¯‰MyBatisï¼Œæ¯ä¸ªæ¥å£çš„XMLæ–‡ä»¶éƒ½åœ¨å“ªé‡Œï¼Ÿåˆ©ç”¨é…ç½®é¡¹</span></span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•CRUD</p>
<h5 id="5ã€è‡ªåŠ¨é…ç½®åŸç†"><a href="#5ã€è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="5ã€è‡ªåŠ¨é…ç½®åŸç†"></a>5ã€è‡ªåŠ¨é…ç½®åŸç†</h5><p>SSMæ•´åˆæ€»ç»“ï¼š </p>
<ol>
<li><p>å¯¼â¼Š  mybatis-spring-boot-starter </p>
</li>
<li><p>é…ç½®æ•°æ®æºä¿¡æ¯ </p>
</li>
<li><p>é…ç½®mybatisçš„  mapper æ¥â¼æ‰«æ ä¸  xml æ˜ å°„â½‚ä»¶æ‰«æ </p>
</li>
<li><p>ç¼–å†™beanï¼Œmapperï¼Œâ½£æˆxmlï¼Œç¼–å†™sql è¿›â¾crudã€‚äº‹åŠ¡ç­‰æ“ä½œä¾ç„¶å’ŒSpringä¸­â½¤æ³•â¼€æ · </p>
</li>
<li><p>æ•ˆæœï¼š </p>
<p>â€‹    a.  æ‰€æœ‰sqlå†™åœ¨xmlä¸­</p>
<p>â€‹    b.  æ‰€æœ‰  mybatis é…ç½® å†™åœ¨  application.properties  ä¸‹â¾¯ </p>
<p><strong>jdbc åœºæ™¯çš„â¾ƒåŠ¨é…ç½®</strong>  ï¼š </p>
<p>mybatis-spring-boot-starter  å¯¼â¼Š  æ•°æ®åº“çš„åœºæ™¯ spring-boot-starter-jdbc  ï¼Œjdbcæ˜¯æ“ä½œæ•°æ®åº“çš„åœºæ™¯</p>
<p>Jdbc  åœºæ™¯çš„â¼ä¸ªâ¾ƒåŠ¨é…ç½® ï¼š</p>
<p>1ã€org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration  </p>
<p>â€‹    æ•°æ®æºçš„â¾ƒåŠ¨é…ç½® </p>
<p>â€‹    æ‰€æœ‰å’Œæ•°æ®æºæœ‰å…³çš„é…ç½®éƒ½ç»‘å®šåœ¨  DataSourceProperties  </p>
<p>â€‹    é»˜è®¤ä½¿â½¤  HikariDataSource </p>
<p>2ã€org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration </p>
<p>â€‹     ç»™å®¹å™¨ä¸­æ”¾äº† JdbcTemplate  æ“ä½œæ•°æ®åº“ </p>
<p>3ã€org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration </p>
<p>4ã€org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration </p>
<p>â€‹    åŸºäºXAâ¼†é˜¶æäº¤åè®®çš„åˆ†å¸ƒå¼äº‹åŠ¡æ•°æ®æº </p>
<p>5ã€org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration â½€æŒäº‹åŠ¡ </p>
<p>å…·æœ‰çš„åº•å±‚èƒ½â¼’ï¼šæ•°æ®æºã€ JdbcTemplate  ã€äº‹åŠ¡ </p>
</li>
</ol>
<p>   <strong>MyBatisAutoConfiguration</strong>  ï¼šé…ç½®äº†MyBatisçš„æ•´åˆæµç¨‹ </p>
<p>   mybatis-spring-boot-starter  å¯¼â¼Š  mybatis-spring-boot-autoconfigure ï¼ˆ mybatis çš„â¾ƒåŠ¨é…ç½®åŒ…ï¼‰  </p>
<p>   é»˜è®¤åŠ è½½ä¸¤ä¸ªâ¾ƒåŠ¨é…ç½®ç±»ï¼š         </p>
<p>   â€‹    org.mybatis.spring.boot.autoconfigure.MybatisLanguageDriverAutoConfiguration</p>
<p>   â€‹    org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration </p>
<p>   â€‹        å¿…é¡»åœ¨æ•°æ®æºé…ç½®å¥½ä¹‹åæ‰é…ç½® </p>
<p>   â€‹        ç»™å®¹å™¨ä¸­ SqlSessionFactory  ç»„ä»¶ã€‚åˆ›å»ºå’Œæ•°æ®åº“çš„â¼€æ¬¡ä¼šè¯ </p>
<p>   â€‹        ç»™å®¹å™¨ä¸­ SqlSessionTemplate  ç»„ä»¶ã€‚æ“ä½œæ•°æ®åº“ </p>
<p>   MyBatisçš„æ‰€æœ‰é…ç½®ç»‘å®šåœ¨ MybatisProperties  </p>
<p>   <strong>æ¯ä¸ªMapperæ¥â¼çš„ä»£ç†å¯¹è±¡æ˜¯æ€ä¹ˆåˆ›å»ºæ”¾åˆ°å®¹å™¨ä¸­</strong>ã€‚è¯¦â»…@MapperScanåŸç†ï¼š </p>
<p>   â€‹    åˆ©â½¤ @Import(MapperScannerRegistrar.class)  æ‰¹é‡ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ã€‚è§£ææŒ‡ å®šçš„åŒ…è·¯å¾„â¾¥â¾¯çš„æ¯â¼€ä¸ªç±»ï¼Œä¸ºæ¯â¼€ä¸ªMapperæ¥â¼ç±»ï¼Œåˆ›å»ºBeanå®šä¹‰ä¿¡æ¯ï¼Œæ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚</p>
<p>   è¿™é‡ŒMapperçš„ä»£ç†å¯¹è±¡åªæ˜¯ä¸ºäº†æ³¨å…¥iocï¼Œmybatisæ‰§è¡Œæ—¶æ ¹æ®mapperRegistryçš„mapperä¿¡æ¯å†åŸºäºåŸå‹æ¨¡å¼å’ŒjdkåŠ¨æ€ä»£ç†æ¯æ¬¡éƒ½ç”Ÿæˆmapperçš„ä»£ç†ç±»</p>
<blockquote>
<p>å¦‚ä½•åˆ†æå“ªä¸ªåœºæ™¯å¯¼â¼Šä»¥åï¼Œå¼€å¯äº†å“ªäº›â¾ƒåŠ¨é…ç½®ç±»ã€‚ æ‰¾ï¼š  classpath:/META-INF/spring/org.springframework.boot.autoconfigure. AutoConfiguration.imports  â½‚ä»¶ä¸­é…ç½®çš„æ‰€æœ‰å€¼ï¼Œå°±æ˜¯è¦å¼€å¯çš„â¾ƒåŠ¨é…ç½®ç±»ï¼Œä½†æ˜¯æ¯ä¸ª ç±»å¯èƒ½æœ‰æ¡ä»¶æ³¨è§£ï¼ŒåŸºäºæ¡ä»¶æ³¨è§£åˆ¤æ–­å“ªä¸ªâ¾ƒåŠ¨é…ç½®ç±»â½£æ•ˆäº†ã€‚ </p>
</blockquote>
<h5 id="6ã€å¿«é€Ÿå®šä½ç”Ÿæ•ˆçš„é…ç½®"><a href="#6ã€å¿«é€Ÿå®šä½ç”Ÿæ•ˆçš„é…ç½®" class="headerlink" title="6ã€å¿«é€Ÿå®šä½ç”Ÿæ•ˆçš„é…ç½®"></a>6ã€å¿«é€Ÿå®šä½ç”Ÿæ•ˆçš„é…ç½®</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œè¯¦ç»†æ‰“å°å¼€å¯äº†å“ªäº›â¾ƒåŠ¨é…ç½®</span></span><br><span class="line"><span class="attr">debug</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># Positive (â½£æ•ˆçš„â¾ƒåŠ¨é…ç½®ï¼‰Negativeï¼ˆä¸â½£æ•ˆçš„â¾ƒåŠ¨é…ç½®ï¼‰</span></span><br></pre></td></tr></table></figure>
<h5 id="7ã€æ•´åˆå…¶ä»–æ•°æ®æº"><a href="#7ã€æ•´åˆå…¶ä»–æ•°æ®æº" class="headerlink" title="7ã€æ•´åˆå…¶ä»–æ•°æ®æº"></a>7ã€æ•´åˆå…¶ä»–æ•°æ®æº</h5><h6 id="1ã€Druidæ•°æ®æº"><a href="#1ã€Druidæ•°æ®æº" class="headerlink" title="1ã€Druidæ•°æ®æº"></a>1ã€Druidæ•°æ®æº</h6><blockquote>
<p>æš‚ä¸â½€æŒ  SpringBoot3 </p>
<p>å¯¼â¼Š  druid-starter </p>
<p>å†™é…ç½® </p>
<p>åˆ†æâ¾ƒåŠ¨é…ç½®äº†å“ªäº›ä¸œâ»„ï¼Œæ€ä¹ˆâ½¤</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ•°æ®æºåŸºæœ¬é…ç½®</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://192.168.200.100:3306/demo</span></span><br><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="comment"># é…ç½®StatFilterç›‘æ§</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.stat.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.stat.db-type</span>=<span class="string">mysql</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.stat.log-slow-sql</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.stat.slow-sql-millis</span>=<span class="string">2000</span></span><br><span class="line"><span class="comment"># é…ç½®WallFilteré˜²â½•å¢™</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.wall.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.wall.db-type</span>=<span class="string">mysql</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.wall.config.delete-allow</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">spring.datasource.druid.filter.wall.config.drop-table-allow</span>=<span class="string">false</span></span><br><span class="line"><span class="comment"># é…ç½®ç›‘æ§â»šï¼Œå†…ç½®ç›‘æ§â»šâ¾¯çš„â¾¸â»šæ˜¯/druid/index.html</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.login-username</span>=<span class="string">admin</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.login-password</span>=<span class="string">admin</span></span><br><span class="line"><span class="attr">spring.datasource.druid.stat-view-servlet.allow</span>=<span class="string">*</span></span><br><span class="line"><span class="comment"># å…¶ä»–Filter é…ç½®ä¸å†æ¼”ç¤º</span></span><br><span class="line"><span class="comment"># â½¬å‰ä¸ºä»¥ä¸‹Filter æä¾›äº†é…ç½®â½€æŒï¼Œè¯·å‚è€ƒâ½‚æ¡£æˆ–è€…æ ¹æ®IDEæç¤ºï¼ˆspring.datasource.druid.filter.*ï¼‰è¿›â¾é…ç½®ã€‚</span></span><br><span class="line"><span class="comment"># StatFilter</span></span><br><span class="line"><span class="comment"># WallFilter</span></span><br><span class="line"><span class="comment"># ConfigFilter</span></span><br><span class="line"><span class="comment"># EncodingConvertFilter</span></span><br><span class="line"><span class="comment"># Slf4jLogFilter</span></span><br><span class="line"><span class="comment"># Log4jFilter</span></span><br><span class="line"><span class="comment"># Log4j2Filter</span></span><br><span class="line"><span class="comment"># CommonsLogFilter</span></span><br></pre></td></tr></table></figure>
<h3 id="4ã€åŸºç¡€ç‰¹æ€§"><a href="#4ã€åŸºç¡€ç‰¹æ€§" class="headerlink" title="4ã€åŸºç¡€ç‰¹æ€§"></a><strong>4ã€åŸºç¡€ç‰¹æ€§</strong></h3><h4 id="1ã€SpringApplication"><a href="#1ã€SpringApplication" class="headerlink" title="1ã€SpringApplication"></a>1ã€SpringApplication</h4><h5 id="1-1-è‡ªå®šä¹‰banner"><a href="#1-1-è‡ªå®šä¹‰banner" class="headerlink" title="1.1 è‡ªå®šä¹‰banner"></a>1.1 è‡ªå®šä¹‰banner</h5><p>å¯åŠ¨æ—¶å€™çš„å›¾æ ‡å°±æ˜¯banner</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç±»è·¯å¾„æ·»åŠ banner.txtæˆ–è®¾ç½®</span></span><br><span class="line"><span class="attr">spring.banner.location</span>  <span class="string"></span></span><br><span class="line"><span class="comment">#å°±å¯ä»¥å®šåˆ¶ banner</span></span><br><span class="line"><span class="comment"># å…³é—­banner</span></span><br><span class="line"><span class="attr">spring.main.banner-mode</span>=<span class="string">off </span></span><br></pre></td></tr></table></figure>
<p>å®šåˆ¶bannerç½‘ç«™ï¼š <a target="_blank" rel="noopener" href="https://www.bootschool.net/ascii">https://www.bootschool.net/ascii</a> </p>
<h5 id="1-2è‡ªå®šä¹‰SpringApplication"><a href="#1-2è‡ªå®šä¹‰SpringApplication" class="headerlink" title="1.2è‡ªå®šä¹‰SpringApplication"></a>1.2è‡ªå®šä¹‰SpringApplication</h5><p>ç„¶ååœ¨ä¸»å¯åŠ¨é‡Œé¢æ¯æ¬¡éƒ½æ˜¯<strong>SpringApplication.run</strong>ï¼Œç°åœ¨æˆ‘ä»¬è¦ç ”ç©¶è¿™ä¸ªã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span><span class="comment">//ä¸»ç¨‹åºç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootApplication</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//1ã€SpringApplicationæ˜¯Bootåº”ç”¨çš„æ ¸å¿ƒAPIå…¥å£</span></span><br><span class="line">        <span class="comment">//SpringApplication.run(BootApplication.class.args);ç‚¹å‡»æºç çœ‹å‡ºè¿™ä¸€æ­¥å¯ä»¥åˆ†è§£æˆ</span></span><br><span class="line">        <span class="comment">//æˆ‘ä»¬èƒ½æ‹†æˆä¸¤æ­¥æ¥å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½è‡ªå®šä¹‰applicationåº”ç”¨</span></span><br><span class="line">        <span class="comment">//1ã€è‡ªå®šä¹‰SpringApplicationçš„åº•å±‚è®¾ç½®</span></span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">springApplication</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(BootApplication.class);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ç„¶åè¿™é‡Œä¹Ÿå¯ä»¥è®¾ç½®bannerç­‰å„ç§åº•å±‚é…ç½®</span></span><br><span class="line">        <span class="comment">//application.setDefaultProperties()</span></span><br><span class="line">        <span class="comment">//è¿™ä¸ªé…ç½®ä¸ä¼˜å…ˆï¼Œä½†æ˜¯æœ‰ç”¨</span></span><br><span class="line">        application.setBannerMode(Banner.Mode.OFF);</span><br><span class="line">        <span class="comment">//2ã€SpringApplication è¿è¡Œèµ·æ¥</span></span><br><span class="line">        application.run(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-3FluentBuilder-API"><a href="#1-3FluentBuilder-API" class="headerlink" title="1.3FluentBuilder API"></a>1.3FluentBuilder API</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span><span class="comment">//ä¸»ç¨‹åºç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootApplication</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//ç¬¬äºŒç§è¿è¡Œçš„æ–¹å¼ï¼Œé€šè¿‡æµå¼APIè¿›è¡Œè®¾ç½®</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">SpringApplicationBuilder</span>()</span><br><span class="line">             .main(BootApplication.class)</span><br><span class="line">			.sources(BootApplication.class)</span><br><span class="line">			<span class="comment">//.child(Application.class)</span></span><br><span class="line">			.bannerMode(Banner.Mode.OFF)</span><br><span class="line">			.run(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2ã€Profiles"><a href="#2ã€Profiles" class="headerlink" title="2ã€Profiles"></a>2ã€Profiles</h4><blockquote>
<p>ç¯å¢ƒéš”ç¦»èƒ½åŠ›ï¼šå¿«é€Ÿåˆ‡æ¢å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒ</p>
<p>æ­¥éª¤ï¼š</p>
<p>1ã€æ ‡è¯†ç¯å¢ƒï¼ŒæŒ‡å®šå“ªäº›ç»„ä»¶ã€é…ç½®åœ¨é‚£ä¸ªç¯å¢ƒç”Ÿæ•ˆ</p>
<p>2ã€åˆ‡æ¢ç¯å¢ƒï¼šè¿™ä¸ªç¯å¢ƒå¯¹åº”çš„æ‰€æœ‰ç»„ä»¶å’Œé…ç½®å°±åº”è¯¥ç”Ÿæ•ˆ</p>
</blockquote>
<h5 id="2-1ä½¿ç”¨"><a href="#2-1ä½¿ç”¨" class="headerlink" title="2.1ä½¿ç”¨"></a>2.1ä½¿ç”¨</h5><h6 id="2-1-1-æŒ‡å®šç¯å¢ƒ"><a href="#2-1-1-æŒ‡å®šç¯å¢ƒ" class="headerlink" title="2.1.1 æŒ‡å®šç¯å¢ƒ"></a>2.1.1 æŒ‡å®šç¯å¢ƒ</h6><ul>
<li>Spring Profiles æä¾›ä¸€ç§ <strong>éš”ç¦»é…ç½®</strong> çš„æ–¹å¼ï¼Œä½¿å…¶ä»…åœ¨ <strong>ç‰¹å®šç¯å¢ƒ</strong> ç”Ÿæ•ˆ</li>
<li>ä»»ä½• <code>@Component</code> ï¼Œ <code>@Configuration</code> æˆ–è€… <code>@ConfigurationProperties</code> å¯ä»¥ä½¿ç”¨<code>@Profile</code>æ ‡è®°ï¼Œæ¥æŒ‡å®šä½•æ—¶è¢«åŠ è½½ ã€å®¹å™¨ä¸­çš„ç»„ä»¶éƒ½å¯ä»¥è¢« <code>@Profile</code>æ ‡è®°ã€‘</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1ã€æ ‡è¯†ç¯å¢ƒ</span></span><br><span class="line"><span class="comment">// 1ï¼‰åŒºåˆ†å‡ºå‡ ä¸ªç¯å¢ƒï¼š dev (å¼€å‘ç¯å¢ƒ) , testï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ï¼Œprodï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</span></span><br><span class="line"><span class="comment">// 2) æŒ‡å®šæ¯ä¸ªç»„ä»¶åœ¨é‚£ä¸ªç¯å¢ƒç”Ÿæ•ˆï¼šdefaultç¯å¢ƒï¼šé»˜è®¤ç¯å¢ƒ</span></span><br><span class="line"><span class="comment">//		ç»„ä»¶æ²¡æœ‰æ ‡æ³¨@Profileé‚£ä¹ˆå°±æ˜¯ä»»ä½•ç¯å¢ƒéƒ½ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment">// 3) é»˜è®¤åªæœ‰æ¿€æ´»æŒ‡å®šçš„ç¯å¢ƒï¼Œè¿™äº›ç»„ä»¶æ‰ä¼šç”Ÿæ•ˆ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç°åœ¨æˆ‘ä»¬æœ‰ç»„ä»¶,åº•å±‚å¯ä»¥æ”¾æ•°ç»„</span></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ç§å†™æ³•@Profile(&quot;dev&quot;)</span></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§@Profile(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆç¡®å®šå®¹å™¨ä¸­æœ‰æ²¡æœ‰è¿™ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬åˆ©ç”¨builderè¿”å›çš„ä¸Šä¸‹æ–‡æ¥</span></span><br><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplicationBuilder</span>();</span><br><span class="line">context.getBean(Cat.class);<span class="comment">//è¿™æ ·å°±çŸ¥é“åº”ç”¨ä¸­æœ‰æ²¡æœ‰äº†</span></span><br></pre></td></tr></table></figure>
<h6 id="2-1-2-æ¿€æ´»ç¯å¢ƒ"><a href="#2-1-2-æ¿€æ´»ç¯å¢ƒ" class="headerlink" title="2.1.2 æ¿€æ´»ç¯å¢ƒ"></a>2.1.2 æ¿€æ´»ç¯å¢ƒ</h6><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2ã€æ¿€æ´»ç¯å¢ƒ</span><br><span class="line">	é…ç½®æ–‡ä»¶æ¿€æ´»ï¼šspring.profiles.active=dev,test</span><br><span class="line">    å‘½ä»¤è¡Œæ¿€æ´»ï¼š java -jar xxx.jar  --spring.profiles.active=dev</span><br></pre></td></tr></table></figure>
<h6 id="2-1-3-ç¯å¢ƒåŒ…å«"><a href="#2-1-3-ç¯å¢ƒåŒ…å«" class="headerlink" title="2.1.3 ç¯å¢ƒåŒ…å«"></a>2.1.3 ç¯å¢ƒåŒ…å«</h6><p>æ³¨æ„ï¼š </p>
<ol>
<li><p>spring.profiles.active å’Œ spring.profiles.default åªèƒ½â½¤åˆ° â½† profile çš„â½‚ä»¶ä¸­ï¼Œå¦‚æœåœ¨ application-dev.yamlä¸­ç¼–å†™å°±æ˜¯â½†æ•ˆçš„ </p>
</li>
<li><p>ä¹Ÿå¯ä»¥é¢å¤–æ·»åŠ â½£æ•ˆâ½‚ä»¶ï¼Œâ½½ä¸æ˜¯æ¿€æ´»æ›¿æ¢ã€‚â½å¦‚ï¼š</p>
</li>
<li><p>```properties</p>
<h1 id="åŒ…å«åˆ¶å®šç¯å¢ƒï¼Œä¸ç®¡ä½ æ¿€æ´»å“ªä¸ªç¯å¢ƒï¼Œè¿™ä¸ªéƒ½è¦æœ‰-æ€»æ˜¯è¦ç”Ÿæ•ˆçš„"><a href="#åŒ…å«åˆ¶å®šç¯å¢ƒï¼Œä¸ç®¡ä½ æ¿€æ´»å“ªä¸ªç¯å¢ƒï¼Œè¿™ä¸ªéƒ½è¦æœ‰-æ€»æ˜¯è¦ç”Ÿæ•ˆçš„" class="headerlink" title="åŒ…å«åˆ¶å®šç¯å¢ƒï¼Œä¸ç®¡ä½ æ¿€æ´»å“ªä¸ªç¯å¢ƒï¼Œè¿™ä¸ªéƒ½è¦æœ‰,æ€»æ˜¯è¦ç”Ÿæ•ˆçš„"></a>åŒ…å«åˆ¶å®šç¯å¢ƒï¼Œä¸ç®¡ä½ æ¿€æ´»å“ªä¸ªç¯å¢ƒï¼Œè¿™ä¸ªéƒ½è¦æœ‰,æ€»æ˜¯è¦ç”Ÿæ•ˆçš„</h1><p>spring.profiles.include[0]=common<br>spring.profiles.include[1]=local</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æœ€ä½³å®æˆ˜ï¼š </span><br><span class="line"></span><br><span class="line">â½£æ•ˆçš„ç¯å¢ƒ = æ¿€æ´»çš„ç¯å¢ƒ/é»˜è®¤ç¯å¢ƒ  + åŒ…å«çš„ç¯å¢ƒ </span><br><span class="line"></span><br><span class="line">é¡¹â½¬â¾¥â¾¯è¿™ä¹ˆâ½¤ </span><br><span class="line"></span><br><span class="line">â€‹	åŸºç¡€çš„é…ç½® mybatis  ã€ log  ã€ xxx  ï¼šå†™åˆ°åŒ…å«ç¯å¢ƒä¸­ </span><br><span class="line"></span><br><span class="line">â€‹	éœ€è¦åŠ¨æ€åˆ‡æ¢å˜åŒ–çš„  db  ã€ redis  ï¼šå†™åˆ°æ¿€æ´»çš„ç¯å¢ƒä¸­</span><br><span class="line"></span><br><span class="line">##### 2.2Profile åˆ†ç»„</span><br><span class="line"></span><br><span class="line">åˆ›å»ºprodç»„ï¼ŒæŒ‡å®šåŒ…å«dbå’Œ mqé…ç½®</span><br><span class="line"></span><br><span class="line">```text</span><br><span class="line">spring.profiles.group.prod[0]=db</span><br><span class="line">spring.profiles.group.prod[1]=mq</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>ä½¿â½¤<code>--spring.profiles.active=prod</code>ï¼Œå°±ä¼šæ¿€æ´» <code>prod</code>ï¼Œ<code>dbï¼Œmq</code>é…ç½®â½‚ä»¶</p>
<h5 id="2-3-Profileé…ç½®æ–‡ä»¶"><a href="#2-3-Profileé…ç½®æ–‡ä»¶" class="headerlink" title="2.3 Profileé…ç½®æ–‡ä»¶"></a>2.3 Profileé…ç½®æ–‡ä»¶</h5><p><code>application-&#123;profile&#125;.properties</code> å¯ä»¥ä½œä¸ºæŒ‡å®šç¯å¢ƒçš„é…ç½®â½‚ä»¶ã€‚</p>
<p>æ¿€æ´»è¿™ä¸ªç¯å¢ƒï¼Œé…ç½®å°±ä¼šâ½£æ•ˆã€‚æœ€ç»ˆâ½£æ•ˆçš„æ‰€æœ‰é…ç½®æ˜¯ </p>
<pre><code> `application.properties ` ï¼šä¸»é…ç½®â½‚ä»¶ï¼Œä»»æ„æ—¶å€™éƒ½â½£æ•ˆ 
</code></pre><p>â€‹    <code>application-&#123;profile&#125;.properties</code>  ï¼šæŒ‡å®šç¯å¢ƒé…ç½®â½‚ä»¶ï¼Œæ¿€æ´»æŒ‡å®šç¯å¢ƒâ½£æ•ˆ</p>
<p> profileä¼˜å…ˆçº§ &gt; application</p>
<h4 id="3ã€å¤–éƒ¨åŒ–é…ç½®"><a href="#3ã€å¤–éƒ¨åŒ–é…ç½®" class="headerlink" title="3ã€å¤–éƒ¨åŒ–é…ç½®"></a>3ã€å¤–éƒ¨åŒ–é…ç½®</h4><blockquote>
<p>åœºæ™¯ï¼šçº¿ä¸Šåº”â½¤å¦‚ä½•å¿«é€Ÿä¿®æ”¹é…ç½®ï¼Œå¹¶åº”â½¤æœ€æ–°é…ç½®ï¼Ÿ </p>
<p> SpringBoot ä½¿â½¤  é…ç½®ä¼˜å…ˆçº§ + å¤–éƒ¨é…ç½®  ç®€åŒ–é…ç½®æ›´æ–°ã€ç®€åŒ–è¿ç»´ã€‚ åªéœ€è¦ç»™  jar  åº”â½¤æ‰€åœ¨çš„â½‚ä»¶å¤¹æ”¾â¼€ä¸ª  application.properties  æœ€æ–°é…ç½®â½‚ä»¶ï¼Œé‡ å¯é¡¹â½¬å°±èƒ½â¾ƒåŠ¨åº”â½¤æœ€æ–°é…ç½®</p>
</blockquote>
<h5 id="3-1-é…ç½®ä¼˜å…ˆçº§"><a href="#3-1-é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="3.1 é…ç½®ä¼˜å…ˆçº§"></a>3.1 é…ç½®ä¼˜å…ˆçº§</h5><p>Spring Boot å…è®¸å°†é…ç½®å¤–éƒ¨åŒ–ï¼Œä»¥ä¾¿å¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä½¿â½¤ç›¸åŒçš„åº”â½¤ç¨‹åºä»£ç ã€‚ </p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿â½¤å„ç§å¤–éƒ¨é…ç½®æºï¼ŒåŒ…æ‹¬ <code>Java Propertiesâ½‚ä»¶ã€</code> <code>YAMLâ½‚ä»¶</code>ã€ <code>ç¯å¢ƒå˜é‡</code> å’Œ <code>å‘½ä»¤â¾å‚æ•°</code>ã€‚</p>
<p> <code>@Value</code>å¯ä»¥è·å–å€¼ï¼Œä¹Ÿå¯ä»¥â½¤  <code>@ConfigurationProperties</code>å°†æ‰€æœ‰å±æ€§ç»‘å®šåˆ° <code>java object</code>ä¸­ </p>
<p>ä»¥ä¸‹æ˜¯ SpringBoot å±æ€§æºåŠ è½½é¡ºåºã€‚ åâ¾¯çš„ä¼šè¦†ç›–å‰â¾¯çš„å€¼ã€‚ç”±ä½åˆ°â¾¼ï¼Œâ¾¼ä¼˜å…ˆçº§é…ç½®è¦†ç›–ä½ ä¼˜å…ˆçº§ </p>
<ol>
<li><strong>é»˜è®¤å±æ€§</strong>ï¼ˆé€šè¿‡ <code>SpringApplication.setDefaultProperties</code>  æŒ‡å®šçš„ï¼‰ </li>
<li><code>@PropertySource</code>æŒ‡å®šåŠ è½½çš„é…ç½®ï¼ˆéœ€è¦å†™åœ¨ <code>@Configuration</code>ç±»ä¸Šæ‰å¯â½£æ•ˆï¼‰</li>
<li><strong>é…ç½®â½‚ä»¶</strong>ï¼ˆ <code>application.properties/yml</code>ç­‰ï¼‰</li>
<li><code>RandomValuePropertySource</code>â½€æŒçš„ <code>random.*</code>é…ç½®ï¼ˆå¦‚ï¼š<code>@Value(&quot;$&#123;random.int&#125;&quot;)ï¼‰</code> </li>
<li>OS ç¯å¢ƒå˜é‡ </li>
<li>Java ç³»ç»Ÿå±æ€§ï¼ˆ <code>System.getProperties()</code>ï¼‰ </li>
<li>JNDI å±æ€§ï¼ˆæ¥â¾ƒ <code>java:comp/env</code>ï¼‰ </li>
<li><code>ServletContext</code>åˆå§‹åŒ–å‚æ•° </li>
<li><code>ServletConfig</code>åˆå§‹åŒ–å‚æ•° </li>
<li><code>SPRING_APPLICATION_JSON</code>å±æ€§ï¼ˆå†…ç½®åœ¨ç¯å¢ƒå˜é‡æˆ–ç³»ç»Ÿå±æ€§ä¸­çš„ JSONï¼‰ </li>
<li><strong>å‘½ä»¤â¾å‚æ•°</strong> </li>
<li>æµ‹è¯•å±æ€§ã€‚( <code>@SpringBootTest</code>è¿›â¾æµ‹è¯•æ—¶æŒ‡å®šçš„å±æ€§) </li>
<li>æµ‹è¯•ç±» <code>@TestPropertySource</code>æ³¨è§£ </li>
<li>Devtools è®¾ç½®çš„å…¨å±€å±æ€§ã€‚<code>( $HOME/.config/spring-boot)</code></li>
</ol>
<blockquote>
<p>ç»“è®ºï¼šé…ç½®å¯ä»¥å†™åˆ°å¾ˆå¤šä½ç½®ï¼Œå¸¸â»…çš„ä¼˜å…ˆçº§é¡ºåºï¼š </p>
<p>å‘½ä»¤â¾ &gt; é…ç½®â½‚ä»¶ &gt;  springapplication é…ç½®</p>
</blockquote>
<p><strong>é…ç½®â½‚ä»¶ä¼˜å…ˆçº§</strong>å¦‚ä¸‹ï¼š(åâ¾¯è¦†ç›–å‰â¾¯)</p>
<p>1ã€  jar åŒ…å†…çš„ <code>application.properties/yml</code></p>
<p>2ã€jar åŒ…å†…çš„ <code>application-&#123;profile&#125;.properties/yml</code></p>
<p>3ã€jar åŒ…å¤–çš„ <code>application.properties/yml</code></p>
<p>4ã€ jar åŒ…å¤–çš„ <code>application-&#123;profile&#125;.properties/yml</code></p>
<p>å¦‚æœ å»ºè®®ï¼šâ½¤â¼€ç§æ ¼å¼çš„é…ç½®â½‚ä»¶ã€‚ .properties å’Œ ç»“ .yml åŒæ—¶å­˜åœ¨ , åˆ™ .properties ä¼˜å…ˆ  </p>
<p><strong>ç»“è®ºï¼š åŒ…å¤– &gt;  åŒ…å†… ï¼› åŒçº§æƒ…å†µï¼š  profile é…ç½® &gt; application é…ç½®</strong></p>
<p>æ‰€æœ‰å‚æ•°å‡å¯ç”±å‘½ä»¤â¾ä¼ â¼Šï¼Œ<code>ä½¿â½¤ --å‚æ•°é¡¹ = å‚æ•°å€¼</code>  ï¼Œå°†ä¼šè¢«æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œå¹¶ä¼˜å…ˆäº ç½®â½‚ä»¶ ã€‚ â½å¦‚ <code>java -jar app.jar --name=&quot;Spring&quot;</code> ,å¯ä»¥ä½¿â½¤ <code>server.port=8000  @Value(&quot;$&#123;name&#125;&quot;)</code>è·å–</p>
<p>æ¼”ç¤ºåœºæ™¯ï¼š </p>
<p>â€‹    åŒ…å†…ï¼š application.properties    server.port=8000 </p>
<p>â€‹    åŒ…å†…ï¼š application-dev.properties     server.port=9000 </p>
<p>â€‹    åŒ…å¤–ï¼š  application.properties    server.port=8001</p>
<p>â€‹    åŒ…å¤–ï¼š application-dev.properties     server.port=9001</p>
<p>å¯åŠ¨ç«¯â¼ï¼Ÿï¼šå‘½ä»¤â¾ &gt; 9001  &gt;  8001  &gt;  9000  &gt;  8000</p>
<h5 id="3-2-å¤–éƒ¨é…ç½®"><a href="#3-2-å¤–éƒ¨é…ç½®" class="headerlink" title="3.2 å¤–éƒ¨é…ç½®"></a>3.2 å¤–éƒ¨é…ç½®</h5><p>SpringBoot åº”â½¤å¯åŠ¨æ—¶ä¼šâ¾ƒåŠ¨å¯»æ‰¾ <code>application.properties</code>å’Œ <code>application.yaml</code>ä½ç½®ï¼Œè¿›â¾åŠ è½½ã€‚ </p>
<p>é¡ºåºå¦‚ä¸‹ï¼šï¼ˆåâ¾¯è¦†ç›–å‰â¾¯ï¼‰ </p>
<ol>
<li>ç±»è·¯å¾„: å†…éƒ¨ </li>
</ol>
<p>â€‹    a.  ç±»æ ¹è·¯å¾„ </p>
<p>â€‹    b.  ç±»ä¸‹ /configåŒ… </p>
<ol>
<li><p>å½“å‰è·¯å¾„ï¼ˆé¡¹â½¬æ‰€åœ¨çš„ä½ç½®ï¼‰ </p>
<p>  a.  å½“å‰è·¯å¾„ </p>
<p>  b.  å½“å‰ä¸‹ /configâ¼¦â½¬å½• </p>
<p>  c. /configâ½¬å½•çš„ç›´æ¥â¼¦â½¬å½•</p>
</li>
</ol>
<p>æœ€ç»ˆæ•ˆæœï¼šä¼˜å…ˆçº§ç”±â¾¼åˆ°ä½ï¼Œå‰â¾¯è¦†ç›–åâ¾¯ </p>
<p>å‘½ä»¤â¾ &gt; åŒ…å¤–configç›´æ¥â¼¦â½¬å½• &gt; åŒ…å¤–configâ½¬å½• &gt; åŒ…å¤–æ ¹â½¬å½• &gt; åŒ…å†…â½¬å½• </p>
<p>åŒçº§â½è¾ƒï¼š  </p>
<p>â€‹            profileé…ç½® &gt; é»˜è®¤é…ç½® </p>
<p>â€‹            propertiesé…ç½® &gt; yamlé…ç½®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251222180321086.png" alt="image-20251222180321086"></p>
<p>è§„å¾‹ï¼šæœ€å¤–å±‚çš„æœ€ä¼˜å…ˆã€‚</p>
<p><code>å‘½ä»¤â¾ &gt; æ‰€æœ‰ åŒ…å¤– &gt; åŒ…å†… configâ½¬å½• &gt; æ ¹â½¬å½• profile &gt; application</code></p>
<p>é…ç½®ä¸åŒå°±éƒ½â½£æ•ˆï¼ˆäº’è¡¥ï¼‰ï¼Œé…ç½®ç›¸åŒâ¾¼ä¼˜å…ˆçº§è¦†ç›–ä½ä¼˜å…ˆçº§</p>
<h5 id="3-3-å¯¼å…¥é…ç½®"><a href="#3-3-å¯¼å…¥é…ç½®" class="headerlink" title="3.3 å¯¼å…¥é…ç½®"></a>3.3 å¯¼å…¥é…ç½®</h5><p>ä½¿â½¤ <code>spring.config.import</code>å¯ä»¥å¯¼â¼Šé¢å¤–é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.config.import</span>=<span class="string">my.properties</span></span><br><span class="line"><span class="attr">my.property</span>=<span class="string">value</span></span><br></pre></td></tr></table></figure>
<p>â½†è®ºä»¥ä¸Šå†™æ³•çš„å…ˆåé¡ºåºï¼Œ my.propertiesçš„å€¼æ€»æ˜¯ä¼˜å…ˆäºç›´æ¥åœ¨â½‚ä»¶ä¸­ç¼–å†™çš„ </p>
<h5 id="3-4-å±æ€§å ä½ç¬¦"><a href="#3-4-å±æ€§å ä½ç¬¦" class="headerlink" title="3.4 å±æ€§å ä½ç¬¦"></a>3.4 å±æ€§å ä½ç¬¦</h5><p>é…ç½®â½‚ä»¶ä¸­å¯ä»¥ä½¿â½¤  ${name:default}å½¢å¼å–å‡ºä¹‹å‰é…ç½®è¿‡çš„å€¼ã€‚</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">app.name</span>=<span class="string">MyApp</span></span><br><span class="line"><span class="attr">app.description</span>=<span class="string">$&#123;app.name&#125; is a Spring Boot application written by $&#123;username:Unknown&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="4ã€å•å…ƒæµ‹è¯•-JUnit5"><a href="#4ã€å•å…ƒæµ‹è¯•-JUnit5" class="headerlink" title="4ã€å•å…ƒæµ‹è¯•-JUnit5"></a>4ã€å•å…ƒæµ‹è¯•-JUnit5</h4><h5 id="4-1-æ•´åˆ"><a href="#4-1-æ•´åˆ" class="headerlink" title="4.1 æ•´åˆ"></a>4.1 æ•´åˆ</h5><p>SpringBoot æä¾›â¼€ç³»åˆ—æµ‹è¯•â¼¯å…·é›†åŠæ³¨è§£â½…ä¾¿æˆ‘ä»¬è¿›â¾æµ‹è¯•ã€‚ <code>spring-boot-test</code>æä¾›æ ¸â¼¼æµ‹è¯•èƒ½â¼’ï¼Œ ç½®ã€‚ æˆ‘ä»¬åªéœ€è¦å¯¼â¼Š <code>spring-boot-test-autoconfigure</code> æä¾›æµ‹è¯•çš„â¼€äº›â¾ƒåŠ¨é… <code>spring-boot-starter-test</code>å³å¯æ•´åˆæµ‹è¯•</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>spring-boot-starter-test</code> é»˜è®¤æä¾›äº†ä»¥ä¸‹åº“ä¾›æˆ‘ä»¬æµ‹è¯•ä½¿â½¤  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JUnit 5 </span><br><span class="line">Spring Test </span><br><span class="line">AssertJ </span><br><span class="line">Hamcrest </span><br><span class="line">Mockito </span><br><span class="line">JSONassert </span><br><span class="line">JsonPat</span><br></pre></td></tr></table></figure>
<h5 id="4-2-æµ‹è¯•"><a href="#4-2-æµ‹è¯•" class="headerlink" title="4.2 æµ‹è¯•"></a>4.2 æµ‹è¯•</h5><h6 id="4-2-0-ç»„ä»¶æµ‹è¯•"><a href="#4-2-0-ç»„ä»¶æµ‹è¯•" class="headerlink" title="4.2.0 ç»„ä»¶æµ‹è¯•"></a>4.2.0 ç»„ä»¶æµ‹è¯•</h6><p>ç›´æ¥ <code>@Autowired</code> å®¹å™¨ä¸­çš„ç»„ä»¶è¿›è¡Œæµ‹è¯•</p>
<h6 id="4-2-1-æ³¨è§£"><a href="#4-2-1-æ³¨è§£" class="headerlink" title="4.2.1 æ³¨è§£"></a>4.2.1 æ³¨è§£</h6><p>Junit5çš„æ³¨è§£å’ŒJunit4çš„æ³¨è§£æœ‰æ‰€å˜åŒ–</p>
<p><a target="_blank" rel="noopener" href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations">https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Test :è¡¨ç¤ºâ½…æ³•æ˜¯æµ‹è¯•â½…æ³•ã€‚ä½†æ˜¯ä¸JUnit4çš„@Testä¸åŒï¼Œä»–çš„èŒè´£â¾®å¸¸å•â¼€ä¸èƒ½å£°æ˜ä»»ä½•å±æ€§ï¼Œæ‹“å±•çš„æµ‹è¯•å°†ä¼šç”±Jupiteræä¾›é¢å¤–æµ‹è¯•</span><br><span class="line">@ParameterizedTest :è¡¨ç¤ºâ½…æ³•æ˜¯å‚æ•°åŒ–æµ‹è¯•ï¼Œä¸‹â½…ä¼šæœ‰è¯¦ç»†ä»‹ç»</span><br><span class="line">@RepeatedTest :è¡¨ç¤ºâ½…æ³•å¯é‡å¤æ‰§â¾ï¼Œä¸‹â½…ä¼šæœ‰è¯¦ç»†ä»‹ç»</span><br><span class="line">@DisplayName :ä¸ºæµ‹è¯•ç±»æˆ–è€…æµ‹è¯•â½…æ³•è®¾ç½®å±•ç¤ºåç§°</span><br><span class="line">@BeforeAll :è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹å‰æ‰§â¾</span><br><span class="line">@BeforeEach :è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹å‰æ‰§â¾</span><br><span class="line">@AfterEach :è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹åæ‰§â¾</span><br><span class="line">@AfterAll :è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹åæ‰§â¾</span><br><span class="line">@Tag :è¡¨ç¤ºå•å…ƒæµ‹è¯•ç±»åˆ«ï¼Œç±»ä¼¼äºJUnit4ä¸­çš„@Categories</span><br><span class="line">@Disabled :è¡¨ç¤ºæµ‹è¯•ç±»æˆ–æµ‹è¯•â½…æ³•ä¸æ‰§â¾ï¼Œç±»ä¼¼äºJUnit4ä¸­çš„@Ignore</span><br><span class="line">@Timeout :è¡¨ç¤ºæµ‹è¯•â½…æ³•è¿â¾å¦‚æœè¶…è¿‡äº†æŒ‡å®šæ—¶é—´å°†ä¼šè¿”å›é”™è¯¯</span><br><span class="line">@ExtendWith :ä¸ºæµ‹è¯•ç±»æˆ–æµ‹è¯•â½…æ³•æä¾›æ‰©å±•ç±»å¼•ç”¨</span><br></pre></td></tr></table></figure>
<h6 id="4-2-2-æ–­è¨€"><a href="#4-2-2-æ–­è¨€" class="headerlink" title="4.2.2 æ–­è¨€"></a>4.2.2 æ–­è¨€</h6><div class="table-container">
<table>
<thead>
<tr>
<th><strong>æ–­è¨€æ–¹æ³•</strong></th>
<th><strong>ä½œç”¨è¯´æ˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>assertEquals(expected, actual)</code></td>
<td>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æˆ–åŸå§‹ç±»å‹æ˜¯å¦<strong>ç›¸ç­‰</strong>ï¼ˆè°ƒç”¨ <code>equals()</code> æ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼‰</td>
</tr>
<tr>
<td><code>assertNotEquals(expected, actual)</code></td>
<td>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æˆ–åŸå§‹ç±»å‹æ˜¯å¦<strong>ä¸ç›¸ç­‰</strong></td>
</tr>
<tr>
<td><code>assertSame(expected, actual)</code></td>
<td>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æ˜¯å¦<strong>æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</strong>ï¼ˆä½¿ç”¨ <code>==</code> æ¯”è¾ƒå¼•ç”¨ï¼‰</td>
</tr>
<tr>
<td><code>assertNotSame(expected, actual)</code></td>
<td>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æ˜¯å¦<strong>æŒ‡å‘ä¸åŒçš„å¯¹è±¡</strong></td>
</tr>
<tr>
<td><code>assertTrue(condition)</code></td>
<td>åˆ¤æ–­ç»™å®šçš„å¸ƒå°”è¡¨è¾¾å¼æ˜¯å¦ä¸º <strong>true</strong></td>
</tr>
<tr>
<td><code>assertFalse(condition)</code></td>
<td>åˆ¤æ–­ç»™å®šçš„å¸ƒå°”è¡¨è¾¾å¼æ˜¯å¦ä¸º <strong>false</strong></td>
</tr>
<tr>
<td><code>assertNull(object)</code></td>
<td>åˆ¤æ–­ç»™å®šçš„å¯¹è±¡å¼•ç”¨æ˜¯å¦ä¸º <strong>null</strong></td>
</tr>
<tr>
<td><code>assertNotNull(object)</code></td>
<td>åˆ¤æ–­ç»™å®šçš„å¯¹è±¡å¼•ç”¨æ˜¯å¦<strong>ä¸ä¸º null</strong></td>
</tr>
<tr>
<td><code>assertArrayEquals(expectedArray, actualArray)</code></td>
<td>åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦<strong>å†…å®¹ç›¸ç­‰</strong>ï¼ˆé€å…ƒç´ æ¯”è¾ƒï¼‰</td>
</tr>
<tr>
<td><code>assertAll(() -&gt; &#123;...&#125;, () -&gt; &#123;...&#125;, ...)</code></td>
<td><strong>ç»„åˆå¤šä¸ªæ–­è¨€</strong>ï¼Œå³ä½¿å…¶ä¸­æŸä¸ªå¤±è´¥ï¼Œå…¶ä½™ä¹Ÿä¼šç»§ç»­æ‰§è¡Œï¼ˆå¸¸ç”¨äºä¸€æ¬¡æ€§éªŒè¯å¤šä¸ªæ¡ä»¶ï¼‰</td>
</tr>
<tr>
<td><code>assertThrows(expectedExceptionClass, executable)</code></td>
<td>éªŒè¯æ‰§è¡ŒæŸæ®µä»£ç æ—¶æ˜¯å¦<strong>æŠ›å‡ºæŒ‡å®šç±»å‹çš„å¼‚å¸¸</strong></td>
</tr>
<tr>
<td><code>assertTimeout(Duration, executable)</code></td>
<td>éªŒè¯æŸæ®µä»£ç æ˜¯å¦åœ¨<strong>æŒ‡å®šæ—¶é—´å†…å®Œæˆæ‰§è¡Œ</strong>ï¼Œè¶…æ—¶åˆ™æµ‹è¯•å¤±è´¥</td>
</tr>
<tr>
<td><code>fail(message)</code></td>
<td><strong>å¼ºåˆ¶ä½¿æµ‹è¯•å¤±è´¥</strong>ï¼Œé€šå¸¸ç”¨äºéªŒè¯â€œæœ¬ä¸è¯¥æ‰§è¡Œåˆ°æ­¤å¤„â€çš„é€»è¾‘</td>
</tr>
</tbody>
</table>
</div>
<h6 id="4-2-3-åµŒå¥—æµ‹è¯•"><a href="#4-2-3-åµŒå¥—æµ‹è¯•" class="headerlink" title="4.2.3 åµŒå¥—æµ‹è¯•"></a>4.2.3 åµŒå¥—æµ‹è¯•</h6><blockquote>
<p>JUnit 5 å¯ä»¥é€šè¿‡ Java ä¸­çš„å†…éƒ¨ç±»å’Œ@Nested æ³¨è§£å®ç°åµŒå¥—æµ‹è¯•ï¼Œä»â½½å¯ä»¥æ›´å¥½çš„æŠŠç›¸å…³çš„æµ‹ è¯•â½…æ³•ç»„ç»‡åœ¨â¼€èµ·ã€‚åœ¨å†…éƒ¨ç±»ä¸­å¯ä»¥ä½¿â½¤@BeforeEach å’Œ@AfterEach æ³¨è§£ï¼Œâ½½ä¸”åµŒå¥—çš„å±‚æ¬¡ æ²¡æœ‰é™åˆ¶ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.*;</span><br><span class="line"><span class="keyword">import</span> java.util.EmptyStackException;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="meta">@DisplayName(&quot;æ ˆï¼ˆStackï¼‰&quot;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StackTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    Stack&lt;Object&gt; stack;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;å¯ä»¥é€šè¿‡ new Stack() å®ä¾‹åŒ–&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">canBeInstantiatedWithNew</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nested</span></span><br><span class="line">    <span class="meta">@DisplayName(&quot;å½“æ ˆæ˜¯æ–°å»ºçš„&quot;)</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">WhenNew</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@BeforeEach</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">createNewStack</span><span class="params">()</span> &#123;</span><br><span class="line">            stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;æ ˆæ˜¯ç©ºçš„&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">            assertTrue(stack.isEmpty());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;å¼¹å‡ºå…ƒç´ æ—¶æŠ›å‡º EmptyStackException&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">throwsExceptionWhenPopped</span><span class="params">()</span> &#123;</span><br><span class="line">            assertThrows(EmptyStackException.class, stack::pop);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;æŸ¥çœ‹æ ˆé¡¶æ—¶æŠ›å‡º EmptyStackException&quot;)</span></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">throwsExceptionWhenPeeked</span><span class="params">()</span> &#123;</span><br><span class="line">            assertThrows(EmptyStackException.class, stack::peek);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Nested</span></span><br><span class="line">        <span class="meta">@DisplayName(&quot;å‹å…¥ä¸€ä¸ªå…ƒç´ ä¹‹å&quot;)</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">AfterPushingElement</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">testElement</span> <span class="operator">=</span> <span class="string">&quot;ä¸€ä¸ªæµ‹è¯•å…ƒç´ &quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@BeforeEach</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">pushAnElement</span><span class="params">()</span> &#123;</span><br><span class="line">                stack.push(testElement);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;æ ˆä¸å†ä¸ºç©º&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">isNotEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">                assertFalse(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;å¼¹å‡ºæ—¶è¿”å›è¯¥å…ƒç´ ï¼Œå¹¶ä¸”æ ˆå˜ä¸ºç©º&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">popReturnsElementAndEmptiesStack</span><span class="params">()</span> &#123;</span><br><span class="line">                assertEquals(testElement, stack.pop());</span><br><span class="line">                assertTrue(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Test</span></span><br><span class="line">            <span class="meta">@DisplayName(&quot;æŸ¥çœ‹æ ˆé¡¶è¿”å›è¯¥å…ƒç´ ï¼Œä¸”æ ˆä»ä¸ä¸ºç©º&quot;)</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">peekReturnsElementAndStackRemainsNotEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">                assertEquals(testElement, stack.peek());</span><br><span class="line">                assertFalse(stack.isEmpty());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="4-2-4-å‚æ•°åŒ–æµ‹è¯•"><a href="#4-2-4-å‚æ•°åŒ–æµ‹è¯•" class="headerlink" title="4.2.4 å‚æ•°åŒ–æµ‹è¯•"></a>4.2.4 å‚æ•°åŒ–æµ‹è¯•</h6><p>å‚æ•°åŒ–æµ‹è¯•æ˜¯JUnit5å¾ˆé‡è¦çš„â¼€ä¸ªæ–°ç‰¹æ€§ï¼Œå®ƒä½¿å¾—â½¤ä¸åŒçš„å‚æ•°å¤šæ¬¡è¿â¾æµ‹è¯•æˆä¸ºäº†å¯èƒ½ï¼Œä¹Ÿä¸º æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•å¸¦æ¥è®¸å¤šä¾¿åˆ©ã€‚ </p>
<p>åˆ©â½¤@ValueSourceç­‰æ³¨è§£ï¼ŒæŒ‡å®šâ¼Šå‚ï¼Œæˆ‘ä»¬å°†å¯ä»¥ä½¿â½¤ä¸åŒçš„å‚æ•°è¿›â¾å¤šæ¬¡å•å…ƒæµ‹è¯•ï¼Œâ½½ä¸éœ€è¦ æ¯æ–°å¢â¼€ä¸ªå‚æ•°å°±æ–°å¢â¼€ä¸ªå•å…ƒæµ‹è¯•ï¼Œçœå»äº†å¾ˆå¤šå†—ä½™ä»£ç ã€‚ </p>
<p>@ValueSource: ä¸ºå‚æ•°åŒ–æµ‹è¯•æŒ‡å®šâ¼Šå‚æ¥æºï¼Œâ½€æŒâ¼‹â¼¤åŸºç¡€ç±»ä»¥åŠStringç±»å‹,Classç±»å‹ @NullSource: è¡¨ç¤ºä¸ºå‚æ•°åŒ–æµ‹è¯•æä¾›â¼€ä¸ªnullçš„â¼Šå‚</p>
<p>@EnumSource: è¡¨ç¤ºä¸ºå‚æ•°åŒ–æµ‹è¯•æä¾›â¼€ä¸ªæšä¸¾â¼Šå‚ </p>
<p>@CsvFileSourceï¼šè¡¨ç¤ºè¯»å–æŒ‡å®šCSVâ½‚ä»¶å†…å®¹ä½œä¸ºå‚æ•°åŒ–æµ‹è¯•â¼Šå‚ </p>
<p>@MethodSourceï¼šè¡¨ç¤ºè¯»å–æŒ‡å®šâ½…æ³•çš„è¿”å›å€¼ä½œä¸ºå‚æ•°åŒ–æµ‹è¯•â¼Šå‚(æ³¨æ„â½…æ³•è¿”å›éœ€è¦æ˜¯â¼€ä¸ªæµ)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ParameterizedTest</span></span><br><span class="line"><span class="meta">@ValueSource(strings = &#123;&quot;one&quot;, &quot;two&quot;, &quot;three&quot;&#125;)</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;å‚æ•°åŒ–æµ‹è¯•1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">parameterizedTest1</span><span class="params">(String string)</span> &#123;</span><br><span class="line">    System.out.println(string);</span><br><span class="line">    Assertions.assertTrue(StringUtils.isNotBlank(string));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@ParameterizedTest</span></span><br><span class="line"><span class="meta">@MethodSource(&quot;method&quot;)</span>    </span><br><span class="line"><span class="meta">@DisplayName(&quot;â½…æ³•æ¥æºå‚æ•°&quot;)</span></span><br><span class="line"><span class="comment">//æŒ‡å®šâ½…æ³•å</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWithExplicitLocalMethodSource</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    System.out.println(name);</span><br><span class="line">    Assertions.assertNotNull(name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> Stream&lt;String&gt; <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> Stream.of(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5ã€æ ¸å¿ƒåŸç†"><a href="#5ã€æ ¸å¿ƒåŸç†" class="headerlink" title="5ã€æ ¸å¿ƒåŸç†"></a><strong>5ã€æ ¸å¿ƒåŸç†</strong></h3><p>æœ‰åŠ©äºç†è§£SpringBootçš„åº•å±‚è¡Œä¸º</p>
<h4 id="1ã€äº‹ä»¶å’Œç›‘å¬å™¨"><a href="#1ã€äº‹ä»¶å’Œç›‘å¬å™¨" class="headerlink" title="1ã€äº‹ä»¶å’Œç›‘å¬å™¨"></a>1ã€äº‹ä»¶å’Œç›‘å¬å™¨</h4><h5 id="1ã€ç”Ÿå‘½å‘¨æœŸç›‘å¬"><a href="#1ã€ç”Ÿå‘½å‘¨æœŸç›‘å¬" class="headerlink" title="1ã€ç”Ÿå‘½å‘¨æœŸç›‘å¬"></a>1ã€ç”Ÿå‘½å‘¨æœŸç›‘å¬</h5><p>åœºæ™¯ï¼šç›‘å¬<strong>åº”ç”¨</strong>çš„ <strong>ç”Ÿå‘½å‘¨æœŸ</strong></p>
<h6 id="1ã€ç›‘å¬å™¨-SpringApplicationRunListener"><a href="#1ã€ç›‘å¬å™¨-SpringApplicationRunListener" class="headerlink" title="1ã€ç›‘å¬å™¨-SpringApplicationRunListener"></a>1ã€ç›‘å¬å™¨-SpringApplicationRunListener</h6><ol>
<li><p>â¾ƒå®šä¹‰ <code>SpringApplicationRunListener</code> æ¥ç›‘å¬äº‹ä»¶ï¼› </p>
<p>1.1.  ç¼–å†™ <code>SpringApplicationRunListener</code> å®ç°ç±» </p>
<p>1.2.  åœ¨  <code>META-INF/spring.factories</code>  ä¸­é…ç½®  <code>org.springframework.boot.Spri ngApplicationRunListener= â¾ƒâ¼°çš„ Listener</code>  ï¼Œè¿˜å¯ä»¥æŒ‡å®šâ¼€ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œæ¥ å—ä¸¤ä¸ªå‚æ•° <code>(SpringApplication application, String[] args)</code></p>
<p>1.3.  springboot åœ¨ spring-boot.jar  ä¸­é…ç½®äº†é»˜è®¤çš„ Listenerï¼Œå¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251222200001848.png" alt="image-20251222200001848"></p>
<p><strong>ç°åœ¨æˆ‘ä»¬æ¥è‡ªå®šä¹‰Listeneræ¥æ¨¡æ‹Ÿæ¡†æ¶åšçš„äº‹æƒ…ï¼Œä»è€Œå¼„æ¸…æ¥šæ¡†æ¶åšäº†ä»€ä¹ˆ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰ SpringApplicationRunListenerï¼Œç”¨äºç›‘å¬ Spring Boot å¯åŠ¨å„é˜¶æ®µ</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * å¿…é¡»æä¾›å¸¦ SpringApplication å’Œ String[] å‚æ•°çš„æ„é€ å‡½æ•°ï¼ˆSpring Boot åå°„è°ƒç”¨ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySpringApplicationRunListener</span> <span class="keyword">implements</span> <span class="title class_">SpringApplicationRunListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SpringApplication application;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String[] args;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// âš ï¸ å¿…é¡»æä¾›æ­¤æ„é€ å‡½æ•°ï¼Spring Boot é€šè¿‡åå°„è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MySpringApplicationRunListener</span><span class="params">(SpringApplication application, String[] args)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.application = application;</span><br><span class="line">        <span class="built_in">this</span>.args = args;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">starting</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¼•å¯¼é˜¶æ®µã€‘starting: åº”ç”¨å¼€å§‹å¯åŠ¨ï¼ŒBootstrapContext å·²åˆ›å»º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¼•å¯¼é˜¶æ®µã€‘environmentPrepared: ç¯å¢ƒå·²å‡†å¤‡å®Œæˆï¼ˆé…ç½®å·²åŠ è½½ï¼‰ï¼Œä½† IOC å®¹å™¨å°šæœªåˆ›å»º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¯åŠ¨é˜¶æ®µã€‘contextPrepared: IOC å®¹å™¨å·²åˆ›å»ºï¼Œä¸»é…ç½®ç±»å°šæœªåŠ è½½ï¼Œå¼•å¯¼ä¸Šä¸‹æ–‡å³å°†å…³é—­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¯åŠ¨é˜¶æ®µã€‘contextLoaded: ä¸»é…ç½®ç±»å·²åŠ è½½ï¼Œä½†å®¹å™¨å°šæœªåˆ·æ–°ï¼ˆBean è¿˜æ²¡åˆ›å»ºï¼‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">started</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¯åŠ¨é˜¶æ®µã€‘started: å®¹å™¨å·²åˆ·æ–°ï¼ˆæ‰€æœ‰ Bean å·²åˆ›å»ºï¼‰ï¼Œä½† Runner å°šæœªæ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ready</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¯åŠ¨é˜¶æ®µã€‘ready: æ‰€æœ‰ Runner å·²æ‰§è¡Œå®Œæ¯•ï¼Œåº”ç”¨å®Œå…¨å°±ç»ªï¼Œå¼€å§‹è¿è¡Œï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€å¼‚å¸¸ã€‘å¯åŠ¨å¤±è´¥: &quot;</span> + (exception != <span class="literal">null</span> ? exception.getMessage() : <span class="string">&quot;æœªçŸ¥é”™è¯¯&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬ç¼–å†™å¥½äº†å®ç°ç±»ï¼Œç„¶åå°±è¦æ ¹æ®ä»–çš„1.2æ­¥éª¤çš„è¦æ±‚è¿›è¡Œé…ç½®äº†</p>
<p><code>src/main/resources/META-INF/spring.factories</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># META-INF/spring.factories</span></span><br><span class="line"><span class="attr">org.springframework.boot.SpringApplicationRunListener</span>=<span class="string">\</span></span><br><span class="line"><span class="string">com.example.listener.MySpringApplicationRunListener</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå¯åŠ¨åº”ç”¨çœ‹çœ‹æ‰“å°é¡ºåºï¼Œå°±çŸ¥é“æµç¨‹äº†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251222202340772.png" alt="image-20251222202340772"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Listenerå…ˆè¦ä»META-INF/spring.factories è¯»åˆ°æ‰¾åˆ°æ‰€æœ‰æ³¨å†Œçš„ SpringApplicationRunListener å®ç°ç±»ï¼Œå¹¶åœ¨å¯åŠ¨æ—©æœŸå°±å®ä¾‹åŒ–å®ƒä»¬ï¼Œç”¨äºç›‘å¬åç»­ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚</span><br><span class="line">1ã€å¼•å¯¼ï¼šåˆ©â½¤BootstrapContext å¼•å¯¼æ•´ä¸ªé¡¹â½¬å¯</span><br><span class="line">	startingï¼šåº”â½¤å¼€å§‹ï¼ŒSpringApplicationçš„runâ½…æ³•â¼€è°ƒâ½¤ï¼Œåªè¦æœ‰äº†BootstrapContext å°±æ‰§â¾</span><br><span class="line">	environmentPrepared:ç¯å¢ƒå‡†å¤‡å¥½ï¼ˆæŠŠå¯åŠ¨å‚æ•°ç­‰ç»‘å®šåˆ°ç¯å¢ƒå˜é‡ä¸­ï¼‰ï¼Œä½†æ˜¯iocè¿˜æ²¡æœ‰åˆ›å»ºï¼›ã€è°ƒâ¼€æ¬¡ã€‘</span><br><span class="line">2ã€å¯åŠ¨ï¼š</span><br><span class="line">	contextPreparedï¼šiocå®¹å™¨åˆ›å»ºå¹¶å‡†å¤‡å¥½ï¼Œä½†æ˜¯sourcesï¼ˆä¸»é…ç½®ç±»ï¼‰æ²¡åŠ è½½ã€‚å¹¶å…³é—­å¼•å¯¼ä¸Šä¸‹â½‚ï¼›ç»„ä»¶éƒ½æ²¡åˆ›å»ºã€è°ƒâ¼€æ¬¡ã€‘</span><br><span class="line">	contextLoadedï¼šiocå®¹å™¨åŠ è½½ã€‚ä¸»é…ç½®ç±»åŠ è½½è¿›å»äº†ã€‚ä½†æ˜¯iocå®¹å™¨è¿˜æ²¡åˆ·æ–°ï¼ˆæˆ‘ä»¬çš„beanæ²¡åˆ›å»ºï¼‰ã€‚</span><br><span class="line">æˆªâ½Œä»¥å‰ï¼Œiocå®¹å™¨â¾¥â¾¯è¿˜æ²¡é€ beanå‘¢</span><br><span class="line">	startedï¼šiocå®¹å™¨åˆ·æ–°äº†ï¼ˆæ‰€æœ‰beané€ å¥½äº†ï¼‰ï¼Œä½†æ˜¯runner æ²¡è°ƒâ½¤ã€‚</span><br><span class="line">	ready:   iocå®¹å™¨åˆ·æ–°äº†ï¼ˆæ‰€æœ‰beané€ å¥½äº†ï¼‰ï¼Œæ‰€æœ‰ runner è°ƒâ½¤å®Œäº†ã€‚</span><br><span class="line">3ã€è¿â¾</span><br><span class="line">	ä»¥å‰æ­¥éª¤éƒ½æ­£ç¡®æ‰§â¾ï¼Œä»£è¡¨å®¹å™¨running</span><br></pre></td></tr></table></figure>
<p>çœ‹è¿™ä¸ªæµç¨‹ï¼Œè¿˜ä¼šæœ‰å¾ˆå¤šç–‘é—®runneræ˜¯ä»€ä¹ˆï¼Ÿ<strong>åŠ è½½æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œçš„â€œåŠ è½½â€æŒ‡çš„æ˜¯ï¼šå°†ä½ çš„ @Configuration ç±»ã€@Component ç±»ç­‰ Spring Bean å®šä¹‰ï¼ˆBeanDefinitionï¼‰æ³¨å†Œåˆ° IOC å®¹å™¨ä¸­ï¼Œä½†æ­¤æ—¶ Bean å°šæœªè¢«å®ä¾‹åŒ–ï¼ˆå³æ²¡è°ƒç”¨æ„é€ å‡½æ•°æˆ– @PostConstructï¼‰ã€‚</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="2ã€äº‹ä»¶è§¦å‘æ—¶æœº"><a href="#2ã€äº‹ä»¶è§¦å‘æ—¶æœº" class="headerlink" title="2ã€äº‹ä»¶è§¦å‘æ—¶æœº"></a>2ã€äº‹ä»¶è§¦å‘æ—¶æœº</h5><h6 id="1ã€å„ç§å›è°ƒç›‘å¬å™¨"><a href="#1ã€å„ç§å›è°ƒç›‘å¬å™¨" class="headerlink" title="1ã€å„ç§å›è°ƒç›‘å¬å™¨"></a>1ã€å„ç§å›è°ƒç›‘å¬å™¨</h6><p><code>BootstrapRegistryInitializer</code> ï¼š    æ„ŸçŸ¥ç‰¹å®šé˜¶æ®µï¼šæ„ŸçŸ¥å¼•å¯¼åˆå§‹åŒ– ï¼Œè¿™ä¸ªæ˜¯å¯åŠ¨ä¹‹å‰</p>
<p>â€‹    <code>META-INF/spring.factories</code> </p>
<p>â€‹    åˆ›å»ºå¼•å¯¼ä¸Šä¸‹â½‚ bootstrapContext  çš„æ—¶å€™è§¦å‘ã€‚ </p>
<p>â€‹    <code>application. addBootstrapRegistryInitializer  ()</code>; </p>
<p>â€‹    åœºæ™¯ï¼š è¿›â¾å¯†é’¥æ ¡å¯¹æˆæƒã€‚ </p>
<p><code>ApplicationContextInitializer</code>ï¼š   æ„ŸçŸ¥ç‰¹å®šé˜¶æ®µï¼š æ„ŸçŸ¥iocå®¹å™¨åˆå§‹åŒ– ,è¿™ä¸ªé˜¶æ®µå°±æ˜¯ç¯å¢ƒå‡†å¤‡å®Œæˆä¹‹å</p>
<p>â€‹    <code>META-INF/spring.factories</code></p>
<p>â€‹    <code>application.addInitializers();</code></p>
<p><strong><code>ApplicationListener</code></strong>ï¼š    <strong>æ„ŸçŸ¥å…¨é˜¶æ®µ</strong>ï¼šåŸºäºäº‹ä»¶æœºåˆ¶ï¼Œæ„ŸçŸ¥äº‹ä»¶ã€‚.AOPã€‚ç¯ç»•é€šçŸ¥è¿™äº›ã€‚â¼€æ—¦åˆ°äº†å“ªä¸ªé˜¶æ®µå¯ä»¥åšåˆ«çš„äº‹ </p>
<p>â€‹    <code>@Bean  æˆ– @EventListener</code> ï¼š  äº‹ä»¶é©±åŠ¨   </p>
<pre><code> `SpringApplication.addListeners(â€¦)`  æˆ–  `SpringApplicationBuilder.listeners(â€¦)  `

 `META-INF/spring.factories `
</code></pre><p>â€‹    ç±»ä¼¼ç²‰ä¸ï¼Œåªèƒ½çŸ¥é“å¹²å˜›</p>
<p><strong><code>SpringApplicationRunListener</code></strong>ï¼š     <strong>æ„ŸçŸ¥å…¨é˜¶æ®µâ½£å‘½å‘¨æœŸ</strong> + <strong>å„ç§é˜¶æ®µéƒ½èƒ½â¾ƒå®šä¹‰æ“ä½œ</strong>ï¼› <strong>åŠŸèƒ½æ›´å®Œå–„</strong></p>
<pre><code>  `META-INF/spring.factories`
</code></pre><p>â€‹    ç±»ä¼¼ç»ç†ï¼Œèƒ½å…¨éƒ¨ç®¡ç†</p>
<p><code>ApplicationRunner</code>:    æ„ŸçŸ¥ç‰¹å®šé˜¶æ®µï¼šæ„ŸçŸ¥åº”â½¤å°±ç»ªReadyã€‚å¡æ­»åº”â½¤ï¼Œå°±ä¸ä¼šå°±ç»ª </p>
<p>â€‹    @Bean</p>
<p><code>CommandLineRunner</code>ï¼š   æ„ŸçŸ¥ç‰¹å®šé˜¶æ®µï¼šæ„ŸçŸ¥åº”â½¤å°±ç»ªReadyã€‚å¡æ­»åº”â½¤ï¼Œå°±ä¸ä¼šå°±ç»ª </p>
<p>â€‹    @Bean</p>
<p>æœ€ä½³å®æˆ˜ï¼š</p>
<p>â€‹    å¦‚æœé¡¹â½¬å¯åŠ¨å‰åšäº‹ï¼š <code>BootstrapRegistryInitializer</code>  å’Œ  <code>ApplicationContextInitializer</code></p>
<p>â€‹    å¦‚æœæƒ³è¦åœ¨é¡¹â½¬å¯åŠ¨å®Œæˆååšäº‹ï¼š  <code>ApplicationRunner</code> å’Œ  <code>CommandLineRunner</code></p>
<p>â€‹    å¦‚æœè¦â¼²æ¶‰â½£å‘½å‘¨æœŸåšäº‹ï¼š <code>SpringApplicationRunListener</code></p>
<p>â€‹    å¦‚æœæƒ³è¦â½¤äº‹ä»¶æœºåˆ¶ï¼š <code>ApplicationListener</code></p>
<h6 id="2ã€å®Œæ•´è§¦å‘æµç¨‹"><a href="#2ã€å®Œæ•´è§¦å‘æµç¨‹" class="headerlink" title="2ã€å®Œæ•´è§¦å‘æµç¨‹"></a>2ã€å®Œæ•´è§¦å‘æµç¨‹</h6><p>springbootå¯åŠ¨çš„æœŸé—´ä¹Ÿä¼šå¯åŠ¨äº‹ä»¶ï¼Œåˆšåˆšæˆ‘ä»¬ç†è§£äº†å¯åŠ¨æµç¨‹ï¼Œç°åœ¨äº†è§£å¯åŠ¨æœŸé—´å‘ç”Ÿçš„äº‹ä»¶ã€‚</p>
<p>9 â¼¤äº‹ä»¶  è§¦å‘é¡ºåº&amp;æ—¶æœº</p>
<p>1ã€<code>ApplicationStartingEvent</code>ï¼šåº”ç”¨å¯åŠ¨ä½†æ²¡æœ‰åšä»»ä½•äº‹æƒ…ï¼Œé™¤äº†æ³¨å†Œ <code>listeners and intializers</code></p>
<p>2ã€<code>ApplicationEnvironmentPreparedEvent</code> ï¼š <code>Environment</code>å‡†å¤‡å¥½ï¼Œä½†<code>context</code>æœªåˆ›å»ºã€‚</p>
<p>3ã€<code>ApplicationContextInitializedEvent</code>ï¼š ApplicationContext å‡†å¤‡å¥½ï¼Œ ApplicationContextInitializers è°ƒâ½¤ï¼Œä½†æ˜¯ä»»ä½•beanæœªåŠ è½½</p>
<p>4ã€ApplicationPreparedEvent  ï¼š å®¹å™¨åˆ·æ–°ä¹‹å‰ï¼Œbeanå®šä¹‰ä¿¡æ¯åŠ è½½</p>
<p>5ã€ApplicationStartedEvent  ï¼š å®¹å™¨åˆ·æ–°å®Œæˆï¼Œ runneræœªè°ƒâ½¤</p>
<p>ä»¥ä¸‹å°±å¼€å§‹æ’â¼Šäº†æ¢é’ˆæœºåˆ¶</p>
<hr>
<p>6ã€AvailabilityChangeEvent  ï¼š  LivenessState.CORRECT  åº”â½¤å­˜æ´»ï¼› å­˜æ´»æ¢é’ˆ</p>
<p>7ã€ApplicationReadyEvent  : ä»»ä½•runnerè¢«è°ƒâ½¤</p>
<p>8ã€AvailabilityChangeEvent  ï¼šReadinessState.ACCEPTING_TRAFFIC  å°±ç»ªæ¢é’ˆï¼Œå¯ä»¥æ¥è¯·æ±‚</p>
<p>9ã€ApplicationFailedEvent   ï¼šå¯åŠ¨å‡ºé”™</p>
<p>è¿™ä¸ªå­˜æ´»æ¢é’ˆå’Œå°±ç»ªæ¢é’ˆå¯¹åº”k8säº‘å¹³å°ï¼Œè¿™æ ·å°±çŸ¥é“åº”ç”¨ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨äº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251222224115461.png" alt="image-20251222224115461"></p>
<p>åº”â½¤äº‹ä»¶å‘é€é¡ºåºå¦‚ä¸‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251222224132487.png" alt="image-20251222224132487"></p>
<p>æ„ŸçŸ¥åº”â½¤æ˜¯å¦å­˜æ´»äº†ï¼šå¯èƒ½æ¤ç‰©çŠ¶æ€ï¼Œè™½ç„¶æ´»ç€ä½†æ˜¯ä¸èƒ½å¤„ç†è¯·æ±‚ã€‚ </p>
<p>åº”â½¤æ˜¯å¦å°±ç»ªäº†ï¼šèƒ½å“åº”è¯·æ±‚ï¼Œè¯´æ˜ç¡®å®æ´»çš„â½è¾ƒå¥½ã€‚</p>
<p>å°æ€»ç»“ï¼šå°±æ˜¯springtbootå¯åŠ¨æ—¶ä¼šè°ƒç”¨å‡ ä¸ªå‡½æ•°å’Œå‘å¸ƒå‡ ä¸ªäº‹ä»¶ï¼Œè§¦å‘ç‚¹å°±æ˜¯å¯åŠ¨ã€å‡†å¤‡ç¯å¢ƒåã€iocåˆå§‹åŒ–ã€ä¸»é…ç½®ç±»åŠ è½½ã€iocåˆ·æ–°ã€runneræ‰§è¡Œä¹‹åã€‚</p>
<h6 id="3ã€SpringBootäº‹ä»¶é©±åŠ¨å¼€å‘"><a href="#3ã€SpringBootäº‹ä»¶é©±åŠ¨å¼€å‘" class="headerlink" title="3ã€SpringBootäº‹ä»¶é©±åŠ¨å¼€å‘"></a>3ã€SpringBootäº‹ä»¶é©±åŠ¨å¼€å‘</h6><p>ä¸Šé¢äº†è§£äº†å¯åŠ¨æµç¨‹å’Œæµç¨‹ä¸­çš„äº‹ä»¶ï¼Œç„¶åæœ‰çš„äº‹ä»¶æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å¼€å‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦çŸ¥é“å¦‚ä½•åŸºäºäº‹ä»¶é©±åŠ¨å¼€å‘çš„äº†ã€‚</p>
<blockquote>
<p>åº”ç”¨å¯åŠ¨è¿‡ç¨‹ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æ„ŸçŸ¥ï¼ˆ9å¤§äº‹ä»¶ï¼‰ã€åº”ç”¨è¿è¡Œä¸­äº‹ä»¶æ„ŸçŸ¥ã€‚</p>
</blockquote>
<ul>
<li>äº‹ä»¶å‘å¸ƒï¼š<code>ApplicationEventPublisherAware</code>æˆ– <code>æ³¨â¼Šï¼š ApplicationEventMulticaster</code></li>
<li>äº‹ä»¶ç›‘å¬ï¼š<code>ç»„ä»¶ + @EventListener</code></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251223001131640.png" alt="image-20251223001131640"></p>
<p>å¦‚æœä¸æ˜¯äº‹ä»¶é©±åŠ¨ï¼Œæˆ‘ä»¬å‡è®¾ç™»å½•çš„æ—¶å€™éœ€è¦ä¸€å †ä¸šåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•ä¹‹åï¼Œéœ€è¦è‡ªåŠ¨ç­¾åˆ°ï¼Œéšæœºå‘æ”¾ä¼˜æƒ å·ç­‰ç­‰ï¼Œç„¶åå†™@Autowiredæ³¨å…¥å…¶ä»–çš„æœåŠ¡ç„¶ååœ¨ç™»å½•ä¸šåŠ¡é‡Œé¢ä¸€ä¸ªä¸ªè°ƒç”¨ã€‚</p>
<p><strong>ä½†æ˜¯å¦‚æœè¿™ç§ç¼–ç æ–¹å¼ï¼Œå¦‚æœè¦å¢åŠ ä¸šåŠ¡ä¼šéå¸¸éº»çƒ¦ã€‚</strong></p>
<p>è®¾è®¡æ¨¡å¼ï¼šå¯¹æ–°å¢å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251223001141018.png" alt="image-20251223001141018"></p>
<blockquote>
<p>äº‹ä»¶å‘å¸ƒè€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äº‹ä»¶å‘å¸ƒå™¨æœåŠ¡ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//SpringBootå·²ç»ç»™æˆ‘ä»¬å‡†å¤‡å¥½äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§æ‰¿ApplicationEventPublisherAwareç„¶åå‘å¸ƒå°±è°ƒç”¨åº•å±‚çš„å°±å¥½äº†</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventPublisher</span> <span class="keyword">implements</span> <span class="title class_">ApplicationEventPublisherAware</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åº•å±‚å‘é€äº‹ä»¶ç”¨çš„ç»„ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     * Spring Boot ä¼šé€šè¿‡ ApplicationEventPublisherAware æ¥å£è‡ªåŠ¨æ³¨å…¥ç»™æˆ‘ä»¬ã€‚</span></span><br><span class="line"><span class="comment">     * äº‹ä»¶æ˜¯å¹¿æ’­å‡ºå»çš„ï¼Œæ‰€æœ‰ç›‘å¬è¯¥äº‹ä»¶çš„ç›‘å¬å™¨éƒ½å¯ä»¥æ”¶åˆ°ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher applicationEventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€ä»»æ„ ApplicationEvent äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> event è¦å‘å¸ƒçš„äº‹ä»¶å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendEvent</span><span class="params">(ApplicationEvent event)</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨åº•å±‚ API å‘é€äº‹ä»¶</span></span><br><span class="line">        applicationEventPublisher.publishEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼šè¢« Spring è‡ªåŠ¨è°ƒç”¨ï¼Œå°†çœŸæ­£çš„äº‹ä»¶å‘å¸ƒç»„ä»¶æ³¨å…¥è¿›æ¥ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> applicationEventPublisher Spring æä¾›çš„äº‹ä»¶å‘å¸ƒå™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.applicationEventPublisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>äº‹ä»¶è®¢é˜…è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CouponService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›‘å¬ç™»å½•æˆåŠŸäº‹ä»¶ï¼Œä¼˜å…ˆçº§ä¸º 1ï¼ˆæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="meta">@Order(1)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onLoginSuccess</span><span class="params">(LoginSuccessEvent event)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;===== CouponService ===== æ„ŸçŸ¥åˆ°äº‹ä»¶: &quot;</span> + event);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‡è®¾ LoginSuccessEvent å†…éƒ¨å·²å°è£… UserEntityï¼Œè€Œä¸æ˜¯é€šè¿‡ getSource()</span></span><br><span class="line">        <span class="type">UserEntity</span> <span class="variable">user</span> <span class="operator">=</span> event.getUser(); <span class="comment">// æ›´å®‰å…¨ã€æ›´æ¸…æ™°</span></span><br><span class="line">        sendCoupon(user.getUsername());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendCoupon</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(username + <span class="string">&quot; éšæœºå¾—åˆ°äº†ä¸€å¼ ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•´ä¸ªæ¡ˆä¾‹å¦‚ä¸‹ï¼šäº‹ä»¶æ˜¯å¹¿æ’­å½¢å¼çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®ä½“ç±»ï¼šUserEntity.java</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserEntity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äº‹ä»¶ç±»ï¼šLoginSuccessEvent.java</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç™»å½•æˆåŠŸäº‹ä»¶</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿ ApplicationEventï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª Spring åº”ç”¨äº‹ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginSuccessEvent</span> <span class="keyword">extends</span> <span class="title class_">ApplicationEvent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è™½ç„¶ source å°±æ˜¯ UserEntityï¼Œä½†æˆ‘ä»¬æä¾›ç±»å‹å®‰å…¨çš„ getter</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginSuccessEvent</span><span class="params">(UserEntity user)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(user); <span class="comment">// å°† user ä½œä¸º source ä¼ ç»™çˆ¶ç±»</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»å‹å®‰å…¨åœ°è·å–ç”¨æˆ·ï¼ˆé¿å…å¤–éƒ¨å¼ºè½¬ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> UserEntity <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (UserEntity) getSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Controllerï¼šå‘å¸ƒäº‹ä»¶</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> EventPublisher eventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginController</span><span class="params">(EventPublisher eventPublisher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.eventPublisher = eventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;</span><br><span class="line">        <span class="type">UserEntity</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserEntity</span>(username);</span><br><span class="line">        <span class="type">LoginSuccessEvent</span> <span class="variable">event</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoginSuccessEvent</span>(user);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‘å¸ƒäº‹ä»¶</span></span><br><span class="line">        eventPublisher.sendEvent(event);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ç™»å½•æˆåŠŸï¼Œå·²è§¦å‘äº‹ä»¶ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//äº‹ä»¶å‘å¸ƒå·¥å…·ç±»</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventPublisher</span> <span class="keyword">implements</span> <span class="title class_">ApplicationEventPublisherAware</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationEventPublisher applicationEventPublisher;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendEvent</span><span class="params">(ApplicationEvent event)</span> &#123;</span><br><span class="line">        applicationEventPublisher.publishEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationEventPublisher</span><span class="params">(ApplicationEventPublisher applicationEventPublisher)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.applicationEventPublisher = applicationEventPublisher;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç§¯åˆ†å¢åŠ æœåŠ¡ï¼ŒåŒæ—¶å®ç°ç›‘å¬å™¨åŠŸèƒ½</span></span><br><span class="line"><span class="comment">//æ–¹å¼ä¸€</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountScoreService</span> <span class="keyword">implements</span> <span class="title class_">ApplicationListener</span>&lt;LoginSuccessEvent&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onApplicationEvent</span><span class="params">(LoginSuccessEvent event)</span> &#123;</span><br><span class="line">        <span class="type">UserEntity</span> <span class="variable">user</span> <span class="operator">=</span> event.getUser();</span><br><span class="line">        addAccountScore(user.getUsername());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addAccountScore</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(username + <span class="string">&quot; åŠ äº†1åˆ†ï¼ˆé€šè¿‡ ApplicationListenerï¼‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ–¹å¼äºŒ</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CouponService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@EventListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoginSuccess</span><span class="params">(LoginSuccessEvent event)</span> &#123;</span><br><span class="line">        <span class="type">UserEntity</span> <span class="variable">user</span> <span class="operator">=</span> event.getUser();</span><br><span class="line">        sendCoupon(user.getUsername());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendCoupon</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(username + <span class="string">&quot; éšæœºå¾—åˆ°äº†ä¸€å¼ ä¼˜æƒ åˆ¸ï¼ˆé€šè¿‡ @EventListenerï¼‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2ã€è‡ªåŠ¨é…ç½®åŸç†"><a href="#2ã€è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="2ã€è‡ªåŠ¨é…ç½®åŸç†"></a>2ã€è‡ªåŠ¨é…ç½®åŸç†</h4><h5 id="1ã€å…¥é—¨ç†è§£"><a href="#1ã€å…¥é—¨ç†è§£" class="headerlink" title="1ã€å…¥é—¨ç†è§£"></a>1ã€å…¥é—¨ç†è§£</h5><blockquote>
<p>åº” â½¤å…³æ³¨çš„ä¸‰â¼¤æ ¸â¼¼ï¼šåœºæ™¯ã€é…ç½®ã€ç»„ä»¶</p>
</blockquote>
<h6 id="1ã€è‡ªåŠ¨é…ç½®æµç¨‹"><a href="#1ã€è‡ªåŠ¨é…ç½®æµç¨‹" class="headerlink" title="1ã€è‡ªåŠ¨é…ç½®æµç¨‹"></a>1ã€è‡ªåŠ¨é…ç½®æµç¨‹</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251223010045177.png" alt="image-20251223010045177"></p>
<ol>
<li><p>å¯¼â¼Š starter  </p>
</li>
<li><p>ä¾èµ–å¯¼â¼Š autoconfigure  </p>
</li>
<li><p>å¯»æ‰¾ç±»è·¯å¾„ä¸‹  META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports  â½‚ä»¶ </p>
</li>
<li><p>å¯åŠ¨ï¼ŒåŠ è½½æ‰€æœ‰  â¾ƒåŠ¨é…ç½®ç±»  xxxAutoConfiguration  </p>
<p>a.  ç»™å®¹å™¨ä¸­é…ç½®åŠŸèƒ½ ç»„ä»¶ </p>
<p>b. ç»„ä»¶å‚æ•° ç»‘å®šåˆ°  å±æ€§ç±» ä¸­ã€‚ </p>
<p>c. å± æ€§ç±» å’Œ xxxProperties  é…ç½®â½‚ä»¶ å‰ç¼€é¡¹ç»‘å®š </p>
<p>d. @Contional æ´¾â½£çš„æ¡ä»¶æ³¨è§£  è¿›â¾åˆ¤æ–­æ˜¯å¦ç»„ä»¶â½£æ•ˆ </p>
</li>
<li><p>æ•ˆæœï¼š </p>
<p>a.  ä¿®æ”¹é…ç½®â½‚ä»¶ï¼Œä¿®æ”¹åº•å±‚å‚æ•° </p>
<p>b.  æ‰€æœ‰åœºæ™¯â¾ƒåŠ¨é…ç½®å¥½ç›´æ¥ä½¿â½¤ </p>
<p>c.  å¯ä»¥æ³¨â¼ŠSpringBooté…ç½®å¥½çš„ç»„ä»¶éšæ—¶ä½¿â½¤</p>
</li>
</ol>
<h6 id="2ã€SPIæœºåˆ¶"><a href="#2ã€SPIæœºåˆ¶" class="headerlink" title="2ã€SPIæœºåˆ¶"></a>2ã€SPIæœºåˆ¶</h6><p>â€‹    ä¸Šé¢è¿™ç§éƒ½æ˜¯SPIæ€æƒ³ã€‚</p>
<blockquote>
<p><strong>Javaä¸­çš„SPIï¼ˆService Provider Interfaceï¼‰æ˜¯â¼€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼</strong>ï¼Œ<strong>â½¤äºåœ¨åº”â½¤ç¨‹åºä¸­åŠ¨æ€åœ°å‘ç° å’ŒåŠ è½½ç»„ä»¶</strong>ã€‚SPIçš„æ€æƒ³æ˜¯ï¼Œå®šä¹‰â¼€ä¸ªæ¥â¼æˆ–æŠ½è±¡ç±»ï¼Œç„¶åé€šè¿‡åœ¨classpathä¸­å®šä¹‰å®ç°è¯¥æ¥â¼çš„ç±» æ¥å®ç°å¯¹ç»„ä»¶çš„åŠ¨æ€å‘ç°å’ŒåŠ è½½ã€‚</p>
<p>SPIçš„ä¸»è¦â½¬çš„æ˜¯è§£å†³åœ¨åº”â½¤ç¨‹åºä¸­ä½¿â½¤å¯æ’æ‹”ç»„ä»¶çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œâ¼€ä¸ªåº”â½¤ç¨‹åºå¯èƒ½éœ€è¦ä½¿â½¤ä¸ åŒçš„â½‡å¿—æ¡†æ¶æˆ–æ•°æ®åº“è¿æ¥æ± ï¼Œä½†æ˜¯è¿™äº›ç»„ä»¶çš„é€‰æ‹©å¯èƒ½å–å†³äºè¿â¾æ—¶çš„æ¡ä»¶ã€‚é€šè¿‡ä½¿â½¤SPIï¼Œåº” â½¤ç¨‹åºå¯ä»¥åœ¨è¿â¾æ—¶å‘ç°å¹¶åŠ è½½é€‚å½“çš„ç»„ä»¶ï¼Œâ½½â½†éœ€åœ¨ä»£ç ä¸­ç¡¬ç¼–ç è¿™äº›ç»„ä»¶çš„å®ç°ç±»ã€‚ </p>
<p>åœ¨Javaä¸­ï¼ŒSPIçš„å®ç°â½…å¼æ˜¯é€šè¿‡åœ¨  META-INF/services  â½¬å½•ä¸‹åˆ›å»ºâ¼€ä¸ªä»¥æœåŠ¡æ¥â¼å…¨é™å®šå ä¸ºåå­—çš„â½‚ä»¶ï¼Œâ½‚ä»¶ä¸­åŒ…å«å®ç°è¯¥æœåŠ¡æ¥â¼çš„ç±»çš„å…¨é™å®šåã€‚å½“åº”â½¤ç¨‹åºå¯åŠ¨æ—¶ï¼ŒJavaçš„SPIæœºåˆ¶ ä¼šâ¾ƒåŠ¨æ‰«æclasspathä¸­çš„è¿™äº›â½‚ä»¶ï¼Œå¹¶æ ¹æ®â½‚ä»¶ä¸­æŒ‡å®šçš„ç±»åæ¥åŠ è½½å®ç°ç±»ã€‚ </p>
<p>é€šè¿‡ä½¿â½¤SPIï¼Œåº”â½¤ç¨‹åºå¯ä»¥å®ç°æ›´çµæ´»ã€å¯æ‰©å±•çš„æ¶æ„ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é¿å…ç¡¬ç¼–ç ä¾èµ–å…³ç³»å’Œå¢åŠ  ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¥éª¤ 1ï¼šå®šä¹‰æ¥å£ï¼ˆæˆ–æŠ½è±¡ç±»ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Robot</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­¥éª¤ 2ï¼šç¼–å†™å®ç°ç±»ï¼ˆç”±ä¸åŒå‚å•†æˆ–æ¨¡å—æä¾›ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bumblebee</span> <span class="keyword">implements</span> <span class="title class_">Robot</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bumblebee: Hello! I&#x27;m from Transformers.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OptimusPrime</span> <span class="keyword">implements</span> <span class="title class_">Robot</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Optimus Prime: Freedom is the right of all sentient beings.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ­¥éª¤ 3ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆå…³é”®ï¼ï¼‰</span></span><br><span class="line"><span class="comment">//åœ¨ resources ç›®å½•ä¸‹åˆ›å»ºï¼šsrc/main/resources/META-INF/services/com.example.Robot</span></span><br><span class="line"><span class="comment">//æ–‡ä»¶å†…å®¹ï¼ˆæ¯è¡Œä¸€ä¸ªå®ç°ç±»çš„å…¨é™å®šåï¼‰ï¼š</span></span><br><span class="line">com.example.Bumblebee</span><br><span class="line">com.example.OptimusPrime</span><br><span class="line">    </span><br><span class="line"><span class="comment">//æ­¥éª¤ 4ï¼šé€šè¿‡ ServiceLoader åŠ è½½æœåŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RobotApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        ServiceLoader&lt;Robot&gt; robots = ServiceLoader.load(Robot.class);</span><br><span class="line">        <span class="keyword">for</span> (Robot robot : robots) &#123;</span><br><span class="line">            robot.sayHello();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ServiceLoaderå·¥ä½œåŸç†</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ServiceLoader.load(Robot.class) çš„å†…éƒ¨æµç¨‹ï¼š</span><br><span class="line">	è·å–å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆThread.currentThread().getContextClassLoader()ï¼‰</span><br><span class="line">	åœ¨ classpath ä¸‹æŸ¥æ‰¾æ‰€æœ‰ META-INF/services/com.example.Robot æ–‡ä»¶</span><br><span class="line">	è¯»å–æ–‡ä»¶å†…å®¹ï¼Œé€è¡Œè§£æä¸ºç±»å</span><br><span class="line">	ä½¿ç”¨ç±»åŠ è½½å™¨åŠ¨æ€åŠ è½½è¿™äº›ç±»ï¼ˆClass.forName()ï¼‰</span><br><span class="line">	é€šè¿‡åå°„è°ƒç”¨æ— å‚æ„é€ å™¨ï¼Œå®ä¾‹åŒ–å¯¹è±¡</span><br><span class="line">	è¿”å›ä¸€ä¸ª æƒ°æ€§è¿­ä»£å™¨ï¼ˆLazy Iteratorï¼‰ï¼Œéå†æ—¶æ‰åˆ›å»ºå®ä¾‹</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>Java åŸç”Ÿ SPI</th>
<th>Spring Bean æœºåˆ¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>è‡ªåŠ¨å‘ç°</td>
<td><code>META-INF/services/</code></td>
<td><code>@ComponentScan</code></td>
</tr>
<tr>
<td>ä¾èµ–æ³¨å…¥</td>
<td>âŒ ä¸æ”¯æŒ</td>
<td>âœ… æ”¯æŒ</td>
</tr>
<tr>
<td>æ¡ä»¶åŠ è½½</td>
<td>âŒ ä¸æ”¯æŒ</td>
<td>âœ… <code>@Conditional</code></td>
</tr>
<tr>
<td>å‘½åè®¿é—®</td>
<td>âŒ åªèƒ½éå†</td>
<td>âœ… <code>@Qualifier</code>, <code>@Primary</code></td>
</tr>
<tr>
<td>ç”Ÿå‘½å‘¨æœŸç®¡ç†</td>
<td>âŒ æ— </td>
<td>âœ… <code>InitializingBean</code>, <code>DisposableBean</code></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>âœ… <strong>Spring æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ›´å¼ºå¤§çš„â€œSPI å®ç°â€</strong>ã€‚</p>
</blockquote>
<h6 id="3ã€åŠŸèƒ½å¼€å…³"><a href="#3ã€åŠŸèƒ½å¼€å…³" class="headerlink" title="3ã€åŠŸèƒ½å¼€å…³"></a>3ã€åŠŸèƒ½å¼€å…³</h6><p>â¾ƒåŠ¨é…ç½®ï¼šå…¨éƒ¨éƒ½é…ç½®å¥½ï¼Œä»€ä¹ˆéƒ½ä¸â½¤ç®¡ã€‚   â¾ƒåŠ¨æ‰¹é‡å¯¼â¼Š </p>
<p>â€‹    é¡¹â½¬â¼€å¯åŠ¨ï¼Œspiâ½‚ä»¶ä¸­æŒ‡å®šçš„æ‰€æœ‰éƒ½åŠ è½½ã€‚ </p>
<p>@EnableXxxx  ï¼šâ¼¿åŠ¨æ§åˆ¶å“ªäº›åŠŸèƒ½çš„å¼€å¯ï¼› â¼¿åŠ¨å¯¼â¼Šã€‚ </p>
<p>â€‹    å¼€å¯xxxåŠŸèƒ½ </p>
<p>â€‹    éƒ½æ˜¯åˆ©â½¤ @Import æŠŠæ­¤åŠŸèƒ½è¦â½¤çš„ç»„ä»¶å¯¼â¼Šè¿›å»</p>
<h5 id="2ã€è¿›é˜¶ç†è§£"><a href="#2ã€è¿›é˜¶ç†è§£" class="headerlink" title="2ã€è¿›é˜¶ç†è§£"></a>2ã€è¿›é˜¶ç†è§£</h5><h6 id="1ã€-SpringBootApplication"><a href="#1ã€-SpringBootApplication" class="headerlink" title="1ã€@SpringBootApplication"></a>1ã€@SpringBootApplication</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan(excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">    @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class="line"><span class="meta">    @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@SpringBootConfiguration å°±æ˜¯ï¼š @Configuration ï¼Œå®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œé…ç½®ç±»ã€‚spring iocå¯åŠ¨å°±ä¼šåŠ è½½åˆ›å»ºè¿™ä¸ªç±»å¯¹è±¡</p>
<p>@EnableAutoConfigurationï¼šå¼€å¯â¾ƒåŠ¨é…ç½®</p>
<p>â€‹    @AutoConfigurationPackageï¼š<strong>æ‰«æä¸»ç¨‹åºåŒ…ï¼šåŠ è½½â¾ƒâ¼°çš„ç»„ä»¶</strong></p>
<p>â€‹        åˆ©â½¤ @Import(AutoConfigurationPackages.Registrar.class)  æƒ³è¦ç»™å®¹å™¨ä¸­å¯¼â¼Šç»„ä»¶ã€‚</p>
<p>â€‹        æŠŠä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…çš„æ‰€æœ‰ç»„ä»¶å¯¼â¼Šè¿›æ¥ã€‚</p>
<p>â€‹        ä¸ºä»€ä¹ˆSpringBooté»˜è®¤åªæ‰«æä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…åŠå…¶â¼¦åŒ…ï¼Ÿ</p>
<p>â€‹    <strong><code>@Import(AutoConfigurationImportSelector.class)</code></strong>ï¼š<strong>åŠ è½½æ‰€æœ‰â¾ƒåŠ¨é…ç½®ç±»ï¼šåŠ è½½starterå¯¼â¼Šçš„ç»„ä»¶</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»–çš„ä»£ç æ˜¯è¿™æ ·å†™çš„</span></span><br><span class="line">List&lt;String&gt; configurations = ImportCandidates.load(AutoConfiguration.class,getBeanClassLoader())</span><br><span class="line">.getCandidates();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ‰«æSPIâ½‚ä»¶ï¼š  META-INF/spring/org.springframework.boot.autoconfigure.AutoConf iguration.imports</p>
</blockquote>
<p>@ComponentScan</p>
<blockquote>
<p>ç»„ä»¶æ‰«æï¼šæ’é™¤â¼€äº›ç»„ä»¶ï¼ˆå“ªäº›ä¸è¦ï¼‰ ï¼Œæ³¨æ„è¿™é‡Œä¹Ÿä¼šæ‰«ææ³¨å†Œï¼Œåªæ˜¯æ·»åŠ äº†æ’é™¤è·¯å¾„è€Œå·²</p>
<p><strong>æ— è„‘æ³¨å†Œ</strong>ï¼Œå®ƒä¸ä¼šçœ‹ @ConditionalOnMissingBean ç­‰æ¡ä»¶</p>
<p>æ’é™¤å‰â¾¯å·²ç»æ‰«æè¿›æ¥çš„ é…ç½®ç±» ã€å’Œ â¾ƒåŠ¨é…ç½®ç±» ã€‚å› ä¸ºä¸€ä¸ªæ˜¯è‡ªå·±çš„ç»„ä»¶ä¸€ä¸ªæ˜¯starterçš„ï¼Œé‚£ä¹ˆå¦‚æœè‡ªå·±çš„ç»„ä»¶é‡Œé¢ä¹Ÿå†™äº†ä¸ªstarteré‚£ä¹ˆå°±é‡å¤æ³¨å†Œäº†ä¸¤æ¬¡ï¼Œè€Œè‡ªåŠ¨é…ç½®å¿…é¡»åœ¨æ‰€æœ‰ç”¨æˆ· Bean åŠ è½½å®Œåï¼Œæ ¹æ®æ¡ä»¶åˆ¤æ–­ã€‚å¦‚æœæå‰æŠŠç±»åŠ è½½äº†ï¼Œè‡ªåŠ¨é…ç½®çš„é€»è¾‘å°±å…¨ä¹±äº†ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),</span></span><br><span class="line"><span class="meta">@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) &#125;)</span></span><br></pre></td></tr></table></figure>
<h6 id="2ã€å®Œæ•´å¯åŠ¨åŠ è½½æµç¨‹"><a href="#2ã€å®Œæ•´å¯åŠ¨åŠ è½½æµç¨‹" class="headerlink" title="2ã€å®Œæ•´å¯åŠ¨åŠ è½½æµç¨‹"></a>2ã€å®Œæ•´å¯åŠ¨åŠ è½½æµç¨‹</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251223023144725.png" alt="image-20251223023144725"></p>
<p>ç¬¬ä¸€é˜¶æ®µï¼šåˆå§‹åŒ– SpringApplication å®ä¾‹</p>
<p>å½“ä½ è°ƒç”¨ SpringApplication.run(Main.class, args) æ—¶ï¼Œåå°é¦–å…ˆä¼šé€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ª SpringApplication å¯¹è±¡ã€‚</p>
<ol>
<li><strong>æ¨æ–­åº”ç”¨ç±»å‹</strong>ï¼šåˆ¤æ–­å½“å‰åº”ç”¨æ˜¯æ™®é€šé¡¹ç›®ï¼ˆNoneï¼‰ã€Web é¡¹ç›®ï¼ˆServletï¼‰è¿˜æ˜¯å“åº”å¼é¡¹ç›®ï¼ˆReactiveï¼‰ã€‚</li>
<li><strong>åŠ è½½åˆå§‹åŒ–å™¨ (Initializers)</strong>ï¼šä» META-INF/spring.factoriesï¼ˆæˆ– Spring 3.0+ çš„æ–°ä½ç½®ï¼‰ä¸­è¯»å–æ‰€æœ‰ ApplicationContextInitializer çš„å®ç°ç±»ã€‚</li>
<li><strong>åŠ è½½ç›‘å¬å™¨ (Listeners)</strong>ï¼šåŒæ ·ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–æ‰€æœ‰ ApplicationListenerã€‚</li>
<li><strong>æ¨æ–­ä¸»å¯åŠ¨ç±»</strong>ï¼šé€šè¿‡çº¿ç¨‹æ ˆæ‰¾åˆ°åŒ…å« main æ–¹æ³•çš„é‚£ä¸ªç±»ï¼Œæ–¹ä¾¿åç»­åŒ…æ‰«æã€‚</li>
</ol>
<p>ç¬¬äºŒé˜¶æ®µï¼šæ‰§è¡Œ run() æ–¹æ³•ï¼ˆæ ¸å¿ƒæµç¨‹ï¼‰</p>
<p>è¿™æ˜¯ Spring Boot å¯åŠ¨çš„æœ€æ ¸å¿ƒéƒ¨åˆ†ï¼ŒåŒ…å«äº†ç¯å¢ƒå‡†å¤‡ã€å®¹å™¨åˆ›å»ºå’Œ Bean æ³¨å…¥ã€‚</p>
<ol>
<li>å¼€å¯è®¡æ—¶ä¸ç›‘å¬</li>
</ol>
<ul>
<li><strong>å¯åŠ¨ StopWatch</strong>ï¼šè®°å½•å¯åŠ¨è€—æ—¶ã€‚</li>
<li><strong>è·å–å¹¶å¯åŠ¨ç›‘å¬å™¨</strong>ï¼šä» spring.factories è·å– SpringApplicationRunListenersï¼Œå¹¶å‘å¸ƒâ€œæ­£åœ¨å¯åŠ¨â€çš„äº‹ä»¶ï¼ˆstartingï¼‰ã€‚</li>
</ul>
<ol>
<li>å‡†å¤‡ç¯å¢ƒ (Environment)</li>
</ol>
<ul>
<li><strong>å°è£…å‘½ä»¤è¡Œå‚æ•°</strong>ï¼šå°† args å°è£…è¿› DefaultApplicationArgumentsã€‚</li>
<li><strong>åˆ›å»ºå¹¶é…ç½® Environment</strong>ï¼šè¯»å– application.properties/yml ä»¥åŠç¯å¢ƒå˜é‡ã€‚</li>
<li><strong>å‘å¸ƒç¯å¢ƒå‡†å¤‡å°±ç»ªäº‹ä»¶</strong>ï¼šé€šçŸ¥ç›‘å¬å™¨ç¯å¢ƒå·² OKã€‚</li>
</ul>
<ol>
<li>åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡ (ApplicationContext)</li>
</ol>
<ul>
<li>æ ¹æ®ç¬¬ä¸€é˜¶æ®µæ¨æ–­çš„ç±»å‹ï¼Œé€šè¿‡åå°„åˆ›å»ºå…·ä½“çš„å®¹å™¨ï¼š<ul>
<li>Servlet åº”ç”¨ï¼šAnnotationConfigServletWebServerApplicationContext</li>
<li>Reactive åº”ç”¨ï¼šAnnotationConfigReactiveWebServerApplicationContext</li>
</ul>
</li>
</ul>
<ol>
<li>å®¹å™¨é¢„å¤„ç† (prepareContext)</li>
</ol>
<ul>
<li><strong>å…³è”ç¯å¢ƒ</strong>ï¼šå°† Environment æ³¨å…¥å®¹å™¨ã€‚</li>
<li><strong>åº”ç”¨åˆå§‹åŒ–å™¨</strong>ï¼šæ‰§è¡Œä¹‹å‰åŠ è½½çš„ Initializersã€‚</li>
<li><strong>åŠ è½½èµ„æº</strong>ï¼šå°†ä¸»å¯åŠ¨ç±»ï¼ˆMain Classï¼‰æ³¨å†Œä¸º Bean å®šä¹‰ï¼ˆBeanDefinitionï¼‰ï¼Œè¿™æ˜¯åç»­è‡ªåŠ¨é…ç½®çš„å…¥å£ã€‚</li>
<li><strong>å‘å¸ƒä¸Šä¸‹æ–‡å‡†å¤‡å°±ç»ªäº‹ä»¶</strong>ã€‚</li>
</ul>
<ol>
<li>åˆ·æ–°å®¹å™¨ (refreshContext) â€”â€” <strong>æœ€é‡è¦çš„æ­¥éª¤</strong></li>
</ol>
<p>è¿™ä¸€æ­¥è°ƒç”¨çš„æ˜¯ Spring æ ¸å¿ƒæ¡†æ¶çš„ refresh() æ–¹æ³•ï¼Œå®ƒæ˜¯ <strong>Bean ç”Ÿå‘½å‘¨æœŸçš„æ ¸å¿ƒ</strong>ï¼š</p>
<ul>
<li><strong>è§£æé…ç½®ç±»</strong>ï¼šConfigurationClassPostProcessor å¼€å§‹å·¥ä½œï¼Œè§£æ @SpringBootApplicationï¼Œæ‰«æåŒ…ï¼Œè§£æ @Importã€‚</li>
<li><strong>è‡ªåŠ¨é…ç½® (Auto-Configuration)</strong>ï¼šæ ¹æ® Condition æ¡ä»¶å†³å®šå“ªäº›é…ç½®ç”Ÿæ•ˆã€‚</li>
<li><strong>å®ä¾‹åŒ– Bean</strong>ï¼šåˆ›å»ºæ‰€æœ‰çš„å•ä¾‹ Beanï¼ˆService, Controller ç­‰ï¼‰ã€‚</li>
<li><strong>å¯åŠ¨å†…åµŒæœåŠ¡å™¨</strong>ï¼šå¦‚æœæ˜¯ Web é¡¹ç›®ï¼Œåœ¨ onRefresh é˜¶æ®µä¼šåˆ›å»ºå¹¶å¯åŠ¨ <strong>Tomcat/Jetty</strong>ã€‚</li>
</ul>
<ol>
<li>å®¹å™¨åˆ·æ–°åå¤„ç† (afterRefresh)</li>
</ol>
<ul>
<li>åœæ­¢ StopWatch è®¡æ—¶ã€‚</li>
<li>æ‰“å°å¯åŠ¨æˆåŠŸçš„æ—¥å¿—ã€‚</li>
<li><strong>å‘å¸ƒåº”ç”¨å·²å¯åŠ¨äº‹ä»¶</strong>ã€‚</li>
</ul>
<ol>
<li>æ‰§è¡Œ Runner (Call Runners)</li>
</ol>
<ul>
<li>æŸ¥æ‰¾å¹¶ä¾æ¬¡æ‰§è¡Œå®ç°äº† CommandLineRunner æˆ– ApplicationRunner æ¥å£çš„ç±»ã€‚è¿™é€šå¸¸ç”¨äºåœ¨é¡¹ç›®å¯åŠ¨åç«‹å³æ‰§è¡ŒæŸäº›åˆå§‹åŒ–é€»è¾‘ï¼ˆå¦‚é¢„çƒ­ç¼“å­˜ï¼‰ã€‚</li>
</ul>
<h4 id="3ã€è‡ªå®šä¹‰starter"><a href="#3ã€è‡ªå®šä¹‰starter" class="headerlink" title="3ã€è‡ªå®šä¹‰starter"></a>3ã€è‡ªå®šä¹‰starter</h4><p>ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰starter</p>
<blockquote>
<p>åœºæ™¯ï¼šæŠ½å–èŠå¤©æœºå™¨â¼ˆåœºæ™¯ï¼Œå®ƒå¯ä»¥æ‰“æ‹›å‘¼ã€‚</p>
<p>æ•ˆæœï¼šä»»ä½•é¡¹â½¬å¯¼â¼Šæ­¤  starter  éƒ½å…·æœ‰æ‰“æ‹›å‘¼åŠŸèƒ½ï¼Œå¹¶ä¸”é—®å€™è¯­ä¸­çš„â¼ˆåéœ€è¦å¯ä»¥åœ¨é…ç½®â½‚ä»¶ä¸­ä¿® æ”¹</p>
</blockquote>
<ol>
<li>åˆ›å»º â¾ƒå®šä¹‰ starter  é¡¹â½¬ï¼Œå¼•â¼Š spring-boot-starter  åŸºç¡€ä¾èµ– </li>
<li>ç¼–å†™æ¨¡å—åŠŸèƒ½ï¼Œå¼•â¼Šæ¨¡å—æ‰€æœ‰éœ€è¦çš„ä¾èµ–ã€‚ </li>
<li>ç¼–å†™ xxxAutoConfiguration  â¾ƒåŠ¨é…ç½®ç±»ï¼Œå¸®å…¶ä»–é¡¹â½¬å¯¼â¼Šè¿™ä¸ªæ¨¡å—éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ </li>
<li>ç¼–å†™é…ç½®â½‚ä»¶ META-INF/spring/org.springframework.boot.autoconfigure. AutoConfiguration.imports  æŒ‡å®šå¯åŠ¨éœ€è¦åŠ è½½çš„â¾ƒåŠ¨é…ç½® </li>
<li>å…¶ä»–é¡¹â½¬å¼•â¼Šå³å¯ä½¿â½¤</li>
</ol>
<h5 id="1ã€ä¸šåŠ¡ä»£ç "><a href="#1ã€ä¸šåŠ¡ä»£ç " class="headerlink" title="1ã€ä¸šåŠ¡ä»£ç "></a>1ã€ä¸šåŠ¡ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;robot&quot;)</span>  <span class="comment">//æ­¤å±æ€§ç±»å’Œé…ç½®â½‚ä»¶æŒ‡å®šå‰ç¼€ç»‘å®š</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RobotProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€åŸºæœ¬æŠ½å–"><a href="#2ã€åŸºæœ¬æŠ½å–" class="headerlink" title="2ã€åŸºæœ¬æŠ½å–"></a>2ã€åŸºæœ¬æŠ½å–</h5><p>åˆ›å»ºstarteré¡¹â½¬ï¼ŒæŠŠå…¬å…±ä»£ç éœ€è¦çš„æ‰€æœ‰ä¾èµ–å¯¼â¼Š </p>
<p>æŠŠå…¬å…±ä»£ç å¤åˆ¶è¿›æ¥ </p>
<p>â¾ƒâ¼°å†™â¼€ä¸ª  </p>
<p>RobotAutoConfiguration  ï¼Œç»™å®¹å™¨ä¸­å¯¼â¼Šè¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ </p>
<p>â€‹    ä¸ºä»€ä¹ˆè¿™äº›ç»„ä»¶é»˜è®¤ä¸ä¼šæ‰«æè¿›å»ï¼Ÿ </p>
<p>â€‹    starteræ‰€åœ¨çš„åŒ…å’Œ å¼•â¼Šå®ƒçš„é¡¹â½¬çš„ä¸»ç¨‹åºæ‰€åœ¨çš„åŒ…ä¸æ˜¯â½—â¼¦å±‚çº§</p>
<p>åˆ«â¼ˆå¼•â½¤è¿™ä¸ª starter   ï¼Œç›´æ¥å¯¼â¼Šè¿™ä¸ª RobotAutoConfiguration  ,å°±èƒ½æŠŠè¿™ä¸ªåœºæ™¯çš„ç»„ä»¶å¯¼â¼Šè¿›æ¥</p>
<p>åŠŸèƒ½â½£æ•ˆ</p>
<p>æµ‹è¯•ç¼–å†™é…ç½®â½‚ä»¶</p>
<h5 id="3ã€ä½¿ç”¨-EnableXxxæœºåˆ¶"><a href="#3ã€ä½¿ç”¨-EnableXxxæœºåˆ¶" class="headerlink" title="3ã€ä½¿ç”¨@EnableXxxæœºåˆ¶"></a>3ã€ä½¿ç”¨@EnableXxxæœºåˆ¶</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(RobotAutoConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableRobot &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ«â¼ˆå¼•â¼Š starter  éœ€è¦ä½¿â½¤  @EnableRobot  å¼€å¯åŠŸèƒ½ </p>
<h5 id="4ã€å®Œå…¨è‡ªåŠ¨é…ç½®"><a href="#4ã€å®Œå…¨è‡ªåŠ¨é…ç½®" class="headerlink" title="4ã€å®Œå…¨è‡ªåŠ¨é…ç½®"></a>4ã€å®Œå…¨è‡ªåŠ¨é…ç½®</h5><p>ä¾èµ–SpringBootçš„SPIæœºåˆ¶ Java </p>
<p>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports  â½‚ä»¶ä¸­ç¼–å†™å¥½æˆ‘ä»¬â¾ƒåŠ¨é…ç½®ç±»çš„å…¨ç±»åå³å¯ </p>
<p>é¡¹â½¬å¯åŠ¨ï¼Œâ¾ƒåŠ¨åŠ è½½æˆ‘ä»¬çš„â¾ƒåŠ¨é…ç½®ç±»</p>
<h5 id="å®Œæ•´æ¡ˆä¾‹"><a href="#å®Œæ•´æ¡ˆä¾‹" class="headerlink" title="å®Œæ•´æ¡ˆä¾‹"></a>å®Œæ•´æ¡ˆä¾‹</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hello-spring-boot-starter/</span><br><span class="line">â”œâ”€â”€ pom.xml</span><br><span class="line">â””â”€â”€ src/main/java</span><br><span class="line">    â””â”€â”€ com/example/starter</span><br><span class="line">        â”œâ”€â”€ HelloProperties.java      // é…ç½®å±æ€§</span><br><span class="line">        â”œâ”€â”€ HelloService.java         // æ ¸å¿ƒæœåŠ¡</span><br><span class="line">        â””â”€â”€ HelloAutoConfiguration.java // è‡ªåŠ¨é…ç½®ç±»</span><br><span class="line">â””â”€â”€ src/main/resources</span><br><span class="line">    â””â”€â”€ META-INF</span><br><span class="line">        â””â”€â”€ spring</span><br><span class="line">            â””â”€â”€ org.springframework.boot.autoconfigure.AutoConfiguration.imports</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Starter é¡¹ç›®ï¼ˆMavenï¼‰</span></span><br><span class="line"><span class="comment">//1ã€pomæ–‡ä»¶ä¸è¦å¼•å…¥ spring-boot-starterï¼ˆé¿å…ä¼ é€’ä¾èµ–æ±¡æŸ“ï¼‰åªä¾èµ– spring-boot-autoconfigure</span></span><br><span class="line"><span class="comment">//ç¬¬äºŒæ­¥ï¼šç¼–å†™æ ¸å¿ƒä»£ç </span></span><br><span class="line"><span class="comment">//2.1 é…ç½®å±æ€§ç±»ï¼šHelloProperties.java</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;example.hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰“æ‹›å‘¼çš„å‰ç¼€ï¼Œé»˜è®¤ &quot;Hello&quot;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPrefix</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrefix</span><span class="params">(String prefix)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.prefix = prefix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.2 æœåŠ¡ç±»ï¼šHelloService.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String prefix;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloService</span><span class="params">(String prefix)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.prefix = prefix;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> prefix + <span class="string">&quot;, &quot;</span> + name + <span class="string">&quot;!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.3 è‡ªåŠ¨é…ç½®ç±»ï¼šHelloAutoConfiguration.java</span></span><br><span class="line"><span class="meta">@AutoConfiguration</span> <span class="comment">// Spring Boot 2.7+ æ¨èæ³¨è§£ï¼ˆæ›¿ä»£ @Configuration + EnableAutoConfigurationï¼‰</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(HelloProperties.class)</span> <span class="comment">// ç»‘å®šé…ç½®</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloAutoConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span> <span class="comment">// å¦‚æœç”¨æˆ·æ²¡è‡ªå®šä¹‰ HelloServiceï¼Œæ‰è‡ªåŠ¨åˆ›å»º</span></span><br><span class="line">    <span class="keyword">public</span> HelloService <span class="title function_">helloService</span><span class="params">(HelloProperties properties)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HelloService</span>(properties.getPrefix());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.4 æ³¨å†Œè‡ªåŠ¨é…ç½®ç±»ï¼ˆå…³é”®ï¼ï¼‰</span></span><br><span class="line"><span class="comment">//åˆ›å»ºæ–‡ä»¶ï¼šsrc/main/resources/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</span></span><br><span class="line"><span class="comment">//å†…å®¹</span></span><br><span class="line"><span class="comment">//com.example.starter.HelloAutoConfiguration</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸‰æ­¥ï¼šå®‰è£…åˆ°æœ¬åœ° Maven ä»“åº“</span></span><br><span class="line"><span class="comment">//åœ¨ hello-spring-boot-starter ç›®å½•ä¸‹æ‰§è¡Œï¼š</span></span><br><span class="line"><span class="comment">//mvn clean installè¿™ä¸ªå‘½ä»¤å°±æŠŠè¿™ä¸ªæ‰“åŒ…æˆmvnäº†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç„¶åå†ä¸»åº”ç”¨mavenä¸­å¯¼å…¥å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†</span></span><br></pre></td></tr></table></figure>
<h2 id="SpringBoot3åœºæ™¯æ•´åˆ"><a href="#SpringBoot3åœºæ™¯æ•´åˆ" class="headerlink" title="SpringBoot3åœºæ™¯æ•´åˆ"></a>SpringBoot3åœºæ™¯æ•´åˆ</h2><h3 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h3><h4 id="0-äº‘æœåŠ¡å™¨"><a href="#0-äº‘æœåŠ¡å™¨" class="headerlink" title="0 äº‘æœåŠ¡å™¨"></a>0 äº‘æœåŠ¡å™¨</h4><p>æœåŠ¡å™¨å¼€é€šï¼Œç„¶åå®‰è£…ä»¥ä¸‹ç»„ä»¶</p>
<ul>
<li>docker</li>
<li>redis</li>
<li>kafka</li>
<li>prometheus</li>
<li>grafana</li>
</ul>
<p>å¼€é€šé˜¿é‡Œäº‘æœåŠ¡å™¨ä¸ºä¾‹</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/1985852996194693312">(12 å°ç§ä¿¡ / 2 æ¡æ¶ˆæ¯) 2026å¹´é˜¿é‡Œäº‘å…è´¹äº‘æœåŠ¡å™¨åŠå­¦ç”Ÿäº‘æœåŠ¡å™¨ç”³è¯·å›¾æ–‡æ•™ç¨‹ - çŸ¥ä¹</a></p>
<p>åˆ›å»ºå®Œä¹‹ååˆ©ç”¨MobaXtermè¿ä¸Šlinuxä¸»æœºã€‚å…¬ç½‘IPï¼Œç„¶åç«¯å£å·22ï¼ˆSSH æœåŠ¡é»˜è®¤ç›‘å¬çš„ç«¯å£ï¼‰ï¼Œç”¨æˆ·root </p>
<p><strong>å…¬ç½‘æƒ³è¦è®¿é—®ç«¯å£å·éœ€è¦è®¾ç½®å®‰å…¨ç»„</strong></p>
<h4 id="1-dockerå®‰è£…"><a href="#1-dockerå®‰è£…" class="headerlink" title="1 dockerå®‰è£…"></a>1 dockerå®‰è£…</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1</span>. å®‰è£… yum-utils å·¥å…·é›†ï¼ˆæä¾› yum-config-manager å‘½ä»¤ï¼Œç”¨äºæ·»åŠ è½¯ä»¶ä»“åº“é…ç½®ï¼‰</span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line"># <span class="number">2</span>. æ·»åŠ  Docker å®˜æ–¹ YUM è½¯ä»¶ä»“åº“ï¼ˆç¡®ä¿å®‰è£…çš„æ˜¯å®˜æ–¹æ­£ç‰ˆ Dockerï¼Œè€Œé CentOS è‡ªå¸¦çš„æ—§ç‰ˆæœ¬ï¼‰</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line"><span class="function">https://<span class="title">download.docker.com</span>/<span class="title">linux</span>/<span class="title">centos</span>/<span class="title">docker</span>-<span class="title">ce.repo</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">sudo</span> <span class="title">yum</span>-<span class="title">config</span>-<span class="title">manager</span> --<span class="title">add</span>-<span class="title">repo</span> <span class="title">https</span>://<span class="title">mirrors.aliyun.com</span>/<span class="title">docker</span>-<span class="title">ce</span>/<span class="title">linux</span>/<span class="title">centos</span>/<span class="title">docker</span>-<span class="title">ce.repo</span></span></span><br><span class="line"><span class="function"># 3. å®‰è£… <span class="title">Docker</span> æ ¸å¿ƒç»„ä»¶åŠç›¸å…³æ’ä»¶</span></span><br><span class="line"><span class="function"># <span class="title">docker</span>-<span class="title">ce</span>ï¼š<span class="title">Docker</span> ç¤¾åŒºç‰ˆæœåŠ¡ç«¯ï¼ˆæ ¸å¿ƒç¨‹åºï¼‰</span></span><br><span class="line"><span class="function"># <span class="title">docker</span>-<span class="title">ce</span>-<span class="title">cli</span>ï¼š<span class="title">Docker</span> å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼ˆç”¨äºæ‰§è¡Œ <span class="title">docker</span> ç›¸å…³å‘½ä»¤ï¼‰</span></span><br><span class="line"><span class="function"># <span class="title">containerd.io</span>ï¼šå®¹å™¨è¿è¡Œæ—¶ï¼ˆè´Ÿè´£ç®¡ç†å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼‰</span></span><br><span class="line"><span class="function"># <span class="title">docker</span>-<span class="title">buildx</span>-<span class="title">plugin</span>ï¼š<span class="title">Docker</span> æ„å»ºå¢å¼ºæ’ä»¶ï¼ˆæ”¯æŒå¤šæ¶æ„æ„å»ºç­‰é«˜çº§åŠŸèƒ½ï¼‰</span></span><br><span class="line"><span class="function"># <span class="title">docker</span>-<span class="title">compose</span>-<span class="title">plugin</span>ï¼š<span class="title">Docker</span> ç¼–æ’æ’ä»¶ï¼ˆæ”¯æŒ <span class="title">docker</span> <span class="title">compose</span> å‘½ä»¤ï¼Œç”¨äºç®¡ç†å¤šå®¹å™¨åº”ç”¨ï¼‰</span></span><br><span class="line"><span class="function"><span class="title">sudo</span> <span class="title">yum</span> <span class="title">install</span> <span class="title">docker</span>-<span class="title">ce</span> <span class="title">docker</span>-<span class="title">ce</span>-<span class="title">cli</span> <span class="title">containerd.io</span> <span class="title">docker</span>-<span class="title">buildx</span>-<span class="title">plugin</span> <span class="title">docker</span>-<span class="title">compose</span>-<span class="title">plugin</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># 4. è®¾ç½® <span class="title">Docker</span> æœåŠ¡å¼€æœºè‡ªå¯ï¼Œå¹¶ç«‹å³å¯åŠ¨ <span class="title">Docker</span> æœåŠ¡</span></span><br><span class="line"><span class="function"># <span class="title">enable</span>ï¼šé…ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line"><span class="function"># --<span class="title">now</span>ï¼šç«‹å³æ‰§è¡Œå¯åŠ¨æ“ä½œï¼ˆç­‰åŒäºå…ˆæ‰§è¡Œ <span class="title">systemctl</span> <span class="title">enable</span> <span class="title">docker</span>ï¼Œå†æ‰§è¡Œ <span class="title">systemctl</span> <span class="title">start</span> <span class="title">docker</span>ï¼‰</span></span><br><span class="line"><span class="function"><span class="title">sudo</span> <span class="title">systemctl</span> <span class="title">enable</span> <span class="title">docker</span> --<span class="title">now</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># 5. éªŒè¯ <span class="title">Docker</span> æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ</span></span><br><span class="line"><span class="function"># <span class="title">docker</span> <span class="title">ps</span>ï¼šåˆ—å‡ºå½“å‰è¿è¡Œä¸­çš„å®¹å™¨ï¼Œè‹¥å‘½ä»¤ä¸æŠ¥é”™ï¼ˆå³ä½¿æ— å®¹å™¨è¾“å‡ºï¼‰ï¼Œè¯´æ˜ <span class="title">Docker</span> æœåŠ¡å·²æ­£å¸¸å¯åŠ¨</span></span><br><span class="line"><span class="function"><span class="title">docker</span> <span class="title">ps</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># 6. ï¼ˆè¡¥å……è¯´æ˜ï¼‰è‹¥éœ€é€šè¿‡ <span class="title">docker</span> <span class="title">compose</span> æ‰¹é‡éƒ¨ç½²/å®‰è£…è½¯ä»¶ï¼ˆç¼–æ’å¤šå®¹å™¨åº”ç”¨ï¼‰</span></span><br><span class="line"><span class="function"># éœ€å…ˆç¼–å†™ <span class="title">docker</span>-<span class="title">compose.yml</span> é…ç½®æ–‡ä»¶ï¼Œå†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ³¨é‡Šå†…ä¸ºç¤ºä¾‹å‘½ä»¤ï¼Œéœ€æ ¹æ®å®é™…é…ç½®æ–‡ä»¶è°ƒæ•´ï¼‰</span></span><br><span class="line"><span class="function"># <span class="title">docker</span> <span class="title">compose</span> <span class="title">up</span> -<span class="title">d</span>  # åå°å¯åŠ¨ <span class="title">docker</span>-<span class="title">compose.yml</span> ä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡</span></span><br><span class="line"><span class="function"># <span class="title">docker</span> <span class="title">compose</span> <span class="title">down</span>    # åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰æœåŠ¡å®¹å™¨ã€ç½‘ç»œç­‰</span></span><br><span class="line"><span class="function"># <span class="title">docker</span> <span class="title">compose</span> <span class="title">up</span> -<span class="title">d</span> --<span class="title">build</span>  # è‹¥é•œåƒéœ€é‡æ–°æ„å»ºï¼Œåå°å¯åŠ¨æ‰€æœ‰æœåŠ¡</span></span><br></pre></td></tr></table></figure>
<p><strong>åˆ›å»º  <code>/prod</code> æ–‡ä»¶å¤¹ ,å‡†å¤‡ä»¥ä¸‹æ–‡ä»¶</strong></p>
<h4 id="2-prometheus-yml"><a href="#2-prometheus-yml" class="headerlink" title="2 prometheus.yml"></a>2 prometheus.yml</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Prometheus å…¨å±€é…ç½®</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="comment"># æŠ“å–ç›®æ ‡æŒ‡æ ‡çš„é—´éš”æ—¶é—´</span></span><br><span class="line">  <span class="attr">scrape_interval:</span> <span class="string">15s</span></span><br><span class="line">  <span class="comment"># è¯„ä¼°å‘Šè­¦è§„åˆ™å’Œè®°å½•è§„åˆ™çš„é—´éš”æ—¶é—´</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠ“å–é…ç½®åˆ—è¡¨ï¼ˆå®šä¹‰éœ€è¦ç›‘æ§çš„ç›®æ ‡ï¼‰</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># ç›‘æ§ Prometheus è‡ªèº«</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;prometheus&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;localhost:9090&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ç›‘æ§ Redis æœåŠ¡</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;redis&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;redis:6379&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ç›‘æ§ Kafka æœåŠ¡</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;kafka:9092&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h4 id="3-docker-compose-yml"><a href="#3-docker-compose-yml" class="headerlink" title="3 docker-compose.yml"></a>3 docker-compose.yml</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Docker Compose é…ç½®ç‰ˆæœ¬ï¼ˆ3.9 å…¼å®¹å¤§éƒ¨åˆ† Docker ç‰ˆæœ¬ï¼Œç¨³å®šæ€§å¼ºï¼‰</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.9&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ‰€æœ‰æœåŠ¡å®¹å™¨</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="comment"># Redis æœåŠ¡</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span>  <span class="comment"># å®¹å™¨å¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span>  <span class="comment"># ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ æ˜ å°„</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span>  <span class="comment"># åŠ å…¥ backend è‡ªå®šä¹‰ç½‘ç»œ</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Zookeeper æœåŠ¡ï¼ˆä¸º Kafka æä¾›åè°ƒæ”¯æŒï¼‰</span></span><br><span class="line">  <span class="attr">zookeeper:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">bitnami/zookeeper:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># Zookeeper å®¢æˆ·ç«¯è¿æ¥ç«¯å£</span></span><br><span class="line">      <span class="attr">ZOOKEEPER_CLIENT_PORT:</span> <span class="number">2181</span></span><br><span class="line">      <span class="comment"># å…³é”®ï¼šå¼€å¯åŒ¿åç™»å½•ï¼Œè§£å†³Zookeeperå¯åŠ¨å¤±è´¥</span></span><br><span class="line">      <span class="attr">ALLOW_ANONYMOUS_LOGIN:</span> <span class="string">&quot;yes&quot;</span></span><br><span class="line">      <span class="comment"># Zookeeper å¿ƒè·³é—´éš”æ—¶é—´</span></span><br><span class="line">      <span class="attr">ZOOKEEPER_TICK_TIME:</span> <span class="number">2000</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">kafka:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wurstmeister/kafka</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kafka</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9092:9092&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># ä»…ç”¨å®¹å™¨åè¿æ¥ Zookeeperï¼Œæ ¼å¼æ— é”™ï¼ŒåŒä¸€ backend ç½‘ç»œå¯è§£æ</span></span><br><span class="line">      <span class="attr">KAFKA_ZOOKEEPER_CONNECT:</span> <span class="string">zookeeper:2181</span></span><br><span class="line">      <span class="comment"># å•èŠ‚ç‚¹å¿…é…ï¼Œé¿å…å‰¯æœ¬æ•°å†²çª</span></span><br><span class="line">      <span class="attr">KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR:</span> <span class="number">1</span></span><br><span class="line">      <span class="comment"># æ ¸å¿ƒï¼šå…¬å‘Šåœ°å€ä¸ºå®¹å™¨å kafka:9092ï¼Œä¸ Kafka UI è¿æ¥åœ°å€å®Œå…¨ä¸€è‡´</span></span><br><span class="line">      <span class="attr">KAFKA_ADVERTISED_LISTENERS:</span> <span class="string">PLAINTEXT://kafka:9092</span></span><br><span class="line">      <span class="comment"># æ ¸å¿ƒï¼šç›‘å¬å®¹å™¨å†…æ‰€æœ‰ç½‘å¡ï¼Œç¡®ä¿èƒ½æ¥æ”¶ Kafka UI çš„è¿æ¥</span></span><br><span class="line">      <span class="attr">KAFKA_LISTENERS:</span> <span class="string">PLAINTEXT://0.0.0.0:9092</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Kafka UI å¯è§†åŒ–ç®¡ç†å·¥å…·</span></span><br><span class="line">  <span class="attr">kafka-ui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">provectuslabs/kafka-ui:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kafka-ui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">kafka</span>  <span class="comment"># ä¾èµ– Kafka æœåŠ¡</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span>  <span class="comment"># è®¿é—®ç«¯å£ï¼šä¸»æœº 8080 å¯¹åº”å®¹å™¨ 8080</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># å®šä¹‰ Kafka é›†ç¾¤åç§°</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_NAME:</span> <span class="string">dev</span></span><br><span class="line">      <span class="comment"># ğŸ‘‡ æ–°å¢è¿™ä¸€è¡Œï¼šå‘Šè¯‰ Kafka UI Zookeeper åœ°å€</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_ZOOKEEPER:</span> <span class="string">zookeeper:2181</span></span><br><span class="line">      <span class="comment"># è¿æ¥ Kafka é›†ç¾¤çš„åœ°å€</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS:</span> <span class="string">kafka:9092</span></span><br><span class="line">      <span class="comment"># å¯é€‰ï¼šå»¶é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé¿å…çŸ­æš‚å»¶è¿Ÿè¢«åˆ¤å®šä¸º offline</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_CONNECT_TIMEOUT:</span> <span class="number">10000</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_READ_TIMEOUT:</span> <span class="number">30000</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Prometheus ç›‘æ§æœåŠ¡</span></span><br><span class="line">  <span class="attr">prometheus:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">prom/prometheus:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">prometheus</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="comment"># æŒ‚è½½æœ¬åœ° prometheus.yml é…ç½®æ–‡ä»¶åˆ°å®¹å™¨å†…å¯¹åº”è·¯å¾„</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./prometheus.yml:/etc/prometheus/prometheus.yml</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9090:9090&quot;</span>  <span class="comment"># Prometheus è®¿é—®ç«¯å£</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Grafana å¯è§†åŒ–ç›‘æ§é¢æ¿</span></span><br><span class="line">  <span class="attr">grafana:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">grafana/grafana:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">grafana</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">prometheus</span>  <span class="comment"># ä¾èµ– Prometheusï¼Œè·å–ç›‘æ§æ•°æ®</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span>  <span class="comment"># Grafana è®¿é—®ç«¯å£ï¼ˆé»˜è®¤è´¦å·å¯†ç ï¼šadmin/adminï¼‰</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">backend</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰è‡ªå®šä¹‰ç½‘ç»œï¼ˆä½¿æ‰€æœ‰æœåŠ¡åœ¨åŒä¸€ç½‘ç»œå†…ï¼Œå¯é€šè¿‡å®¹å™¨åäº’ç›¸è®¿é—®ï¼‰</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">backend:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">backend</span>  <span class="comment"># è‡ªå®šä¹‰ç½‘ç»œåç§°ä¸º backend</span></span><br></pre></td></tr></table></figure>
<h4 id="4-å¯åŠ¨ç¯å¢ƒ"><a href="#4-å¯åŠ¨ç¯å¢ƒ" class="headerlink" title="4 å¯åŠ¨ç¯å¢ƒ"></a>4 å¯åŠ¨ç¯å¢ƒ</h4><p>å¦‚æœå¤±è´¥é…ç½®é•œåƒåŠ é€Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose -f docker-compose.yml up -d</span><br></pre></td></tr></table></figure>
<h4 id="5-éªŒè¯"><a href="#5-éªŒè¯" class="headerlink" title="5 éªŒè¯"></a>5 éªŒè¯</h4><ul>
<li>redis: ä½ çš„ipï¼š6379<ul>
<li>å¡«å†™è¡¨å•ï¼Œä¸‹è½½å¯è§†åŒ–å·¥å…·</li>
<li>redisinsight</li>
</ul>
</li>
</ul>
<p>pomå¯¼å…¥</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®yaml</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">boot3-09-redis</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.data.redis.host</span>=<span class="string">ä½ çš„redisIP</span></span><br><span class="line"><span class="attr">spring.data.redis.port</span>=<span class="string">6379</span></span><br></pre></td></tr></table></figure>
<p>ç¼–å†™ä¸šåŠ¡</p>
<p>ç¼–å†™controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisTestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/count&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">count</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().increment(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;è®¿é—®äº†ï¼š&quot;</span>+ count + <span class="string">&quot;æ¬¡&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸»å¯åŠ¨</p>
<p>æµ‹è¯•æˆåŠŸã€‚</p>
<h3 id="Redisæ•´åˆ"><a href="#Redisæ•´åˆ" class="headerlink" title="Redisæ•´åˆ"></a>Redisæ•´åˆ</h3><h4 id="Redisè‡ªåŠ¨é…ç½®åŸç†"><a href="#Redisè‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="Redisè‡ªåŠ¨é…ç½®åŸç†"></a>Redisè‡ªåŠ¨é…ç½®åŸç†</h4><ol>
<li><code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>ä¸­ å¯¼â¼Šäº† <code>RedisAutoConfiguration</code>  ã€ <code>RedisReactiveAutoConfiguration</code>å’Œ <code>RedisRepositoriesAutoConfiguration</code>ã€‚æ‰€æœ‰å±æ€§ç»‘å®šåœ¨ <code>RedisProperties</code>  ä¸­ </li>
<li><code>RedisReactiveAutoConfiguration</code>å±äºå“åº”å¼ç¼–ç¨‹ï¼Œä¸â½¤ç®¡ã€‚ <code>RedisRepositoriesAutoConfiguration</code>å±äº JPA æ“ä½œï¼Œä¹Ÿä¸â½¤ç®¡ </li>
<li><code>RedisAutoConfiguration</code> é…ç½®äº†ä»¥ä¸‹ç»„ä»¶ <ol>
<li><code>LettuceConnectionConfiguration</code>ï¼š ç»™å®¹å™¨ä¸­æ³¨â¼Šäº†è¿æ¥â¼¯â¼š <code>LettuceConnectionFactory</code>ï¼Œå’Œæ“ä½œ redis çš„å®¢æˆ·ç«¯ <code>DefaultClientResources</code>ã€‚</li>
<li><code>RedisTemplate</code>  ï¼š å¯ç»™ redis ä¸­å­˜å‚¨ä»»æ„å¯¹è±¡ï¼Œä¼šä½¿â½¤ jdk é»˜ è®¤åºåˆ—åŒ–â½…å¼ã€‚ </li>
<li><code>StringRedisTemplate</code> ï¼š ç»™ redis ä¸­å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¦‚æœè¦å­˜å¯¹è±¡ï¼Œéœ€è¦å¼€å‘â¼ˆå‘˜â¾ƒ â¼°è¿›â¾åºåˆ—åŒ–ã€‚key-valueéƒ½æ˜¯å­—ç¬¦ä¸²è¿›â¾æ“ä½œ</li>
</ol>
</li>
</ol>
<h4 id="å®šåˆ¶åŒ–"><a href="#å®šåˆ¶åŒ–" class="headerlink" title="å®šåˆ¶åŒ–"></a>å®šåˆ¶åŒ–</h4><h5 id="1ã€åºåˆ—åŒ–æœºåˆ¶"><a href="#1ã€åºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="1ã€åºåˆ—åŒ–æœºåˆ¶"></a>1ã€åºåˆ—åŒ–æœºåˆ¶</h5><p>ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–æœºåˆ¶ï¼Ÿ</p>
<p>å› ä¸ºå¦‚æœæˆ‘ä»¬æƒ³ç»™redisä¼ å…¥å¯¹è±¡ï¼Œä½¿ç”¨RedisTemplateä¸­çš„æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šåˆ©ç”¨é»˜è®¤çš„åºåˆ—åŒ–æœºåˆ¶å¯¼è‡´ä¼ å…¥åˆ°redisçš„å¯¹è±¡æ˜¯ä¹±ç ï¼Œä¸ºäº†ç»Ÿä¸€ï¼Œæˆ‘ä»¬ç»Ÿä¸€è½¬ä¸ºjsonå­˜å‚¨ï¼Œé‚£ä¹ˆå°±éœ€è¦åºåˆ—åŒ–æœºåˆ¶äº†ã€‚å¦å¤–å¯¹è±¡æƒ³è¦åœ¨ç½‘ç»œä¼ è¾“éœ€è¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p>
<p>é‚£ä¹ˆ<strong>å¦‚æœæƒ³è¦æ”¹æ‰åºåˆ—åŒ–æœºåˆ¶</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>è‡ªå®šä¹‰edisTemplate</strong></p>
<p>æ–°å»ºä¸€ä¸ªé…ç½®ç±»configåŒ…ä¸‹AppRedisConfiguration</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis é…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * å…è®¸ Object ç±»å‹çš„ key-value éƒ½å¯ä»¥è¢«è½¬ä¸º json è¿›è¡Œå­˜å‚¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppRedisConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰ RedisTemplateï¼Œæ”¯æŒ Object ç±»å‹æ•°æ®çš„ JSON åºåˆ—åŒ–å­˜å‚¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisConnectionFactory Spring è‡ªåŠ¨é…ç½®çš„ Redis è¿æ¥å·¥å‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é…ç½®å¥½çš„ RedisTemplate&lt;Object, Object&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º RedisTemplate å®ä¾‹</span></span><br><span class="line">        RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½® Redis è¿æ¥å·¥å‚</span></span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é…ç½®é»˜è®¤åºåˆ—åŒ–å™¨ï¼šå°†å¯¹è±¡è½¬ä¸º JSON å­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨</span></span><br><span class="line">        template.setDefaultSerializer(<span class="keyword">new</span> <span class="title class_">GenericJackson2JsonRedisSerializer</span>());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿”å›é…ç½®å®Œæˆçš„ RedisTemplate</span></span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€rediså®¢æˆ·ç«¯"><a href="#2ã€rediså®¢æˆ·ç«¯" class="headerlink" title="2ã€rediså®¢æˆ·ç«¯"></a>2ã€rediså®¢æˆ·ç«¯</h5><blockquote>
<p>RedisTemplateã€StringRedisTemplateï¼š æ“ä½œredisçš„â¼¯å…·ç±» </p>
<p>è¦ä»redisçš„è¿æ¥â¼¯â¼šè·å–é“¾æ¥æ‰èƒ½æ“ä½œredis </p>
<p>Rediså®¢æˆ·ç«¯ </p>
<p>Lettuceï¼š é»˜è®¤ </p>
<p>Jedisï¼šå¯ä»¥ä½¿â½¤ä»¥ä¸‹åˆ‡æ¢</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.lettuce<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lettuce-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--åˆ‡æ¢jedisä½œä¸ºæ“ä½œredisçš„åº•å±‚å®¢æˆ·ç«¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.data.redis.host</span>=<span class="string">redisIP</span></span><br><span class="line"><span class="attr">spring.data.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment">#spring.data.redis.client-type=lettuce</span></span><br><span class="line"><span class="comment">#è®¾ç½®lettuceçš„åº•å±‚å‚æ•°</span></span><br><span class="line"><span class="comment">#spring.data.redis.lettuce.pool.enabled=true</span></span><br><span class="line"><span class="comment">#spring.data.redis.lettuce.pool.max-active=8</span></span><br><span class="line"><span class="attr">spring.data.redis.client-type</span>=<span class="string">jedis</span></span><br><span class="line"><span class="attr">spring.data.redis.jedis.pool.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.data.redis.jedis.pool.max-active</span>=<span class="string">8</span></span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>å¯¹æ¯”ç»´åº¦</th>
<th>Jedis</th>
<th>Lettuce</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>çº¿ç¨‹æ¨¡å‹</strong></td>
<td>éçº¿ç¨‹å®‰å…¨ï¼ˆå•çº¿ç¨‹ç‹¬å ä½¿ç”¨ï¼‰ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€é…åˆè¿æ¥æ± ï¼ˆå¦‚ JedisPoolï¼‰ä½¿ç”¨ï¼Œå¦åˆ™ä¼šå‡ºç°å¹¶å‘é—®é¢˜</td>
<td>çº¿ç¨‹å®‰å…¨ï¼ˆåŸºäº Netty å®ç°å¼‚æ­¥éé˜»å¡ I/Oï¼Œé‡‡ç”¨å…±äº«è¿æ¥æ¨¡å¼ï¼‰ï¼Œå¤šçº¿ç¨‹å¯å®‰å…¨å…±äº«ä¸€ä¸ªè¿æ¥å®ä¾‹ï¼Œæ— éœ€é¢å¤–å°è£…è¿æ¥æ± ï¼ˆåº•å±‚å·²ä¼˜åŒ–è¿æ¥ç®¡ç†ï¼‰</td>
</tr>
<tr>
<td><strong>I/O æ¨¡å‹</strong></td>
<td>åŒæ­¥é˜»å¡ I/Oï¼Œæ¯æ¬¡ Redis æ“ä½œéƒ½ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°è·å–å“åº”ç»“æœ</td>
<td>å¼‚æ­¥éé˜»å¡ I/Oï¼ˆåº•å±‚ä¾èµ– Netty æ¡†æ¶ï¼‰ï¼Œæ”¯æŒå¼‚æ­¥ã€å“åº”å¼ç¼–ç¨‹ï¼ˆé€‚é… Spring WebFluxï¼‰ï¼Œæ“ä½œä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œæ€§èƒ½æ›´é«˜</td>
</tr>
<tr>
<td><strong>åŠŸèƒ½æ”¯æŒ</strong></td>
<td>åŠŸèƒ½ç®€æ´ï¼Œä»…æ”¯æŒ Redis åŸºç¡€å‘½ä»¤æ“ä½œï¼Œä¸æ”¯æŒ Redis é›†ç¾¤ï¼ˆClusterï¼‰ã€å“¨å…µï¼ˆSentinelï¼‰ç­‰é«˜çº§ç‰¹æ€§çš„åŸç”Ÿå°è£…ï¼ˆéœ€é¢å¤–ä¾èµ–ç¬¬ä¸‰æ–¹å·¥å…·ï¼‰</td>
<td>åŠŸèƒ½ä¸°å¯Œï¼ŒåŸç”Ÿæ”¯æŒ Redis é›†ç¾¤ï¼ˆClusterï¼‰ã€å“¨å…µï¼ˆSentinelï¼‰ã€ç®¡é“ï¼ˆPipelineï¼‰ã€å‘å¸ƒè®¢é˜…ï¼ˆPub/Subï¼‰ç­‰é«˜çº§ç‰¹æ€§ï¼Œè¿˜æ”¯æŒ Redis 6.0+ çš„ RESP3 åè®®ã€ACL æƒé™æ§åˆ¶ç­‰æ–°ç‰¹æ€§</td>
</tr>
<tr>
<td><strong>è¿æ¥ç®¡ç†</strong></td>
<td>ç®€å•çš„è¿æ¥æ± ç®¡ç†ï¼ˆJedisPoolï¼‰ï¼Œé…ç½®ç›¸å¯¹ç¹çï¼Œè¿æ¥å¤ç”¨æ•ˆç‡ä¸€èˆ¬</td>
<td>åŸºäº Netty å®ç°é«˜æ•ˆè¿æ¥ç®¡ç†ï¼Œæ”¯æŒè‡ªåŠ¨é‡è¿ã€è¿æ¥æ± ä¼˜åŒ–ã€TCP è¿æ¥å¤ç”¨ï¼Œç®¡ç†æ›´æ™ºèƒ½ï¼Œæ€§èƒ½æŸè€—æ›´ä½</td>
</tr>
<tr>
<td><strong>ç¼–ç¨‹èŒƒå¼</strong></td>
<td>ä»…æ”¯æŒåŒæ­¥ç¼–ç¨‹ï¼Œä»£ç ç¼–å†™é£æ ¼ç®€æ´ç›´è§‚ï¼Œç¬¦åˆä¼ ç»ŸåŒæ­¥å¼€å‘ä¹ æƒ¯</td>
<td>æ”¯æŒåŒæ­¥ã€å¼‚æ­¥ï¼ˆCallback/Futureï¼‰ã€å“åº”å¼ï¼ˆReactiveï¼‰ä¸‰ç§ç¼–ç¨‹èŒƒå¼ï¼Œé€‚é…ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘éœ€æ±‚ï¼ˆå¦‚ Spring Cloud/Spring WebFluxï¼‰</td>
</tr>
<tr>
<td><strong>ä¾èµ–ä¸è½»é‡æ€§</strong></td>
<td>è½»é‡çº§ç»„ä»¶ï¼Œä¾èµ–æå°‘ï¼Œæ‰“åŒ…åä½“ç§¯å°ï¼Œå­¦ä¹ æˆæœ¬ä½</td>
<td>ä¾èµ– Netty æ¡†æ¶ï¼ˆå¼‚æ­¥ I/O æ ¸å¿ƒä¾èµ–ï¼‰ï¼Œæ‰“åŒ…åä½“ç§¯ç•¥å¤§ï¼Œå­¦ä¹ æˆæœ¬ç¨é«˜ï¼ˆéœ€äº†è§£å¼‚æ­¥ / å“åº”å¼ç¼–ç¨‹æ€æƒ³ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<h3 id="æ¥å£æ–‡æ¡£"><a href="#æ¥å£æ–‡æ¡£" class="headerlink" title="æ¥å£æ–‡æ¡£"></a>æ¥å£æ–‡æ¡£</h3><h4 id="OpenAPI-3-ä¸-Swagger"><a href="#OpenAPI-3-ä¸-Swagger" class="headerlink" title="OpenAPI 3 ä¸ Swagger"></a>OpenAPI 3 ä¸ Swagger</h4><blockquote>
<p>Swagger å¯ä»¥å¿«é€Ÿâ½£æˆå®æ—¶æ¥â¼â½‚æ¡£ï¼Œâ½…ä¾¿å‰åå¼€å‘â¼ˆå‘˜è¿›â¾åè°ƒæ²Ÿé€šã€‚éµå¾ª OpenAPI è§„èŒƒã€‚ â½‚æ¡£ï¼š<a target="_blank" rel="noopener" href="https://springdoc.org/v2/">https://springdoc.org/v2/</a></p>
</blockquote>
<h5 id="1ã€OpenAPI-3-æ¶æ„"><a href="#1ã€OpenAPI-3-æ¶æ„" class="headerlink" title="1ã€OpenAPI 3 æ¶æ„"></a>1ã€OpenAPI 3 æ¶æ„</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251228161500752.png" alt="image-20251228161500752"></p>
<h5 id="2ã€æ•´åˆ"><a href="#2ã€æ•´åˆ" class="headerlink" title="2ã€æ•´åˆ"></a>2ã€æ•´åˆ</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /api-docs endpoint custom path é»˜è®¤ /v3/api-docs</span></span><br><span class="line"><span class="attr">springdoc.api-docs.path</span>=<span class="string">/api-docs</span></span><br><span class="line"><span class="comment"># swagger ç›¸å…³é…ç½®åœ¨ springdoc.swagger-ui</span></span><br><span class="line"><span class="comment"># swagger-ui custom path</span></span><br><span class="line"><span class="attr">springdoc.swagger-ui.path</span>=<span class="string">/swagger-ui.html</span></span><br><span class="line"><span class="attr">springdoc.show-actuator</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<h5 id="3ã€ä½¿ç”¨"><a href="#3ã€ä½¿ç”¨" class="headerlink" title="3ã€ä½¿ç”¨"></a>3ã€ä½¿ç”¨</h5><h6 id="1ã€å¸¸ç”¨æ³¨è§£"><a href="#1ã€å¸¸ç”¨æ³¨è§£" class="headerlink" title="1ã€å¸¸ç”¨æ³¨è§£"></a>1ã€å¸¸ç”¨æ³¨è§£</h6><div class="table-container">
<table>
<thead>
<tr>
<th>æ³¨è§£åç§°</th>
<th>æ ‡æ³¨ä½ç½®</th>
<th>ä½œç”¨æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@Tag</code></td>
<td>controller ç±»</td>
<td>æ ‡è¯† controller çš„æ•´ä½“ä½œç”¨ï¼ˆç”¨é€”è¯´æ˜ï¼‰</td>
</tr>
<tr>
<td><code>@Parameter</code></td>
<td>æ–¹æ³•å‚æ•°</td>
<td>æ ‡è¯†å•ä¸ªå‚æ•°çš„ä½œç”¨ï¼ˆå‚æ•°è¯´æ˜ï¼‰</td>
</tr>
<tr>
<td><code>@Parameters</code></td>
<td>æ–¹æ³•</td>
<td>å¯¹æ–¹æ³•çš„å¤šä¸ªå‚æ•°è¿›è¡Œå¤šé‡è¯´æ˜ï¼ˆæ‰¹é‡å‚æ•°æè¿°ï¼‰</td>
</tr>
<tr>
<td><code>@Schema</code></td>
<td>model å±‚çš„ JavaBeanï¼ˆç±» / å±æ€§ï¼‰</td>
<td>æè¿°æ¨¡å‹çš„æ•´ä½“ä½œç”¨åŠæ¯ä¸ªå±æ€§çš„å«ä¹‰ã€çº¦æŸç­‰</td>
</tr>
<tr>
<td><code>@Operation</code></td>
<td>controller ä¸­çš„æ–¹æ³•</td>
<td>æè¿°å•ä¸ªæ¥å£æ–¹æ³•çš„ä½œç”¨ï¼ˆæ¥å£ç”¨é€”ã€åŠŸèƒ½è¯´æ˜ï¼‰</td>
</tr>
<tr>
<td><code>@ApiResponse</code></td>
<td>controller ä¸­çš„æ–¹æ³•</td>
<td>æè¿°æ¥å£çš„å•ä¸ªå“åº”çŠ¶æ€ç ã€å“åº”ä¿¡æ¯ã€å“åº”æ¨¡å‹ç­‰</td>
</tr>
</tbody>
</table>
</div>
<h6 id="2ã€Docketé…ç½®"><a href="#2ã€Docketé…ç½®" class="headerlink" title="2ã€Docketé…ç½®"></a>2ã€Docketé…ç½®</h6><blockquote>
<p>è¿™ä¸ªå°±æ˜¯è®©swagger-uiçš„ç•Œé¢æ›´åŠ å¥½çœ‹ï¼Œæ¯”å¦‚ä¸€ä¸ªéƒ¨é—¨ç±»é‡Œé¢çš„æ³¨é‡Šåœ¨ä¸€èµ·ï¼Œå‘˜å·¥ç±»çš„æ³¨é‡Šåœ¨ä¸€èµ·</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> GroupedOpenApi <span class="title function_">publicApi</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> GroupedOpenApi.builder()</span><br><span class="line">        .group(<span class="string">&quot;å‘˜å·¥ç®¡ç†&quot;</span>)</span><br><span class="line">        .pathsToMatch(<span class="string">&quot;/emp/**&quot;</span>)</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> GroupedOpenApi <span class="title function_">adminApi</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> GroupedOpenApi.builder()</span><br><span class="line">        .group(<span class="string">&quot;éƒ¨é—¨ç®¡ç†&quot;</span>)</span><br><span class="line">        .pathsToMatch(<span class="string">&quot;/dept/**&quot;</span>)</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="3ã€OpenAPIé…ç½®"><a href="#3ã€OpenAPIé…ç½®" class="headerlink" title="3ã€OpenAPIé…ç½®"></a>3ã€OpenAPIé…ç½®</h6><p>ä¸Šé¢çš„æ˜¯åˆ†ç»„é…ç½®ï¼Œè¿™ä¸ªæ˜¯æ€»çš„ä»‹ç»ç±»ä¼¼äºæ–‡æ¡£æ¢—æ¦‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">  <span class="keyword">public</span> OpenAPI <span class="title function_">springShopOpenAPI</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OpenAPI</span>()</span><br><span class="line">              .info(<span class="keyword">new</span> <span class="title class_">Info</span>().title(<span class="string">&quot;SpringShop API&quot;</span>)</span><br><span class="line">              .description(<span class="string">&quot;ä¸“é—¨æµ‹è¯•æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class="line">              .version(<span class="string">&quot;v0.0.1&quot;</span>)</span><br><span class="line">              .license(<span class="keyword">new</span> <span class="title class_">License</span>().name(<span class="string">&quot;Apache 2.0&quot;</span>).url(<span class="string">&quot;http://springdoc.org&quot;</span>)))</span><br><span class="line">              .externalDocs(<span class="keyword">new</span> <span class="title class_">ExternalDocumentation</span>()</span><br><span class="line">              .description(<span class="string">&quot;SpringShop Wiki Documentation&quot;</span>)</span><br><span class="line">              .url(<span class="string">&quot;https://springshop.wiki.github.org/docs&quot;</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="è¿œç¨‹è°ƒç”¨"><a href="#è¿œç¨‹è°ƒç”¨" class="headerlink" title="è¿œç¨‹è°ƒç”¨"></a>è¿œç¨‹è°ƒç”¨</h3><p><strong>RPCï¼ˆRemote Procedure Callï¼‰ï¼šè¿œç¨‹è¿‡ç¨‹è°ƒâ½¤</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251228223141589.png" alt="image-20251228223141589"></p>
<p><strong>æœ¬åœ°è¿‡ç¨‹è°ƒâ½¤</strong>ï¼š a()ï¼› b()ï¼› a() { b()ï¼›}ï¼š ä¸åŒâ½…æ³•éƒ½åœ¨<strong>åŒâ¼€ä¸ªJVMè¿â¾</strong></p>
<p><strong>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</strong></p>
<p>æœåŠ¡æä¾›è€…ï¼š</p>
<p> æœåŠ¡æ¶ˆè´¹è€…ï¼š </p>
<p>é€šè¿‡è¿æ¥å¯¹â½…æœåŠ¡å™¨è¿›â¾è¯·æ±‚\å“åº”äº¤äº’ï¼Œæ¥å®ç°è°ƒâ½¤æ•ˆæœ</p>
<p><strong>API / SDK çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>apiï¼šæ¥â¼ï¼ˆApplication Programming Interfaceï¼‰ </p>
<p>â€‹    â—‹ è¿œç¨‹æä¾›åŠŸèƒ½ï¼›  </p>
<p>sdkï¼šâ¼¯å…·åŒ…ï¼ˆSoftware Development Kitï¼‰ </p>
<p>â€‹    â—‹ å¯¼â¼ŠjaråŒ…ï¼Œç›´æ¥è°ƒâ½¤åŠŸèƒ½å³å¯</p>
<blockquote>
<p>å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è°ƒâ½¤åˆ«â¼ˆå†™çš„åŠŸèƒ½ </p>
<p>å¦‚æœæ˜¯å†…éƒ¨å¾®æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡ä¾èµ–cloudã€æ³¨å†Œä¸­â¼¼ã€openfeignç­‰è¿›â¾è°ƒâ½¤ </p>
<p>å¦‚æœæ˜¯å¤–éƒ¨æš´éœ²çš„ï¼Œå¯ä»¥å‘é€ http è¯·æ±‚ã€æˆ–éµå¾ªå¤–éƒ¨åè®®è¿›â¾è°ƒâ½¤ </p>
<p>SpringBoot æ•´åˆæä¾›äº†å¾ˆå¤šâ½…å¼è¿›â¾è¿œç¨‹è°ƒâ½¤</p>
<p>â€‹    è½»é‡çº§å®¢æˆ·ç«¯â½…å¼ </p>
<p>â€‹        RestTemplateï¼š æ™®é€šå¼€å‘</p>
<p>â€‹        <strong>WebClientï¼š å“åº”å¼ç¼–ç¨‹å¼€å‘</strong> </p>
<p>â€‹        <strong>Http Interfaceï¼š å£°æ˜å¼ç¼–ç¨‹</strong></p>
<p>â€‹    Spring Cloudåˆ†å¸ƒå¼è§£å†³â½…æ¡ˆâ½…å¼ </p>
<p>â€‹        Spring Cloud OpenFeign</p>
<p>â€‹    ç¬¬ä¸‰â½…æ¡†æ¶  </p>
<p>â€‹        Dubbo </p>
<p>â€‹        gRPC</p>
</blockquote>
<h4 id="WebClient"><a href="#WebClient" class="headerlink" title="WebClient"></a>WebClient</h4><blockquote>
<p>éé˜»å¡ã€å“åº”å¼HTTPå®¢æˆ·ç«¯</p>
</blockquote>
<p>ç”±äºè¿™æ˜¯å“åº”å¼ç¼–ç¨‹äº†ï¼Œåé¢ä¹Ÿä¼šè®²è§£ï¼Œç°åœ¨åªæ˜¯æ¼”ç¤ºä¸€ä¸‹ã€‚é¦–å…ˆå¼•å…¥<code>spring reactive web</code>äº†ï¼Œå¯¼å…¥<code>spring-boot-starter-webflux</code>åœºæ™¯</p>
<p>ç„¶åå¼€å§‹åˆ›å»ºcontrollerï¼Œä½†æ˜¯è®¿é—®å¤©æ°”çš„åŠŸèƒ½ä¸æ˜¯æˆ‘ä»¬å†™çš„ï¼Œæˆ‘ä»¬è°ƒç”¨åˆ«äººçš„api ï¼Œ è¿™åº”è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆå®Œæˆå¥½controllerï¼Œåœ¨serviceé‡Œé¢å®šä¹‰å¥½æ–¹æ³•ï¼Œç„¶åå†™å®Œcontrollerçš„æµç¨‹ï¼Œå†å†™serviceæœåŠ¡ã€‚</p>
<p>ç°åœ¨éœ€è¦serviceåˆ©ç”¨HTTPå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œé¦–å…ˆç†è§£å‘é€è¯·æ±‚éœ€è¦åšä»€ä¹ˆï¼Ÿ</p>
<p>å‘è¯·æ±‚ï¼š </p>
<p>è¯·æ±‚â½…å¼ï¼š GET\POST\DELETE\xxxx </p>
<p>è¯·æ±‚è·¯å¾„ï¼š /xxx </p>
<p>è¯·æ±‚å‚æ•°ï¼šaa=bb&amp;cc=dd&amp;xxx </p>
<p>è¯·æ±‚å¤´ï¼š aa=bb,cc=ddd </p>
<p>è¯·æ±‚ä½“ï¼š</p>
<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†è¦åšä»€ä¹ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨WebClientå‘é€è¯·æ±‚ã€‚</p>
<p>é¦–å…ˆåˆ›å»ºWebClient</p>
<p>åˆ›å»º  WebClient â¾®å¸¸ç®€å•: </p>
<p>â€‹    WebClient.create() </p>
<p>â€‹    WebClient.create(String baseUrl) </p>
<p>è¿˜å¯ä»¥ä½¿â½¤  WebClient.builder() é…ç½®æ›´å¤šå‚æ•°é¡¹: </p>
<p>â€‹    uriBuilderFactory: â¾ƒå®šä¹‰ UriBuilderFactory ï¼Œå®šä¹‰ baseurl. </p>
<p>â€‹    defaultUriVariables: é»˜è®¤ uri å˜é‡. </p>
<p>â€‹     defaultHeader: æ¯ä¸ªè¯·æ±‚é»˜è®¤å¤´. 131 </p>
<p>â€‹    defaultCookie: æ¯ä¸ªè¯·æ±‚é»˜è®¤ cookie.</p>
<p>â€‹    defaultRequest:  Consumer â¾ƒå®šä¹‰æ¯ä¸ªè¯·æ±‚.</p>
<p>â€‹    filter: è¿‡æ»¤ client å‘é€çš„æ¯ä¸ªè¯·æ±‚ </p>
<p>â€‹    exchangeStrategies: HTTP æ¶ˆæ¯ reader/writer â¾ƒå®šä¹‰. </p>
<p>â€‹    clientConnector: HTTP client åº“è®¾ç½®.</p>
<p><strong>URIï¼ˆUniform Resource Identifierï¼Œç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰</strong></p>
<p>æœ¬è´¨æ˜¯ã€Œ<strong>ç”¨æ¥å”¯ä¸€æ ‡è¯†æŸä¸ªèµ„æºçš„å­—ç¬¦ä¸²</strong>ã€ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ã€Œè¯†åˆ«èµ„æºã€ï¼Œåªè´Ÿè´£å‘Šè¯‰æˆ‘ä»¬ã€Œè¿™ä¸ªèµ„æºæ˜¯è°ã€ï¼Œä¸ä¿è¯èƒ½é€šè¿‡å®ƒè·å–åˆ°è¯¥èµ„æºã€‚</p>
<p><strong>URLï¼ˆUniform Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰</strong></p>
<p>æœ¬è´¨æ˜¯ã€Œ<strong>ç”¨æ¥å®šä½æŸä¸ªèµ„æºå¹¶æŒ‡æ˜å¦‚ä½•è®¿é—®è¯¥èµ„æºçš„å­—ç¬¦ä¸²</strong>ã€ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ã€Œå®šä½ + è®¿é—®ã€ï¼Œä¸ä»…èƒ½æ ‡è¯†èµ„æºï¼Œè¿˜èƒ½æä¾›è®¿é—®è¯¥èµ„æºçš„å®Œæ•´è·¯å¾„ï¼ˆåè®®ã€ä¸»æœºã€ç«¯å£ç­‰ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">weather</span><span class="params">(String city)</span>&#123;</span><br><span class="line">        <span class="comment">// è¿œç¨‹è°ƒç”¨é˜¿é‡Œäº‘API</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//1ã€åˆ›å»ºWebClient è¿™æ ·å°±æœ‰è®¿é—®é˜¿é‡Œäº‘å¤©æ°”æœåŠ¡apiçš„å®¢æˆ·ç«¯äº†</span></span><br><span class="line">        <span class="type">WebClient</span> <span class="variable">client</span> <span class="operator">=</span> WebClient.create();</span><br><span class="line">        Map&lt;String,String&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">&quot;area&quot;</span>,<span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        <span class="comment">//2ã€å®šä¹‰å‘è¯·æ±‚è¡Œä¸º</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> client.get() <span class="comment">//é¦–å…ˆæ˜¯getè¯·æ±‚</span></span><br><span class="line">            .uri(<span class="string">&quot;https://ali-weater/xxx?area=&#123;area&#125; &quot;</span>,params)</span><br><span class="line">            .accept(MediaType.APPLICATION_JSON)<span class="comment">//æ¥å—JSONè¿”å›çš„æ•°æ®</span></span><br><span class="line">            .header(<span class="string">&quot;Authorization&quot;</span>,<span class="string">&quot;APPCODE xxx&quot;</span>)<span class="comment">//æºå¸¦è¯·æ±‚å¤´ï¼ŒæŒ‰ç…§é˜¿é‡Œäº‘çš„è¦æ±‚å‘é€è¯·æ±‚å¤´</span></span><br><span class="line">            .retrieve()<span class="comment">//ä»£è¡¨æŸ¥è¯¢</span></span><br><span class="line">            .bodyToMono(String.class)<span class="comment">//è¿™é‡Œç”¨æ¥æ¥æ”¶è¿”å›ä¿¡æ¯</span></span><br><span class="line">            .block();<span class="comment">//é˜»å¡ï¼Œå› ä¸ºæ²¡å­¦å“åº”å¼ç¼–ç¨‹</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å¦‚æœç”¨å“åº”å¼ç¼–ç¨‹</span></span><br><span class="line">        Mono&lt;String&gt; mono = client.get() <span class="comment">//é¦–å…ˆæ˜¯getè¯·æ±‚</span></span><br><span class="line">            .uri(<span class="string">&quot;https://ali-weaterxxx?area=&#123;area&#125; &quot;</span>,params)</span><br><span class="line">            .accept(MediaType.APPLICATION_JSON)<span class="comment">//æ¥å—JSONè¿”å›çš„æ•°æ®</span></span><br><span class="line">            .header(<span class="string">&quot;Authorization&quot;</span>,<span class="string">&quot;APPCODE xxx&quot;</span>)<span class="comment">//æºå¸¦è¯·æ±‚å¤´ï¼ŒæŒ‰ç…§é˜¿é‡Œäº‘çš„è¦æ±‚å‘é€è¯·æ±‚å¤´</span></span><br><span class="line">            .retrieve()<span class="comment">//ä»£è¡¨æŸ¥è¯¢</span></span><br><span class="line">            .bodyToMono(String.class);<span class="comment">//è¿™é‡Œç”¨æ¥å£°æ˜å¦‚ä½•æå–è¿”å›ä¿¡æ¯</span></span><br><span class="line">          </span><br><span class="line">        <span class="keyword">return</span> mono;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HTTP-Interface"><a href="#HTTP-Interface" class="headerlink" title="HTTP Interface"></a>HTTP Interface</h4><blockquote>
<p>Spring å…è®¸æˆ‘ä»¬é€šè¿‡å®šä¹‰æ¥â¼çš„â½…å¼ï¼Œç»™ä»»æ„ä½ç½®å‘é€ http è¯·æ±‚ï¼Œå®ç°è¿œç¨‹è°ƒâ½¤ï¼Œå¯ä»¥â½¤æ¥ç®€ åŒ– HTTP è¿œç¨‹è®¿é—®ã€‚</p>
</blockquote>
<p>ä¹Ÿæ˜¯å¯¼å…¥<code>spring-boot-starter-webflux</code>åœºæ™¯ï¼Œå¦‚æœè®¿é—®çš„æ¬¡æ•°å¤šï¼Œæ¯æ¬¡éƒ½è¦å®šä¹‰å®¢æˆ·ç«¯ï¼Œç„¶åå‘é€è¯·æ±‚ä¼šå¾ˆéº»çƒ¦ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æ¥å£çš„æ–¹å¼æ¥æ›´æŠ½è±¡çš„ç¼–å†™ã€‚</p>
<p><strong>å®šä¹‰æ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WeatherInterface</span> &#123;</span><br><span class="line">    <span class="meta">@GetExchange(url = &quot;/xxx&quot;,accpet=&quot;application/json&quot;)</span></span><br><span class="line">    </span><br><span class="line">   	<span class="comment">//åœ¨GetExchangeé‡Œé¢å†™ï¼Œä»£è¡¨è¦æŠŠcityç»‘å®šåˆ°areaé‡Œé¢å½“å‚æ•°å‘å‡ºå»ï¼Œåœ¨controlleré‡Œé¢å†™æ˜¯æ¥å—ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">    Mono&lt;String&gt; <span class="title function_">gerWeather</span><span class="params">(<span class="meta">@RequestParam(&quot;area&quot;)</span> String city,</span></span><br><span class="line"><span class="params">                     <span class="meta">@RequestHeader(&quot;Authorization&quot;)</span> String header)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetExchange(url = &quot;/search&quot;)</span></span><br><span class="line">    String <span class="title function_">search</span><span class="params">(<span class="meta">@RequestParam(&quot;q&quot;)</span> String keyword)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç¼–å†™service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherService</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">getByHttpInterface</span><span class="params">(String city)</span>&#123;</span><br><span class="line">		<span class="comment">//1ã€åˆ›å»ºå®¢æˆ·ç«¯        </span></span><br><span class="line">        <span class="type">WebClient</span> <span class="variable">client</span> <span class="operator">=</span> WebClient.builder()</span><br><span class="line">                    .baseUrl(<span class="string">&quot;https://ali-weater&quot;</span>)</span><br><span class="line">                    .codecs(clientCodecConfigurer -&gt; &#123;</span><br><span class="line">                        clientCodecConfigurer</span><br><span class="line">                                .defaultCodecs()</span><br><span class="line">                                .maxInMemorySize(<span class="number">256</span>*<span class="number">1024</span>*<span class="number">1024</span>);</span><br><span class="line">                         <span class="comment">//å“åº”æ•°æ®é‡å¤ªâ¼¤æœ‰å¯èƒ½ä¼šè¶…å‡ºBufferSizeï¼Œæ‰€ä»¥è¿™â¾¥è®¾ç½®çš„â¼¤â¼€ç‚¹             </span></span><br><span class="line">                    &#125;)</span><br><span class="line">                    .build();</span><br><span class="line">        <span class="comment">//2ã€åˆ›å»ºâ¼¯â¼š        </span></span><br><span class="line">        <span class="type">HttpServiceProxyFactory</span> <span class="variable">factory</span> <span class="operator">=</span> HttpServiceProxyFactory</span><br><span class="line">                    .builder(WebClientAdapter.forClient(client)).build();</span><br><span class="line">        <span class="comment">//3ã€è·å–ä»£ç†å¯¹è±¡        </span></span><br><span class="line">        <span class="type">WeatherInterface</span> <span class="variable">weatherAPI</span> <span class="operator">=</span> factory.createClient(WeatherInterface.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿™æ ·æ¯æ¬¡åªç”¨è°ƒç”¨ä»£ç†å¯¹è±¡å°±è¡Œäº†,ä¸Šé¢å¯ä»¥å†™åˆ°é…ç½®ç±»é‡Œé¢</span></span><br><span class="line">        Mono&lt;String&gt; weather = weatherAPI.getWeather(city,<span class="string">&quot;APPCODE xxx&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> weather;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å½“å‰æ–¹æ¡ˆä»…é’ˆå¯¹ <code>WeatherInterface</code> åšäº†å°è£…ï¼Œè¿˜èƒ½é€šè¿‡ã€Œ</strong>é€šç”¨åŒ–æ¨¡æ¿å°è£… + å¯é…ç½®åŒ–æ‰©å±•<strong>ã€ï¼Œå®ç°å¯¹ä»»æ„ HTTP æ¥å£ï¼ˆå¦‚ UserInterfaceã€OrderInterface ç­‰ï¼‰çš„å¤ç”¨ï¼Œå½»åº•æ¶ˆé™¤ä¸åŒä¸šåŠ¡æ¥å£çš„é‡å¤é…ç½®é€»è¾‘ã€‚</strong></p>
<p>åŸç†å°±æ˜¯æŠŠåˆ›å»ºå·¥å‚æŠ½å‡ºï¼Œç„¶åå°±å¯ä»¥ä¸æ–­çš„åˆ©ç”¨ä¸€ä¸ªå·¥å‚æ¥åˆ›å»ºä¸åŒçš„ä»£ç†ç±»äº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * HTTP æ¥å£ä»£ç†é…ç½®ç±»</span></span><br><span class="line"><span class="comment"> * åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒBeanï¼š</span></span><br><span class="line"><span class="comment"> * 1. httpServiceProxyFactoryï¼šé€šç”¨HttpServiceProxyFactoryå·¥å‚ï¼ˆå¯å¤ç”¨ï¼‰</span></span><br><span class="line"><span class="comment"> * 2. weatherAPIï¼šWeatherInterfaceä»£ç†å¯¹è±¡ï¼ˆä¾›ä¸šåŠ¡Serviceæ³¨å…¥ä½¿ç”¨ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeatherHttpProxyConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Bean1ï¼šåˆ›å»ºé€šç”¨çš„ HttpServiceProxyFactory å·¥å‚ï¼ˆå¯å¤ç”¨ç»™å…¶ä»–HTTPæ¥å£ï¼‰</span></span><br><span class="line"><span class="comment">     * åŸºäºå®šåˆ¶åŒ–WebClientæ„å»ºï¼Œè§£å†³å¤§å“åº”æ•°æ®ç¼“å†²æº¢å‡ºé—®é¢˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> HttpServiceProxyFactory å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> HttpServiceProxyFactory <span class="title function_">httpServiceProxyFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ„å»ºå®šåˆ¶åŒ–WebClientï¼ˆé…ç½®åŸºç¡€åœ°å€+ç¼–è§£ç å™¨å¤§å°ï¼‰</span></span><br><span class="line">        <span class="type">WebClient</span> <span class="variable">weatherWebClient</span> <span class="operator">=</span> WebClient.builder()</span><br><span class="line">                .baseUrl(<span class="string">&quot;https://ali-weater&quot;</span>) <span class="comment">// å¤©æ°”æ¥å£åŸºç¡€åœ°å€</span></span><br><span class="line">                .codecs(clientCodecConfigurer -&gt; &#123;</span><br><span class="line">                    <span class="comment">// é…ç½®æœ€å¤§å†…å­˜ç¼“å†²åŒºå¤§å°256Mï¼Œè§£å†³å¤§å“åº”æ•°æ®æº¢å‡º</span></span><br><span class="line">                    clientCodecConfigurer.defaultCodecs().maxInMemorySize(<span class="number">256</span> * <span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">                &#125;)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. åŸºäºWebClientæ„å»ºå¹¶è¿”å›HttpServiceProxyFactoryå·¥å‚</span></span><br><span class="line">        <span class="keyword">return</span> HttpServiceProxyFactory</span><br><span class="line">                .builder(WebClientAdapter.forClient(weatherWebClient))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Bean2ï¼šåˆ›å»º WeatherInterface ä»£ç†å¯¹è±¡ï¼ˆä¾èµ–ä¸Šé¢çš„å·¥å‚Beanï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> httpServiceProxyFactory è‡ªåŠ¨æ³¨å…¥é…ç½®ç±»ä¸­çš„å·¥å‚Bean</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> WeatherInterface ä»£ç†å®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WeatherInterface <span class="title function_">weatherAPI</span><span class="params">(HttpServiceProxyFactory httpServiceProxyFactory)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ©ç”¨å·¥å‚åˆ›å»ºå¹¶è¿”å›WeatherInterfaceä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> httpServiceProxyFactory.createClient(WeatherInterface.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ¶ˆæ¯æœåŠ¡"><a href="#æ¶ˆæ¯æœåŠ¡" class="headerlink" title="æ¶ˆæ¯æœåŠ¡"></a>æ¶ˆæ¯æœåŠ¡</h3><h4 id="æ¶ˆæ¯é˜Ÿåˆ—-åœºæ™¯"><a href="#æ¶ˆæ¯é˜Ÿåˆ—-åœºæ™¯" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—-åœºæ™¯"></a>æ¶ˆæ¯é˜Ÿåˆ—-åœºæ™¯</h4><h5 id="1ã€å¼‚æ­¥"><a href="#1ã€å¼‚æ­¥" class="headerlink" title="1ã€å¼‚æ­¥"></a>1ã€å¼‚æ­¥</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229010436695.png" alt="image-20251229010436695"></p>
<h5 id="2ã€è§£è€¦"><a href="#2ã€è§£è€¦" class="headerlink" title="2ã€è§£è€¦"></a>2ã€è§£è€¦</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229010814338.png" alt="image-20251229010814338"></p>
<h5 id="3ã€å‰Šå³°"><a href="#3ã€å‰Šå³°" class="headerlink" title="3ã€å‰Šå³°"></a>3ã€å‰Šå³°</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229011503029.png" alt="image-20251229011503029"></p>
<h5 id="4ã€ç¼“å†²"><a href="#4ã€ç¼“å†²" class="headerlink" title="4ã€ç¼“å†²"></a>4ã€ç¼“å†²</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229011614878.png" alt="image-20251229011614878"></p>
<p>ç¼“å†²ï¼ˆBufferingï¼‰è§£å†³<strong>é€Ÿç‡ä¸åŒ¹é…</strong>é—®é¢˜ </p>
<p>å‰Šå³° é˜²æ­¢ç³»ç»Ÿåœ¨<strong>æµé‡é«˜å³°</strong>æ—¶è¿‡è½½å´©æºƒï¼Œæé«˜ç³»ç»Ÿçš„<strong>å¯ç”¨æ€§å’Œç¨³å®šæ€§</strong>ã€‚</p>
<h4 id="æ¶ˆæ¯é˜Ÿåˆ—-Kafka"><a href="#æ¶ˆæ¯é˜Ÿåˆ—-Kafka" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—-Kafka"></a>æ¶ˆæ¯é˜Ÿåˆ—-Kafka</h4><p>è¿™é‡Œåˆ©ç”¨ä¹‹å‰ç¯å¢ƒå‡†å¤‡çš„Kafkaæ¥ä½¿ç”¨ã€‚</p>
<h5 id="1ã€æ¶ˆæ¯æ¨¡å¼"><a href="#1ã€æ¶ˆæ¯æ¨¡å¼" class="headerlink" title="1ã€æ¶ˆæ¯æ¨¡å¼"></a>1ã€æ¶ˆæ¯æ¨¡å¼</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229013318736.png" alt="image-20251229013318736"></p>
<p>ç‚¹å¯¹ç‚¹å°±æ˜¯å‘å¾®ä¿¡ä¸€æ ·ï¼šä¸€å¯¹ä¸€å‘æ¶ˆæ¯</p>
<p>æ¶ˆæ¯å‘å¸ƒè®¢é˜…æ¨¡å¼å°±æ˜¯ç¾¤å‘æ¶ˆæ¯ï¼Œåœ¨Kafkaé‡Œé¢å¯ä»¥å®šåˆ¶ä¸»é¢˜ï¼Œç±»æ¯”æŠ¥çº¸ï¼Œæœ‰æ–°åæ—¥æŠ¥ï¼Œäººæ°‘æ—¥æŠ¥ç­‰ä¸åŒä¸»é¢˜ï¼Œç„¶åäººä»¬å¯ä»¥è®¢æŠ¥çº¸ï¼Œç„¶åå¦‚æœæœ‰æŠ¥çº¸åˆ°äº†å°±å‘é€ç»™æ‰€æœ‰è®¢é˜…çš„äººæ‰‹ä¸Šï¼Œç„¶åKafkaä¼šè®°å½•æ¯ä¸ªè®¢é˜…è€…çš„åç§»é‡ï¼Œè®°å½•æ¯ä¸ªäººæ¶ˆè´¹åˆ°å“ªäº†ï¼Œåˆ©ç”¨å¹¿æ’­è®¢é˜…çš„è¯ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸ä¼šåˆ é™¤æ¶ˆæ¯çš„ã€‚ï¼ˆåç»­æ˜¯å¦ä¼šåˆ é™¤æ¶ˆæ¯å¯ä»¥å…·ä½“é…ç½®è§„åˆ™ï¼‰</p>
<h5 id="2ã€Kafkaå·¥ä½œåŸç†"><a href="#2ã€Kafkaå·¥ä½œåŸç†" class="headerlink" title="2ã€Kafkaå·¥ä½œåŸç†"></a>2ã€Kafkaå·¥ä½œåŸç†</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229015806660.png" alt="image-20251229015806660"></p>
<p>Kafkaæƒ³è¦çœŸæ­£çš„å‘æ¶ˆæ¯ä»–æ˜¯è¿™ä¹ˆåšçš„ï¼š</p>
<p>é¦–å…ˆæœ‰ä¸€ä¸ªç”Ÿäº§è€…ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œæœªæ¥å¯èƒ½éƒ½ä¼šæœ‰å¾ˆå¤šã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ€è€ƒå¦‚æœæˆ‘ä»¬æƒ³è¦å‘æ¶ˆæ¯ï¼Œç°åœ¨æ¶ˆæ¯å·¨å¤§ï¼Œåªå¯åŠ¨ä¸€å°æœåŠ¡å™¨è‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥Kafkaå¼•å…¥äº†ä¸¤ä¸ªæ¦‚å¿µï¼š<strong>åˆ†åŒº</strong> ã€ <strong>å‰¯æœ¬</strong></p>
<p><strong>åˆ†åŒºï¼šæµ·é‡æ•°æ®åˆ†æ•£å­˜å‚¨</strong> Kafkaå¯ä»¥ä¸ºæ¯ä¸ªä¸»é¢˜åˆ†åŒºï¼Œç„¶åæ ¹æ®æ•°æ®çš„å“ˆå¸Œè®¡ç®—æ¯”å¦‚ï¼Œå¾—åˆ°æ•°æ®åœ¨å“ªä¸ªåŒºã€‚</p>
<p><strong>å‰¯æœ¬ï¼šæ¯ä¸ªæ•°æ®åŒºéƒ½æœ‰å¤‡ä»½</strong> ä¸ºäº†é«˜å¯ç”¨ï¼Œæ¯ä¸ªåˆ†åŒº2ä¸ªå‰¯æœ¬ï¼Œå›¾ä¸Šæ˜¾ç¤ºçš„æ˜¯3åˆ†åŒº2å‰¯æœ¬ï¼Œç„¶å0å·åˆ†åŒºçš„å‰¯æœ¬åœ¨1å·åˆ†åŒºå’Œ2å·åˆ†åŒºé‡Œé¢è¿™æ ·ä¿è¯é¢é«˜å¯ç”¨</p>
<p>é‚£ä¹ˆä»¥åç”Ÿäº§è€…æƒ³è¦å‘é€æ¶ˆæ¯ï¼Œæ‰€æœ‰æ¶ˆæ¯ä¼šå…ˆçœ‹å‘é€ç»™å“ªä¸ªåˆ†åŒºï¼Œä¼šå…ˆè·å–ä¸»åˆ†åŒºç§°ä¸ºleaderåˆ†åŒºï¼Œæ‰€æœ‰é›†ç¾¤çš„ä¿¡æ¯éƒ½ç”±Zookeeperè¿›è¡Œç®¡ç†ï¼Œè¿™ä¸ªæ—¶å€™æƒ³ç»™ä¸»åˆ†åŒºå‘æ¶ˆæ¯ï¼Œå¦‚æœä¸»åˆ†åŒºç‚¸äº†ï¼Œzookeeperä¼šå¸®ä½ åœ¨å…¶ä»–åˆ†åŒºé€‰ä¸€ä¸ªä½œä¸ºä¸»åˆ†åŒºï¼Œç„¶åç»™ä¸»åˆ†åŒºå‘é€å°±è¡Œã€‚æ¶ˆè´¹è€…ä¹Ÿæœ‰å¾ˆå¤šï¼Œå¼•å…¥ä¸€ä¸ªæ¦‚å¿µæ¶ˆè´¹è€…ç»„ï¼Œå¦‚æœå¾ˆå¤šæ¶ˆè´¹è€…æ˜¯åŒä¸€ç»„ï¼ŒåŒä¸€ä¸ªç»„é‡Œçš„æ¶ˆè´¹è€…æ˜¯ç«äº‰å…³ç³»ï¼ˆc1æ¶ˆè´¹äº†1åˆ†åŒºï¼Œc2å°±ä¸èƒ½æ¶ˆè´¹1åˆ†åŒºï¼Œå»æ¶ˆè´¹2åˆ†åŒºå»äº†ï¼‰ï¼Œä¸åŒæ¶ˆè´¹è€…ç»„é‡Œé¢çš„æ¶ˆè´¹è€…æ˜¯å‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯ä¼šè®¡ç®—åç§»é‡ä¸å½±å“ã€‚</p>
<h5 id="3ã€SpringBootæ•´åˆ"><a href="#3ã€SpringBootæ•´åˆ" class="headerlink" title="3ã€SpringBootæ•´åˆ"></a>3ã€SpringBootæ•´åˆ</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-kafka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ–°ç”¨ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¯ä»¥çœ‹ä»–çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œä»è€ŒçŸ¥é“ä»–éœ€è¦çš„é…ç½®</p>
<h6 id="è‡ªåŠ¨é…ç½®åŸç†"><a href="#è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="è‡ªåŠ¨é…ç½®åŸç†"></a>è‡ªåŠ¨é…ç½®åŸç†</h6><p>kafka â¾ƒåŠ¨é…ç½®åœ¨ KafkaAutoConfiguration </p>
<ol>
<li>å®¹å™¨ä¸­æ”¾äº†  KafkaTemplate å¯ä»¥è¿›â¾æ¶ˆæ¯æ”¶å‘ </li>
<li>å®¹å™¨ä¸­æ”¾äº† KafkaAdmin å¯ä»¥è¿›â¾ Kafka çš„ç®¡ç†ï¼Œâ½å¦‚åˆ›å»º topic ç­‰ </li>
<li>kafka çš„é…ç½®åœ¨ KafkaPropertiesä¸­ </li>
<li>@EnableKafkaå¯ä»¥å¼€å¯åŸºäºæ³¨è§£çš„æ¨¡å¼</li>
</ol>
<p>ç„¶åé…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.kafka.bootstrap-servers</span>=<span class="string">ä½ çš„IP:9092</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œåˆ©ç”¨æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•æ•´åˆ</p>
<h6 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Boot312MessageApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Resource</span></span><br><span class="line">	KafkaTemplate kafkaTemplate;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="type">StopWatch</span> <span class="variable">stopWatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line"></span><br><span class="line">		CompletableFuture[] futures = <span class="keyword">new</span> <span class="title class_">CompletableFuture</span>[<span class="number">10000</span>];</span><br><span class="line">		stopWatch.start();</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">			<span class="comment">//JUCçš„çŸ¥è¯†</span></span><br><span class="line">			<span class="type">CompletableFuture</span> <span class="variable">send</span> <span class="operator">=</span> kafkaTemplate.send(<span class="string">&quot;news&quot;</span>, <span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">			futures[i] = send;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		CompletableFuture.allOf(futures)</span><br><span class="line">			.join();</span><br><span class="line">		stopWatch.stop();</span><br><span class="line"></span><br><span class="line">		<span class="type">long</span> <span class="variable">millis</span> <span class="operator">=</span> stopWatch.getTotalTimeMillis();</span><br><span class="line">		System.out.println(<span class="string">&quot;å‘é€å®Œæˆç”¨äº†ï¼š&quot;</span>+millis+<span class="string">&quot;æ¯«ç§’&quot;</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸€ä¸ªå‘ï¼š</strong>åœ¨æœ¬åœ°è®¿é—®kafkaè®¿é—®å¤±è´¥äº†è¯´ä¸çŸ¥é“è¿™ä¸ªkafka</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¹‹å‰é…ç½®äº†è¿™ä¸ª spring.kafka.bootstrap-servers=æœåŠ¡å™¨IP:9092</span><br><span class="line">è¯¥é…ç½®åªæ˜¯å®¢æˆ·ç«¯ã€Œåˆå§‹è¿æ¥ã€çš„å…¥å£ï¼Œå®¢æˆ·ç«¯è¿æ¥æˆåŠŸåï¼ŒKafka æœåŠ¡ç«¯ä¼šè¿”å›é›†ç¾¤çš„å®Œæ•´èŠ‚ç‚¹ä¿¡æ¯ï¼ˆè‹¥ä¸ºé›†ç¾¤ï¼‰ï¼Œåç»­å®¢æˆ·ç«¯ä¼šç›´æ¥ä¸å¯¹åº”èŠ‚ç‚¹äº¤äº’ã€‚</span><br><span class="line">Kafka æœ‰ä¸€ä¸ªå…³é”®ç‰¹æ€§ï¼šå®¢æˆ·ç«¯ï¼ˆä½ çš„æœ¬åœ°åº”ç”¨ï¼‰å…ˆé€šè¿‡ bootstrap-serversï¼ˆ47.107.236.146:9092ï¼‰ä¸ Kafka å»ºç«‹åˆå§‹è¿æ¥ï¼›</span><br><span class="line">åˆå§‹è¿æ¥æˆåŠŸåï¼ŒKafka ä¼šæŠŠè‡ªå·±çš„ã€Œå¹¿å‘Šåœ°å€ï¼ˆadvertised.listenersï¼‰ã€è¿”å›ç»™å®¢æˆ·ç«¯ï¼›</span><br><span class="line">å®¢æˆ·ç«¯åç»­å‘é€ / æ¶ˆè´¹æ¶ˆæ¯æ—¶ï¼Œä¸ä¼šå†ä½¿ç”¨ bootstrap-serversï¼Œè€Œæ˜¯ä¼šåˆ‡æ¢åˆ° Kafka è¿”å›çš„ advertised.listeners åœ°å€è¿›è¡Œé€šä¿¡ï¼›</span><br><span class="line">å½“å‰çš„ Kafka å› é…ç½®é—®é¢˜ï¼Œè¿”å›çš„å¹¿å‘Šåœ°å€æ˜¯ Docker å†…éƒ¨çš„ã€ŒæœåŠ¡åã€ï¼ˆè€Œéé˜¿é‡Œäº‘å…¬ç½‘ IPï¼‰ï¼Œæœ¬åœ°åº”ç”¨æ— æ³•è§£æè¿™ä¸ª Docker å†…éƒ¨æœåŠ¡åï¼ˆç›¸å½“äº â€œä¸è®¤è¯†è¿™ä¸ªåœ°å€â€ï¼‰ï¼Œå¯¼è‡´è¿æ¥ä¸­æ–­ / å¤±è´¥ã€‚</span><br><span class="line">å¦‚æœæˆ‘ä»¬è¿™ä¸ªæœåŠ¡ä¹Ÿéƒ¨ç½²åˆ°dockerå†…éƒ¨å°±ä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ç°åœ¨æ²¡æœ‰ï¼Œæ‰€ä»¥åªèƒ½ä¿®æ”¹HOSTæ–‡ä»¶ï¼Œå‘Šè¯‰ç”µè„‘kafkaå¯¹åº”çš„IPåœ°å€å…¶å®æ˜¯æœåŠ¡å™¨çš„IPåœ°å€ã€‚</span><br></pre></td></tr></table></figure>
<p><code>ä¿®æ”¹ C:\Windows\System32\drivers\etc\hosts  â½‚ä»¶ï¼Œé…ç½® æœåŠ¡å™¨IP kafka</code></p>
<p>å¦‚æœæƒ³è¦å‘é€å¯¹è±¡å‘é€ï¼Œä¼šå‘ç°å¤±è´¥ï¼Œå› ä¸ºåºåˆ—åŒ–è§„åˆ™é—®é¢˜é»˜è®¤æ˜¯å­—ç¬¦ä¸²åºåˆ—åŒ–å™¨ï¼Œæ‰€ä»¥éœ€è¦é…ç½®ä¸ºç»Ÿä¸€ä¸ºJSONçš„åºåˆ—åŒ–å™¨ã€‚</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å€¼çš„åºåˆ—åŒ–å™¨</span></span><br><span class="line"><span class="attr">spring.kafka.producer.value-serializer</span>=<span class="string">org.springframework.kafka.support.serializer.JsonSerializer</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…æŠŠå¯¹è±¡æ¢æˆå­—ç¬¦ä¸²ä¹Ÿè¡Œï¼Œå¦‚æœkeyä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆä¹Ÿè¦é…ç½®åºåˆ—åŒ–å™¨æˆ–è€…æ¢æˆå­—ç¬¦ä¸²ã€‚</p>
<h6 id="ç›‘å¬æ¶ˆæ¯"><a href="#ç›‘å¬æ¶ˆæ¯" class="headerlink" title="ç›‘å¬æ¶ˆæ¯"></a>ç›‘å¬æ¶ˆæ¯</h6><p>ä¹‹å‰å®ç°å¾€kafkaä¸»é¢˜é‡Œé¢å‘é€æ¶ˆæ¯ï¼Œç°åœ¨éœ€è¦ä»ä¸»é¢˜é‡Œé¢ç›‘å¬åˆ°æ–°æ¥çš„æ¶ˆæ¯ï¼Œå†æ¶ˆè´¹æ¶ˆæ¯ã€‚</p>
<p><strong>é…ç½®Topic</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆåœ¨ä¸»å¯åŠ¨é‡Œå¯åŠ¨Kafkaçš„æ³¨è§£åŠŸèƒ½@EnableKafka</span><br><span class="line">ç„¶ååœ¨é…ç½®é‡Œé¢ï¼Œé…ç½®configï¼Œç„¶ååœ¨é‡Œé¢æ·»åŠ ä¸€ä¸ªBeanå°±èƒ½åˆ›å»ºç›¸å…³çš„topicäº†ï¼Œç„¶åå¯åŠ¨å°±ä¼šæœ‰è¿™ä¸ªTopic</span><br><span class="line">@Bean</span><br><span class="line">public NewTopic topic1()&#123;</span><br><span class="line">	return TopicBuilder.name(&quot;thing1&quot;)</span><br><span class="line">			.partitions(3)</span><br><span class="line">			.replicas(2)</span><br><span class="line">			.compact()</span><br><span class="line">			.build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ¶ˆæ¯ç›‘å¬</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderMsgListener</span> &#123;</span><br><span class="line">    <span class="meta">@KafkaListener(topics = &quot;order&quot;,groupId = &quot;order-service&quot;)</span><span class="comment">//æ¶ˆè´¹è€…åˆ†ç»„</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">(ConsumerRecord record)</span>&#123;</span><br><span class="line">    	System.out.println(<span class="string">&quot;æ”¶åˆ°æ¶ˆæ¯ï¼š&quot;</span>+record); <span class="comment">//å¯ä»¥ç›‘å¬åˆ°å‘ç»™kafkaçš„æ–°æ¶ˆæ¯ï¼Œä»¥å‰çš„æ‹¿ä¸åˆ°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@KafkaListener(groupId = &quot;order-service-2&quot;,topicPartitions = &#123;</span></span><br><span class="line"><span class="meta">        @TopicPartition(topic = &quot;order&quot;,partitionOffsets = &#123;</span></span><br><span class="line"><span class="meta">            @PartitionOffset(partition = &quot;0&quot;,initialOffset = &quot;0&quot;)</span></span><br><span class="line"><span class="meta">		&#125;)</span></span><br><span class="line"><span class="meta">	&#125;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listenAll</span><span class="params">(ConsumerRecord record)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;æ”¶åˆ°partion-0æ¶ˆæ¯ï¼š&quot;</span>+record);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">KafkaAutoConfigurationæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</span><br><span class="line">1ã€KafkaPropertiesï¼škafkaçš„æ‰€æœ‰é…ç½®ï¼Œä»¥Spring.kafkaå¼€å§‹</span><br><span class="line">	bootstrapServersï¼š kafkaé›†ç¾¤çš„æ‰€æœ‰æœåŠ¡åœ°å€ï¼Œä¸€å¼€å§‹å»ºç«‹è¿æ¥ç„¶åä¼šè¿”å›kafkaçš„åœ°å€ï¼Œä»¥åä»¥åé¢çš„åœ°å€è¿æ¥ã€‚</span><br><span class="line">	properties:å‚æ•°è®¾ç½®</span><br><span class="line">	consumerï¼šæ¶ˆè´¹è€…</span><br><span class="line">	producerï¼šç”Ÿäº§è€…</span><br><span class="line">2ã€@EnableKafkaï¼šå¼€å¯Kafkaçš„æ³¨è§£é©±åŠ¨åŠŸèƒ½</span><br><span class="line">3ã€KafkaTemplateï¼šæ”¶å‘æ¶ˆæ¯</span><br><span class="line">4ã€KafkaAdminï¼šç»´æŠ¤ä¸»é¢˜ç­‰</span><br><span class="line">5ã€@EnableKafka + @KafkaListener æ¥å—æ¶ˆæ¯</span><br><span class="line">	æ¶ˆè´¹è€…æ¥æ¥å—æ¶ˆæ¯ï¼Œéœ€è¦æœ‰group-id æ¶ˆè´¹è€…åˆ†ç»„</span><br><span class="line">	æ”¶æ¶ˆæ¯ä½¿ç”¨@KafkaListener + ConsumerRecord</span><br><span class="line">	Spring.kafkaå¼€å§‹é…ç½®æ‰€æœ‰é…ç½®</span><br></pre></td></tr></table></figure>
<h3 id="Webå®‰å…¨"><a href="#Webå®‰å…¨" class="headerlink" title="Webå®‰å…¨"></a>Webå®‰å…¨</h3><p>Apache Shiro </p>
<p>Spring Security </p>
<p>â¾ƒç ”ï¼šFilter</p>
<h4 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h4><p>åªè¦æ˜¯å®‰å…¨æ¡†æ¶å°±è¦å…³æ³¨ä¸‰ä¸ªæ–¹é¢</p>
<h5 id="1ã€å®‰å…¨æ¶æ„"><a href="#1ã€å®‰å…¨æ¶æ„" class="headerlink" title="1ã€å®‰å…¨æ¶æ„"></a>1ã€å®‰å…¨æ¶æ„</h5><h6 id="1ã€è®¤è¯ï¼šAuthentication"><a href="#1ã€è®¤è¯ï¼šAuthentication" class="headerlink" title="1ã€è®¤è¯ï¼šAuthentication"></a>1ã€è®¤è¯ï¼šAuthentication</h6><blockquote>
<p>who are you? </p>
<p>ç™»å½•ç³»ç»Ÿï¼Œâ½¤æˆ·ç³»ç»Ÿ</p>
</blockquote>
<h6 id="2ã€æˆæƒï¼šAuthorization"><a href="#2ã€æˆæƒï¼šAuthorization" class="headerlink" title="2ã€æˆæƒï¼šAuthorization"></a>2ã€æˆæƒï¼šAuthorization</h6><blockquote>
<p>what are you allowed to doï¼Ÿ </p>
<p>æƒé™ç®¡ç†ï¼Œâ½¤æˆ·æˆæƒ</p>
</blockquote>
<h6 id="3ã€æ”»å‡»é˜²æŠ¤"><a href="#3ã€æ”»å‡»é˜²æŠ¤" class="headerlink" title="3ã€æ”»å‡»é˜²æŠ¤"></a>3ã€æ”»å‡»é˜²æŠ¤</h6><blockquote>
<p>XSSï¼ˆCross-site scriptingï¼‰ </p>
<p>CSRFï¼ˆCross-site request forgeryï¼‰ </p>
<p>CORSï¼ˆCross-Origin Resource Sharingï¼‰ </p>
<p>SQLæ³¨â¼Š â€¦</p>
</blockquote>
<p>ä¸Šé¢ä¸¤ä¸ªæ€ä¹ˆå®ç°çš„ï¼Œæ˜¯è¦è®¾è®¡ä¸€å¥—å®Œæ•´çš„æƒé™æ¨¡å‹</p>
<h6 id="æ‰©å±•ï¼šæƒé™æ¨¡å‹"><a href="#æ‰©å±•ï¼šæƒé™æ¨¡å‹" class="headerlink" title="æ‰©å±•ï¼šæƒé™æ¨¡å‹"></a>æ‰©å±•ï¼šæƒé™æ¨¡å‹</h6><p>ä¸»æµçš„æƒé™æ¨¡å‹æœ‰ä¸¤ä¸ªã€‚</p>
<p><strong>1ã€RBAC(Role Based Access Controll)</strong></p>
<p>å¦‚æœæ˜¯RBACä¸€èˆ¬æœ‰è¿™äº›ä¸‰å¼ è¡¨ï¼Œç”¨æˆ·è¡¨ï¼Œè§’è‰²è¡¨ï¼Œæƒé™è¡¨ï¼Œç„¶åä¸ºäº†å¤šå¯¹å¤šï¼Œæ¯ä¸ªè¡¨ä¹‹é—´ä¹Ÿæœ‰ä¸­é—´è¡¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">â½¤æˆ·ï¼ˆt_userï¼‰</span><br><span class="line">    id,username,passwordï¼Œxxx</span><br><span class="line">    1,zhangsan</span><br><span class="line">    2,lisi </span><br><span class="line">â½¤æˆ·_â»†â¾Šï¼ˆt_user_roleï¼‰ã€Nå¯¹Nå…³ç³»éœ€è¦ä¸­é—´è¡¨ã€‘</span><br><span class="line">    zhangsan, admin</span><br><span class="line">    zhangsan,common_user</span><br><span class="line">    lisi, hr</span><br><span class="line">    lisi, common_user</span><br><span class="line">â»†â¾Šï¼ˆt_roleï¼‰</span><br><span class="line">    id,role_name</span><br><span class="line">    admin</span><br><span class="line">    hr</span><br><span class="line">    common_user</span><br><span class="line">â»†â¾Š_æƒé™(t_role_perm)</span><br><span class="line">    admin, â½‚ä»¶r</span><br><span class="line">    admin, â½‚ä»¶w</span><br><span class="line">    admin, â½‚ä»¶æ‰§â¾</span><br><span class="line">    admin, è®¢å•queryï¼Œcreate,xxx</span><br><span class="line">    hr, â½‚ä»¶r</span><br><span class="line">æƒé™ï¼ˆt_permissionï¼‰</span><br><span class="line">    id,perm_id</span><br><span class="line">	â½‚ä»¶ r,w,x</span><br><span class="line">	è®¢å• query,create,xxx</span><br></pre></td></tr></table></figure>
<p><strong>2ã€ACL(Access Controll List)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥â½¤æˆ·å’Œæƒé™æŒ‚é’©</span><br><span class="line">â½¤æˆ·ï¼ˆt_userï¼‰</span><br><span class="line">    zhangsan</span><br><span class="line">    lisi</span><br><span class="line">â½¤æˆ·_æƒé™(t_user_perm)</span><br><span class="line">    zhangsan,â½‚ä»¶ r</span><br><span class="line">    zhangsan,â½‚ä»¶ x</span><br><span class="line">    zhangsan,è®¢å• query</span><br><span class="line">æƒé™ï¼ˆt_permissionï¼‰</span><br><span class="line">    id,perm_id</span><br><span class="line">    â½‚ä»¶ r,w,x</span><br><span class="line">    è®¢å• query,create,xxx</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Secured(&quot;â½‚ä»¶ r&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="comment">//è¯»â½‚ä»¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€Spring-SecurityåŸç†"><a href="#2ã€Spring-SecurityåŸç†" class="headerlink" title="2ã€Spring SecurityåŸç†"></a>2ã€Spring SecurityåŸç†</h5><h6 id="1ã€è¿‡æ»¤å™¨é“¾æ¶æ„"><a href="#1ã€è¿‡æ»¤å™¨é“¾æ¶æ„" class="headerlink" title="1ã€è¿‡æ»¤å™¨é“¾æ¶æ„"></a>1ã€è¿‡æ»¤å™¨é“¾æ¶æ„</h6><blockquote>
<p>Spring Securityåˆ©â½¤ FilterChainProxy å°è£…â¼€ç³»åˆ—æ‹¦æˆªå™¨é“¾ï¼Œå®ç°å„ç§å®‰å…¨æ‹¦æˆªåŠŸèƒ½ </p>
<p>Servletä¸‰â¼¤ç»„ä»¶ï¼šServletã€Filterã€Listener</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229142248403.png" alt="image-20251229142248403"></p>
<h6 id="2ã€FilterChainProxy"><a href="#2ã€FilterChainProxy" class="headerlink" title="2ã€FilterChainProxy"></a>2ã€FilterChainProxy</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229142603771.png" alt="image-20251229142603771"></p>
<h6 id="3ã€SecurityFilterChain"><a href="#3ã€SecurityFilterChain" class="headerlink" title="3ã€SecurityFilterChain"></a>3ã€SecurityFilterChain</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251229142625156.png" alt="image-20251229142625156"></p>
<h5 id="3ã€ä½¿ç”¨-1"><a href="#3ã€ä½¿ç”¨-1" class="headerlink" title="3ã€ä½¿ç”¨"></a>3ã€ä½¿ç”¨</h5><p>æ‰€ä»¥SpringSecurityå…¶å®å°±æ˜¯å¾ˆå¤šä¸ªè¿‡æ»¤å™¨ï¼Œåé¢æƒ³è¦ä½¿ç”¨çš„è¯ï¼Œéœ€è¦ç”¨åˆ°ä¸¤ä¸ªé…ç½®ç±»ã€‚</p>
<h6 id="1ã€HttpSecurity"><a href="#1ã€HttpSecurity" class="headerlink" title="1ã€HttpSecurity"></a>1ã€HttpSecurity</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Order(SecurityProperties.BASIC_AUTH_ORDER - 10)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationConfigurerAdapter</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        http.antMatcher(<span class="string">&quot;/match1/**&quot;</span>)</span><br><span class="line">            .authorizeRequests()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/match1/user&quot;</span>).hasRole(<span class="string">&quot;USER&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/match1/spam&quot;</span>).hasRole(<span class="string">&quot;SPAM&quot;</span>)</span><br><span class="line">                .anyRequest().isAuthenticated();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="2ã€MethodSecurity"><a href="#2ã€MethodSecurity" class="headerlink" title="2ã€MethodSecurity"></a>2ã€MethodSecurity</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableGlobalMethodSecurity(securedEnabled = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SampleSecureApplication</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="meta">@Secured(&quot;ROLE_USER&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">secure</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello Security&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ ¸å¿ƒ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">WebSecurityConfigurerAdapter</span><br><span class="line">@EnableGlobalMethodSecurityï¼š å¼€å¯å…¨å±€â½…æ³•å®‰å…¨é…ç½®</span><br><span class="line">	@Secured</span><br><span class="line">	@PreAuthorize</span><br><span class="line">	@PostAuthorize</span><br><span class="line">UserDetailServiceï¼š å»æ•°æ®åº“æŸ¥è¯¢â½¤æˆ·è¯¦ç»†ä¿¡æ¯çš„serviceï¼ˆâ½¤æˆ·åŸºæœ¬ä¿¡æ¯ã€â½¤æˆ·â»†â¾Šã€â½¤æˆ·æƒé™ï¼‰</span><br></pre></td></tr></table></figure>
<h5 id="4ã€å®æˆ˜"><a href="#4ã€å®æˆ˜" class="headerlink" title="4ã€å®æˆ˜"></a>4ã€å®æˆ˜</h5><h6 id="1ã€å¼•å…¥ä¾èµ–"><a href="#1ã€å¼•å…¥ä¾èµ–" class="headerlink" title="1ã€å¼•å…¥ä¾èµ–"></a>1ã€å¼•å…¥ä¾èµ–</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Sercurityåœºæ™¯çš„è‡ªåŠ¨é…ç½®ç±»å¼•å…¥äº†ï¼š</span><br><span class="line">    SecurityAutoConfiguration</span><br><span class="line">    SpringBootWebSecurityConfiguration</span><br><span class="line">    SecurityFilterAutoConfiguration</span><br><span class="line">    </span><br><span class="line">1ã€securityçš„æ‰€æœ‰é…ç½®åœ¨ SercurityPropertiesï¼šä»¥spring.securityå¼€å¤´</span><br><span class="line">2ã€é»˜è®¤SecurityFilterChainç»„ä»¶</span><br><span class="line">	æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è®¤è¯ï¼ˆç™»å½•ï¼‰</span><br><span class="line">	å¼€å¯è¡¨å•ç™»å½•ï¼ˆæ¡†æ¶æä¾›è¡¨å•é¡µé¢ï¼‰</span><br><span class="line">	httpbasicæ–¹å¼ç™»å½•</span><br><span class="line">3ã€@EnableWebSecurity ç”Ÿæ•ˆ</span><br><span class="line">	æ³¨è§£ç”Ÿæ•ˆ WebSecurityConfigurationç”Ÿæ•ˆï¼šwebå®‰å…¨é…ç½®ç”Ÿæ•ˆäº†</span><br><span class="line">	HttpSecurityConfigurationç”Ÿæ•ˆï¼šHttpå®‰å…¨è§„åˆ™</span><br><span class="line">	@EnableGlobalAuthentication å…¨å±€è®¤è¯ç”Ÿæ•ˆ</span><br><span class="line">		å¯¼å…¥AuthenticationConfiguration è®¤è¯é…ç½®ç±»</span><br></pre></td></tr></table></figure>
<p>å†™ä¸€ä¸ªindex.htmlç„¶åå‘ç°ï¼Œå¼€å¯äº†ç™»å½•è®¤è¯ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰æœªç™»å½•çš„éƒ½éœ€è¦ç»è¿‡ç™»å½•é¡µæ‰èƒ½ä½¿ç”¨åŠŸèƒ½ã€‚</p>
<p>æƒ³è¦è‡ªå®šä¹‰è¿™ä¸ªè§„åˆ™å°±éœ€è¦è‡ªå®šä¹‰é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppSecurityConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    SecurityFilterChain <span class="title function_">securityFilterChain</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è¯·æ±‚æˆæƒ</span></span><br><span class="line">        http.authorizeHttpRequests(registry -&gt; &#123;</span><br><span class="line">            registry.requestMatchers(<span class="string">&quot;/&quot;</span>).permitAll() <span class="comment">//1ã€é¦–é¡µæ‰€æœ‰äººéƒ½èƒ½è®¿é—®</span></span><br><span class="line">                .anyRequest().authenticated();          <span class="comment">//2ã€å‰©ä¸‹çš„ä»»æ„è¯·æ±‚éƒ½éœ€è¦è®¤è¯ï¼ˆç™»å½•ï¼‰ï¼Œæˆæƒæ‰æ˜¯éªŒè¯æƒé™</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//è¡¨å•ç™»å½•</span></span><br><span class="line">        <span class="comment">//3ã€è¡¨å•ç™»å½•åŠŸèƒ½:å¼€å¯é»˜è®¤è¡¨å•ç™»å½•åŠŸèƒ½</span></span><br><span class="line">        http.formLogin();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> http.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨é¦–é¡µéƒ½èƒ½è®¿é—®ï¼Œç„¶åå…¶ä»–ä»»ä½•åŠŸèƒ½éƒ½è¦ä½¿ç”¨é»˜è®¤çš„ç™»å½•è¡¨å•ï¼Œç°åœ¨ä¸æƒ³ç”¨é»˜è®¤çš„ç™»å½•è¡¨å•ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;https://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Spring Security Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;param.error&#125;&quot;</span>&gt;</span>Invalid username and password.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;param.logout&#125;&quot;</span>&gt;</span>You have been logged out.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span> User Name : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span> <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span> Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span> <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppSecurityConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    SecurityFilterChain <span class="title function_">securityFilterChain</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è¯·æ±‚æˆæƒ</span></span><br><span class="line">        http.authorizeHttpRequests(registry -&gt; &#123;</span><br><span class="line">            registry.requestMatchers(<span class="string">&quot;/&quot;</span>).permitAll() <span class="comment">//1ã€é¦–é¡µæ‰€æœ‰äººéƒ½èƒ½è®¿é—®</span></span><br><span class="line">                .anyRequest().authenticated();          <span class="comment">//2ã€å‰©ä¸‹çš„ä»»æ„è¯·æ±‚éƒ½éœ€è¦è®¤è¯ï¼ˆç™»å½•ï¼‰ï¼Œæˆæƒæ‰æ˜¯éªŒè¯æƒé™</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//è¡¨å•ç™»å½•</span></span><br><span class="line">        <span class="comment">//3ã€è¡¨å•ç™»å½•åŠŸèƒ½:å¼€å¯é»˜è®¤è¡¨å•ç™»å½•åŠŸèƒ½</span></span><br><span class="line">        http.formLogin(formLogin -&gt; &#123;</span><br><span class="line">            formLogin.loginPage(<span class="string">&quot;/login&quot;</span>).permitAll();<span class="comment">//è‡ªå®šä¹‰ç™»å½•é¡µä½ç½®ï¼Œæ‰€æœ‰äººéƒ½èƒ½è®¿é—®</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> http.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è¿˜æœ‰é—®é¢˜å°±æ˜¯è´¦å·å¯†ç éƒ½æ˜¯securityæä¾›çš„ï¼Œè¿™äº›éƒ½é…ç½®åœ¨äº†é…ç½®ç±»é‡Œé¢</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.security.user.name</span>=<span class="string">zs</span></span><br><span class="line"><span class="attr">spring.security.user.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">spring.security.user.roles</span>=<span class="string">admin,common,hr</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ˜¯å†™æ­»çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨@Beanæ³¨è§£æ³¨å…¥ä¸€ä¸ªå¯¹åº”çš„UserDetailServiceå°±è¡Œäº†ï¼Œç„¶åè¿™ä¸ªå¯ä»¥è‡ªå·±å†™æŸ¥è¯¢æ•°æ®åº“å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œæ¨¡æ‹Ÿå¾ˆå¤šç”¨æˆ·ï¼Œåªæ˜¯æä¾›äº†ç”¨æˆ·æ”¾åœ¨å†…å­˜é‡Œé¢ï¼Œè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸‹ï¼Œå¹¶ä¸”è¿™é‡Œçš„å¯†ç éƒ½è¦åŠ å¯†</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> UserDetailsService <span class="title function_">userDetailsService</span><span class="params">(PasswordEncoder passwordEncoder)</span> &#123;</span><br><span class="line">    <span class="type">UserDetails</span> <span class="variable">user</span> <span class="operator">=</span> User.withUsername(<span class="string">&quot;zs&quot;</span>)</span><br><span class="line">        .password(passwordEncoder.encode(<span class="string">&quot;admin&quot;</span>))</span><br><span class="line">        .roles(<span class="string">&quot;USER&quot;</span>)</span><br><span class="line">        .authorities(<span class="string">&quot;file_read&quot;</span>)</span><br><span class="line">        .build();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">InMemoryUserDetailsManager</span>(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line">PasswordEncoder <span class="title function_">passwordEncoder</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BcryxxEncoder</span>();<span class="comment">//sercurityé»˜è®¤æä¾›çš„åŠ å¯†å™¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PreAuthorize(&quot;hasAuthority(file_read)&quot;)</span><span class="comment">//é…åˆæ³¨è§£å®ç°æƒé™æˆæƒ</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/file&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">file</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä½¿ç”¨SpringSecurityéœ€è¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1ã€è‡ªå®šä¹‰è¯·æ±‚æˆæƒè§„åˆ™ http.authorizeHttpRequests</span><br><span class="line">2ã€è‡ªå®šä¹‰ç™»å½•è§„åˆ™ http.formLogin</span><br><span class="line">3ã€è‡ªå®šä¹‰ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢è§„åˆ™ï¼šUserDetailService</span><br><span class="line">4ã€å¼€å¯æ–¹æ³•çº§åˆ«çš„ç²¾ç¡®æƒé™æ§åˆ¶@EnableMethodSecurity é…åˆæ³¨è§£å®ç°æ§åˆ¶</span><br></pre></td></tr></table></figure>
<h3 id="å¯è§‚æµ‹æ€§"><a href="#å¯è§‚æµ‹æ€§" class="headerlink" title="å¯è§‚æµ‹æ€§"></a>å¯è§‚æµ‹æ€§</h3><blockquote>
<p>å¯ è§‚æµ‹æ€§ Observability</p>
</blockquote>
<p>å¯¹çº¿ä¸Šåº”â½¤è¿›â¾è§‚æµ‹ã€ç›‘æ§ã€é¢„è­¦â€¦ </p>
<p>å¥åº·çŠ¶å†µã€ç»„ä»¶çŠ¶æ€ã€å­˜æ´»çŠ¶æ€ã€‘Health </p>
<p>è¿â¾æŒ‡æ ‡ã€cpuã€å†…å­˜ã€åƒåœ¾å›æ”¶ã€ååé‡ã€å“åº”æˆåŠŸç‡â€¦ã€‘Metrics </p>
<p>é“¾è·¯è¿½è¸ª â€¦</p>
<h4 id="1ã€SpringBoot-Actuator"><a href="#1ã€SpringBoot-Actuator" class="headerlink" title="1ã€SpringBoot Actuator"></a>1ã€SpringBoot Actuator</h4><h5 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h5><h6 id="1ã€åœºæ™¯å¼•å…¥"><a href="#1ã€åœºæ™¯å¼•å…¥" class="headerlink" title="1ã€åœºæ™¯å¼•å…¥"></a>1ã€åœºæ™¯å¼•å…¥</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¼å…¥äº†è¿™ä¸ªåœºæ™¯ï¼Œæ²¡æœ‰ä»»ä½•é…ç½®ç›´æ¥å¯åŠ¨ç¨‹åºï¼Œç„¶åè®¿é—®ä»»ä½•ä¸€ä¸ªåº”ç”¨çš„actuatorï¼Œå°±ä¼šè¿”å›ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—® localhost:8080/actuator</span><br><span class="line">è¿”å›è¿™äº›</span><br><span class="line">&#123;</span><br><span class="line">  &quot;_links&quot;: &#123;</span><br><span class="line">    &quot;self&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://localhost:8080/actuator&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;health-path&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://localhost:8080/actuator/health/&#123;*path&#125;&quot;,</span><br><span class="line">      &quot;templated&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;health&quot;: &#123;</span><br><span class="line">      &quot;href&quot;: &quot;http://localhost:8080/actuator/health&quot;,</span><br><span class="line">      &quot;templated&quot;: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¿˜æƒ³è¦è§‚æµ‹æ›´å¤šçš„æŒ‡æ ‡ï¼Œæˆ‘ä»¬éœ€è¦æš´éœ²æ‰€æœ‰çš„è§‚æµ‹ç«¯ç‚¹</p>
<h6 id="2ã€æš´éœ²æŒ‡æ ‡"><a href="#2ã€æš´éœ²æŒ‡æ ‡" class="headerlink" title="2ã€æš´éœ²æŒ‡æ ‡"></a>2ã€æš´éœ²æŒ‡æ ‡</h6><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">	<span class="attr">endpoints:</span></span><br><span class="line">	<span class="attr">enabled-by-default:</span> <span class="literal">true</span> <span class="comment">#æš´éœ²æ‰€æœ‰ç«¯ç‚¹ä¿¡æ¯</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">    	<span class="attr">exposure:</span></span><br><span class="line">    	<span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span>  <span class="comment">#ä»¥webâ½…å¼æš´éœ²</span></span><br></pre></td></tr></table></figure>
<h6 id="3ã€è®¿é—®æ•°æ®"><a href="#3ã€è®¿é—®æ•°æ®" class="headerlink" title="3ã€è®¿é—®æ•°æ®"></a>3ã€è®¿é—®æ•°æ®</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—® http://localhost:8080/actuatorï¼›å±•ç¤ºå‡ºæ‰€æœ‰å¯ä»¥â½¤çš„ç›‘æ§ç«¯ç‚¹</span><br><span class="line">http://localhost:8080/actuator/beansï¼šå±•ç¤ºbean</span><br><span class="line">http://localhost:8080/actuator/configpropsï¼šå±•ç¤ºé…ç½®çš„å±æ€§</span><br><span class="line">http://localhost:8080/actuator/metricsï¼šæ‰“å°æ‰€æœ‰æŒ‡æ ‡</span><br><span class="line">http://localhost:8080/actuator/metrics/jvm.gc.pause</span><br><span class="line">http://localhost:8080/actuator/endpointName/detailPath</span><br></pre></td></tr></table></figure>
<h5 id="Endpoint"><a href="#Endpoint" class="headerlink" title="Endpoint"></a>Endpoint</h5><p>åœ¨springbootä¸­æœ‰ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µå«Endpointä¹Ÿå°±æ˜¯ç«¯ç‚¹ã€‚åªè¦æŠŠæ‰€æœ‰çš„è§‚æµ‹ç«¯ç‚¹æš´éœ²å‡ºæ¥ï¼Œå°±èƒ½çœ‹åˆ°æ‰€æœ‰çš„æŒ‡æ ‡ã€‚</p>
<p>Actuator ç«¯ç‚¹ï¼ˆEndpointï¼‰æ˜¯ Spring Boot æä¾›çš„æ ‡å‡†åŒ–æ¥å£ï¼ˆé»˜è®¤ä»¥ HTTP æ¥å£å½¢å¼æš´éœ²ï¼Œä¹Ÿæ”¯æŒ JMXï¼‰ï¼Œç”¨äº<strong>ç›‘æ§åº”ç”¨è¿è¡ŒçŠ¶æ€ã€æŸ¥è¯¢é…ç½®ä¿¡æ¯ã€æ‰§è¡Œç®¡ç†æ“ä½œ</strong>ï¼ˆå¦‚çº¿ç¨‹ dumpã€å † dump ç­‰ï¼‰ï¼Œé€šå¸¸è®¿é—®è·¯å¾„ä¸º <code>http://&#123;åº”ç”¨IP&#125;:&#123;åº”ç”¨ç«¯å£&#125;/&#123;åŸºç¡€è·¯å¾„&#125;/&#123;ç«¯ç‚¹åç§°&#125;</code>ï¼ˆé»˜è®¤åŸºç¡€è·¯å¾„ä¸º <code>/actuator</code>ï¼Œå¯é€šè¿‡ <code>management.endpoints.web.base-path</code> è‡ªå®šä¹‰ï¼‰ã€‚</p>
<h6 id="1ã€å¸¸ç”¨ç«¯ç‚¹"><a href="#1ã€å¸¸ç”¨ç«¯ç‚¹" class="headerlink" title="1ã€å¸¸ç”¨ç«¯ç‚¹"></a>1ã€å¸¸ç”¨ç«¯ç‚¹</h6><div class="table-container">
<table>
<thead>
<tr>
<th>ç«¯ç‚¹åç§°ï¼ˆEndpointï¼‰</th>
<th>ä¸­æ–‡æè¿°</th>
<th>æ ¸å¿ƒåŠŸèƒ½</th>
<th>ä¾èµ– / å‰ç½®æ¡ä»¶</th>
<th>è®¿é—®å½¢å¼ï¼ˆé»˜è®¤ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metrics</code></td>
<td>åº”ç”¨æŒ‡æ ‡ç«¯ç‚¹</td>
<td>æš´éœ²å½“å‰åº”ç”¨çš„æ‰€æœ‰ã€Œæ€§èƒ½æŒ‡æ ‡ã€ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š1. ç³»ç»ŸæŒ‡æ ‡ï¼ˆCPU ä½¿ç”¨ç‡ã€å†…å­˜å ç”¨ã€ç£ç›˜ä½¿ç”¨ï¼‰2. åº”ç”¨æŒ‡æ ‡ï¼ˆQPSã€å“åº”æ—¶é—´ã€çº¿ç¨‹æ•°ã€ç¼“å­˜å‘½ä¸­ç‡ï¼‰3. è‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆå¯é€šè¿‡ Spring Boot Metrics è‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–ï¼ˆSpring Boot æ ¸å¿ƒè‡ªå¸¦ï¼‰</td>
<td><code>GET http://ip:port/actuator/metrics</code>ï¼ˆæŸ¥çœ‹æ‰€æœ‰æŒ‡æ ‡åç§°ï¼‰<code>GET http://ip:port/actuator/metrics/&#123;æŒ‡æ ‡å&#125;</code>ï¼ˆæŸ¥çœ‹æŒ‡å®šæŒ‡æ ‡è¯¦æƒ…ï¼Œå¦‚ <code>actuator/metrics/jvm.memory.used</code>ï¼‰</td>
</tr>
<tr>
<td><code>threaddump</code></td>
<td>çº¿ç¨‹è½¬å‚¨ç«¯ç‚¹</td>
<td>æ‰§è¡Œåº”ç”¨çº¿ç¨‹è½¬å‚¨ï¼Œè¿”å›æ‰€æœ‰çº¿ç¨‹çš„å½“å‰çŠ¶æ€ï¼š1. çº¿ç¨‹ IDã€çº¿ç¨‹åç§°ã€çº¿ç¨‹çŠ¶æ€ï¼ˆRUNNABLE/BLOCKED/WAITING ç­‰ï¼‰2. çº¿ç¨‹å †æ ˆä¿¡æ¯ï¼ˆç”¨äºæ’æŸ¥çº¿ç¨‹æ­»é”ã€çº¿ç¨‹é˜»å¡ã€CPU é£™é«˜ç­‰é—®é¢˜ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
<td><code>GET http://ip:port/actuator/threaddump</code></td>
</tr>
<tr>
<td><code>heapdump</code></td>
<td>å †è½¬å‚¨ç«¯ç‚¹</td>
<td>ç”Ÿæˆå¹¶è¿”å›åº”ç”¨çš„ <code>hprof</code> æ ¼å¼å †è½¬å‚¨æ–‡ä»¶ï¼ˆå†…å­˜å¿«ç…§ï¼‰ï¼Œç”¨äºæ’æŸ¥ï¼š1. å†…å­˜æ³„æ¼é—®é¢˜2. å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰åŸå› 3. å¤§å¯¹è±¡å ç”¨å†…å­˜å¼‚å¸¸ç­‰é—®é¢˜</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>å…¶ä»–å…³é”®ç«¯ç‚¹</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ç«¯ç‚¹åç§°ï¼ˆEndpointï¼‰</th>
<th>ä¸­æ–‡æè¿°</th>
<th>æ ¸å¿ƒåŠŸèƒ½</th>
<th>ä¾èµ– / å‰ç½®æ¡ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auditevents</code></td>
<td>å®¡æ ¸äº‹ä»¶ç«¯ç‚¹</td>
<td>æš´éœ²åº”ç”¨çš„å®¡æ ¸äº‹ä»¶ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·ç™»å½•ã€æƒé™å˜æ›´ç­‰å®¡è®¡æ—¥å¿—ï¼‰</td>
<td>éœ€è¦ <code>AuditEventRepository</code> ç»„ä»¶</td>
</tr>
<tr>
<td><code>beans</code></td>
<td>Bean åˆ—è¡¨ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºåº”ç”¨ä¸­æ‰€æœ‰ Spring ç®¡ç†çš„ Bean å®Œæ•´åˆ—è¡¨ï¼ˆå« Bean åç§°ã€ç±»å‹ã€ä¾èµ–å…³ç³»ç­‰ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>caches</code></td>
<td>ç¼“å­˜ä¿¡æ¯ç«¯ç‚¹</td>
<td>æš´éœ²åº”ç”¨ä¸­æ‰€æœ‰å¯ç”¨çš„ç¼“å­˜ï¼ˆå¦‚ Redis/Caffeine ç¼“å­˜ï¼‰åŠç¼“å­˜çŠ¶æ€</td>
<td>æ— é¢å¤–ä¾èµ–ï¼ˆéœ€åº”ç”¨é…ç½®äº†ç¼“å­˜ç»„ä»¶ï¼‰</td>
</tr>
<tr>
<td><code>conditions</code></td>
<td>è‡ªåŠ¨é…ç½®æ¡ä»¶ç«¯ç‚¹</td>
<td>æ˜¾ç¤º Spring Boot è‡ªåŠ¨é…ç½®çš„æ‰€æœ‰æ¡ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬é…ç½®ã€ŒåŒ¹é…æˆåŠŸã€æˆ–ã€ŒåŒ¹é…å¤±è´¥ã€çš„å…·ä½“åŸå› ï¼ˆç”¨äºæ’æŸ¥è‡ªåŠ¨é…ç½®ä¸ç”Ÿæ•ˆé—®é¢˜ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>configprops</code></td>
<td>é…ç½®å±æ€§ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºæ‰€æœ‰ <code>@ConfigurationProperties</code> æ³¨è§£ç»‘å®šçš„é…ç½®å±æ€§ï¼ˆå¦‚è‡ªå®šä¹‰é…ç½®ã€æ¡†æ¶é»˜è®¤é…ç½®ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>env</code></td>
<td>ç¯å¢ƒå˜é‡ç«¯ç‚¹</td>
<td>æš´éœ² Spring åº”ç”¨çš„ <code>ConfigurableEnvironment</code> ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡ã€JVM ç³»ç»Ÿå±æ€§ã€åº”ç”¨é…ç½®æ–‡ä»¶ï¼ˆapplication.yml/propertiesï¼‰ä¸­çš„é…ç½®ç­‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>flyway</code></td>
<td>Flyway è¿ç§»ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºå·²åº”ç”¨çš„æ‰€æœ‰ Flyway æ•°æ®åº“ç‰ˆæœ¬è¿ç§»è®°å½•ï¼ˆå¦‚è¿ç§»è„šæœ¬åç§°ã€æ‰§è¡Œæ—¶é—´ã€çŠ¶æ€ç­‰ï¼‰</td>
<td>éœ€è¦ 1 ä¸ªæˆ–å¤šä¸ª <code>Flyway</code> ç»„ä»¶ï¼ˆéœ€å¼•å…¥ Flyway ä¾èµ–ï¼‰</td>
</tr>
<tr>
<td><code>health</code></td>
<td>å¥åº·æ£€æŸ¥ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºåº”ç”¨è¿è¡ŒçŠ¶å†µä¿¡æ¯ï¼ˆæ ¸å¿ƒç›‘æ§ç«¯ç‚¹ï¼‰ï¼ŒåŒ…æ‹¬ï¼šåº”ç”¨è‡ªèº«çŠ¶æ€ã€ä¾èµ–ç»„ä»¶çŠ¶æ€ï¼ˆæ•°æ®åº“ã€Redisã€MQ ç­‰æ˜¯å¦å¯ç”¨ï¼‰ï¼Œæ”¯æŒã€Œç®€å•æ¨¡å¼ã€ï¼ˆä»…è¿”å› UP/DOWNï¼‰å’Œã€Œè¯¦ç»†æ¨¡å¼ã€ï¼ˆè¿”å›æ‰€æœ‰ä¾èµ–çŠ¶æ€è¯¦æƒ…ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–ï¼ˆä¾èµ–ç»„ä»¶éœ€å¯¹åº”é…ç½®ï¼‰</td>
</tr>
<tr>
<td><code>httptrace</code></td>
<td>HTTP è·Ÿè¸ªç«¯ç‚¹</td>
<td>æ˜¾ç¤ºæœ€è¿‘ 100 æ¡ HTTP è¯·æ±‚ - å“åº”çš„è·Ÿè¸ªä¿¡æ¯ï¼ˆå¦‚è¯·æ±‚è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ã€å“åº”çŠ¶æ€ç ã€å“åº”æ—¶é—´ç­‰ï¼‰</td>
<td>éœ€è¦ <code>HttpTraceRepository</code> ç»„ä»¶</td>
</tr>
<tr>
<td><code>info</code></td>
<td>åº”ç”¨ä¿¡æ¯ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºè‡ªå®šä¹‰çš„åº”ç”¨ä¿¡æ¯ï¼ˆå¦‚åº”ç”¨åç§°ã€ç‰ˆæœ¬ã€ä½œè€…ç­‰ï¼Œå¯é€šè¿‡ <code>info.xxx</code> é…ç½®ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>integrationgraph</code></td>
<td>Spring Integration å›¾ç«¯ç‚¹</td>
<td>æ˜¾ç¤º Spring Integration çš„ç»„ä»¶æ‹“æ‰‘å›¾ï¼ˆç”¨äºå¯è§†åŒ–é›†æˆæµç¨‹ï¼‰</td>
<td>éœ€è¦å¼•å…¥ <code>spring-integration-core</code> ä¾èµ–</td>
</tr>
<tr>
<td><code>loggers</code></td>
<td>æ—¥å¿—é…ç½®ç«¯ç‚¹</td>
<td>1. æŸ¥çœ‹åº”ç”¨ä¸­æ‰€æœ‰æ—¥å¿—å™¨ï¼ˆLoggerï¼‰çš„å½“å‰æ—¥å¿—çº§åˆ«ï¼ˆå¦‚ ROOTã€æŒ‡å®šåŒ…è·¯å¾„çš„æ—¥å¿—çº§åˆ«ï¼‰2. åŠ¨æ€ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼ˆæ— éœ€é‡å¯åº”ç”¨ï¼Œå³å¯è°ƒæ•´æ—¥å¿—è¾“å‡ºç²’åº¦ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–</td>
</tr>
<tr>
<td><code>liquibase</code></td>
<td>Liquibase è¿ç§»ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºå·²åº”ç”¨çš„æ‰€æœ‰ Liquibase æ•°æ®åº“ç‰ˆæœ¬è¿ç§»è®°å½•ï¼ˆåŠŸèƒ½åŒ Flywayï¼Œå‡ä¸ºæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†ï¼‰</td>
<td>éœ€è¦ 1 ä¸ªæˆ–å¤šä¸ª <code>Liquibase</code> ç»„ä»¶ï¼ˆéœ€å¼•å…¥ Liquibase ä¾èµ–ï¼‰</td>
</tr>
<tr>
<td><code>mappings</code></td>
<td>è¯·æ±‚æ˜ å°„ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºåº”ç”¨ä¸­æ‰€æœ‰ <code>@RequestMapping</code> æ³¨è§£ç»‘å®šçš„ HTTP è¯·æ±‚è·¯å¾„ï¼ˆå«æ¥å£è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ã€å¯¹åº”æ§åˆ¶å™¨æ–¹æ³•ç­‰ï¼Œç”¨äºå¿«é€ŸæŸ¥è¯¢æ¥å£æ˜ å°„å…³ç³»ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–ï¼ˆé€‚ç”¨äº Spring MVC/WebFlux åº”ç”¨ï¼‰</td>
</tr>
<tr>
<td><code>scheduledtasks</code></td>
<td>å®šæ—¶ä»»åŠ¡ç«¯ç‚¹</td>
<td>æ˜¾ç¤ºåº”ç”¨ä¸­æ‰€æœ‰é€šè¿‡ <code>@Scheduled</code> æ³¨è§£é…ç½®çš„å®šæ—¶ä»»åŠ¡ï¼ˆå«ä»»åŠ¡æ‰§è¡Œè¡¨è¾¾å¼ã€æ‰§è¡ŒçŠ¶æ€ç­‰ï¼‰</td>
<td>æ— é¢å¤–ä¾èµ–ï¼ˆéœ€åº”ç”¨é…ç½®äº†å®šæ—¶ä»»åŠ¡ï¼‰</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>ä¼šè¯ç®¡ç†ç«¯ç‚¹</td>
<td>æ£€ç´¢å’Œåˆ é™¤ Spring Session æ”¯æŒçš„ç”¨æˆ·ä¼šè¯ï¼ˆå¦‚åˆ†å¸ƒå¼ä¼šè¯ï¼‰</td>
<td>1. éœ€ä¸ºåŸºäº Servlet çš„ Web åº”ç”¨2. éœ€å¼•å…¥ Spring Session ä¾èµ–å¹¶é…ç½®</td>
</tr>
<tr>
<td><code>shutdown</code></td>
<td>åº”ç”¨å…³é—­ç«¯ç‚¹</td>
<td>è§¦å‘åº”ç”¨æ­£å¸¸å…³é—­ï¼ˆä¼˜é›…åœæœºï¼‰ï¼Œé¿å…å¼ºåˆ¶å…³é—­å¯¼è‡´çš„æ•°æ®ä¸¢å¤±</td>
<td>1. é»˜è®¤ç¦ç”¨ï¼Œéœ€é€šè¿‡ <code>management.endpoint.shutdown.enabled=true</code> å¼€å¯2. ä»…æ”¯æŒ POST è¯·æ±‚</td>
</tr>
<tr>
<td><code>startup</code></td>
<td>å¯åŠ¨æ­¥éª¤ç«¯ç‚¹</td>
<td>æ˜¾ç¤º <code>ApplicationStartup</code> æ”¶é›†çš„åº”ç”¨å¯åŠ¨æ­¥éª¤æ•°æ®ï¼ˆå¦‚å„ç»„ä»¶å¯åŠ¨è€—æ—¶ï¼Œç”¨äºæ’æŸ¥åº”ç”¨å¯åŠ¨ç¼“æ…¢é—®é¢˜ï¼‰</td>
<td>éœ€è¦é…ç½® <code>BufferingApplicationStartup</code>ï¼ˆé€šè¿‡ <code>SpringApplication</code> é…ç½®ï¼‰</td>
</tr>
<tr>
<td><code>jolokia</code></td>
<td>JMX æš´éœ²ç«¯ç‚¹</td>
<td>é€šè¿‡ HTTP åè®®æš´éœ²åº”ç”¨çš„ JMX Beanï¼ˆæ— éœ€ç›´æ¥è¿æ¥ JMX ç«¯å£ï¼Œä¾¿äºè¿œç¨‹ç›‘æ§ JMX æŒ‡æ ‡ï¼‰</td>
<td>1. éœ€å¼•å…¥ <code>jolokia-core</code> ä¾èµ–2. ä¸é€‚ç”¨äº Spring WebFlux åº”ç”¨</td>
</tr>
<tr>
<td><code>logfile</code></td>
<td>æ—¥å¿—æ–‡ä»¶ç«¯ç‚¹</td>
<td>è¿”å›åº”ç”¨æ—¥å¿—æ–‡ä»¶çš„å†…å®¹ï¼ˆæ”¯æŒåˆ†æ®µä¸‹è½½ï¼Œé€šè¿‡ HTTP <code>Range</code> æ ‡å¤´æŒ‡å®šè·å–çš„æ—¥å¿—ç‰‡æ®µï¼‰</td>
<td>éœ€é…ç½® <code>logging.file.name</code> æˆ– <code>logging.file.path</code> å±æ€§ï¼ˆæŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„ / åç§°ï¼‰</td>
</tr>
<tr>
<td><code>prometheus</code></td>
<td>Prometheus æŒ‡æ ‡ç«¯ç‚¹</td>
<td>ä»¥ Prometheus æœåŠ¡å™¨å¯æŠ“å–çš„æ ¼å¼æš´éœ²åº”ç”¨æŒ‡æ ‡ï¼ˆç”¨äº Prometheus + Grafana å®ç°ç›‘æ§å¯è§†åŒ–å’Œå‘Šè­¦ï¼‰</td>
<td>éœ€è¦å¼•å…¥ <code>micrometer-registry-prometheus</code> ä¾èµ–</td>
</tr>
</tbody>
</table>
</div>
<h6 id="2ã€å®šåˆ¶ç«¯ç‚¹"><a href="#2ã€å®šåˆ¶ç«¯ç‚¹" class="headerlink" title="2ã€å®šåˆ¶ç«¯ç‚¹"></a>2ã€å®šåˆ¶ç«¯ç‚¹</h6><p>å¥åº·ç›‘æ§ï¼šè¿”å›å­˜æ´»ã€æ­»äº¡</p>
<p>æŒ‡æ ‡ç›‘æ§ï¼šæ¬¡æ•°ã€ç‡</p>
<p><strong>1ã€HealthEndpoint </strong></p>
<p>å…ˆåˆ›å»ºäº†ä¸€ä¸ªç»„ä»¶<code>MyHahaComponent</code>ï¼Œç„¶åè¦ç›‘æ§è¿™ä¸ªç»„ä»¶çš„ç»„ä»¶<code>MyHahaHealthIndicator</code>åªè¦åç¼€æ˜¯Indicatorçš„éƒ½æ˜¯ç›‘æ§çš„ï¼Œç„¶åå¿…é¡»å®ç°å¥åº·ç›‘æ§çš„æ¥å£<code>HealthIndicator</code>,åªç”¨é‡å†™ä¸€ä¸ªæ–¹æ³•<code>health</code>ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ç»§æ‰¿æŠ½è±¡å¥åº·æ£€æŸ¥æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHahaComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">check</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//ä¸šåŠ¡ä»£ç åˆ¤æ–­è¿™ä¸ªç»„ä»¶æ˜¯å¦å­˜æ´»</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHahaHealthIndicator</span> <span class="keyword">extends</span> <span class="title class_">AbstractHealthIndicator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    MyHahaComponent myHahaComponent;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doHealthCheck</span><span class="params">(Health.Builder builder)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰æ£€æŸ¥æ–¹æ³•</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">check</span> <span class="operator">=</span> myHahaComponent.check();</span><br><span class="line">        <span class="keyword">if</span> (check &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//å­˜æ´»</span></span><br><span class="line">            builder.up().withDetail(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;1000&quot;</span>)</span><br><span class="line">                .withDetail(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;è·å¾—å¾ˆå¥åº·&quot;</span>).build();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//ä¸‹çº¿</span></span><br><span class="line">            builder.down().build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¼€å¯è¯¦ç»†ä¿¡æ¯å¼€å¯é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">show-details:</span> <span class="string">always</span> <span class="comment">#æ€»æ˜¯æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚å¯æ˜¾ç¤ºæ¯ä¸ªæ¨¡å—çš„çŠ¶æ€ä¿¡æ¯</span></span><br></pre></td></tr></table></figure>
<p><strong>è‡ªå®šä¹‰æŒ‡æ ‡</strong></p>
<p>ä¸Šé¢æ˜¯è‡ªå®šä¹‰ç›‘æ§ï¼Œè¿™é‡Œæ˜¯è‡ªå®šä¹‰æŒ‡æ ‡</p>
<p><strong>2ã€MetricesEndpoint</strong></p>
<p>å‡è®¾æœ‰ä¸€ä¸ªç»„ä»¶æœ‰ä¸ªhahaæ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬æƒ³ç›‘æ§è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨å¤šå°‘é</p>
<p>æœ‰ä¸€ä¸ª controller è°ƒç”¨ ç»„ä»¶çš„hahaæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHahaComponent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Counter</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//å¦‚æœè¿™ä¸ªç»„ä»¶åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šä»å®¹å™¨ä¸­æ‹¿.meterRegistryå°±æ˜¯è®°å½•æ‰€æœ‰æŒ‡æ ‡çš„ç»„ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyHahaComponent</span><span class="params">(MeterRegistry meterRegistry)</span> &#123;</span><br><span class="line">        <span class="comment">//ç„¶åæ³¨å†Œè¿›å»ï¼Œå½“ç„¶æœ‰ä¸åŒçš„è§‚æµ‹æ–¹æ³•ï¼Œcounteråªæ˜¯è®¡æ•°è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•</span></span><br><span class="line">        counter = meterRegistry.counter(<span class="string">&quot;myhaha.hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">check</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//ä¸šåŠ¡ä»£ç åˆ¤æ–­è¿™ä¸ªç»„ä»¶æ˜¯å¦å­˜æ´»</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">haha</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;haha&quot;</span>);</span><br><span class="line">        couter.increment();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2ã€ç›‘æ§æ¡ˆä¾‹è½åœ°"><a href="#2ã€ç›‘æ§æ¡ˆä¾‹è½åœ°" class="headerlink" title="2ã€ç›‘æ§æ¡ˆä¾‹è½åœ°"></a>2ã€ç›‘æ§æ¡ˆä¾‹è½åœ°</h4><p>ç°åœ¨æˆ‘ä»¬èƒ½æš´éœ²å¾ˆå¤šç›‘æ§æ•°æ®äº†ï¼Œå¦‚æœæƒ³è¦ç›‘æ§æ•°æ®æ˜¾ç¤ºå¥½çœ‹ï¼Œè¦ä¹ˆå°±æ˜¯å‰ç«¯å†™ä¸€å¥—é¡µé¢ã€‚</p>
<p>è¦ä¹ˆå°±æ˜¯ç”¨ä¼ä¸šå¸¸ç”¨çš„ åŸºäº Prometheus + Grafana</p>
<p>åŸç†å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230024251613.png" alt="image-20251230024251613"></p>
<h5 id="1ã€å®‰è£…-Prometheus-Grafana"><a href="#1ã€å®‰è£…-Prometheus-Grafana" class="headerlink" title="1ã€å®‰è£… Prometheus + Grafana"></a>1ã€å®‰è£… Prometheus + Grafana</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…prometheus:æ—¶åºæ•°æ®åº“</span></span><br><span class="line">docker run -p 9090:9090 -d \-v pc:/etc/prometheus \</span><br><span class="line">prom/prometheus</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…grafanaï¼›é»˜è®¤è´¦å·å¯†ç admin:admin</span></span><br><span class="line">docker run -d --name=grafana -p 3000:3000 grafana/grafana</span><br></pre></td></tr></table></figure>
<h5 id="2ã€å¯¼å…¥ä¾èµ–"><a href="#2ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="2ã€å¯¼å…¥ä¾èµ–"></a>2ã€å¯¼å…¥ä¾èµ–</h5><p>ç°åœ¨æˆ‘ä»¬å¯¼å…¥ä¾èµ–ï¼Œè®©SpringBootäº§ç”Ÿprometheuséœ€è¦çš„æ•°æ®</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.micrometer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¼å…¥ä¹‹åå°±ä¼šç›´æ¥æŠŠä¹‹å‰jsonçš„ç›‘æ§æ•°æ®å˜æˆprometheuséœ€è¦çš„sqlå†™è¿›æ•°æ®åº“é‡Œé¢äº†</p>
<p><code>è®¿é—®ï¼š http://localhost:8001/actuator/prometheus  éªŒè¯ï¼Œè¿”å› prometheus æ ¼å¼çš„æ‰€æœ‰æŒ‡æ ‡</code></p>
<p>è®°å¾—æ”¹ç«¯å£ï¼Œå› ä¸ºspringbootçš„ç«¯å£é»˜è®¤8080</p>
<p>ç„¶åæŠŠspringbootåº”ç”¨æ‰“åŒ…ï¼Œç„¶åæŠŠJaråŒ…å®‰è£…åˆ°æœåŠ¡å™¨é‡Œé¢</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…ä¸Šä¼ â¼¯å…·ï¼Œç„¶åè¾“å…¥å‘½ä»¤rzå°±èƒ½ä¸Šä¼ äº†</span></span><br><span class="line">yum install lrzsz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…openjdk</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½openjdk</span></span><br><span class="line">wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.tar.gz</span><br><span class="line"></span><br><span class="line">mkdir -p /opt/java</span><br><span class="line">tar -xzf jdk-17_linux-x64_bin.tar.gz -C /opt/java/</span><br><span class="line">sudo vi /etc/profile</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åŠ â¼Šä»¥ä¸‹å†…å®¹</span></span><br><span class="line">export JAVA_HOME=/opt/java/jdk-17.0.7</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¯å¢ƒå˜é‡â½£æ•ˆ</span></span><br><span class="line">source /etc/profile</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åå°å¯åŠ¨javaåº”â½¤</span></span><br><span class="line">nohup java -jar boot3-14-actuator-0.0.1-SNAPSHOT.jar &gt; output.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<p>ç¡®è®¤å¯ä»¥è®¿é—®åˆ°ï¼š<code>http://æœåŠ¡å™¨å…¬ç½‘IP:9999/actuator/prometheus</code></p>
<p>å¦‚æœåœ¨åŒä¸€ä¸ªæœºå™¨å†…ï¼Œå¯ä»¥ç”¨ä¹‹å‰è‡ªå®šä¹‰çš„ç§ç½‘IP</p>
<h5 id="3ã€é…ç½®-Prometheus-æ‹‰å–æ•°æ®"><a href="#3ã€é…ç½®-Prometheus-æ‹‰å–æ•°æ®" class="headerlink" title="3ã€é…ç½® Prometheus æ‹‰å–æ•°æ®"></a>3ã€é…ç½® Prometheus æ‹‰å–æ•°æ®</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹prometheus.yml é…ç½®â½‚ä»¶</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;spring-boot-actuator-exporter&#x27;</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">&#x27;/actuator/prometheus&#x27;</span> <span class="comment">#æŒ‡å®šæŠ“å–çš„è·¯å¾„</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;ç§ç½‘IP:8001&#x27;</span>]</span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">nodename:</span> <span class="string">&#x27;app-demo&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="4ã€é…ç½®Grafanaç›‘æ§é¢æ¿"><a href="#4ã€é…ç½®Grafanaç›‘æ§é¢æ¿" class="headerlink" title="4ã€é…ç½®Grafanaç›‘æ§é¢æ¿"></a>4ã€é…ç½®Grafanaç›‘æ§é¢æ¿</h5><p>æ·»åŠ æ•°æ®æºï¼ˆPrometheusï¼‰ </p>
<p>æ·»åŠ â¾¯æ¿ã€‚å¯å» dashboard å¸‚åœºæ‰¾â¼€ä¸ªâ¾ƒâ¼°å–œæ¬¢çš„â¾¯æ¿ï¼Œä¹Ÿå¯ä»¥â¾ƒâ¼°å¼€å‘â¾¯æ¿;<code>Dashboards |  Grafana Labs</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230032020123.png" alt="image-20251230032020123"></p>
<h3 id="AOT"><a href="#AOT" class="headerlink" title="AOT"></a>AOT</h3><p>AOTï¼šAhead-of-Timeï¼ˆæå‰ç¼–è¯‘ï¼‰ï¼šç¨‹åºæ‰§â¾å‰ï¼Œå…¨éƒ¨è¢«ç¼–è¯‘æˆæœºå™¨ç  </p>
<p>JITï¼šJust in Timeï¼ˆå³æ—¶ç¼–è¯‘ï¼‰: ç¨‹åºè¾¹ç¼–è¯‘ï¼Œè¾¹è¿â¾ï¼›</p>
<h4 id="AOT-ä¸-JIT"><a href="#AOT-ä¸-JIT" class="headerlink" title="AOT ä¸ JIT"></a>AOT ä¸ JIT</h4><p>è¯­â¾”ï¼š </p>
<p>â€‹    ç¼–è¯‘å‹è¯­â¾”ï¼šç¼–è¯‘å™¨ </p>
<p>â€‹    è§£é‡Šå‹è¯­â¾”ï¼šè§£é‡Šå™¨</p>
<h5 id="1ã€Complier-ä¸-Interpreter"><a href="#1ã€Complier-ä¸-Interpreter" class="headerlink" title="1ã€Complier ä¸ Interpreter"></a>1ã€Complier ä¸ Interpreter</h5><p>Javaï¼šåŠç¼–è¯‘åŠè§£é‡Š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230032917766.png" alt="image-20251230032917766"></p>
<h5 id="2ã€AOTä¸JITå¯¹æ¯”"><a href="#2ã€AOTä¸JITå¯¹æ¯”" class="headerlink" title="2ã€AOTä¸JITå¯¹æ¯”"></a>2ã€AOTä¸JITå¯¹æ¯”</h5><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>JIT</th>
<th>AOT</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¼˜ç‚¹</td>
<td>1.å…·å¤‡å®æ—¶è°ƒæ•´èƒ½â¼’ <br />2.â½£æˆæœ€ä¼˜æœºå™¨æŒ‡ä»¤ <br />3.æ ¹æ®ä»£ç è¿â¾æƒ…å†µä¼˜åŒ–å†…å­˜å â½¤</td>
<td>1.é€Ÿåº¦å¿«ï¼Œä¼˜åŒ–äº†è¿â¾æ—¶ç¼–è¯‘æ—¶é—´å’Œå†…å­˜æ¶ˆè€— <br />2.ç¨‹åºåˆæœŸå°±èƒ½è¾¾æœ€â¾¼æ€§èƒ½ <br />3.åŠ å¿«ç¨‹åºå¯åŠ¨é€Ÿåº¦</td>
</tr>
<tr>
<td>ç¼ºç‚¹</td>
<td>1.è¿â¾æœŸè¾¹ç¼–è¯‘é€Ÿåº¦æ…¢ <br />2.åˆå§‹ç¼–è¯‘ä¸èƒ½è¾¾åˆ°æœ€â¾¼æ€§èƒ½</td>
<td>1.ç¨‹åºç¬¬â¼€æ¬¡ç¼–è¯‘å â½¤æ—¶é—´â»“ <br />2.ç‰ºç‰²â¾¼çº§è¯­â¾”â¼€äº›ç‰¹æ€§</td>
</tr>
</tbody>
</table>
</div>
<p>åœ¨ OpenJDK çš„å®˜â½… Wiki ä¸Šï¼Œä»‹ç»äº†HotSpot è™šæ‹Ÿæœºâ¼€ä¸ªç›¸å¯¹â½è¾ƒå…¨â¾¯çš„ã€å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰ ä¸­é‡‡â½¤çš„ä¼˜åŒ–æŠ€æœ¯åˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´Javaä¸­æ˜¯éƒ½æœ‰ã€‚</p>
<h5 id="3ã€JVMæ¶æ„"><a href="#3ã€JVMæ¶æ„" class="headerlink" title="3ã€JVMæ¶æ„"></a>3ã€JVMæ¶æ„</h5><p>JVM: æ—¢æœ‰è§£é‡Šå™¨ï¼Œâ¼œæœ‰ç¼–è¾‘å™¨ï¼ˆJITï¼šå³æ—¶ç¼–è¯‘ï¼‰ï¼›</p>
<p>.java åˆ° .class åˆ° æœºå™¨ç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230041117065.png" alt="image-20251230041117065"></p>
<p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å†™çš„ java ä»£ç é€šè¿‡ <code>javac</code> ç¼–è¯‘æˆ <code>.class</code> æ–‡ä»¶ï¼Œä½†è¿™ä¸ç®—çœŸæ­£çš„ç¼–è¯‘ã€‚åªæ˜¯ä¸€ä¸ªä¸­é—´è¡¨ç¤ºå±‚ã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼Œ<code>.class</code>æ–‡ä»¶ä¼šè¢«JVMçš„ç±»åŠ è½½å™¨åŠ è½½è¿›å»ï¼Œè¿™é‡Œçœç•¥è®²è§£ç±»åŠ è½½è¿‡ç¨‹</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œæ•´ä¸ªæ•°æ®ä¼šåŠ è½½åˆ°è¿è¡Œæ—¶æ•°æ®åŒºï¼Œæ–¹æ³•åˆ°æ–¹æ³•åŒºï¼Œ<code>new</code> çš„å¯¹è±¡æ”¾åˆ°å †å†…å­˜ï¼Œç„¶åæ¯ä¸ªçº¿ç¨‹æœ‰æ ˆç­‰ï¼Œè¿™é‡Œä¹Ÿä¸è¯¦ç»†è§£é‡Šã€‚</p>
<p>ç¬¬å››æ­¥ï¼ŒçœŸæ­£æ‰§è¡Œä»£ç çš„æ˜¯æ‰§è¡Œå¼•æ“é‡Œé¢æœ‰ä¸ª <code>Interpreter</code>è§£é‡Šå™¨ <code>JIT</code>ç¼–è¯‘å™¨ </p>
<p>ç„¶åè¿™é‡Œåˆæ¶‰åŠåˆ°ä»€ä¹ˆæ—¶å€™æŠŠ <code>.class</code>ç¼–è¯‘ä»€ä¹ˆæ—¶å€™ä¸ç¼–è¯‘ï¼Œå¼•å‡ºä¸‹é¢çš„Javaæ‰§è¡Œæµç¨‹</p>
<h5 id="4ã€Javaçš„æ‰§è¡Œè¿‡ç¨‹"><a href="#4ã€Javaçš„æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="4ã€Javaçš„æ‰§è¡Œè¿‡ç¨‹"></a>4ã€Javaçš„æ‰§è¡Œè¿‡ç¨‹</h5><blockquote>
<p>å»ºè®®é˜…è¯»ï¼š </p>
<p>ç¾å›¢æŠ€æœ¯ï¼š<a target="_blank" rel="noopener" href="https://tech.meituan.com/2020/10/22/java-jit-practice-in-meituan.html">https://tech.meituan.com/2020/10/22/java-jit-practice-in-meituan.html</a> </p>
<p>openjdkå®˜â½¹ï¼š<a target="_blank" rel="noopener" href="https://wiki.openjdk.org/display/HotSpot/Compiler">https://wiki.openjdk.org/display/HotSpot/Compiler</a></p>
</blockquote>
<h6 id="1ã€å¤§æ¦‚æµç¨‹"><a href="#1ã€å¤§æ¦‚æµç¨‹" class="headerlink" title="1ã€å¤§æ¦‚æµç¨‹"></a>1ã€å¤§æ¦‚æµç¨‹</h6><p>IR å°±æ˜¯ä¸­é—´è¡¨ç¤ºå±‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230041944032.png" alt="image-20251230041944032"></p>
<h6 id="2ã€è¯¦ç»†æµç¨‹"><a href="#2ã€è¯¦ç»†æµç¨‹" class="headerlink" title="2ã€è¯¦ç»†æµç¨‹"></a>2ã€è¯¦ç»†æµç¨‹</h6><p>çƒ­ç‚¹ä»£ç ï¼šè°ƒâ½¤æ¬¡æ•°â¾®å¸¸å¤šçš„ä»£ç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230042144747.png" alt="image-20251230042144747"></p>
<h5 id="5ã€JVMç¼–è¯‘å™¨"><a href="#5ã€JVMç¼–è¯‘å™¨" class="headerlink" title="5ã€JVMç¼–è¯‘å™¨"></a>5ã€JVMç¼–è¯‘å™¨</h5><p>JVMä¸­é›†æˆäº†ä¸¤ç§ç¼–è¯‘å™¨ï¼ŒClient Compiler å’Œ Server Compilerï¼›</p>
<p>Client Compileræ³¨é‡å¯åŠ¨é€Ÿåº¦å’Œå±€éƒ¨çš„ä¼˜åŒ– </p>
<p>Server Compileræ›´åŠ å…³æ³¨å…¨å±€ä¼˜åŒ–ï¼Œæ€§èƒ½æ›´å¥½ï¼Œä½†ç”±äºä¼šè¿›â¾æ›´å¤šçš„å…¨å±€åˆ†æï¼Œæ‰€ä»¥å¯åŠ¨é€Ÿåº¦ä¼š æ…¢ã€‚</p>
<p>Client Compilerï¼š</p>
<p>â€‹    HotSpot VMå¸¦æœ‰â¼€ä¸ªClient Compiler  </p>
<p>â€‹    è¿™ç§ç¼–è¯‘å™¨ C1ç¼–è¯‘å™¨ å¯åŠ¨é€Ÿåº¦å¿« ï¼Œä½†æ˜¯æ€§èƒ½â½è¾ƒServer Compileræ¥è¯´ä¼šå·®â¼€äº›ã€‚ </p>
<p>â€‹    ç¼–è¯‘åçš„æœºå™¨ç æ‰§â¾æ•ˆç‡æ²¡æœ‰C2çš„â¾¼</p>
<p>Server Compilerï¼š</p>
<p>â€‹    Hotspotè™šæ‹Ÿæœºä¸­ä½¿â½¤çš„Server Compileræœ‰ä¸¤ç§ï¼š C2 å’Œ  Graal ã€‚ </p>
<p>â€‹    åœ¨Hotspot VMä¸­ï¼Œé»˜è®¤çš„Server Compileræ˜¯ C2ç¼–è¯‘å™¨ã€‚    </p>
<h5 id="6ã€åˆ†å±‚ç¼–è¯‘"><a href="#6ã€åˆ†å±‚ç¼–è¯‘" class="headerlink" title="6ã€åˆ†å±‚ç¼–è¯‘"></a>6ã€åˆ†å±‚ç¼–è¯‘</h5><p>Java 7å¼€å§‹å¼•â¼Šäº†åˆ†å±‚ç¼–è¯‘(Tiered Compiler )çš„æ¦‚å¿µï¼Œå®ƒç»“åˆäº†C1å’Œ C2 çš„ä¼˜åŠ¿ï¼Œè¿½æ±‚å¯åŠ¨é€Ÿåº¦å’Œå³°å€¼ æ€§èƒ½çš„â¼€ä¸ªå¹³è¡¡ã€‚åˆ†å±‚ç¼–è¯‘å°†JVMçš„æ‰§â¾çŠ¶æ€åˆ†ä¸ºäº†äº”ä¸ªå±‚æ¬¡ã€‚ <strong>äº”ä¸ªå±‚çº§</strong> åˆ†åˆ«æ˜¯ï¼š </p>
<p>â€‹    è§£é‡Šæ‰§â¾ã€‚ </p>
<p>â€‹    æ‰§â¾ä¸å¸¦profilingçš„C1ä»£ç ã€‚ </p>
<p>â€‹    æ‰§â¾ä»…å¸¦â½…æ³•è°ƒâ½¤æ¬¡æ•°ä»¥åŠå¾ªç¯å›è¾¹æ‰§â¾æ¬¡æ•°profilingçš„C1ä»£ç ã€‚ </p>
<p>â€‹    æ‰§â¾å¸¦æ‰€æœ‰profilingçš„C1ä»£ç ã€‚ </p>
<p>â€‹    æ‰§â¾C2ä»£ç ã€‚</p>
<p>profilingå°±æ˜¯æ”¶é›†èƒ½å¤Ÿåæ˜ ç¨‹åºæ‰§â¾çŠ¶æ€çš„æ•°æ® ã€‚å…¶ä¸­æœ€åŸºæœ¬çš„ç»Ÿè®¡æ•°æ®å°±æ˜¯â½…æ³•çš„è°ƒâ½¤æ¬¡æ•°ï¼Œä»¥åŠå¾ªç¯å›è¾¹çš„æ‰§â¾æ¬¡æ•°ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230043217979.png" alt="image-20251230043217979"></p>
<p>å›¾ä¸­ç¬¬â‘ æ¡è·¯å¾„ï¼Œä»£è¡¨ç¼–è¯‘çš„ä¸€èˆ¬æƒ…å†µï¼šçƒ­ç‚¹æ–¹æ³•ä»è§£é‡Šæ‰§è¡Œåˆ°è¢« 3 å±‚çš„ C1 ç¼–è¯‘ï¼Œæœ€åè¢« 4 å±‚çš„ C2 ç¼–è¯‘ã€‚</p>
<p>å¦‚æœæ–¹æ³•æ¯”è¾ƒå°ï¼ˆæ¯”å¦‚ Java æœåŠ¡ä¸­å¸¸è§çš„ getter/setter æ–¹æ³•ï¼‰ï¼Œ3 å±‚çš„ profiling æ²¡æœ‰æ”¶é›†åˆ°æœ‰ä»·å€¼çš„æ•°æ®ï¼ŒJVM å°±ä¼šæ–­å®šè¯¥æ–¹æ³•å¯¹äº C1 ä»£ç å’Œ C2 ä»£ç çš„æ‰§è¡Œæ•ˆç‡ç›¸åŒï¼Œå°±ä¼šæ‰§è¡Œå›¾ä¸­ç¬¬â‘¡æ¡è·¯å¾„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJVM ä¼šåœ¨ 3 å±‚ç¼–è¯‘ä¹‹åï¼Œæ”¾å¼ƒè¿›å…¥ C2 ç¼–è¯‘ï¼Œç›´æ¥é€‰æ‹©ç”¨ 1 å±‚çš„ C1 ç¼–è¯‘è¿è¡Œã€‚</p>
<p>åœ¨ C1 å¿™ç¢Œçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œå›¾ä¸­ç¬¬â‘¢æ¡è·¯å¾„ï¼šåœ¨è§£é‡Šæ‰§è¡Œè¿‡ç¨‹ä¸­å¯¹ç¨‹åºè¿›è¡Œ profilingï¼Œæ ¹æ®æ”¶é›†åˆ°çš„ä¿¡æ¯ç›´æ¥ç”±ç¬¬ 4 å±‚çš„ C2 ç¼–è¯‘ã€‚</p>
<p>å‰æ–‡æåˆ° C1 ä¸­çš„æ‰§è¡Œæ•ˆç‡æ˜¯ 1 å±‚ &gt; 2 å±‚ &gt; 3 å±‚ï¼Œç¬¬ 3 å±‚ä¸€èˆ¬è¦æ¯”ç¬¬ 2 å±‚æ…¢ 35% ä»¥ä¸Šï¼Œæ‰€ä»¥åœ¨ C2 å¿™ç¢Œçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œå›¾ä¸­ç¬¬â‘£æ¡è·¯å¾„ã€‚è¿™æ—¶æ–¹æ³•ä¼šè¢« 2 å±‚çš„ C1 ç¼–è¯‘ï¼Œç„¶åå†è¢« 3 å±‚çš„ C1 ç¼–è¯‘ï¼Œä»¥å‡å°‘æ–¹æ³•åœ¨ 3 å±‚çš„æ‰§è¡Œæ—¶é—´ã€‚</p>
<p>å¦‚æœç¼–è¯‘å™¨åšäº†ä¸€äº›æ¯”è¾ƒæ¿€è¿›çš„ä¼˜åŒ–ï¼ˆæ¯”å¦‚åˆ†æ”¯é¢„æµ‹ï¼‰ï¼Œåœ¨å®é™…è¿è¡Œæ—¶å‘ç°é¢„æµ‹å‡ºé”™ï¼Œè¿™æ—¶å°±ä¼šè¿›è¡Œåä¼˜åŒ–ï¼Œé‡æ–°è¿›å…¥è§£é‡Šæ‰§è¡Œï¼Œå›¾ä¸­ç¬¬â‘¤æ¡æ‰§è¡Œè·¯å¾„ä»£è¡¨çš„å°±æ˜¯è¿™ä¸€åä¼˜åŒ–è¿‡ç¨‹ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼ŒC1 çš„ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼ŒC2 çš„ç¼–è¯‘è´¨é‡æ›´é«˜ã€‚åˆ†å±‚ç¼–è¯‘çš„ä¸åŒç¼–è¯‘è·¯å¾„ï¼Œæ˜¯ JVM æ ¹æ®å½“å‰æœåŠ¡çš„è¿è¡Œæƒ…å†µï¼Œå¯»æ‰¾æœåŠ¡æœ€ä½³æ€§èƒ½å¹³è¡¡ç‚¹çš„è¿‡ç¨‹ã€‚ä» JDK 8 å¼€å§‹ï¼ŒJVM é»˜è®¤å¼€å¯åˆ†å±‚ç¼–è¯‘ã€‚</p>
<p>ä½†æ˜¯ç°åœ¨ä¹Ÿæœ‰ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ java ç¨‹åºä¸€å¼€å§‹éƒ½æ˜¯è§£é‡Šè¿è¡Œï¼Œä¼šå¾ˆæ…¢ï¼Œåé¢ç¨³å®šäº†è°ƒç”¨æ¬¡æ•°å¤šäº†ä¹‹åï¼Œæ‰ä¼šè¶Šæ¥è¶Šå¿«ã€‚</p>
<p>ç°åœ¨äº‘åŸç”Ÿï¼Œä¸æ˜¯ä¸€ç›´åœ¨ä¸€å°æœºå™¨ä¸Šè·‘äº†,å°±æœ‰å¯èƒ½ä¹‹å‰çš„é‚£äº›çƒ­ç‚¹æ•°æ®ç™½å¼„äº†ã€‚</p>
<p>é‚£ä¹ˆä¸ºäº†åº”å¯¹è¿™ä¸ªæˆ‘ä»¬å°±éœ€è¦å¯¹ java è¿›è¡Œå°æ”¹ç‰ˆ</p>
<p>æœ€å¥½çš„æ•ˆæœï¼š</p>
<p>å­˜åœ¨çš„é—®é¢˜ï¼šjavaåº”â½¤å¦‚æœâ½¤jarï¼Œè§£é‡Šæ‰§â¾ï¼Œçƒ­ç‚¹ä»£ç æ‰ç¼–è¯‘æˆæœºå™¨ç ï¼›åˆå§‹å¯åŠ¨é€Ÿåº¦æ…¢ï¼Œåˆå§‹å¤„ç†è¯·æ±‚æ•°é‡ å°‘ã€‚â¼¤å‹äº‘å¹³å°ï¼Œè¦æ±‚æ¯â¼€ç§åº”â½¤éƒ½å¿…é¡»ç§’çº§å¯åŠ¨ã€‚æ¯ä¸ªåº”â½¤éƒ½è¦æ±‚æ•ˆç‡â¾¼ã€‚</p>
<p>å¸Œæœ›çš„æ•ˆæœï¼š</p>
<p>â€‹    javaåº”â½¤ä¹Ÿèƒ½æå‰è¢«ç¼–è¯‘æˆæœºå™¨ç ï¼Œéšæ—¶æ€¥é€Ÿå¯åŠ¨ï¼Œâ¼€å¯åŠ¨å°±æ€¥é€Ÿè¿â¾ï¼Œæœ€â¾¼æ€§èƒ½</p>
<p>â€‹    ç¼–è¯‘æˆæœºå™¨ç çš„å¥½å¤„ï¼š</p>
<p>â€‹        å¦å¤–çš„æœåŠ¡å™¨è¿˜éœ€è¦å®‰è£…Javaç¯å¢ƒ</p>
<p>â€‹        ç¼–è¯‘æˆæœºå™¨ç çš„ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå¹³å° Windows X64 ç›´æ¥è¿â¾ã€‚</p>
<p>ä¸‹é¢å°±è®²è§£åˆ©ç”¨ GraalVM æŠŠ java æ–‡ä»¶æ‰“åŒ…æˆåŸç”Ÿé•œåƒ</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è¿˜è¦å…ˆäº†è§£åŸç”Ÿé•œåƒï¼šnative-imageï¼ˆæœºå™¨ç ã€æœ¬åœ°é•œåƒï¼‰</p>
<p>æŠŠåº”â½¤æ‰“åŒ…æˆèƒ½é€‚é…æœ¬æœºå¹³å° çš„å¯æ‰§â¾â½‚ä»¶ï¼ˆæœºå™¨ç ã€æœ¬åœ°é•œåƒï¼‰</p>
<h4 id="GraalVM"><a href="#GraalVM" class="headerlink" title="GraalVM"></a>GraalVM</h4><blockquote>
<p>GraalVMæ˜¯â¼€ä¸ªâ¾¼æ€§èƒ½çš„JDKï¼Œæ—¨åœ¨åŠ é€Ÿâ½¤Javaå’Œå…¶ä»–JVMè¯­â¾”ç¼–å†™çš„åº”â½¤ç¨‹åºçš„æ‰§â¾ï¼ŒåŒæ—¶è¿˜æä¾› JavaScriptã€Pythonå’Œè®¸å¤šå…¶ä»–æµâ¾è¯­â¾”çš„è¿â¾æ—¶ã€‚ </p>
<p> GraalVMæä¾›äº†ä¸¤ç§è¿â¾Javaåº”â½¤ç¨‹åºçš„â½…å¼ï¼š </p>
<ol>
<li>åœ¨HotSpot JVMä¸Šä½¿â½¤Graalå³æ—¶ï¼ˆJITï¼‰ç¼–è¯‘å™¨ </li>
<li><p>ä½œä¸ºé¢„å…ˆç¼–è¯‘ï¼ˆAOTï¼‰çš„æœ¬æœºå¯æ‰§â¾â½‚ä»¶è¿â¾ï¼ˆæœ¬åœ°é•œåƒï¼‰ã€‚</p>
<p>GraalVMçš„å¤šè¯­â¾”èƒ½â¼’ä½¿å¾—åœ¨å•ä¸ªåº”â½¤ç¨‹åºä¸­æ··åˆå¤šç§ç¼–ç¨‹è¯­â¾”æˆä¸ºå¯èƒ½ï¼ŒåŒæ—¶æ¶ˆé™¤äº†å¤–éƒ¨è¯­â¾”è°ƒâ½¤çš„æˆæœ¬ã€‚</p>
</li>
</ol>
</blockquote>
<h5 id="1ã€æ¶æ„"><a href="#1ã€æ¶æ„" class="headerlink" title="1ã€æ¶æ„"></a>1ã€æ¶æ„</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230045202624.png" alt="image-20251230045202624"></p>
<h5 id="2ã€å®‰è£…"><a href="#2ã€å®‰è£…" class="headerlink" title="2ã€å®‰è£…"></a>2ã€å®‰è£…</h5><blockquote>
<p>è·¨ å¹³å°æä¾›åŸâ½£é•œåƒåŸç†ï¼š</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230045240304.png" alt="image-20251230045240304"></p>
<h6 id="1ã€å®‰è£…MicrosoftVisualStudio"><a href="#1ã€å®‰è£…MicrosoftVisualStudio" class="headerlink" title="1ã€å®‰è£…MicrosoftVisualStudio"></a>1ã€å®‰è£…MicrosoftVisualStudio</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230050924222.png" alt="image-20251230050924222"></p>
<p>é€‰è‹±æ–‡</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230050941968.png" alt="image-20251230050941968"></p>
<p>è®°ä½ä½ å®‰è£…çš„åœ°å€ï¼›</p>
<h6 id="2ã€å®‰è£…GraalVM"><a href="#2ã€å®‰è£…GraalVM" class="headerlink" title="2ã€å®‰è£…GraalVM"></a>2ã€å®‰è£…GraalVM</h6><p>ä¸‹è½½ GraalVM + native-image</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230051304905.png" alt="image-20251230051304905"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251230051327620.png" alt="image-20251230051327620"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/graalvm/graalvm-ce-builds">graalvm/graalvm-ce-builds: GraalVM CE binaires built by the GraalVM community</a></p>
<h6 id="3ã€é…ç½®"><a href="#3ã€é…ç½®" class="headerlink" title="3ã€é…ç½®"></a>3ã€é…ç½®</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">åŸæ¥</span><br><span class="line">JAVA_HOME</span><br><span class="line">D:\Study4It\SoftWare\jdk\jdk\jdk17</span><br><span class="line">ç°åœ¨</span><br><span class="line">JAVA_HOME</span><br><span class="line">D:\Study4It\SoftWare\jdk\graalvm-ce-java17-22.3.3</span><br><span class="line">éªŒè¯ java -version</span><br><span class="line"></span><br><span class="line">å®‰è£… native image ä¾èµ–</span><br><span class="line">1ã€ç½‘ç»œç¯å¢ƒå¥½ï¼š gu install native-image</span><br><span class="line">2ã€â½¹ç»œä¸å¥½ï¼Œä½¿â½¤æˆ‘ä»¬ä¸‹è½½çš„ç¦»çº¿jar gu install --file native-image-installable-svm-java17-windows-amd64-22.3.3.jar</span><br><span class="line"></span><br><span class="line">éªŒè¯ native-image</span><br></pre></td></tr></table></figure>
<h5 id="3ã€æµ‹è¯•"><a href="#3ã€æµ‹è¯•" class="headerlink" title="3ã€æµ‹è¯•"></a>3ã€æµ‹è¯•</h5><h6 id="1ã€åˆ›å»ºé¡¹ç›®"><a href="#1ã€åˆ›å»ºé¡¹ç›®" class="headerlink" title="1ã€åˆ›å»ºé¡¹ç›®"></a>1ã€åˆ›å»ºé¡¹ç›®</h6><p>åˆ›å»ºæ™®é€šjavaé¡¹â½¬ã€‚ç¼–å†™HelloWorldç±»ï¼›   </p>
<p>â€‹    ä½¿â½¤ mvn clean package  è¿›â¾æ‰“åŒ… </p>
<p>â€‹    ç¡®è®¤jaråŒ…æ˜¯å¦å¯ä»¥æ‰§â¾ java -jar xxx.jar  </p>
<p>â€‹    å¯èƒ½éœ€è¦ç»™  MANIFEST.MF  æ·»åŠ   Main-Class:  ä½ çš„ä¸»ç±» </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251231012220954.png" alt="image-20251231012220954"></p>
<p>é‡åˆ°è¿™ç§æƒ…å†µå°±ç”¨å‹ç¼©æ–‡ä»¶æ‰“å¼€jaråŒ…ç„¶ååœ¨ MANIFEST.MF  æ·»åŠ   Main-Class:  ä½ çš„ä¸»ç±» ç„¶åå°±å¥½äº†ã€‚</p>
<p>ä»¥å‰æ²¡æœ‰é€‰æ‹©ï¼Œåªèƒ½æ‰“æˆ jar åŒ…</p>
<p>ç°åœ¨æœ‰ <code>graalVM</code> æˆ‘ä»¬å¯ä»¥æ‰“åŒ…æˆæœ¬åœ°é•œåƒï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ï¼šexeæˆ–è€…åˆ«çš„</p>
<h6 id="2ã€ç¼–è¯‘é•œåƒ"><a href="#2ã€ç¼–è¯‘é•œåƒ" class="headerlink" title="2ã€ç¼–è¯‘é•œåƒ"></a>2ã€ç¼–è¯‘é•œåƒ</h6><p>ç¼–è¯‘ä¸ºåŸâ½£é•œåƒï¼ˆnative-imageï¼‰ï¼šä½¿â½¤ native-tools  ç»ˆç«¯</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä»â¼Šâ¼å¼€å§‹ï¼Œç¼–è¯‘æ•´ä¸ªjar</span></span><br><span class="line">native-image -cp boot3-15-aot-common-1.0-SNAPSHOT.jar com.bitzh.Main -o Haha</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¼–è¯‘æŸä¸ªç±»ã€å¿…é¡»æœ‰mainâ¼Šâ¼â½…æ³•ï¼Œå¦åˆ™â½†æ³•ç¼–è¯‘ã€‘</span></span><br><span class="line">native-image -cp .\classes org.example.App</span><br></pre></td></tr></table></figure>
<h6 id="3ã€Linuxå¹³å°æµ‹è¯•"><a href="#3ã€Linuxå¹³å°æµ‹è¯•" class="headerlink" title="3ã€Linuxå¹³å°æµ‹è¯•"></a>3ã€Linuxå¹³å°æµ‹è¯•</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1ã€å®‰è£…gccç­‰ç¯å¢ƒ</span><br><span class="line">yum install lrzsz</span><br><span class="line">sudo yum install gcc glibc-devel zlib-devel</span><br><span class="line">2ã€ä¸‹è½½å®‰è£…é…ç½®Linuxä¸‹çš„GraalVMã€native-image</span><br><span class="line">ä¸‹è½½ï¼šhttps://www.graalvm.org/downloads/</span><br><span class="line">å®‰è£…ï¼šGraalVMã€native-image</span><br><span class="line">é…ç½®ï¼šJAVAç¯å¢ƒå˜é‡ä¸ºGraalVM</span><br><span class="line">tar -zxvf graalvm-ce-java17-linux-amd64-22.3.2.tar.gz -C /opt/java/</span><br><span class="line">sudo vim /etc/profile</span><br><span class="line">#ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span><br><span class="line">export JAVA_HOME=/opt/java/graalvm-ce-java17-22.3.2</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line">source /etc/profile</span><br><span class="line">3ã€å®‰è£…native-image</span><br><span class="line">gu install --file native-image-installable-svm-java17-linux-amd64-22.3.2.jar</span><br><span class="line">4ã€ä½¿â½¤native-imageç¼–è¯‘jarä¸ºåŸâ½£ç¨‹åº</span><br><span class="line">native-image -cp xxx.jar org.example.App -o è¾“å‡ºçš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure>
<p><strong>å¹¶ä¸æ˜¯æ‰€æœ‰çš„Javaä»£ç éƒ½èƒ½æ”¯æŒæœ¬åœ°æ‰“åŒ…</strong></p>
<p>æ¯”å¦‚åå°„ä»£ç ï¼šåŠ¨æ€è·å–æ„é€ å™¨ï¼Œåå°„åˆ›å»ºå¯¹è±¡ï¼Œåå°„è°ƒç”¨æ–¹æ³•ï¼Œè¿™äº›éƒ½ä¸è¡Œã€‚å› ä¸ºAOTä¼šæŸå¤±åŠ¨æ€èƒ½åŠ›ã€‚</p>
<p>éœ€è¦é¢å¤–å¤„ç†ï¼Œè¦æ˜ç¡®æå‰å‘ŠçŸ¥graalvmåå°„ä¼šç”¨åˆ°å“ªäº›æ–¹æ³•ã€æ„é€ å™¨</p>
<p>è§£å†³æ–¹æ¡ˆï¼šSpringBootæä¾›äº†ä¸€äº›æ³¨è§£ï¼Œæå‰å‘ŠçŸ¥GraalVMã€‚</p>
<p>é…ç½®æ–‡ä»¶ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œå› ä¸º jar åŒ…çš„è¯é‡Œé¢æœ‰é…ç½®æ–‡ä»¶çš„ï¼Œä½†æ˜¯è¿™ä¸ªä¹Ÿè¦é¢å¤–å¤„ç†ï¼ˆä»ç›¸å¯¹è·¯å¾„è¯»å–ï¼‰ä¸»è¦æ˜¯å‘ŠçŸ¥GraalVMé…ç½®æ–‡ä»¶éœ€è¦æ€ä¹ˆå¤„ç†ï¼Œä¹Ÿå¯ä»¥åŠ é…ç½®ä¸­å¿ƒã€‚</p>
<p>ä¸€å¥è¯ï¼šäºŒè¿›åˆ¶é‡Œé¢ä¸èƒ½åŒ…å«çš„ï¼Œä¸èƒ½åŠ¨æ€çš„éƒ½å¾—æå‰å¤„ç†ã€‚</p>
<p>ä¸æ˜¯æ‰€æœ‰æ¡†æ¶éƒ½é€‚é…äº†AOTç‰¹æ€§ï¼ŒSpringå…¨ç³»åˆ—æ ˆé€‚é…OK</p>
<h5 id="4ã€SpringBootæ•´åˆ"><a href="#4ã€SpringBootæ•´åˆ" class="headerlink" title="4ã€SpringBootæ•´åˆ"></a>4ã€SpringBootæ•´åˆ</h5><h6 id="1ã€ä¾èµ–å¯¼å…¥"><a href="#1ã€ä¾èµ–å¯¼å…¥" class="headerlink" title="1ã€ä¾èµ–å¯¼å…¥"></a>1ã€ä¾èµ–å¯¼å…¥</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>native-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="2ã€-â½£æˆnative-image"><a href="#2ã€-â½£æˆnative-image" class="headerlink" title="2ã€ â½£æˆnative-image"></a>2ã€ â½£æˆnative-image</h6><p>1ã€è¿â¾aotæå‰å¤„ç†å‘½ä»¤ï¼š <code>mvn springboot:process-aot</code></p>
<p>2ã€è¿â¾nativeæ‰“åŒ…ï¼š <code>mvn -Pnative native:build</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¨èåŠ ä¸Š-Pnative</span></span><br><span class="line">mvn -Pnative native:build -f pom.xml</span><br></pre></td></tr></table></figure>
<h6 id="3ã€å¸¸è§é—®é¢˜"><a href="#3ã€å¸¸è§é—®é¢˜" class="headerlink" title="3ã€å¸¸è§é—®é¢˜"></a>3ã€å¸¸è§é—®é¢˜</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å¯èƒ½æç¤ºå¦‚ä¸‹å„ç§é”™è¯¯ï¼Œâ½†æ³•æ„å»ºåŸâ½£é•œåƒï¼Œéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼›</span><br><span class="line"></span><br><span class="line">å‡ºç°cl.exe æ‰¾ä¸åˆ°é”™è¯¯</span><br><span class="line">å‡ºç°ä¹±ç </span><br><span class="line">æç¤º no include path set </span><br><span class="line">æç¤ºfatal error LNK1104: cannot open file &#x27;LIBCMT.lib&#x27;</span><br><span class="line">æç¤º LINK : fatal error LNK1104: cannot open file &#x27;kernel32.lib&#x27;</span><br><span class="line">æç¤ºå„ç§å…¶ä»–æ‰¾ä¸åˆ°</span><br><span class="line">éœ€è¦ä¿®æ”¹ä¸‰ä¸ªç¯å¢ƒå˜é‡ï¼šPath ã€INCLUDE ã€lib </span><br><span class="line">1ã€ Pathï¼šæ·»åŠ å¦‚ä¸‹å€¼</span><br><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSV</span><br><span class="line">C\14.33.31629\bin\Hostx64\x64</span><br><span class="line">2ã€æ–°å»ºINCLUDE ç¯å¢ƒå˜é‡ï¼šå€¼ä¸º</span><br><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.3</span><br><span class="line">3.31629\include;C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0</span><br><span class="line">\shared;C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\ucrt;</span><br><span class="line">C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\um;C:\Program F</span><br><span class="line">iles (x86)\Windows Kits\10\Include\10.0.19041.0\winrt</span><br><span class="line">3ã€æ–°å»ºlib ç¯å¢ƒå˜é‡ï¼šå€¼ä¸º</span><br><span class="line">C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.3</span><br><span class="line">3.31629\lib\x64;C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\um</span><br><span class="line">\x64;C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\ucrt\x64</span><br></pre></td></tr></table></figure>
<h2 id="SpringBoot3-æ”¹å˜å’Œæ–°ç‰¹æ€§"><a href="#SpringBoot3-æ”¹å˜å’Œæ–°ç‰¹æ€§" class="headerlink" title="SpringBoot3 æ”¹å˜å’Œæ–°ç‰¹æ€§"></a>SpringBoot3 æ”¹å˜å’Œæ–°ç‰¹æ€§</h2><p>1ã€â¾ƒåŠ¨é…ç½®åŒ…ä½ç½®å˜åŒ–</p>
<p><code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.im ports</code></p>
<p>2ã€jakata apiè¿ç§»</p>
<p><code>druid</code> æœ‰é—®é¢˜</p>
<p>3ã€æ–°ç‰¹æ€§ - å‡½æ•°å¼Webã€ProblemDetails</p>
<p>4ã€GraalVM ä¸ AOT</p>
<p>5ã€å“åº”å¼ç¼–ç¨‹å…¨å¥—</p>
<p>6ã€å‰©ä¸‹å˜åŒ–éƒ½æ˜¯ç‰ˆæœ¬å‡çº§ï¼Œæ„ä¹‰ä¸â¼¤</p>
<h2 id="SpringBoot3å“åº”å¼ç¼–ç¨‹"><a href="#SpringBoot3å“åº”å¼ç¼–ç¨‹" class="headerlink" title="SpringBoot3å“åº”å¼ç¼–ç¨‹"></a>SpringBoot3å“åº”å¼ç¼–ç¨‹</h2><h3 id="å‰ç½®-java8æ–°ç‰¹æ€§"><a href="#å‰ç½®-java8æ–°ç‰¹æ€§" class="headerlink" title="å‰ç½® java8æ–°ç‰¹æ€§"></a>å‰ç½® java8æ–°ç‰¹æ€§</h3><h4 id="1ã€Lambda"><a href="#1ã€Lambda" class="headerlink" title="1ã€Lambda"></a>1ã€Lambda</h4><p>Lambdaè¡¨è¾¾å¼æ˜¯Java 8 å¼•å…¥çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§</p>
<p>Lambdaè¡¨è¾¾å¼å¯ä»¥è¢«è§†ä¸ºåŒ¿åå‡½æ•°</p>
<p>å…è®¸åœ¨éœ€è¦å‡½æ•°çš„åœ°æ–¹ä»¥æ›´ç®€æ´çš„æ–¹å¼å®šä¹‰åŠŸèƒ½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°å¼æ¥å£ï¼Œåªè¦æ˜¯å‡½æ•°å¼æ¥å£å°±èƒ½ç”¨Lambdaç®€åŒ–</span></span><br><span class="line"><span class="comment">// æ¥å£ä¸­åªæœ‰ä¸€ä¸ªä¸ºå®ç°çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ¥å£å°±æ˜¯å‡½æ•°å¼æ¥å£</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span> <span class="comment">//æ£€æŸ¥æ³¨è§£ï¼Œå¸®æˆ‘ä»¬å¿«é€Ÿæ£€æŸ¥æˆ‘ä»¬å†™çš„æ¥å£æ˜¯å¦å‡½æ•°å¼æ¥å£</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyInterface</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> <span class="type">int</span> <span class="title function_">sum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;<span class="comment">// é»˜è®¤å®ç°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1ã€è‡ªå·±å†™å®ç°ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyInterfaceImpl</span> <span class="keyword">implements</span> <span class="title class_">MyInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lambda</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1ã€è‡ªå·±åˆ›å»ºå®ç°ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="type">MyInterfaceImpl</span> <span class="variable">myInterface</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyInterfaceImpl</span>();</span><br><span class="line">        System.out.println(myInterface.sum(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€åˆ›å»ºåŒ¿åå®ç°ç±»</span></span><br><span class="line">        <span class="type">MyInterface</span> <span class="variable">myInterface1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyInterfaceImpl</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> a * a + b * b;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(myInterface1.sum(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">        <span class="comment">// å†—ä½™å†™æ³•</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">        <span class="type">MyInterface</span> <span class="variable">myInterface2</span> <span class="operator">=</span> (<span class="type">int</span> a, <span class="type">int</span> b) -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> a * a + b * b;</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(myInterface2.sum(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">        <span class="comment">// å®Œæ•´å†™æ³•</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç®€åŒ–å†™æ³•</span></span><br><span class="line">        <span class="comment">// 1 å‚æ•°ç±»å‹å¯ä»¥ä¸å†™ï¼Œåªå†™(å‚æ•°å),å‚æ•°å˜é‡åï¼Œå‚æ•°è¡¨æœ€å°‘ä¸€ä¸ªç©ºçš„()ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªå‚æ•°å</span></span><br><span class="line">        <span class="comment">// 2 æ–¹æ³•ä½“å¦‚æœåªæœ‰ä¸€å¥è¯ï¼Œ&#123;&#125; å¯ä»¥çœç•¥</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»¥ä¸ŠLambdaè¡¨è¾¾å¼ç®€åŒ–äº†å®ä¾‹åˆ›å»º</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="type">var</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;aA&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;dB&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;sC&quot;</span>);</span><br><span class="line"></span><br><span class="line">        list.add(<span class="string">&quot;bD&quot;</span>);</span><br><span class="line">        Collections.sort(list, (o1, o2) -&gt; o1.compareTo(o2));</span><br><span class="line">        <span class="comment">// ç±»::æ–¹æ³•ï¼Œå¼•ç”¨ç±»ä¸­çš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">        Collections.sort(list, String::compareTo);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt;</span><br><span class="line">            System.out.println(<span class="string">&quot;haha&quot;</span>)</span><br><span class="line">        ).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ€»ç»“ä¸€ä¸‹ï¼šå¦‚æœä¸ç†Ÿæ‚‰æ¥å£å¯ä»¥å…ˆå†—ä½™å†™æ³•ï¼Œç„¶åå†ç‚¹è¿›æ¥å£çœ‹èƒ½ä¸èƒ½ç®€åŒ–å†™æ³•ï¼Œå¦‚æœç†Ÿæ‚‰å¯ä»¥ç›´æ¥ç”¨ç®€åŒ–å†™æ³•ã€‚</strong></p>
<h4 id="2ã€Function"><a href="#2ã€Function" class="headerlink" title="2ã€Function"></a>2ã€Function</h4><p>åœ¨Javaä¸­ï¼Œå‡½æ•°å¼æ¥å£æ˜¯åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œä»–ä»¬æ˜¯æ”¯æŒLambdaè¡¨è¾¾å¼çš„åŸºç¡€ï¼Œå› ä¸ºLambdaè¡¨è¾¾å¼éœ€è¦ä¸€ä¸ª <strong>ç›®æ ‡ç±»å‹</strong>ï¼Œè¿™ä¸ªç›®æ ‡ç±»å‹å¿…é¡»æ˜¯ä¸€ä¸ª<strong>å‡½æ•°å¼æ¥å£</strong></p>
<p>å½“æˆ‘ä»¬çœ‹ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå…³æ³¨ä»–ä»¬çš„å‡ºå…¥å‚å®šä¹‰ï¼Œåº•å±‚çš„Funtionï¼Œå®šä¹‰äº†ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªTä¸€ä¸ªRï¼Œç„¶ååº•å±‚èƒ½æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå‚æ•°ã€‚</p>
<p>é‚£ä¹ˆæ ¹æ®è¿™ä¸ªå‚æ•°çš„ä½ç½®å°±åˆ†ä¸ºäº†å››ç§</p>
<p>1ã€æœ‰â¼Šå‚ï¼Œâ½†å‡ºå‚ã€æ¶ˆè´¹è€…ã€‘</p>
<p>2ã€æœ‰â¼Šå‚ï¼Œæœ‰å‡ºå‚ã€å¤šåŠŸèƒ½å‡½æ•°ã€‘</p>
<p>3ã€â½†â¼Šå‚ï¼Œâ½†å‡ºå‚ã€æ™®é€šå‡½æ•°ã€‘</p>
<p>4ã€â½†â¼Šå‚ ï¼Œæœ‰å‡ºå‚ã€æä¾›è€…ã€‘</p>
<p><code>java.util.function</code>åŒ…ä¸‹çš„æ‰€æœ‰functionå®šä¹‰ï¼š </p>
<p>Consumerï¼š æ¶ˆè´¹è€… </p>
<p>Supplierï¼š æä¾›è€… </p>
<p>Predicateï¼š æ–­â¾” </p>
<p>get/test/apply/acceptè°ƒâ½¤çš„å‡½æ•°â½…æ³•ï¼›</p>
<h4 id="3ã€StreamAPI"><a href="#3ã€StreamAPI" class="headerlink" title="3ã€StreamAPI"></a>3ã€StreamAPI</h4><p>æœ€ä½³å®æˆ˜ï¼šä»¥åå‡¡æ˜¯ä½ å†™forå¾ªç¯å¤„ç†æ•°æ®çš„ç»Ÿâ¼€å…¨éƒ¨â½¤StreamAPIè¿›â¾æ›¿æ¢ï¼›</p>
<p><strong>æµæ˜¯å¹¶å‘è¿˜æ˜¯ä¸å¹¶å‘çš„ï¼Ÿæµä¹Ÿæ˜¯ç”¨forå¾ªç¯æŒ¨ä¸ªå¤„ç†çš„ä½†æ˜¯å¯ä»¥ç”¨ parallel å˜æˆå¹¶å‘</strong></p>
<p>ä½†æ˜¯å¹¶å‘åè¦è‡ªè¡Œè§£å†³å¹¶å‘å®‰å…¨é—®é¢˜ã€‚</p>
<p>æ¨èæµçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯æ— çŠ¶æ€æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ— çŠ¶æ€ï¼ˆStatelessï¼‰ æ¯æ¬¡è¯·æ±‚éƒ½ç‹¬ç«‹å¤„ç†ï¼Œä¸ä¾èµ–ä¹Ÿä¸ä¿å­˜ä¹‹å‰çš„è¯·æ±‚ä¿¡æ¯ã€‚</span><br><span class="line">æœ‰çŠ¶æ€ï¼ˆStatefulï¼‰ ç³»ç»Ÿéœ€è¦è®°ä½ä¹‹å‰äº¤äº’çš„å†å²ä¿¡æ¯ï¼ˆçŠ¶æ€ï¼‰ï¼Œæ‰èƒ½æ­£ç¡®å¤„ç†å½“å‰è¯·æ±‚ã€‚</span><br></pre></td></tr></table></figure>
<p>Streamæ‰€æœ‰æ•°æ®å’Œæ“ä½œè¢«ç»„åˆæˆæµç®¡é“æµç®¡é“ç»„æˆï¼š</p>
<p>â€‹    â¼€ä¸ªæ•°æ®æºï¼ˆå¯ä»¥æ˜¯â¼€ä¸ªæ•°ç»„ã€é›†åˆã€â½£æˆå™¨å‡½æ•°ã€I/Oç®¡é“ï¼‰ </p>
<p>â€‹    é›¶æˆ–å¤šä¸ªä¸­é—´æ“ä½œï¼ˆå°†â¼€ä¸ªæµå˜å½¢æˆå¦â¼€ä¸ªæµï¼‰ </p>
<p>â€‹    â¼€ä¸ªç»ˆâ½Œæ“ä½œï¼ˆäº§â½£æœ€ç»ˆç»“æœï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20251231175031198.png" alt="image-20251231175031198"></p>
<p><strong>åˆ›å»ºæµ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">of builder empty ofNullable generate concat é›†åˆ.stream</span><br></pre></td></tr></table></figure>
<p><strong>å¸¸ç”¨ä¸­é—´æ“ä½œ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">filterï¼šè¿‡æ»¤ï¼›  æŒ‘å‡ºæˆ‘ä»¬â½¤çš„å…ƒç´ </span><br><span class="line">mapï¼š æ˜ å°„ï¼š â¼€â¼€æ˜ å°„ï¼Œa å˜æˆ b</span><br><span class="line">	mapToIntã€mapToLongã€mapToDouble</span><br><span class="line">flatMapï¼šæ‰“æ•£ã€æ•£åˆ—ã€å±•å¼€ã€æ‰©ç»´ï¼šâ¼€å¯¹å¤šæ˜ å°„</span><br><span class="line">filtermapã€mapToIntã€mapToLongã€mapToDouble</span><br><span class="line">flatMapã€flatMapToIntã€flatMapToLongã€flatMapToDouble</span><br><span class="line">mapMultiã€mapMultiToIntã€mapMultiToLongã€mapMultiToDouble</span><br><span class="line">parallelã€unorderedã€onCloseã€sequential</span><br><span class="line">distinctã€sortedã€peekã€limitã€skipã€takeWhileï¼ˆå½“æ»¡è¶³æ¡ä»¶ï¼Œæ‹¿åˆ°è¿™ä¸ªå…ƒç´ ï¼Œä¸æ»¡è¶³ï¼Œç›´æ¥ç»“æŸæµæ“ä½œï¼‰ã€dropWhile</span><br></pre></td></tr></table></figure>
<p>æ¡ˆä¾‹æœ‰ä¸ªPersonç±»ï¼Œç„¶åè¿‡æ»¤å‡ºå¹´é¾„å¤§äº18çš„ï¼Œè¿™ä¸ªå°±æ˜¯åœ¨Filteré‡Œé¢è¿‡æ»¤å‡ºæœ‰ç”¨çš„Personã€‚</p>
<p>ç„¶åæƒ³è¦æ‰“å°æ¯ä¸ªäººçš„åå­—ï¼Œé‚£ä¹ˆå°±ç”¨mapï¼ŒæŠŠPersonç±»çš„æµå˜æˆåå­—æµï¼Œç‹äº”ï¼Œæå››ç­‰ã€‚</p>
<p>ç„¶åfiltermapï¼Œå°±æ˜¯æŠŠç‹äº”æ‹†æˆç‹å’Œäº”ç­‰ã€‚æ‹¿åˆ°çš„å…¶å®æ˜¯å…ƒç´ çš„æ·±æ‹·è´ã€‚</p>
<p>é¡ºåºæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ æµè¿›æ‰€æœ‰ç®¡é“å¤„ç†åï¼Œæ‰ä¼šåˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p><strong>ç»ˆæ­¢æ“ä½œ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">forEachã€forEachOrderedã€toArrayã€reduceã€collectã€toListã€</span><br><span class="line">minã€maxã€countã€anyMatchã€allMatchã€noneMatchã€findFirstã€findAnyã€iterator</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 1ã€è°ƒå‡ºæœ€å¤§å¶æ•°</span></span><br><span class="line">        List&lt;Integer&gt; integers = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// for å¾ªç¯ï¼ŒæŒ¨ä¸ªéå†æ‰¾åˆ°å¶æ•°ï¼Œtemp = i ,ä¸‹æ¬¡æ‰¾åˆ°å¶æ•°å’Œä¸´æ—¶å˜é‡æ¯”è¾ƒ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Integer integer : integers) &#123;</span><br><span class="line">            <span class="keyword">if</span> (integer % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                max = Math.max(max, integer);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å¤§å¶æ•°&quot;</span> + max);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æµç‰¹æ€§ï¼šæµæ˜¯lazyï¼Œä¸ç”¨æ–¹æ³•å°±ä¸ä¼šè¢«è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2ã€ä½¿ç”¨StreamAPI</span></span><br><span class="line">        <span class="comment">//1)æŠŠæ•°æ®å°è£…æˆæµï¼Œè¦åˆ°æ•°æ®æµï¼Œé›†åˆç±».stream</span></span><br><span class="line">        <span class="comment">//2ï¼‰å®šä¹‰æµå¼æ“ä½œ</span></span><br><span class="line">        <span class="comment">//3ï¼‰è·å–æœ€ç»ˆç»“æœ</span></span><br><span class="line">        integers.stream()</span><br><span class="line">            .filter(element -&gt; &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ­£åœ¨filter&quot;</span> + element);<span class="comment">//è¿‡æ»¤å‡ºæˆ‘ä»¬æƒ³è¦çš„å€¼ï¼Œå¦‚æœæ–­è¨€è¿”å›trueï¼Œå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„</span></span><br><span class="line">                <span class="keyword">return</span> element % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">            &#125;)</span><br><span class="line">            .max(Integer::compareTo)</span><br><span class="line">            .ifPresent(System.out::println);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å£°æ˜å¼ï¼šåŸºäºäº‹ä»¶æœºåˆ¶çš„å›è°ƒ</p>
<p>å›è°ƒï¼šç¨‹åºå‘˜ä¸æ˜¯è‡ªå·±è°ƒç”¨ï¼Œè€Œæ˜¯JVMå½“å‘ç”Ÿè¿™ä¸ªæ—¶é—´ç³»ç»Ÿè°ƒç”¨</p>
<h3 id="1ã€Reactoræ ¸å¿ƒ"><a href="#1ã€Reactoræ ¸å¿ƒ" class="headerlink" title="1ã€Reactoræ ¸å¿ƒ"></a>1ã€Reactoræ ¸å¿ƒ</h3><h4 id="1ã€Reactor-Stream"><a href="#1ã€Reactor-Stream" class="headerlink" title="1ã€Reactor-Stream"></a>1ã€Reactor-Stream</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Reactive Streamsæ˜¯JVMé¢å‘æµçš„åº“çš„ æ ‡å‡†å’Œè§„èŒƒ</span><br><span class="line">1ã€å¤„ç†å¯èƒ½æ— é™æ•°é‡çš„å…ƒç´ </span><br><span class="line">2ã€æœ‰åº</span><br><span class="line">3ã€åœ¨ç»„ä»¶ä¹‹é—´å¼‚æ­¥ä¼ é€’å…ƒç´ </span><br><span class="line">4ã€å¼ºåˆ¶æ€§ éé˜»å¡ èƒŒå‹æ¨¡å¼ï¼ˆæµæœ‰å‘å¸ƒè€…ï¼Œè®¢é˜…è€…ï¼‰</span><br><span class="line">æ­£å‹ï¼šæ­£å‘å‹åŠ›ï¼Œæ•°æ®çš„ç”Ÿäº§è€…ç»™æ¶ˆè´¹è€…å‹åŠ›ï¼Œç”Ÿäº§äº†1000wè¯·æ±‚ï¼Œæ¶ˆè´¹è€…è¢«å‹å®</span><br><span class="line">èƒŒå‹ï¼šåŠ äº†ä¸€ä¸ªé˜Ÿåˆ—ç¼“å†²ï¼Œæ¶ˆè´¹è€…æ ¹æ®è‡ªå·±çš„èƒ½åŠ›é€ä¸ªå¤„ç†ï¼Œç”Ÿäº§è€…å‹åŠ›</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101145150829.png" alt="image-20260101145150829"></p>
<p><strong>çº¿ç¨‹æ˜¯è¶Šå¤šå¥½è¿˜æ˜¯è¶Šå°‘å¥½ï¼Ÿ</strong></p>
<p>ç°åœ¨æœ‰4æ ¸çš„CPUï¼Œç°åœ¨æœ‰100ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆç°åœ¨æ¯ä¸ªæ ¸å¿ƒéƒ½æœ‰25ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å°±è¦åˆ‡æ¢ï¼Œåˆ‡æ¢ä¿ç•™ç°åœºï¼ˆæµªè´¹å†…å­˜ï¼Œæµªè´¹æ—¶é—´ï¼‰ï¼Œè¶Šå¤šçš„çº¿ç¨‹åªä¼šäº§ç”Ÿæ¿€çƒˆç«äº‰ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101145351532.png" alt="image-20260101145351532"></p>
<p>ç°åœ¨åªæœ‰å››ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯éƒ½å¾ˆå¿™ï¼Œè€Œä¸æ˜¯è®©å¤§é‡çš„çº¿ç¨‹ä¸€ç›´åˆ‡æ¢ã€‚</p>
<p>ç°åœ¨Tomcatå­¦èªæ˜äº†ï¼Œé‡Œé¢ä¸“é—¨æœ‰ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥ç›‘å¬çš„ç›‘å¬8080ï¼Œç„¶åæ¯ä¸€ä¸ªè¯·æ±‚æ¥äº†éƒ½æ”¾åœ¨ç¼“å†²åŒºï¼Œå­¦äº†Nettyï¼Œè¿™ä¸ªç›‘å¬çš„å…¶å®æ˜¯bossçº¿ç¨‹ï¼Œç„¶ååé¢æœ‰å‡ ä¸ªæ ¸å¿ƒæœ‰å‡ ä¸ªworkerçº¿ç¨‹ï¼Œç„¶ååœ¨ç¼“å†²åŒºæ‹¿çº¿ç¨‹ï¼Œä½†æ˜¯æ‹¿åˆ°äº†æ•°æ®1ç„¶åå†å»æ•°æ®åº“è¿œç¨‹è°ƒç”¨ï¼Œå¦‚æœå¤±è´¥äº†å°±é˜»å¡äº†ï¼Œæ‰€ä»¥è°ƒç”¨æ•°æ®åº“ä¹Ÿæœ‰ç¼“å†²åŒºï¼Œè¿œç¨‹è°ƒç”¨è‚¯å®šæ˜¯TCPï¼Œåªè¦æ•°æ®åˆ°è¾¾åè‡ªåŠ¨æ”¾åˆ°ç¼“å†²åŒºï¼Œworkeré—²äº†å°±å»ç¼“å†²åŒºæ‹¿æ•°æ®ç»§ç»­å¤„ç†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101150311773.png" alt="image-20260101150311773"></p>
<p>Kafkaã€MQèƒ½æ„å»ºå‡ºå¤§å‹åˆ†å¸ƒå¼å“åº”ç³»ç»Ÿã€‚</p>
<p>ç¼ºæœ¬åœ°åŒ–çš„æ¶ˆæ¯ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚</p>
<p>1ã€è®©æ‰€æœ‰çš„å¼‚æ­¥çº¿ç¨‹èƒ½äº’ç›¸ç›‘å¬æ¶ˆæ¯ï¼Œå¤„ç†æ¶ˆæ¯ï¼Œ æ„å»ºå®æ—¶æ¶ˆæ¯å¤„ç†æµã€‚</p>
<p>é‚£ä¹ˆJavaå°±æä¾›äº†Reactive Stream</p>
<p>ç„¶ååœ¨JAVA 9ä¹‹ååœ¨ <code>java.util.concurrent</code>åŒ…é‡Œé¢æ·»åŠ äº†ä¸ªFlowç±»ï¼Œé‡Œé¢å°±æä¾›äº†è¿™ä¸ªæ–¹æ¡ˆã€‚</p>
<p>ä»¥å‰æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ï¼šå…¨è‡ªå®šä¹‰</p>
<p>ç°åœ¨æ˜¯å“åº”å¼ç¼–ç¨‹/å£°æ˜å¼ç¼–ç¨‹ï¼šå£°æ˜æµã€è¯´æ¸…æ¥šè¦å¹²ä»€ä¹ˆã€æœ€ç»ˆç»“æœæ˜¯è¦æ€ä¹ˆæ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">API ç»„ä»¶ï¼š</span><br><span class="line">1ã€Publisherï¼šå‘å¸ƒè€…ï¼šäº§ç”Ÿæ•°æ®æµ</span><br><span class="line">2ã€Subscriberï¼šè®¢é˜…è€…ï¼šæ¶ˆè´¹æ•°æ®æµ</span><br><span class="line">3ã€Subscriptionï¼šè®¢é˜…å…³ç³»</span><br><span class="line">	è®¢é˜…å…³ç³»æ˜¯å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´çš„å…³é”®æ¥å£ã€‚è®¢é˜…è€…é€šè¿‡è®¢é˜…æ¥è¡¨ç¤ºå¯¹å‘å¸ƒè€…äº§ç”Ÿçš„æ•°æ®çš„å…´è¶£ã€‚è®¢é˜…è€…å¯ä»¥è¯·æ±‚ä¸€å®šæ•°é‡çš„å…ƒç´ ï¼Œä¹Ÿå¯ä»¥å–æ¶ˆè®¢é˜…ã€‚</span><br><span class="line">4ã€Processorï¼šå¤„ç†å™¨</span><br><span class="line">	å¤„ç†å™¨æ˜¯åŒäº‹å®ç°äº†å‘å¸ƒè€…å’Œè®¢é˜…è€…æ¥å£çš„ç»„ä»¶ã€‚ä»–å¯ä»¥æ¥å—ä¸€ä¸ªæ¥è‡ªä¸€ä¸ªå‘å¸ƒè€…çš„æ•°æ®ï¼Œè¿›è¡Œå¤„ç†ï¼Œå¹¶å°†ç»“æœå‘å¸ƒç»™ä¸‹ä¸€ä¸ªè®¢é˜…è€…ã€‚å¤„ç†å™¨åœ¨Reactorä¸­å……å½“ä¸­é—´ç¯èŠ‚ï¼Œä»£è¡¨ä¸€ä¸ªå¤„ç†é˜¶æ®µï¼Œå…è®¸ä½ åœ¨æ•°æ®æµä¸­è¿›è¡Œè½¬æ¢ã€è¿‡æ»¤å’Œå…¶ä»–æ“ä½œã€‚</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101154740981.png" alt="image-20260101154740981"></p>
<p><strong>æ¡ˆä¾‹ä¸€ï¼šå‘å¸ƒè€…+è®¢é˜…è€…</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101171612898.png" alt="image-20260101171612898"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlowDemo</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€ å®šä¹‰ä¸€ä¸ªå‘å¸ƒè€…ï¼Œå‘å¸ƒæ•°æ®</span></span><br><span class="line">        SubmissionPublisher&lt;String&gt; publisher = <span class="keyword">new</span> <span class="title class_">SubmissionPublisher</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å®šä¹‰ä¸€ä¸ªè®¢é˜…è€…ï¼Œè®¢é˜…è€…æ„Ÿå…´è¶£å‘å¸ƒè€…çš„æ•°æ®</span></span><br><span class="line">        <span class="comment">// å®šä¹‰è®¢é˜…è€…éœ€è¦å®ç°å››ä¸ªæ–¹æ³•</span></span><br><span class="line">        Flow.Subscriber&lt;String&gt; subscriber = <span class="keyword">new</span> <span class="title class_">Flow</span>.Subscriber&lt;&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> Flow.Subscription subscription;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨è®¢é˜…æ—¶ on<span class="doctag">XXX:</span>åœ¨xxxæ—¶é—´å‘ç”Ÿæ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªå›è°ƒ</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSubscribe</span><span class="params">(Flow.Subscription subscription)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…å¼€å§‹äº†&quot;</span> + subscription);</span><br><span class="line">                <span class="built_in">this</span>.subscription = subscription;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//ä»ä¸Šæ¸¸è¯·æ±‚ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">                subscription.request(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨ä¸‹ä¸€ä¸ªå…ƒç´ åˆ°è¾¾æ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªå›è°ƒï¼Œ æ¥æ”¶åˆ°æ–°æ•°æ®</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onNext</span><span class="params">(String item)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°æ•°æ®&quot;</span> + item);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//ä»ä¸Šæ¸¸è¯·æ±‚ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">                subscription.request(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨é”™è¯¯å‘ç”Ÿæ—¶</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°é”™è¯¯&quot;</span> + throwable);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨å®Œæˆæ—¶</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°å®Œæˆä¿¡å·&quot;</span> );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3ã€ç»‘å®šå‘å¸ƒè€…å’Œè®¢é˜…è€…,è¦å…ˆç»‘å®šå†å‘æ•°æ®</span></span><br><span class="line">        publisher.subscribe(subscriber);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            publisher.submit(<span class="string">&quot;p-&quot;</span> + i);</span><br><span class="line">            <span class="comment">// publisherå‘å¸ƒçš„æ•°æ®åœ¨ä»–çš„bufferåŒº</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//jvmåº•å±‚å¯¹äºæ•´ä¸ªå‘å¸ƒè®¢é˜…å…³ç³»åšå¥½äº† å¼‚æ­¥+ç¼“å­˜åŒºå¤„ç† = å“åº”å¼ç³»ç»Ÿ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        publisher.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘å¸ƒè€…æœ‰æ•°æ®ï¼Œè®¢é˜…è€…å°±ä¼šæ‹¿åˆ°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Thread.sleep(<span class="number">20000</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ¡ˆä¾‹äºŒï¼šå‘å¸ƒè€…+è®¢é˜…è€…+Processor</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101173857931.png" alt="image-20260101173857931"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlowDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸­é—´æ“ä½œå¤„ç†å™¨,ç°åœ¨æˆ‘ä»¬ç»§æ‰¿äº†å‘å¸ƒè€…ï¼Œæ‰€ä»¥å‘å¸ƒè€…çš„æ¥å£å°±ä¸ç”¨å†™äº†ï¼Œåªç”¨å†™è®¢é˜…è€…</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyProcessor</span> <span class="keyword">extends</span> <span class="title class_">SubmissionPublisher</span>&lt;String&gt;  <span class="keyword">implements</span> <span class="title class_">Flow</span>.Processor&lt;String, String&gt;&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Flow.Subscription subscription;<span class="comment">//ä¿å­˜ç»‘å®šå…³ç³»</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSubscribe</span><span class="params">(Flow.Subscription subscription)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;processorè®¢é˜…ç»‘å®šå®Œæˆ&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.subscription = subscription;</span><br><span class="line">            subscription.request(<span class="number">1</span>);<span class="comment">//æ‰¾ä¸Šæ¸¸ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span> <span class="comment">//æ•°æ®åˆ°è¾¾ï¼Œè§¦å‘onNext</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onNext</span><span class="params">(String item)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;processoræ‹¿åˆ°æ•°æ®&quot;</span> + item);</span><br><span class="line">            <span class="comment">//å†åŠ å·¥</span></span><br><span class="line">            item += <span class="string">&quot;å“ˆå“ˆ&quot;</span>;</span><br><span class="line">            submit(item);</span><br><span class="line">            subscription.request(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€ å®šä¹‰ä¸€ä¸ªå‘å¸ƒè€…ï¼Œå‘å¸ƒæ•°æ®</span></span><br><span class="line">        SubmissionPublisher&lt;String&gt; publisher = <span class="keyword">new</span> <span class="title class_">SubmissionPublisher</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´æ“ä½œ</span></span><br><span class="line">        <span class="type">MyProcessor</span> <span class="variable">processor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyProcessor</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å®šä¹‰ä¸€ä¸ªè®¢é˜…è€…ï¼Œè®¢é˜…è€…æ„Ÿå…´è¶£å‘å¸ƒè€…çš„æ•°æ®</span></span><br><span class="line">        <span class="comment">// å®šä¹‰è®¢é˜…è€…éœ€è¦å®ç°å››ä¸ªæ–¹æ³•</span></span><br><span class="line">        Flow.Subscriber&lt;String&gt; subscriber = <span class="keyword">new</span> <span class="title class_">Flow</span>.Subscriber&lt;&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> Flow.Subscription subscription;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨è®¢é˜…æ—¶ on<span class="doctag">XXX:</span>åœ¨xxxæ—¶é—´å‘ç”Ÿæ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªå›è°ƒ</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSubscribe</span><span class="params">(Flow.Subscription subscription)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…å¼€å§‹äº†&quot;</span> + subscription);</span><br><span class="line">                <span class="built_in">this</span>.subscription = subscription;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//ä»ä¸Šæ¸¸è¯·æ±‚ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">                subscription.request(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨ä¸‹ä¸€ä¸ªå…ƒç´ åˆ°è¾¾æ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªå›è°ƒï¼Œ æ¥æ”¶åˆ°æ–°æ•°æ®</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onNext</span><span class="params">(String item)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°æ•°æ®&quot;</span> + item);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//ä»ä¸Šæ¸¸è¯·æ±‚ä¸€ä¸ªæ•°æ®</span></span><br><span class="line">                subscription.request(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨é”™è¯¯å‘ç”Ÿæ—¶</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onError</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°é”™è¯¯&quot;</span> + throwable);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span><span class="comment">// åœ¨å®Œæˆæ—¶</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot;è®¢é˜…è€…ï¼Œæ¥æ”¶åˆ°å®Œæˆä¿¡å·&quot;</span> );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3ã€ç»‘å®šå‘å¸ƒè€…å’Œè®¢é˜…è€…,è¦å…ˆç»‘å®šå†å‘æ•°æ®</span></span><br><span class="line">        publisher.subscribe(processor);</span><br><span class="line">        processor.subscribe(subscriber);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            publisher.submit(<span class="string">&quot;p-&quot;</span> + i);</span><br><span class="line">            <span class="comment">// publisherå‘å¸ƒçš„æ•°æ®åœ¨ä»–çš„bufferåŒº</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//jvmåº•å±‚å¯¹äºæ•´ä¸ªå‘å¸ƒè®¢é˜…å…³ç³»åšå¥½äº† å¼‚æ­¥+ç¼“å­˜åŒºå¤„ç† = å“åº”å¼ç³»ç»Ÿ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        publisher.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘å¸ƒè€…æœ‰æ•°æ®ï¼Œè®¢é˜…è€…å°±ä¼šæ‹¿åˆ°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Thread.sleep(<span class="number">20000</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>å“åº”å¼ç¼–ç¨‹æ˜¯ä¸æ˜¯åªæ˜¯å¼‚æ­¥å›è°ƒä½†æ˜¯æµæ•°æ®æ˜¯æœ‰é¡ºåº</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å“åº”å¼ç¼–ç¨‹ï¼š</span><br><span class="line">1ã€åº•å±‚ï¼šåŸºäºæ•°æ®ç¼“å†²é˜Ÿåˆ— + æ¶ˆæ¯é©±åŠ¨æ¨¡å‹ + å¼‚æ­¥å›è°ƒæœºåˆ¶</span><br><span class="line">2ã€ç¼–ç ï¼šæµå¼ç¼–ç¨‹ + é“¾å¼è°ƒç”¨ + å£°æ˜å¼API</span><br><span class="line">3ã€æ•ˆæœï¼šä¼˜é›…å…¨ä¸€éƒ¨ + æ¶ˆæ¯å®æ—¶å¤„ç† + é«˜ååé‡ + å ç”¨å°‘é‡èµ„æº</span><br><span class="line">åº•å±‚å¸®ä½ æ­å»ºå¥½äº†ï¼Œç°åœ¨åªç”¨ç†è§£æ€æƒ³å°±èƒ½å®ç°å¼‚æ­¥</span><br></pre></td></tr></table></figure>
<p><strong>ä¸‡ç‰©çš†æ•°æ®</strong></p>
<p><strong>é«˜å¹¶å‘æœ‰ä¸‰å®ï¼šç¼“å­˜ã€å¼‚æ­¥ã€é˜Ÿæ’å¥½</strong>ã€‚ä»¥å‰å…¨æ˜¯æ‰‹åŠ¨æ§åˆ¶ï¼Œç¨‹åºå‘˜æ°´å¹³ä¸é«˜å¾ˆéš¾å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿï¼Œä½†æ˜¯åé¢å“åº”å¼ç¼–ç¨‹å¤©ç”Ÿé«˜å¹¶å‘ï¼Œä¸éœ€è¦ä½ è€ƒè™‘ç¼“å­˜ã€å¼‚æ­¥ã€é˜Ÿæ’å¥½ï¼Œåªéœ€è¦å…³æ³¨å¦‚ä½•</p>
<p><strong>é«˜å¯ç”¨æœ‰ä¸‰å®ï¼šåˆ†ç‰‡ã€å¤åˆ¶ã€é€‰é¢†å¯¼ã€‚</strong></p>
<p>ä¸‡ç‰©çš†æ•°æ®ï¼Œé‚£ä¹ˆå°±æœ‰ä¸¤ç§ï¼šå•ä¸ªå’Œå¤šä¸ªã€‚å•ä¸ªå°±æ˜¯Mono[0 | 1]ï¼Œå¤šä¸ªå°±æ˜¯Flux</p>
<p>éé˜»å¡çš„åŸç†å°±æ˜¯ç¼“å­˜ï¼ˆç”¨æ¥è°ƒé€Ÿçš„ï¼‰+å›è°ƒ</p>
<p>å°‘é‡çº¿ç¨‹ä¸€ç›´è¿è¡Œ ã€‹ å¤§é‡çº¿ç¨‹åˆ‡æ¢ç­‰å¾…ã€‚</p>
<p><strong>å•ä¸ªå°±æ˜¯Mono[0 | 1]ï¼Œå¤šä¸ªå°±æ˜¯Fluxï¼Œé€šè¿‡è¿™ä¸¤ä¸ªå®šä¹‰å“åº”å¼æ•°æ®æµï¼Œä¹Ÿå°±æ˜¯æ•°æ®ã€‚</strong></p>
<h4 id="2ã€Reactor"><a href="#2ã€Reactor" class="headerlink" title="2ã€Reactor"></a>2ã€Reactor</h4><p>è¦å­¦å¥½å“åº”å¼ç¼–ç¨‹ï¼Œå…ˆå­¦å¥½ä¸¤ä¸ªä¸œè¥¿ï¼Œä¸€ä¸ªå«Fluxï¼Œä¸€ä¸ªå«Monoã€‚ç„¶åè®¤æ¸…æ¥šä¸€ä¸ªå›¾ï¼Œå¼¹ç å›¾</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260101221354662.png" alt="image-20260101221354662"></p>
<p>æœ‰ä¸€ä¸ªfluxï¼Œç„¶åå‘é€äº†ä¸‰ä¸ªå…ƒç´ ï¼Œç„¶åè¿½åŠ ä¸€ç³»åˆ—æ“ä½œç¬¦ï¼Œç„¶åå˜æˆä¸€ä¸ªæ–°æµã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæµæ•°æ®ï¼ŒåŒ…å«å…ƒç´  + ç»“æŸä¿¡å·ï¼Œç°åœ¨å¼€å§‹ä½“éªŒå¦‚ä½•å†™ã€‚</p>
<h5 id="1ã€å¯¼å…¥ä¾èµ–"><a href="#1ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¼•å…¥ Reactor BOMï¼Œç»Ÿä¸€ç®¡ç† Reactor ç›¸å…³ç»„ä»¶ç‰ˆæœ¬ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-bom<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2022.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- æ³¨æ„ï¼š2.0.3.RELEASE æ˜¯æ—§ç‰ˆï¼Œå·²åºŸå¼ƒ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä½¿ç”¨ reactor-coreï¼Œç‰ˆæœ¬ç”± BOM è‡ªåŠ¨ç®¡ç† --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¦‚æœéœ€è¦æµ‹è¯•æ”¯æŒ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="2ã€å“åº”å¼å…¥é—¨ï¼ŒåŸºç¡€API"><a href="#2ã€å“åº”å¼å…¥é—¨ï¼ŒåŸºç¡€API" class="headerlink" title="2ã€å“åº”å¼å…¥é—¨ï¼ŒåŸºç¡€API"></a>2ã€å“åº”å¼å…¥é—¨ï¼ŒåŸºç¡€API</h5><p><strong>ä¸‹é¢æµ‹è¯•ä¸€ä¸‹FluxåŸºç¡€ç”¨æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// Mono 0|1ä¸ªå…ƒç´ çš„æµ</span></span><br><span class="line">        <span class="comment">// Fluxï¼š Nä¸ªå…ƒç´ çš„æµ</span></span><br><span class="line">        <span class="comment">// å‘å¸ƒè€…å‘å¸ƒæ•°æ®æµï¼šæºå¤´</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€å¤šå…ƒç´ çš„æµ</span></span><br><span class="line">        Flux&lt;Integer&gt; just = Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æµä¸æ¶ˆè´¹å°±æ²¡ç”¨: æ¶ˆè´¹ï¼šè®¢é˜…</span></span><br><span class="line">        just.subscribe(e -&gt; System.out.println(<span class="string">&quot;e1 = &quot;</span> + e));</span><br><span class="line">        <span class="comment">// ä¸€ä¸ªæ•°æ®æµå¯ä»¥æœ‰å¾ˆå¤šæ¶ˆè´¹è€…</span></span><br><span class="line">        just.subscribe(e -&gt; System.out.println(<span class="string">&quot;e2 = &quot;</span> + e));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹äºæ¯ä¸ªæ¶ˆè´¹è€…æ¥è¯´æµéƒ½æ˜¯ä¸€æ ·çš„ï¼šå¹¿æ’­æ¨¡å¼</span></span><br><span class="line">        <span class="comment">//å¤šä¸ªæ¶ˆè´¹æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å†…å—ï¼Ÿä¸‹é¢è¿™ä¸ªä¾‹å­å°±è¯´æ˜ï¼Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œå› ä¸ºæ˜¯æ¯ç§’äº§ç”Ÿä¸€ä¸ªæ•°æ®ï¼Œç„¶åæ‰“å°æ•°æ®ï¼Œè€Œä¸æ˜¯äº§ç”Ÿå®Œç„¶åè¯»å–ã€‚</span></span><br><span class="line">        System.out.println(<span class="string">&quot;===========&quot;</span>);</span><br><span class="line">        Flux&lt;Long&gt; flux = Flux.interval(Duration.ofSeconds(<span class="number">1</span>));<span class="comment">// æ¯ç§’äº§ç”Ÿä¸€ä¸ªä»0å¼€å§‹çš„é€’å¢æ•°æ®</span></span><br><span class="line">        flux.subscribe(System.out::println);<span class="comment">//æ‰“å°æ•°å­—</span></span><br><span class="line"></span><br><span class="line">        System.in.read();<span class="comment">//è¿™ä¸ªæ˜¯è®©ä¸»çº¿ç¨‹ä¸ç»“æŸï¼ŒçŸ¥é“åœ¨æ§åˆ¶å°è¾“å…¥äº†ä¸€ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸‹é¢æµ‹è¯•ä¸€ä¸‹MonoåŸºç¡€ç”¨æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxDemo</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//Mono åªæœ‰ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="comment">//Flux æœ‰å¾ˆå¤šå…ƒç´ </span></span><br><span class="line">        Mono&lt;String&gt; just = Mono.just(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        just.subscribe(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/image-20260102025519781.png" alt="image-20260102025519781"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxDemo</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// Mono åªæœ‰ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="comment">// Flux æœ‰å¾ˆå¤šå…ƒç´ </span></span><br><span class="line">        Mono&lt;String&gt; just = Mono.just(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        just.subscribe(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç©ºæµ</span></span><br><span class="line">        Flux&lt;Object&gt; empty = Flux.empty();<span class="comment">// æœ‰ä¸€ä¸ªä¿¡å·ï¼šæ­¤æ—¶ä»£è¡¨å®Œæˆä¿¡å·</span></span><br><span class="line">        empty.subscribe(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å›å¿†ä¸Šé¢æ¶ˆè´¹è€…æœ‰å››ä¸ªæ“ä½œï¼ŒonNextï¼ŒonComplete,onErrorï¼ŒonSub</span></span><br><span class="line">        Flux&lt;Object&gt; empty2 = Flux.empty()</span><br><span class="line">            .doOnComplete(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æµç»“æŸäº†&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        empty2.subscribe(System.out::println);</span><br><span class="line">        <span class="comment">//è¿™ä¸ªdoOnXxxæ˜¯äº‹ä»¶æ„ŸçŸ¥APIï¼Œå½“æµå‘ç”Ÿä»€ä¹ˆäº‹çš„æ—¶å€™ï¼Œè§¦å‘ä¸€ä¸ªå›è°ƒï¼Œç³»ç»Ÿè°ƒç”¨æå‰å®šä¹‰å¥½çš„é’©å­</span></span><br><span class="line">        <span class="comment">//Hooké’©å­å‡½æ•°ï¼šdoOnXxx</span></span><br><span class="line">        <span class="comment">//doOnComplete æµæ­£å¸¸ç»“æŸ</span></span><br><span class="line">        <span class="comment">//doOnCancel æµè¢«å–æ¶ˆå</span></span><br><span class="line"></span><br><span class="line">        System.in.read();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>å°æ€»ç»“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">doOnXxx APIè§¦å‘æ—¶æœº</span><br><span class="line">	doOnNext:æ¯ä¸ªå…ƒç´ ï¼ˆæµçš„æ•°æ®ï¼‰åˆ°çš„æ—¶å€™è§¦å‘</span><br><span class="line">	doOnEachï¼šæ¯ä¸ªæ•°æ®ï¼ˆæ•°æ®+ä¿¡å·ï¼‰åˆ°è¾¾çš„æ—¶å€™è§¦å‘</span><br><span class="line">	doOnRequest:æ¶ˆè´¹è€…è¯·æ±‚æµæ•°æ®çš„æ—¶å€™</span><br><span class="line">	doOnErrorï¼šæµå‘ç”Ÿé”™è¯¯</span><br><span class="line">	doOnSubscribe:æµè¢«è®¢é˜…çš„æ—¶å€™</span><br><span class="line">	doOnTerminateï¼šå‘é€å–æ¶ˆ/å¼‚å¸¸ä¿¡å·ä¸­æ–­äº†æµ</span><br><span class="line">	doOnCancleï¼šæµè¢«å–æ¶ˆ</span><br><span class="line">	doOnDiscard:æµä¸­å…ƒç´ è¢«å¿½ç•¥çš„æ—¶å€™</span><br><span class="line"></span><br><span class="line">çœ‹æ‡‚æ–‡æ¡£çš„å¼¹ç å›¾å³å¯ï¼Œä¿¡å·æœ‰ä¸¤ç§ æ­£å¸¸/å¼‚å¸¸ å…·ä½“çš„æœ‰å¾ˆå¤š</span><br><span class="line">é¦–å…ˆåˆ›å»ºæµç”¨FLUXæˆ–è€…Monoï¼Œflux.justï¼Œæˆ–è€…å…¶ä»–ã€‚</span><br><span class="line">ç„¶ååœ¨æµé‡Œé¢åˆ©ç”¨APIï¼Œè¿›è¡Œæµå¼æ“ä½œï¼Œ .doOnXxxè¿›è¡Œæµå¼æ“ä½œç„¶åè¿™äº›åº•å±‚æ˜¯å¼‚æ­¥å¹¶ä¸”æ— é˜»å¡çš„ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºçš„ï¼Œç„¶åæ¥å—å¯¹è±¡å°±æ˜¯æ¶ˆè´¹è€…ï¼Œåœ¨æœŸé—´æ²¡æœ‰subscribeä¹‹å‰éƒ½æ˜¯æµï¼Œæœ€åéœ€è¦subscibeæ¥è¿›è¡Œæ¶ˆè´¹ã€‚æœŸé—´å¯ä»¥åˆ©ç”¨å‡½æ•°å¼æ¥å£ï¼Œè¿›è¡Œæµå¼æ“ä½œã€‚</span><br></pre></td></tr></table></figure>
<h5 id="3ã€subscribe"><a href="#3ã€subscribe" class="headerlink" title="3ã€subscribe"></a>3ã€subscribe</h5><p>è®¢é˜…æµï¼Œæµæ²¡è®¢é˜…ä¹‹å‰ä»€ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªmainæ–¹æ³•ï¼Œç¨‹åºçš„å…¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Flux&lt;String&gt; flux = Flux.range(<span class="number">1</span>, <span class="number">10</span>).map(i -&gt; <span class="string">&quot;å“ˆå“ˆï¼š&quot;</span> + i);</span><br><span class="line">        flux.subscribe(); <span class="comment">// æµè¢«è®¢é˜…ï¼ŒæµåŠ¨èµ·æ¥äº†ï¼Œé»˜è®¤è®¢é˜…ï¼Œæ²¡æœ‰è®¢é˜…è€…ï¼Œfluxæ˜¯å‘å¸ƒè€…ï¼Œç„¶åsubscribeå¯ä»¥ä¼ æ¶ˆè´¹è€…</span></span><br><span class="line">        flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;v:&quot;</span> + v));<span class="comment">//åªæ¶ˆè´¹æ­£å¸¸å…ƒç´ </span></span><br><span class="line">        flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;v:&quot;</span> + v),throwable -&gt;</span><br><span class="line">            System.out.println(<span class="string">&quot;throwable:&quot;</span> + throwable));<span class="comment">//ç¬¬ä¸€ä¸ªæ­£å¸¸æ¶ˆè´¹è€…ï¼Œç¬¬äºŒä¸ªæ˜¯å¼‚å¸¸æ¶ˆè´¹è€…ï¼Œç”¨æ¥æ¶ˆè´¹å¼‚å¸¸</span></span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰ä¸ªæ˜¯æ„ŸçŸ¥æ­£å¸¸ç»“æŸ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//onXxxï¼šå‘ç”Ÿè¿™ä¸ªæ—¶é—´åæ‰§è¡Œä¸€ä¸ªåŠ¨ä½œï¼Œå¯ä»¥æ”¹å˜å…ƒç´ ï¼Œä¿¡å·</span></span><br><span class="line">        <span class="comment">//doOnXxxï¼šå‘ç”Ÿè¿™ä¸ªæ—¶é—´çš„æ—¶å€™äº§ç”Ÿä¸€ä¸ªå›è°ƒï¼Œé€šçŸ¥ä½ ï¼ˆä¸èƒ½æ”¹å˜ï¼‰</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰æ¶ˆè´¹è€…</span></span><br><span class="line">        flux.subscribe(<span class="keyword">new</span> <span class="title class_">BaseSubscriber</span>&lt;String&gt;()&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç”Ÿå‘½å‘¨æœŸé’©å­1ï¼šè®¢é˜…å…³ç³»ç»‘å®šçš„æ—¶å€™è§¦å‘</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnSubscribe</span><span class="params">(Subscription subscription)</span> &#123;</span><br><span class="line">                subscription = subscription;</span><br><span class="line">                <span class="comment">//æµè¢«è®¢é˜…çš„æ—¶å€™è§¦å‘ï¼Œé’©å­å‡½æ•°</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç»‘å®šäº†&quot;</span>+subscription);</span><br><span class="line">                <span class="comment">//æ‰¾å‘å¸ƒè€…è¦æ•°æ®</span></span><br><span class="line">                request(<span class="number">1</span>);</span><br><span class="line">                <span class="comment">//requestUnbounded();//è¦æ— çº¿æ•°æ®</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnNext</span><span class="params">(String value)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ•°æ®åˆ°è¾¾ï¼Œæ­£åœ¨å¤„ç†&quot;</span>+value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnComplete</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµæ­£å¸¸ç»“æŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnError</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµå¼‚å¸¸&quot;</span>+throwable);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnCancel</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµè¢«å–æ¶ˆ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookFinally</span><span class="params">(SignalType type)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æœ€ç»ˆå›è°ƒ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="4ã€æµçš„å–æ¶ˆ"><a href="#4ã€æµçš„å–æ¶ˆ" class="headerlink" title="4ã€æµçš„å–æ¶ˆ"></a>4ã€æµçš„å–æ¶ˆ</h5><blockquote>
<p>æ¶ˆè´¹è€…è°ƒç”¨cancle() å–æ¶ˆæµçš„è®¢é˜…</p>
<p>Disposableæ¥å£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hookOnNext</span><span class="params">(String value)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ•°æ®åˆ°è¾¾ï¼Œæ­£åœ¨å¤„ç†ï¼š&quot;</span>+value);</span><br><span class="line">    <span class="keyword">if</span>(value.equals(<span class="string">&quot;å“ˆå“ˆï¼š5&quot;</span>))&#123;</span><br><span class="line">        cancel(); <span class="comment">//å–æ¶ˆæµ                </span></span><br><span class="line">    &#125;</span><br><span class="line">     request(<span class="number">1</span>); <span class="comment">//è¦1ä¸ªæ•°æ®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="5ã€èƒŒå‹ï¼ˆBackpressure-ï¼‰å’Œè¯·æ±‚é‡å¡‘ï¼ˆReshape-Requestsï¼‰"><a href="#5ã€èƒŒå‹ï¼ˆBackpressure-ï¼‰å’Œè¯·æ±‚é‡å¡‘ï¼ˆReshape-Requestsï¼‰" class="headerlink" title="5ã€èƒŒå‹ï¼ˆBackpressure ï¼‰å’Œè¯·æ±‚é‡å¡‘ï¼ˆReshape Requestsï¼‰"></a>5ã€èƒŒå‹ï¼ˆBackpressure ï¼‰å’Œè¯·æ±‚é‡å¡‘ï¼ˆReshape Requestsï¼‰</h5><h6 id="1ã€buffer-ç¼“å†²"><a href="#1ã€buffer-ç¼“å†²" class="headerlink" title="1ã€buffer:ç¼“å†²"></a>1ã€buffer:ç¼“å†²</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;List&lt;Integer&gt;&gt; flux = Flux.range(<span class="number">1</span>, <span class="number">10</span>)  <span class="comment">//åŸå§‹æµ10ä¸ª</span></span><br><span class="line">	.buffer(<span class="number">3</span>)</span><br><span class="line">	.log();<span class="comment">//ç¼“å†²åŒºï¼šç¼“å†²3ä¸ªå…ƒç´ : æ¶ˆè´¹â¼€æ¬¡æœ€å¤šå¯ä»¥æ‹¿åˆ°ä¸‰ä¸ªå…ƒç´ ï¼›å‡‘æ»¡æ•°æ‰¹é‡å‘ç»™æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment">//â¼€æ¬¡å‘â¼€ä¸ªï¼Œâ¼€ä¸ªâ¼€ä¸ªå‘ï¼›</span></span><br><span class="line"><span class="comment">// 10å…ƒç´ ï¼Œbuffer(3)ï¼›æ¶ˆè´¹è€…è¯·æ±‚4æ¬¡ï¼Œæ•°æ®æ¶ˆè´¹å®Œæˆ</span></span><br></pre></td></tr></table></figure>
<h6 id="2ã€limitï¼šé™æµ"><a href="#2ã€limitï¼šé™æµ" class="headerlink" title="2ã€limitï¼šé™æµ"></a>2ã€limitï¼šé™æµ</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">	.log()<span class="comment">//é™æµè§¦å‘ï¼Œçœ‹ä¸Šæ¸¸æ˜¯æ€ä¹ˆé™æµè·å–æ•°æ®çš„</span></span><br><span class="line">	.limitRate(<span class="number">100</span>) <span class="comment">//â¼€æ¬¡é¢„å–30ä¸ªå…ƒç´ ï¼›ç¬¬â¼€æ¬¡request(100)ï¼Œä»¥årequest(75)75%ç­–ç•¥ï¼Œæ¶ˆè´¹åˆ°25çš„æ—¶å€™ï¼Œè¯·æ±‚75.</span></span><br><span class="line">	.subscribe();</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>limitRate(n)</code>ï¼šæ§åˆ¶ä¸‹æ¸¸å‘ä¸Šæ¸¸â€œè¦æ•°æ®çš„é€Ÿåº¦â€ï¼ˆèƒŒå‹é™æµï¼‰</strong></li>
<li><strong><code>buffer(n)</code>ï¼šæŠŠä¸Šæ¸¸çš„æ•°æ®â€œæ”’æˆä¸€æ‰¹â€å†å‘ç»™ä¸‹æ¸¸ï¼ˆæ•°æ®èšåˆï¼‰</strong></li>
</ul>
<h5 id="6ã€ç¼–ç¨‹æ–¹å¼åˆ›å»ºåºåˆ—Sink"><a href="#6ã€ç¼–ç¨‹æ–¹å¼åˆ›å»ºåºåˆ—Sink" class="headerlink" title="6ã€ç¼–ç¨‹æ–¹å¼åˆ›å»ºåºåˆ—Sink"></a>6ã€ç¼–ç¨‹æ–¹å¼åˆ›å»ºåºåˆ—Sink</h5><blockquote>
<p>Sink.next   æ¥æ”¶å™¨æˆ–è€…æ°´æ§½ï¼Œé€šé“</p>
<p>Sink.complete </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒæ­¥ç¯å¢ƒ-gennerate</span></span><br><span class="line"><span class="comment">//å¤šçº¿ç¨‹-create</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxGenerateAndMultiThreadDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæ­¥ç¯å¢ƒ - generate ç”Ÿæˆæ•°æ®æµ</span></span><br><span class="line"><span class="comment">     * ç‰¹ç‚¹ï¼šå•çº¿ç¨‹ã€åŒæ­¥æ‰§è¡Œã€æŒ‰éœ€ç”Ÿæˆã€æ¯æ¬¡åªèƒ½ç”Ÿæˆä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Flux.generateï¼šåŒæ­¥ç”Ÿæˆæ•°æ®æµçš„æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">        Flux&lt;String&gt; stringFlux = Flux.generate(</span><br><span class="line">                <span class="comment">// 1. çŠ¶æ€åˆå§‹åŒ–ï¼ˆå¯é€‰å‚æ•°ï¼Œæ­¤å¤„ä»¥&quot;è®¡æ•°å™¨&quot;ä¸ºä¾‹ï¼Œè®°å½•ç”Ÿæˆå…ƒç´ çš„åºå·ï¼‰</span></span><br><span class="line">                () -&gt; <span class="number">0</span>, <span class="comment">// åˆå§‹åŒ–çŠ¶æ€ï¼šè®¡æ•°å™¨ä»0å¼€å§‹</span></span><br><span class="line">                <span class="comment">// 2. ç”Ÿæˆé€»è¾‘ï¼š(å½“å‰çŠ¶æ€, åŒæ­¥Sink) -&gt; æ–°çŠ¶æ€</span></span><br><span class="line">                (counter, sink) -&gt; &#123;</span><br><span class="line">                    <span class="comment">// sink.next()ï¼šä¼ é€’å•ä¸ªæ•°æ®ï¼ˆåŒæ­¥ç¯å¢ƒä¸‹ï¼Œæ¯æ¬¡åªèƒ½è°ƒç”¨1æ¬¡ï¼Œå¤šæ¬¡è°ƒç”¨ä¼šæŠ¥é”™ï¼‰</span></span><br><span class="line">                    <span class="comment">// æ­¤å¤„æ‹¼æ¥è®¡æ•°å™¨ï¼Œæ¼”ç¤ºæŒ‰éœ€ç”Ÿæˆæœ‰åºæ•°æ®</span></span><br><span class="line">                    sink.next(<span class="string">&quot;å“ˆå“ˆ&quot;</span> + counter); <span class="comment">// ä¼ é€’æ•°æ®ï¼Œæ¯æ¬¡ä»…èƒ½ç”Ÿæˆä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 3. ç»ˆæ­¢æ¡ä»¶ï¼šå½“è®¡æ•°å™¨è¾¾åˆ°4æ—¶ï¼Œè°ƒç”¨sink.complete()ç»“æŸæ•°æ®æµ</span></span><br><span class="line">                    <span class="keyword">if</span> (counter &gt;= <span class="number">4</span>) &#123;</span><br><span class="line">                        sink.complete(); <span class="comment">// æ ‡è®°æ•°æ®æµç»“æŸï¼Œä¸å†ç”Ÿæˆæ–°å…ƒç´ </span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 4. æ›´æ–°çŠ¶æ€ï¼šè®¡æ•°å™¨+1ï¼Œä½œä¸ºä¸‹ä¸€æ¬¡ç”Ÿæˆçš„åˆå§‹çŠ¶æ€</span></span><br><span class="line">                    <span class="keyword">return</span> counter + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¢é˜…æ•°æ®æµï¼ˆè§¦å‘ç”Ÿæˆé€»è¾‘ï¼Œå› ä¸ºFluxæ˜¯å†·æ•°æ®æµï¼Œè®¢é˜…æ‰ä¼šæ‰§è¡Œï¼‰</span></span><br><span class="line">        stringFlux.subscribe(</span><br><span class="line">                <span class="comment">// æ¶ˆè´¹æ­£å¸¸å…ƒç´ </span></span><br><span class="line">                data -&gt; System.out.println(<span class="string">&quot;ã€åŒæ­¥generateã€‘æ¶ˆè´¹æ•°æ®ï¼š&quot;</span> + data + <span class="string">&quot;ï¼Œå½“å‰çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName()),</span><br><span class="line">                <span class="comment">// æ¶ˆè´¹å¼‚å¸¸ï¼ˆæ­¤å¤„æ— å¼‚å¸¸ï¼Œä»…åšæ¼”ç¤ºï¼‰</span></span><br><span class="line">                error -&gt; System.err.println(<span class="string">&quot;ã€åŒæ­¥generateã€‘å‘ç”Ÿå¼‚å¸¸ï¼š&quot;</span> + error.getMessage()),</span><br><span class="line">                <span class="comment">// æ•°æ®æµç»“æŸå›è°ƒ</span></span><br><span class="line">                () -&gt; System.out.println(<span class="string">&quot;ã€åŒæ­¥generateã€‘æ•°æ®æµæ¶ˆè´¹å®Œæ¯•\n&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç‰¹ç‚¹ï¼šæ¶ˆè´¹é©±åŠ¨ç”Ÿäº§ï¼Œé€ä¸ªç”Ÿäº§ã€é€ä¸ªæ¶ˆè´¹ï¼ŒåŒæ­¥ä¸²è¡Œï¼Œäº’ç›¸é˜»å¡ã€‚</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mainçº¿ç¨‹ï¼ˆå•çº¿ç¨‹ï¼‰ï¼š</span></span><br><span class="line"><span class="comment">æ¶ˆè´¹è€…è¯·æ±‚æ•°æ® â†’ generateç”Ÿäº§1æ¡ï¼ˆå“ˆå“ˆ0ï¼‰â†’ æ¨é€æ¶ˆè´¹è€… â†’ æ¶ˆè´¹è€…æ¶ˆè´¹å“ˆå“ˆ0 â†’ </span></span><br><span class="line"><span class="comment">æ¶ˆè´¹è€…å†è¯·æ±‚æ•°æ® â†’ generateç”Ÿäº§1æ¡ï¼ˆå“ˆå“ˆ1ï¼‰â†’ æ¨é€æ¶ˆè´¹è€… â†’ æ¶ˆè´¹è€…æ¶ˆè´¹å“ˆå“ˆ1 â†’ </span></span><br><span class="line"><span class="comment">... é‡å¤ç›´åˆ°è®¡æ•°å™¨â‰¥4 â†’ æ•°æ®æµç»“æŸ</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FluxCreateEnhancedAsyncDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// ==================== 1. æ„å»ºå¼‚æ­¥æ•°æ®æµï¼ˆæ ¸å¿ƒå¢å¼ºï¼šçº¿ç¨‹åˆ†ç¦»ï¼‰ ====================</span></span><br><span class="line">        Flux&lt;String&gt; enhancedAsyncFlux = Flux.create(</span><br><span class="line">                <span class="comment">// Sinkï¼šæ•°æ®æ¨é€è½½ä½“ï¼Œæ”¯æŒå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çµæ´»æ¨é€</span></span><br><span class="line">                (Sink&lt;String&gt; sink) -&gt; &#123;</span><br><span class="line">                    <span class="comment">// â‘  ç”Ÿäº§è€…è¿è¡Œåœ¨ç‹¬ç«‹çº¿ç¨‹ï¼ˆæ‰‹åŠ¨åˆ›å»ºå¼‚æ­¥çº¿ç¨‹ï¼Œæ¨¡æ‹ŸIO/å¼‚æ­¥ä»»åŠ¡ï¼‰</span></span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="comment">// æ¨¡æ‹Ÿä¸šåŠ¡æ•°æ®ç”Ÿæˆï¼ˆå¦‚è¯»å–æ–‡ä»¶ã€è°ƒç”¨è¿œç¨‹æ¥å£ï¼‰</span></span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">                                <span class="comment">// æ¨¡æ‹Ÿå¼‚æ­¥è€—æ—¶æ“ä½œï¼ˆæ¯æ¬¡ç”Ÿæˆæ•°æ®è€—æ—¶300msï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ï¼‰</span></span><br><span class="line">                                Thread.sleep(<span class="number">300</span>);</span><br><span class="line"></span><br><span class="line">                                <span class="comment">// æ˜¾å¼ä¸šåŠ¡æ¡ä»¶ï¼šåªæ¨é€å¶æ•°ç´¢å¼•çš„æ•°æ®ï¼ˆè¿‡æ»¤å¥‡æ•°ç´¢å¼•ï¼‰</span></span><br><span class="line">                                <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                                    <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;å¼‚æ­¥ç”Ÿäº§çš„ç¬¬ &quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot; æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰&quot;</span>;</span><br><span class="line">                                    <span class="comment">// ä¸»åŠ¨æ¨é€æ•°æ®ï¼ˆå¯å¤šæ¬¡è°ƒç”¨ï¼Œæ— æ¬¡æ•°é™åˆ¶ï¼‰</span></span><br><span class="line">                                    sink.next(data);</span><br><span class="line">                                    <span class="comment">// æ‰“å°ç”Ÿäº§è€…æ—¥å¿—ï¼Œæ ‡è®°å½“å‰çº¿ç¨‹</span></span><br><span class="line">                                    System.out.println(<span class="string">&quot;ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®ï¼š&quot;</span> + data + <span class="string">&quot; | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    System.out.println(<span class="string">&quot;ã€ç”Ÿäº§è€…ã€‘ä¸æ»¡è¶³æ¡ä»¶ï¼Œè·³è¿‡ç¬¬ &quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot; æ¡æ•°æ®ï¼ˆå¥‡æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="comment">// æ‰€æœ‰æ•°æ®æ¨é€å®Œæˆåï¼Œæ ‡è®°æ•°æ®æµç»“æŸ</span></span><br><span class="line">                            sink.complete();</span><br><span class="line">                            System.out.println(<span class="string">&quot;ã€ç”Ÿäº§è€…ã€‘æ‰€æœ‰æ•°æ®æ¨é€å®Œæ¯• | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line"></span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            <span class="comment">// å¼‚å¸¸æ—¶æ¨é€é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">                            sink.error(e);</span><br><span class="line">                            System.err.println(<span class="string">&quot;ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®å¼‚å¸¸ï¼š&quot;</span> + e.getMessage() + <span class="string">&quot; | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;, <span class="string">&quot;ç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹&quot;</span>).start(); <span class="comment">// ç»™å¼‚æ­¥çº¿ç¨‹å‘½åï¼Œä¾¿äºè§‚å¯Ÿ</span></span><br><span class="line">                &#125;</span><br><span class="line">        )</span><br><span class="line">        <span class="comment">// â‘¡ æŒ‡å®šæ¶ˆè´¹è€…è¿è¡Œçš„çº¿ç¨‹æ± ï¼ˆä¸ç”Ÿäº§è€…çº¿ç¨‹åˆ†ç¦»ï¼‰</span></span><br><span class="line">        .publishOn(Schedulers.boundedElastic())</span><br><span class="line">        <span class="comment">// â‘¢ æŒ‡å®šç”Ÿäº§è€…ï¼ˆFlux.createå†…éƒ¨é€»è¾‘ï¼‰çš„çº¿ç¨‹æ± ï¼ˆä¹Ÿå¯æ›¿ä»£æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼ŒäºŒé€‰ä¸€å³å¯ï¼‰</span></span><br><span class="line">        <span class="comment">// .subscribeOn(Schedulers.io()) </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ==================== 2. æ•°æ®é¢„å¤„ç†ï¼ˆå¯é€‰ï¼Œæ¼”ç¤ºæ¶ˆè´¹è€…çº¿ç¨‹å†…çš„å¤„ç†ï¼‰ ====================</span></span><br><span class="line">        .map(data -&gt; data + <span class="string">&quot; - æ¶ˆè´¹è€…é¢„å¤„ç†å®Œæˆ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ==================== 3. è®¢é˜…æ¶ˆè´¹æ•°æ®æµï¼ˆä¸»çº¿ç¨‹ä»…è´Ÿè´£è®¢é˜…ï¼Œä¸é˜»å¡ï¼‰ ====================</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ã€ä¸»çº¿ç¨‹ã€‘å¼€å§‹è®¢é˜…æ•°æ®æµï¼Œä¸é˜»å¡åç»­é€»è¾‘æ‰§è¡Œ&quot;</span>);</span><br><span class="line">        enhancedAsyncFlux.subscribe(</span><br><span class="line">                <span class="comment">// æ¶ˆè´¹æ­£å¸¸æ•°æ®ï¼ˆæ¥ä¸€ä¸ªæ¶ˆè´¹ä¸€ä¸ªï¼‰</span></span><br><span class="line">                data -&gt; System.out.println(<span class="string">&quot;ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¹¶æ¶ˆè´¹æ•°æ®ï¼š&quot;</span> + data + <span class="string">&quot; | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName()),</span><br><span class="line">                <span class="comment">// æ¶ˆè´¹å¼‚å¸¸æ•°æ®</span></span><br><span class="line">                error -&gt; System.err.println(<span class="string">&quot;ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¼‚å¸¸ï¼š&quot;</span> + error.getMessage() + <span class="string">&quot; | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName()),</span><br><span class="line">                <span class="comment">// æ•°æ®æµç»“æŸå›è°ƒ</span></span><br><span class="line">                () -&gt; System.out.println(<span class="string">&quot;ã€æ¶ˆè´¹è€…ã€‘æ‰€æœ‰æ•°æ®æ¶ˆè´¹å®Œæ¯• | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName())</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ==================== 4. ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–é€»è¾‘ï¼ˆä½“ç°éé˜»å¡ç‰¹æ€§ï¼‰ ====================</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ã€ä¸»çº¿ç¨‹ã€‘è®¢é˜…åç«‹å³æ‰§è¡Œå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€ç­‰å¾…ç”Ÿäº§è€…/æ¶ˆè´¹è€…å®Œæˆ&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;ã€ä¸»çº¿ç¨‹ã€‘æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼š&quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot; | çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸»çº¿ç¨‹ä¼‘çœ 3ç§’ï¼Œç¡®ä¿å¼‚æ­¥çº¿ç¨‹ï¼ˆç”Ÿäº§è€…/æ¶ˆè´¹è€…ï¼‰æ‰§è¡Œå®Œæˆï¼ˆä»…ä¸ºè§‚å¯Ÿæ—¥å¿—ï¼Œå®é™…ä¸šåŠ¡æ— éœ€æ­¤ä¼‘çœ ï¼‰</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ã€ä¸»çº¿ç¨‹ã€‘å¼€å§‹è®¢é˜…æ•°æ®æµï¼Œä¸é˜»å¡åç»­é€»è¾‘æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">ã€ä¸»çº¿ç¨‹ã€‘è®¢é˜…åç«‹å³æ‰§è¡Œå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€ç­‰å¾…ç”Ÿäº§è€…/æ¶ˆè´¹è€…å®Œæˆ</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘ä¸æ»¡è¶³æ¡ä»¶ï¼Œè·³è¿‡ç¬¬ 2 æ¡æ•°æ®ï¼ˆå¥‡æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 1 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¹¶æ¶ˆè´¹æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 1 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ - æ¶ˆè´¹è€…é¢„å¤„ç†å®Œæˆ | çº¿ç¨‹ï¼šboundedElastic-1</span></span><br><span class="line"><span class="comment">ã€ä¸»çº¿ç¨‹ã€‘æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼š1 | çº¿ç¨‹ï¼šmain</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 3 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘ä¸æ»¡è¶³æ¡ä»¶ï¼Œè·³è¿‡ç¬¬ 4 æ¡æ•°æ®ï¼ˆå¥‡æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¹¶æ¶ˆè´¹æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 3 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ - æ¶ˆè´¹è€…é¢„å¤„ç†å®Œæˆ | çº¿ç¨‹ï¼šboundedElastic-1</span></span><br><span class="line"><span class="comment">ã€ä¸»çº¿ç¨‹ã€‘æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼š2 | çº¿ç¨‹ï¼šmain</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 5 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘ä¸æ»¡è¶³æ¡ä»¶ï¼Œè·³è¿‡ç¬¬ 6 æ¡æ•°æ®ï¼ˆå¥‡æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¹¶æ¶ˆè´¹æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 5 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ - æ¶ˆè´¹è€…é¢„å¤„ç†å®Œæˆ | çº¿ç¨‹ï¼šboundedElastic-1</span></span><br><span class="line"><span class="comment">ã€ä¸»çº¿ç¨‹ã€‘æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼š3 | çº¿ç¨‹ï¼šmain</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘æ¨é€æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 7 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘ä¸æ»¡è¶³æ¡ä»¶ï¼Œè·³è¿‡ç¬¬ 8 æ¡æ•°æ®ï¼ˆå¥‡æ•°ç´¢å¼•ï¼‰ | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¥æ”¶å¹¶æ¶ˆè´¹æ•°æ®ï¼šå¼‚æ­¥ç”Ÿäº§çš„ç¬¬ 7 æ¡æ•°æ®ï¼ˆå¶æ•°ç´¢å¼•ï¼‰ - æ¶ˆè´¹è€…é¢„å¤„ç†å®Œæˆ | çº¿ç¨‹ï¼šboundedElastic-1</span></span><br><span class="line"><span class="comment">ã€ç”Ÿäº§è€…ã€‘æ‰€æœ‰æ•°æ®æ¨é€å®Œæ¯• | çº¿ç¨‹ï¼šç”Ÿäº§è€…-å¼‚æ­¥çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ‰€æœ‰æ•°æ®æ¶ˆè´¹å®Œæ¯• | çº¿ç¨‹ï¼šboundedElastic-1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><strong>å°æ€»ç»“</strong></p>
<p>åŒæ­¥generateå’Œå¼‚æ­¥createçš„åŒºåˆ«</p>
<p>åŒæ­¥æ˜¯æŒ‰é¡ºåºæ‰§è¡Œæœ‰ä¸ªåˆå§‹åŒ–çŠ¶æ€ï¼Œå½“å‰çŠ¶æ€å’ŒåŒæ­¥æµç¨‹sinkæ¥ç»´æŠ¤é¡ºåº</p>
<p>å¼‚æ­¥å°±æ˜¯æ²¡æœ‰äº†å†…ç½®çš„åˆå§‹çŠ¶æ€å’Œå½“å‰çŠ¶æ€ï¼Œå½“ç„¶å¦‚æœæƒ³è¦çº¿ç¨‹å®‰å…¨éœ€è¦æ‰‹åŠ¨ç»´æŠ¤çŠ¶æ€ï¼Œä½†æ˜¯éœ€è¦å®šä¹‰å›è°ƒå‡½æ•°æ¡ä»¶è®¾ç½®ï¼Œå¦‚æœæ»¡è¶³äº†æŸä¸ªæ¡ä»¶å°±ä¼šç”±ç³»ç»Ÿä¸»åŠ¨æ¨é€ï¼Œä»¥åŠç”¨sinkæ¥å®šä¹‰å¤„ç†æµç¨‹å³å¯ã€‚</p>
<h5 id="7ã€handle"><a href="#7ã€handle" class="headerlink" title="7ã€handle()"></a>7ã€handle()</h5><blockquote>
<p>â¾ƒ å®šä¹‰æµä¸­å…ƒç´ å¤„ç†è§„åˆ™</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">	.handle((value,sink)-&gt;&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;æ‹¿åˆ°çš„å€¼ï¼š&quot;</span>+value);</span><br><span class="line">		sink.next(<span class="string">&quot;å¼ ä¸‰ï¼š&quot;</span>+value); <span class="comment">//å¯ä»¥å‘ä¸‹å‘é€æ•°æ®çš„é€šé“</span></span><br><span class="line">	&#125;)</span><br><span class="line">	.log() <span class="comment">//â½‡å¿—</span></span><br><span class="line">	.subscribe();</span><br></pre></td></tr></table></figure>
<h5 id="8ã€è‡ªå®šä¹‰çº¿ç¨‹è°ƒåº¦"><a href="#8ã€è‡ªå®šä¹‰çº¿ç¨‹è°ƒåº¦" class="headerlink" title="8ã€è‡ªå®šä¹‰çº¿ç¨‹è°ƒåº¦"></a>8ã€è‡ªå®šä¹‰çº¿ç¨‹è°ƒåº¦</h5><blockquote>
<p>å“åº”å¼ï¼šå“åº”å¼ç¼–ç¨‹ï¼šå…¨å¼‚æ­¥ã€æ¶ˆæ¯ã€äº‹ä»¶å›è°ƒ</p>
<p>é»˜è®¤è¿˜æ˜¯ç”¨å½“å‰çº¿ç¨‹ï¼Œç”Ÿæˆæ•´ä¸ªæµï¼Œå‘å¸ƒæµï¼Œæµæ“ä½œ</p>
</blockquote>
<p>è°ƒåº¦å™¨å…¶å®å°±æ˜¯çº¿ç¨‹æ± ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReactorPublishOnDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¡ˆä¾‹æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">thread1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå¹¶è¡Œçº¿ç¨‹æ± ï¼šåç§°ä¸ºparallel-schedulerï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°4</span></span><br><span class="line">        <span class="type">Schedulers</span> <span class="variable">s</span> <span class="operator">=</span> Schedulers.newParallel(<span class="string">&quot;parallel-scheduler&quot;</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. æ„å»ºFluxæ•°æ®æµï¼ŒåŒ…å«ä¸¤æ¬¡mapè½¬æ¢ + publishOnçº¿ç¨‹åˆ‡æ¢ + logæ—¥å¿—ï¼ˆä¾¿äºè§‚å¯Ÿçº¿ç¨‹ï¼‰</span></span><br><span class="line">        <span class="keyword">final</span> Flux&lt;String&gt; flux = Flux</span><br><span class="line">                .range(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// ç”Ÿæˆä¸¤ä¸ªå…ƒç´ ï¼š1ã€2</span></span><br><span class="line">                .map(i -&gt; &#123;</span><br><span class="line">                    <span class="comment">// ç¬¬ä¸€ä¸ªmapï¼š10 + å…ƒç´ å€¼ï¼ˆæ‰“å°å½“å‰çº¿ç¨‹ï¼Œä¾¿äºè§‚å¯Ÿï¼‰</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;ã€ç¬¬ä¸€ä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š&quot;</span> + i + <span class="string">&quot;ï¼Œå½“å‰çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">10</span> + i; <span class="comment">// 1â†’11ï¼Œ2â†’12</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .log() <span class="comment">// æ‰“å°æ•°æ®æµæ‰§è¡Œæ—¥å¿—ï¼Œè¾…åŠ©è§‚å¯Ÿçº¿ç¨‹å˜åŒ–</span></span><br><span class="line">                .publishOn(s) <span class="comment">// å…³é”®ï¼šåˆ‡æ¢åç»­æ“ä½œçš„æ‰§è¡Œçº¿ç¨‹æ± ä¸ºs</span></span><br><span class="line">                .map(i -&gt; &#123;</span><br><span class="line">                    <span class="comment">// ç¬¬äºŒä¸ªmapï¼šæ‹¼æ¥å­—ç¬¦ä¸²ï¼ˆæ‰“å°å½“å‰çº¿ç¨‹ï¼Œä¾¿äºè§‚å¯Ÿï¼‰</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;ã€ç¬¬äºŒä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š&quot;</span> + i + <span class="string">&quot;ï¼Œå½“å‰çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;value &quot;</span> + i; <span class="comment">// 11â†’&quot;value 11&quot;ï¼Œ12â†’&quot;value 12&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. æ–°å»ºä¸€ä¸ªåŒ¿åçº¿ç¨‹ï¼Œåœ¨è¯¥çº¿ç¨‹ä¸­æ‰§è¡Œè®¢é˜…åŠ¨ä½œï¼ˆè®¢é˜…è€…è¿è¡Œåœ¨åŒ¿åçº¿ç¨‹ï¼‰</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ã€è®¢é˜…åŠ¨ä½œã€‘æ‰§è¡Œè®¢é˜…çš„çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">            <span class="comment">// è®¢é˜…æ•°æ®æµï¼Œæ¶ˆè´¹æ•°æ®å¹¶æ‰“å°</span></span><br><span class="line">            flux.subscribe(data -&gt; System.out.println(<span class="string">&quot;ã€æ¶ˆè´¹è€…ã€‘æ¶ˆè´¹æ•°æ®ï¼š&quot;</span> + data + <span class="string">&quot;ï¼Œå½“å‰çº¿ç¨‹ï¼š&quot;</span> + Thread.currentThread().getName()));</span><br><span class="line">        &#125;, <span class="string">&quot;è‡ªå®šä¹‰è®¢é˜…çº¿ç¨‹&quot;</span>).start(); <span class="comment">// ç»™åŒ¿åçº¿ç¨‹å‘½åï¼Œæ›´æ˜“è§‚å¯Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸»æ–¹æ³•ï¼šæ‰§è¡Œæµ‹è¯•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ReactorPublishOnDemo</span> <span class="variable">demo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReactorPublishOnDemo</span>();</span><br><span class="line">        demo.thread1();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸»çº¿ç¨‹ä¼‘çœ 2ç§’ï¼Œç¡®ä¿å¼‚æ­¥çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œèƒ½çœ‹åˆ°å®Œæ•´æ—¥å¿—</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ã€è®¢é˜…åŠ¨ä½œã€‘æ‰§è¡Œè®¢é˜…çš„çº¿ç¨‹ï¼šè‡ªå®šä¹‰è®¢é˜…çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç¬¬ä¸€ä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š1ï¼Œå½“å‰çº¿ç¨‹ï¼šè‡ªå®šä¹‰è®¢é˜…çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç¬¬ä¸€ä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š2ï¼Œå½“å‰çº¿ç¨‹ï¼šè‡ªå®šä¹‰è®¢é˜…çº¿ç¨‹</span></span><br><span class="line"><span class="comment">ã€ç¬¬äºŒä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š11ï¼Œå½“å‰çº¿ç¨‹ï¼šparallel-scheduler-1</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¶ˆè´¹æ•°æ®ï¼švalue 11ï¼Œå½“å‰çº¿ç¨‹ï¼šparallel-scheduler-1</span></span><br><span class="line"><span class="comment">ã€ç¬¬äºŒä¸ªmapã€‘å¤„ç†å…ƒç´ ï¼š12ï¼Œå½“å‰çº¿ç¨‹ï¼šparallel-scheduler-1</span></span><br><span class="line"><span class="comment">ã€æ¶ˆè´¹è€…ã€‘æ¶ˆè´¹æ•°æ®ï¼švalue 12ï¼Œå½“å‰çº¿ç¨‹ï¼šparallel-scheduler-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//publishOnæ”¹å˜å‘å¸ƒè€…æ‰€åœ¨çº¿ç¨‹æ± </span></span><br><span class="line"><span class="comment">//subscribeOnæ”¹å˜è®¢é˜…è€…æ‰€åœ¨çº¿ç¨‹æ± </span></span><br><span class="line"><span class="comment">//åªè¦ä¸æŒ‡å®šçº¿ç¨‹ï¼Œé»˜è®¤å‘å¸ƒè€…çš„çº¿ç¨‹å°±æ˜¯è®¢é˜…è€…çš„çº¿ç¨‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">thread1</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">Scheduler</span> <span class="variable">s</span> <span class="operator">=</span> Schedulers.newParallel(<span class="string">&quot;parallel-scheduler&quot;</span>, <span class="number">4</span>);</span><br><span class="line">		<span class="keyword">final</span> Flux&lt;String&gt; flux = Flux</span><br><span class="line">			.range(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">			.map(i -&gt; <span class="number">10</span> + i)</span><br><span class="line">			.log()</span><br><span class="line">			.publishOn(s)</span><br><span class="line">			.map(i -&gt; <span class="string">&quot;value &quot;</span> + i);</span><br><span class="line">	<span class="comment">//åªè¦ä¸æŒ‡å®šçº¿ç¨‹æ± ï¼Œé»˜è®¤å‘å¸ƒè€…â½¤çš„çº¿ç¨‹å°±æ˜¯è®¢é˜…è€…çš„çº¿ç¨‹ï¼›</span></span><br><span class="line">	<span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; flux.subscribe(System.out::println)).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="9ã€é”™è¯¯å¤„ç†"><a href="#9ã€é”™è¯¯å¤„ç†" class="headerlink" title="9ã€é”™è¯¯å¤„ç†"></a>9ã€é”™è¯¯å¤„ç†</h5><p><strong>å‘½ä»¤å¼ç¼–ç¨‹ï¼šå¸¸è§çš„é”™è¯¯å¤„ç†æ–¹å¼</strong></p>
<h6 id="1ã€Catch-and-return-a-static-defalut-value"><a href="#1ã€Catch-and-return-a-static-defalut-value" class="headerlink" title="1ã€Catch and return a static defalut value"></a>1ã€Catch and return a static defalut value</h6><p>æ•è·å¼‚å¸¸è¿”å›ä¸€ä¸ªé™æ€é»˜è®¤å€¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> doSomethingDangerous(<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Throwable error) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;RECOVERED&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>onErrorReturn: å®ç°ä¸Šâ¾¯æ•ˆæœï¼Œé”™è¯¯çš„æ—¶å€™è¿”å›â¼€ä¸ªå€¼ </p>
<p> 1ã€åƒæ‰å¼‚å¸¸ï¼Œæ¶ˆè´¹è€…â½†å¼‚å¸¸æ„ŸçŸ¥</p>
<p> 2ã€è¿”å›â¼€ä¸ªå…œåº•é»˜è®¤å€¼ </p>
<p>3ã€æµæ­£å¸¸å®Œæˆï¼›</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">	.map(i -&gt; <span class="string">&quot;100 / &quot;</span> + i + <span class="string">&quot; = &quot;</span> + (<span class="number">100</span> / i))</span><br><span class="line">	.onErrorReturn(NullPointerException.class,<span class="string">&quot;å“ˆå“ˆ-6666&quot;</span>)</span><br><span class="line">	.subscribe(v-&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v),</span><br><span class="line">	err -&gt; System.out.println(<span class="string">&quot;err = &quot;</span> + err),</span><br><span class="line">	()-&gt; System.out.println(<span class="string">&quot;æµç»“æŸ&quot;</span>)); <span class="comment">// error handling example</span></span><br></pre></td></tr></table></figure>
<h6 id="2ã€Catch-and-execute-an-alternative-path-with-fallback-method"><a href="#2ã€Catch-and-execute-an-alternative-path-with-fallback-method" class="headerlink" title="2ã€Catch and execute an alternative path with fallback method"></a>2ã€Catch and execute an alternative path with fallback method</h6><p>åƒæ‰å¼‚å¸¸ï¼Œæ‰§â¾â¼€ä¸ªå…œåº•â½…æ³•ï¼›</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> doSomethingDangerous(<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Throwable error) &#123;</span><br><span class="line">	<span class="keyword">return</span> doOtherthing(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>onErrorResume </p>
<p>1ã€åƒæ‰å¼‚å¸¸ï¼Œæ¶ˆè´¹è€…â½†å¼‚å¸¸æ„ŸçŸ¥ </p>
<p>2ã€è°ƒâ½¤â¼€ä¸ªå…œåº•â½…æ³• </p>
<p>3ã€æµæ­£å¸¸å®Œæˆ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">	.map(i -&gt; <span class="string">&quot;100 / &quot;</span> + i + <span class="string">&quot; = &quot;</span> + (<span class="number">100</span> / i))</span><br><span class="line">    .onErrorResume(err -&gt; Mono.just(<span class="string">&quot;å“ˆå“ˆ-777&quot;</span>))</span><br><span class="line">	.subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v),</span><br><span class="line">		err -&gt; System.out.println(<span class="string">&quot;err = &quot;</span> + err),</span><br><span class="line">		() -&gt; System.out.println(<span class="string">&quot;æµç»“æŸ&quot;</span>));</span><br></pre></td></tr></table></figure>
<h6 id="3ã€Catch-and-dynamically-compute-a-fallback-value"><a href="#3ã€Catch-and-dynamically-compute-a-fallback-value" class="headerlink" title="3ã€Catch and dynamically compute a fallback value"></a>3ã€Catch and dynamically compute a fallback value</h6><p>æ•è·å¹¶åŠ¨æ€è®¡ç®—â¼€ä¸ªè¿”å›å€¼</p>
<p>æ ¹æ®é”™è¯¯è¿”å›ä¸€ä¸ªæ–°å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="type">Value</span> <span class="variable">v</span> <span class="operator">=</span> erroringMethod();</span><br><span class="line">	<span class="keyword">return</span> MyWrapper.fromValue(v);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Throwable error) &#123;</span><br><span class="line">	<span class="keyword">return</span> MyWrapper.fromError(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.onErrorResume(err -&gt; Flux.error(<span class="keyword">new</span> <span class="title class_">BusinessException</span>(err.getMessage()+<span class="string">&quot;ï¼šç‚¸äº†&quot;</span>)))</span><br><span class="line"><span class="comment">/*1ã€åƒæ‰å¼‚å¸¸ï¼Œæ¶ˆè´¹è€…æœ‰æ„ŸçŸ¥</span></span><br><span class="line"><span class="comment">2ã€è°ƒâ½¤â¼€ä¸ªâ¾ƒå®šä¹‰â½…æ³•</span></span><br><span class="line"><span class="comment">3ã€æµå¼‚å¸¸å®Œæˆ*/</span></span><br></pre></td></tr></table></figure>
<h6 id="4ã€Catchï¼Œwrap-to-a-BussinessExceptionï¼Œand-re-throw"><a href="#4ã€Catchï¼Œwrap-to-a-BussinessExceptionï¼Œand-re-throw" class="headerlink" title="4ã€Catchï¼Œwrap to a BussinessExceptionï¼Œand re-throw"></a>4ã€Catchï¼Œwrap to a BussinessExceptionï¼Œand re-throw</h6><p>æ•è·å¹¶åŒ…è£…æˆâ¼€ä¸ªä¸šåŠ¡å¼‚å¸¸ï¼Œå¹¶é‡æ–°æŠ›å‡º</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> callExternalService(k);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Throwable error) &#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;oops, SLA exceeded&quot;</span>, error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åŒ…è£…é‡æ–°æŠ›å‡ºå¼‚å¸¸:  æ¨èâ½¤  .onErrorMap </p>
<p>1ã€åƒæ‰å¼‚å¸¸ï¼Œæ¶ˆè´¹è€…æœ‰æ„ŸçŸ¥  </p>
<p>2ã€æŠ›æ–°å¼‚å¸¸ </p>
<p>3ã€æµå¼‚å¸¸å®Œæˆ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.onErrorResume(err -&gt; Flux.error(<span class="keyword">new</span> <span class="title class_">BusinessException</span>(err.getMessage()+<span class="string">&quot;ï¼šç‚¸äº†&quot;</span>)))</span><br><span class="line">	Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">		.map(i -&gt; <span class="string">&quot;100 / &quot;</span> + i + <span class="string">&quot; = &quot;</span> + (<span class="number">100</span> / i))</span><br><span class="line">		.onErrorMap(err-&gt; <span class="keyword">new</span> <span class="title class_">BusinessException</span>(err.getMessage()+<span class="string">&quot;: â¼œç‚¸äº†...&quot;</span>))</span><br><span class="line">		.subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v),</span><br><span class="line">		err -&gt; System.out.println(<span class="string">&quot;err = &quot;</span> + err),</span><br><span class="line">		() -&gt; System.out.println(<span class="string">&quot;æµç»“æŸ&quot;</span>));</span><br></pre></td></tr></table></figure>
<h6 id="5ã€Catch-log-an-error-specific-message-and-re-throw"><a href="#5ã€Catch-log-an-error-specific-message-and-re-throw" class="headerlink" title="5ã€Catch, log an error-specific message, and re-throw."></a>5ã€Catch, log an error-specific message, and re-throw.</h6><p>æ•è·å¼‚å¸¸ï¼Œè®°å½•ç‰¹æ®Šçš„é”™è¯¯â½‡å¿—ï¼Œé‡æ–°æŠ›å‡º</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> callExternalService(k);</span><br><span class="line">&#125;<span class="keyword">catch</span> (RuntimeException error) &#123;</span><br><span class="line">	<span class="comment">//make a record of the error</span></span><br><span class="line">	log(<span class="string">&quot;uh oh, falling back, service failed for key &quot;</span> + k);</span><br><span class="line">	<span class="keyword">throw</span> error;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">	.map(i -&gt; <span class="string">&quot;100 / &quot;</span> + i + <span class="string">&quot; = &quot;</span> + (<span class="number">100</span> / i))</span><br><span class="line">	.doOnError(err -&gt; &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;errå·²è¢«è®°å½• = &quot;</span> + err);</span><br><span class="line">	&#125;).subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v),</span><br><span class="line">				err -&gt; System.out.println(<span class="string">&quot;err = &quot;</span> + err),</span><br><span class="line">				() -&gt; System.out.println(<span class="string">&quot;æµç»“æŸ&quot;</span>));</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¼‚å¸¸è¢«æ•è·ã€åšâ¾ƒâ¼°çš„äº‹æƒ…</span><br><span class="line">ä¸å½±å“å¼‚å¸¸ç»§ç»­é¡ºç€æµâ½”çº¿ä¼ æ’­</span><br><span class="line">1ã€ä¸åƒæ‰å¼‚å¸¸ï¼Œåªåœ¨å¼‚å¸¸å‘â½£çš„æ—¶å€™åšâ¼€ä»¶äº‹ï¼Œæ¶ˆè´¹è€…æœ‰æ„ŸçŸ¥ </span><br></pre></td></tr></table></figure>
<h6 id="6ã€Use-the-finally-block-to-clean-up-resources-or-a-Java-7-â€œ-try-with-resourceâ€-construct"><a href="#6ã€Use-the-finally-block-to-clean-up-resources-or-a-Java-7-â€œ-try-with-resourceâ€-construct" class="headerlink" title="6ã€Use the finally block to clean up resources or a Java 7 â€œ try-with-resourceâ€ construct."></a>6ã€Use the finally block to clean up resources or a Java 7 â€œ try-with-resourceâ€ construct.</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">	.map(i -&gt; <span class="string">&quot;100 / &quot;</span> + i + <span class="string">&quot; = &quot;</span> + (<span class="number">100</span> / i))</span><br><span class="line">	.doOnError(err -&gt; &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;errå·²è¢«è®°å½•= &quot;</span> + err);</span><br><span class="line">	&#125;)</span><br><span class="line">	.doFinally(signalType -&gt; &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;æµä¿¡å·ï¼š&quot;</span>+signalType);</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<h6 id="7ã€å¿½ç•¥å½“å‰å¼‚å¸¸ï¼Œä»…é€šçŸ¥è®°å½•ï¼Œç»§ç»­æ¨è¿›"><a href="#7ã€å¿½ç•¥å½“å‰å¼‚å¸¸ï¼Œä»…é€šçŸ¥è®°å½•ï¼Œç»§ç»­æ¨è¿›" class="headerlink" title="7ã€å¿½ç•¥å½“å‰å¼‚å¸¸ï¼Œä»…é€šçŸ¥è®°å½•ï¼Œç»§ç»­æ¨è¿›"></a>7ã€å¿½ç•¥å½“å‰å¼‚å¸¸ï¼Œä»…é€šçŸ¥è®°å½•ï¼Œç»§ç»­æ¨è¿›</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Flux.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">5</span>)</span><br><span class="line">	.map(i-&gt;<span class="number">10</span>/i)</span><br><span class="line">	.onErrorContinue((err,val)-&gt;&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;err = &quot;</span> + err);</span><br><span class="line">		System.out.println(<span class="string">&quot;val = &quot;</span> + val);é—®é¢˜<span class="string">&quot;);</span></span><br><span class="line"><span class="string">		System.out.println(&quot;</span>å‘ç°<span class="string">&quot;+val+&quot;</span>æœ‰é—®é¢˜äº†ï¼Œç»§ç»­æ‰§â¾å…¶ä»–çš„ï¼Œæˆ‘ä¼šè®°å½•è¿™ä¸ª</span><br><span class="line">	&#125;) <span class="comment">//å‘â½£</span></span><br><span class="line">	.subscribe(v-&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v),</span><br><span class="line">				err-&gt; System.out.println(<span class="string">&quot;err = &quot;</span> + err));</span><br></pre></td></tr></table></figure>
<p><strong>å°æ€»ç»“</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>å‘½ä»¤å¼å†™æ³•</th>
<th>Reactor æ“ä½œç¬¦</th>
<th>æ˜¯å¦â€œåƒæ‰â€å¼‚å¸¸</th>
<th>æ¶ˆè´¹è€…æ˜¯å¦æ„ŸçŸ¥å¼‚å¸¸</th>
<th>æµæœ€ç»ˆçŠ¶æ€</th>
<th>å…¸å‹ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1. è¿”å›é™æ€é»˜è®¤å€¼</strong></td>
<td><code>catch &#123; return &quot;DEFAULT&quot;; &#125;</code></td>
<td><code>.onErrorReturn(value)</code> æˆ– <code>.onErrorReturn(Class, value)</code></td>
<td>âœ… æ˜¯</td>
<td>âŒ å¦</td>
<td><strong>æ­£å¸¸å®Œæˆ</strong></td>
<td>å¿«é€Ÿå…œåº•ï¼Œå¦‚è¿”å›ç©ºåˆ—è¡¨ã€é»˜è®¤æ–‡æ¡ˆ</td>
</tr>
<tr>
<td><strong>2. æ‰§è¡Œå…œåº•æ–¹æ³•ï¼ˆæ›¿ä»£æµï¼‰</strong></td>
<td><code>catch &#123; return fallback(); &#125;</code></td>
<td><code>.onErrorResume(err â†’ Flux/Mono.just(...))</code></td>
<td>âœ… æ˜¯</td>
<td>âŒ å¦</td>
<td><strong>æ­£å¸¸å®Œæˆ</strong></td>
<td>è°ƒç”¨å¤‡ç”¨æœåŠ¡ã€æœ¬åœ°ç¼“å­˜ã€é™çº§é€»è¾‘</td>
</tr>
<tr>
<td><strong>3. åŠ¨æ€è®¡ç®—æ–°å€¼ï¼ˆå«å¼‚å¸¸ä¿¡æ¯ï¼‰</strong></td>
<td><code>catch &#123; return Wrapper.fromError(err); &#125;</code></td>
<td><code>.onErrorResume(err â†’ Mono.just(new Wrapper(err)))</code></td>
<td>âœ… æ˜¯</td>
<td>âŒ å¦ï¼ˆé™¤éè¿”å› errorï¼‰</td>
<td><strong>æ­£å¸¸å®Œæˆ</strong></td>
<td>å°†å¼‚å¸¸å°è£…ä¸ºä¸šåŠ¡å¯¹è±¡ï¼ˆå¦‚ Result.error(err)ï¼‰</td>
</tr>
<tr>
<td><strong>4. åŒ…è£…å¹¶é‡æ–°æŠ›å‡ºå¼‚å¸¸</strong></td>
<td><code>catch &#123; throw new BizEx(&quot;msg&quot;, err); &#125;</code></td>
<td><code>.onErrorMap(err â†’ new BusinessException(...))</code></td>
<td>âŒ å¦</td>
<td>âœ… æ˜¯</td>
<td><strong>å¼‚å¸¸ç»ˆæ­¢</strong></td>
<td>ç»Ÿä¸€å¼‚å¸¸ç±»å‹ã€æ·»åŠ ä¸Šä¸‹æ–‡ã€å±è”½åº•å±‚ç»†èŠ‚</td>
</tr>
<tr>
<td><strong>5. è®°å½•æ—¥å¿—ä½†ä¸å¤„ç†å¼‚å¸¸</strong></td>
<td><code>catch &#123; log(); throw err; &#125;</code></td>
<td><code>.doOnError(err â†’ log(err))</code></td>
<td>âŒ å¦</td>
<td>âœ… æ˜¯</td>
<td><strong>å¼‚å¸¸ç»ˆæ­¢</strong></td>
<td>ç›‘æ§ã€å®¡è®¡ã€è°ƒè¯•ï¼Œä¸å½±å“å¼‚å¸¸ä¼ æ’­</td>
</tr>
<tr>
<td><strong>6. æ¸…ç†èµ„æºï¼ˆfinallyï¼‰</strong></td>
<td><code>try &#123; ... &#125; finally &#123; cleanup(); &#125;</code></td>
<td><code>.doFinally(signalType â†’ cleanup())</code></td>
<td>âŒ ä¸å¤„ç†å¼‚å¸¸</td>
<td>å–å†³äºæ˜¯å¦æœ‰å…¶ä»–å¤„ç†</td>
<td>æ­£å¸¸ or å¼‚å¸¸</td>
<td>å…³é—­è¿æ¥ã€é‡Šæ”¾é”ã€ç»Ÿè®¡è€—æ—¶</td>
</tr>
<tr>
<td><strong>7. å¿½ç•¥å½“å‰é”™è¯¯ï¼Œç»§ç»­å¤„ç†åç»­å…ƒç´ </strong></td>
<td>ï¼ˆå‘½ä»¤å¼éš¾ä»¥å®ç°ï¼‰</td>
<td><code>.onErrorContinue((err, item) â†’ &#123;...&#125;)</code></td>
<td>âœ… å±€éƒ¨åƒæ‰</td>
<td>âŒ åç»­å…ƒç´ ä»å¯å‘å‡º</td>
<td><strong>æ­£å¸¸å®Œæˆ</strong>ï¼ˆè·³è¿‡å¤±è´¥é¡¹ï¼‰</td>
<td>æ‰¹å¤„ç†ä¸­å®¹å¿ä¸ªåˆ«å¤±è´¥ï¼ˆå¦‚å¯¼å…¥1000æ¡ï¼Œ998æˆåŠŸï¼‰</td>
</tr>
</tbody>
</table>
</div>
<h5 id="10ã€å¸¸ç”¨æ“ä½œ"><a href="#10ã€å¸¸ç”¨æ“ä½œ" class="headerlink" title="10ã€å¸¸ç”¨æ“ä½œ"></a>10ã€å¸¸ç”¨æ“ä½œ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filterã€flatMapã€concatMapã€flatMapManyã€transformã€defaultIfEmptyã€switchIfEmptyã€concatã€concatWithã€mergeã€mergeWithã€mergeSequentialã€zipã€zipWith...</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å¸¸â½¤æ“ä½œ</span><br><span class="line">	é”™è¯¯å¤„ç†</span><br><span class="line">	è¶…æ—¶ä¸é‡è¯•</span><br><span class="line">	Sinksâ¼¯å…·ç±»</span><br><span class="line">		å•æ’­</span><br><span class="line">		å¤šæ’­</span><br><span class="line">		é‡æ”¾</span><br><span class="line">		èƒŒå‹</span><br><span class="line">		ç¼“å­˜</span><br><span class="line">	é˜»å¡å¼API</span><br><span class="line">		block</span><br><span class="line">	Context-APIï¼šå“åº”å¼ä¸­çš„ThreadLocal</span><br><span class="line">		ThreadLocalæœºåˆ¶å¤±æ•ˆ</span><br></pre></td></tr></table></figure>
<h6 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œç›´æ¥ä½¿ç”¨APIæ¼”ç¤ºä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment">//filterã€flatMapã€concatMapã€flatMapManyã€transformã€defaultIfEmptyã€switchIfEmptyã€concatã€concatWithã€mergeã€mergeWithã€mergeSequentialã€zipã€zipWith</span></span><br><span class="line"><span class="comment">//filter</span></span><br><span class="line">Flux.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    .log()</span><br><span class="line">    .filter(s -&gt; s%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">    .subscribe();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onSubscribe([Synchronous Fuseable] FluxArray.ArrayConditionalSubscription)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | request(unbounded)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onNext(1)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | request(1)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onNext(2)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onNext(3)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | request(1)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onNext(4)</span></span><br><span class="line"><span class="comment">[ INFO] (main) | onComplete()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ—¥å¿—è§£æ</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€è¡Œï¼šä¸‹æ¸¸Filterï¼ŒæˆåŠŸè®¢é˜…äº†ä¸Šæ¸¸Justæµ</span></span><br><span class="line"><span class="comment">ç¬¬äºŒè¡Œï¼šä¸‹æ¸¸Filterï¼Œå‘ä¸Šæ¸¸Justå‘èµ·äº† æ— ç•Œæ•°é‡ çš„æ•°æ®è¯·æ±‚ï¼ŒFilterä½œä¸ºä¸­æ¸¸å¯ä»¥æŠŠä¸‹æ¸¸subscribeè½¬å‘ç»™ä¸Šæ¸¸ã€‚</span></span><br><span class="line"><span class="comment">ç¬¬ä¸‰è¡Œï¼šJust æµå“åº” Filter æµçš„ unbounded è¯·æ±‚ï¼Œæ¨é€ç¬¬ä¸€ä¸ªå…ƒç´  1 ç»™ Filter æµã€‚onNext(X) æ˜¯ä¸Šæ¸¸å‘ä¸‹æ¸¸ä¼ é€’ã€Œæ•°æ®å…ƒç´ ã€çš„ä¿¡å·ã€‚</span></span><br><span class="line"><span class="comment">ç¬¬å››è¡Œï¼šJust æµæ¨é€çš„å…ƒç´  1ï¼Œä¸æ»¡è¶³å¶æ•°æ¡ä»¶ï¼Œå› æ­¤ Filter æµä¸ä¼šæŠŠ 1 è½¬å‘ç»™æœ€ä¸‹æ¸¸çš„ Subscribe æµï¼Œè€Œæœ€ä¸‹æ¸¸çš„ Subscribe æµéœ€è¦æ¥æ”¶æ•°æ®ï¼ŒFilter æµä¸ºäº†æ»¡è¶³ä¸‹æ¸¸çš„éœ€æ±‚ï¼Œä¼šä¸»åŠ¨å‘ä¸Šæ¸¸ Just æµè¡¥å……è¯·æ±‚ 1 ä¸ªæ•°æ®ï¼ˆå³ request(1)ï¼‰ï¼Œç»§ç»­å¯»æ‰¾æ»¡è¶³è¿‡æ»¤æ¡ä»¶çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">ç¬¬äº”è¡Œï¼šJust æµå“åº” Filter æµçš„ request(1) è¯·æ±‚ï¼Œæ¨é€ç¬¬äºŒä¸ªå…ƒç´  2 ç»™ Filter æµã€‚</span></span><br><span class="line"><span class="comment">ç¬¬å…­è¡Œï¼šJust æµåŸºäºä¹‹å‰çš„ unbounded æ— ç•Œè¯·æ±‚ï¼Œç»§ç»­æ¨é€ç¬¬ä¸‰ä¸ªå…ƒç´  3 ç»™ Filter æµï¼ˆå› ä¸ºæ— ç•Œè¯·æ±‚æ„å‘³ç€ â€œä¸€æ¬¡æ€§æ¨é€æ‰€æœ‰æ•°æ®â€ï¼Œæ‰€ä»¥ä¼šè¿ç»­æ¨é€ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">ç¬¬ä¸ƒè¡Œï¼šå’Œç¬¬å››è¡Œä¸€æ ·</span></span><br><span class="line"><span class="comment">ç¬¬å…«è¡Œï¼šJust æµå“åº” Filter æµçš„ request(1) è¯·æ±‚ï¼Œæ¨é€ç¬¬å››ä¸ªå…ƒç´  4 ç»™ Filter æµã€‚</span></span><br><span class="line"><span class="comment">ç¬¬ä¹è¡Œï¼šJust æµæ¨é€å®Œæ‰€æœ‰ 4 ä¸ªå…ƒç´ åï¼Œå‘ä¸‹æ¸¸ Filter æµä¼ é€’ã€Œæ•°æ®æµç»“æŸã€çš„ä¿¡å·ï¼Œè¡¨ç¤º â€œæˆ‘æ²¡æœ‰æ›´å¤šæ•°æ®äº†ï¼Œæ•°æ®æµç»“æŸâ€ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h6 id="filterMap"><a href="#filterMap" class="headerlink" title="filterMap"></a>filterMap</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">filterMap</span><span class="params">()</span> &#123;</span><br><span class="line">    Flux.just(<span class="string">&quot;zhang san&quot;</span>, <span class="string">&quot;li si&quot;</span>).flatMap(i -&gt; &#123;</span><br><span class="line">        String[] s = i.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Flux.fromArray(s);<span class="comment">// æŠŠæ•°æ®åŒ…è£…æˆå¤šå…ƒç´ æµ</span></span><br><span class="line">    &#125;).log().subscribe();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿™é‡Œæ‰“å°æ—¥å¿—å°±åªæœ‰ç¬¬ä¸€æ¬¡çš„æ— ç•Œæ•°æ®è¯·æ±‚ï¼Œå…¶ä»–éƒ½æ˜¯onNextäº†</span></span><br></pre></td></tr></table></figure>
<h6 id="concatMap"><a href="#concatMap" class="headerlink" title="concatMap"></a>concatMap</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">concatMap</span><span class="params">()</span> &#123;</span><br><span class="line">    Flux.just(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">        .concatMap(s -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> Flux.just(s + <span class="string">&quot;-a&quot;</span>ï¼Œ<span class="number">1</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .log()</span><br><span class="line">        .subscribe();</span><br><span class="line">    Flux.concat(Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), Flux.just(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)).log().subscribe();</span><br><span class="line">    Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).concatWith(Flux.just(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)).log().subscribe();<span class="comment">//è¿™ä¸ªè¦è·Ÿå‰ä¸€ä¸ªæµçš„ç±»å‹ä¿æŒä¸€è‡´</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">atomic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>)</span><br><span class="line">        .transform(v -&gt; &#123;</span><br><span class="line">            <span class="comment">//++atomic</span></span><br><span class="line">            <span class="keyword">if</span> (atomic.incrementAndGet() == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨</span></span><br><span class="line">                <span class="keyword">return</span> v.map(String::toUpperCase);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">//transformæ— deferï¼Œä¸ä¼šå…±äº«å¤–éƒ¨å˜é‡ï¼Œæ— çŠ¶æ€è½¬æ¢ï¼Œ</span></span><br><span class="line">    flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;è®¢é˜…è€…1ï¼šv = &quot;</span> + v));</span><br><span class="line">    flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;è®¢é˜…è€…2ï¼šv = &quot;</span> + v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¸¤ä¸ªè®¢é˜…è€…éƒ½æ˜¯A B C</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">atomic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>)</span><br><span class="line">        .transformDeferred(v -&gt; &#123;</span><br><span class="line">            <span class="comment">//++atomic</span></span><br><span class="line">            <span class="keyword">if</span> (atomic.incrementAndGet() == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨</span></span><br><span class="line">                <span class="keyword">return</span> v.map(String::toUpperCase);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">//transformæ— deferï¼Œä¸ä¼šå…±äº«å¤–éƒ¨å˜é‡ï¼Œæœ‰çŠ¶æ€è½¬æ¢</span></span><br><span class="line">    flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;è®¢é˜…è€…1ï¼šv = &quot;</span> + v));</span><br><span class="line">    flux.subscribe(v -&gt; System.out.println(<span class="string">&quot;è®¢é˜…è€…2ï¼šv = &quot;</span> + v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//transformDeferredæ˜¯æ¯ä¸ªè®¢é˜…è€…æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æœ‰å¤–éƒ¨å˜é‡æ§åˆ¶çš„æ—¶å€™æ‰§è¡Œç»“æœä¸ä¸€æ ·</span></span><br><span class="line"><span class="comment">//transformæ˜¯æ— è®ºå¤šå°‘ä¸ªè®¢é˜…è€…åªæ‰§è¡Œä¸€æ¬¡</span></span><br></pre></td></tr></table></figure>
<h6 id="empty"><a href="#empty" class="headerlink" title="empty"></a>empty</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">empty</span><span class="params">()</span>&#123;</span><br><span class="line">    haha()</span><br><span class="line">        .defaultIfEmpty(<span class="string">&quot;x&quot;</span>)<span class="comment">//å¦‚æœå‘å¸ƒè€…ä¸ºç©ºæŒ‡å®šé»˜è®¤å€¼</span></span><br><span class="line">        .subscribe(System.out::println);</span><br><span class="line">    haha()</span><br><span class="line">        .switchIfEmpty(hehe())</span><br><span class="line">        .subscribe(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line">Mono&lt;String&gt; <span class="title function_">haha</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Mono.just(<span class="string">&quot;haha&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Mono&lt;String&gt; <span class="title function_">hehe</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Mono.just(<span class="string">&quot;hehe&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mergeï¼šæŒ‰ç…§å®ç°é¡ºåºï¼Œå¢åŠ æµ</span></span><br><span class="line"><span class="comment">mergeWithï¼šåœ¨åŸæœ‰çš„æµä¸Šå¢åŠ ï¼Œä¹Ÿæ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºå¢åŠ </span></span><br><span class="line"><span class="comment">mergeSequentialï¼šæŒ‰ç…§å“ªä¸ªæµå…ˆåˆ°ï¼Œå…ˆæŠŠæµå…¨å¢åŠ äº†ï¼Œå†å¢åŠ ä¸‹ä¸€ä¸ªæµ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    Flux.merge(</span><br><span class="line">        Flux.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).delayElements(Duration.ofSeconds(<span class="number">1</span>)),</span><br><span class="line">        Flux.just(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>).delayElements(Duration.ofMillis(<span class="number">1500</span>))</span><br><span class="line">    ).log().subscribe();</span><br><span class="line">    System.in.read();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    * zipï¼šæ— æ³•ç»“å¯¹çš„å…ƒç´ ä¼šè¢«å¿½ç•¥</span></span><br><span class="line"><span class="comment">    * zipæœ€å¤šæ”¯æŒ8å…ƒç¥–</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">zip</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// Tupleï¼šå…ƒç¥–</span></span><br><span class="line">    <span class="comment">// Tuple2:&lt;Integer,String&gt;</span></span><br><span class="line"></span><br><span class="line">    Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">        .zipWith(Flux.just(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>))</span><br><span class="line">        .map(tuple -&gt; &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">t1</span> <span class="operator">=</span> tuple.getT1();</span><br><span class="line">            <span class="type">String</span> <span class="variable">t2</span> <span class="operator">=</span> tuple.getT2();</span><br><span class="line">            <span class="keyword">return</span> t1 + <span class="string">&quot;==&quot;</span> + t2;</span><br><span class="line">        &#125;).log().subscribe(v -&gt; System.out.println(<span class="string">&quot;v-&quot;</span> + v));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="11ã€sinksã€é‡è¯•ã€Contextã€é˜»å¡API"><a href="#11ã€sinksã€é‡è¯•ã€Contextã€é˜»å¡API" class="headerlink" title="11ã€sinksã€é‡è¯•ã€Contextã€é˜»å¡API"></a>11ã€sinksã€é‡è¯•ã€Contextã€é˜»å¡API</h5><p><strong>retry é‡è¯•</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">retry</span><span class="params">()</span> &#123;</span><br><span class="line">    Flux.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">        .delayElements(Duration.ofSeconds(<span class="number">3</span>))</span><br><span class="line">        .log()</span><br><span class="line">        .timeout(Duration.ofSeconds(<span class="number">2</span>))</span><br><span class="line">        .retry(<span class="number">3</span>)</span><br><span class="line">        .map(i -&gt; i+<span class="string">&quot;haha&quot;</span>)</span><br><span class="line">        .subscribe();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>sinks ç®¡é“å·¥å…·</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sinks</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, IOException &#123;</span><br><span class="line">        <span class="comment">// Flux.create(fluxSink -&gt; &#123;</span></span><br><span class="line">        <span class="comment">//     fluxSink.next(&quot;haha&quot;);</span></span><br><span class="line">        <span class="comment">// &#125;).log().subscribe();</span></span><br><span class="line">        <span class="comment">// Sinks.many();//å‘é€Fluxæ•°æ®</span></span><br><span class="line">        <span class="comment">// Sinks.one();//å‘é€Monoæ•°æ®</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// //Sinks:æ¥æ”¶å™¨ï¼Œæ•°æ®ç®¡é“ï¼Œæ‰€æœ‰æ•°æ®éƒ½é¡ºç€è¿™ä¸ªç®¡é“å¾€ä¸‹èµ°çš„ã€‚</span></span><br><span class="line">        <span class="comment">// Sinks.many().unicast();//å•æ’­ï¼Œåªèƒ½ç»‘å®šå•ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line">        <span class="comment">// Sinks.many().multicast();//å¤šæ’­ï¼Œè¿™ä¸ªç®¡é“èƒ½ç»‘å®šå¤šä¸ªè®¢é˜…è€…</span></span><br><span class="line">        <span class="comment">// Sinks.many().replay();//é‡æ”¾ï¼Œè¿™ä¸ªç®¡é“èƒ½é‡æ”¾å…ƒç´ ã€‚æ˜¯å¦ç»™åæ¥çš„è®¢é˜…è€…æŠŠä¹‹å‰çš„å…ƒç´ ä¾ç„¶å‘ç»™ä»–ã€‚</span></span><br><span class="line">        <span class="comment">// //ä»å¤´æ¶ˆè´¹è¿˜æ˜¯ä»è®¢é˜…é‚£ä¸€åˆ»æ¶ˆè´¹</span></span><br><span class="line"></span><br><span class="line">        Sinks.Many&lt;Object&gt; many = Sinks.many()</span><br><span class="line">            .unicast().onBackpressureBuffer(<span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">5</span>));<span class="comment">//èƒŒå‹é˜Ÿåˆ—</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt; <span class="number">10</span> ; i++)&#123;</span><br><span class="line">                many.tryEmitNext(<span class="string">&quot;a-&quot;</span> + i);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        many.asFlux().subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v));</span><br><span class="line"></span><br><span class="line">        System.in.read();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>cache ç¼“å­˜</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cache</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    Flux&lt;Integer&gt; cache = Flux.range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">        .delayElements(Duration.ofSeconds(<span class="number">1</span>));<span class="comment">//é»˜è®¤ä¸ç¼“å­˜ä»»ä½•æ•°æ®ï¼Œæ¯ä¸€æ¬¡æ–°çš„è®¢é˜…éƒ½æ˜¯ä¸€ä¸ªå…¨æ–°çš„æµï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šé‡æ–°å‘é€</span></span><br><span class="line">    <span class="comment">//.cache(3);//ç¼“å­˜3ä¸ªæœ€æ–°å…ƒç´ </span></span><br><span class="line">    cache.subscribe();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        cache.subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v));</span><br><span class="line">    &#125;).start();</span><br><span class="line">    System.in.read();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Context-API ä¸Šä¸‹æ–‡åˆ‡æ¢</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">parallelFlux</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Flux.range(<span class="number">1</span>, <span class="number">10000000</span>)</span><br><span class="line">            .buffer(<span class="number">100</span>)</span><br><span class="line">            .parallel(<span class="number">8</span>)</span><br><span class="line">            .runOn(Schedulers.newParallel(<span class="string">&quot;xx&quot;</span>))</span><br><span class="line">            .log()</span><br><span class="line">            .subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v));</span><br><span class="line"></span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Context-API</span></span><br><span class="line">    <span class="meta">@Test</span> <span class="comment">//ThreadLocalåœ¨å“åº”å¼ç¼–ç¨‹ä¸­æ— æ³•ä½¿ç”¨</span></span><br><span class="line">    <span class="comment">//å“åº”å¼ä¸­ï¼Œæ•°æ®æµæœŸé—´å…±äº«æ•°æ®ï¼ŒContext API ,Context è¯»å†™ï¼ŒContextView åªè¯»</span></span><br><span class="line">    <span class="comment">//ä¸­é—´æ“ä½œè¦æ”¯æŒContextï¼Œä¹Ÿå°±æ˜¯æ”¯æŒä¸Šä¸‹æ–‡åˆ‡æ¢çš„</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">threadLocal</span><span class="params">()</span> &#123;</span><br><span class="line">        Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">            .transformDeferredContextual((flux,context) -&gt;&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;flux = &quot;</span> + flux);</span><br><span class="line">                System.out.println(<span class="string">&quot;context = &quot;</span> + context);</span><br><span class="line">                <span class="keyword">return</span> flux.map(i -&gt; i+<span class="string">&quot;==&gt;&quot;</span>+context.get(<span class="string">&quot;prefix&quot;</span>));</span><br><span class="line">            &#125;)</span><br><span class="line">            .contextWrite(Context.of(<span class="string">&quot;prefix&quot;</span>,<span class="string">&quot;å“ˆå“ˆ&quot;</span>))</span><br><span class="line">            <span class="comment">//ThreadLocalå…±äº«äº†æ•°æ®ï¼Œä¸Šæ¸¸æ‰€æœ‰çš„äººéƒ½èƒ½çœ‹åˆ°ï¼ŒContextç”±ä¸‹æ¸¸ä¼ æ’­ç»™ä¸Šæ¸¸</span></span><br><span class="line">            .subscribe(v -&gt; System.out.println(<span class="string">&quot;v = &quot;</span> + v));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä»¥å‰å‘½ä»¤å¼å˜æˆï¼Œcontroller -&gt; service -&gt; dao</span></span><br><span class="line">    <span class="comment">// å“åº”å¼ç¼–ç¨‹ dao -&gt; service -&gt; controller ,ä»ä¸‹æ¸¸åå‘ä¼ æ’­ï¼Œä¹Ÿå°±æ˜¯ä¸‹æ¸¸çš„é€Ÿåº¦å†³å®šä¸Šæ¸¸çš„é€Ÿåº¦ï¼ŒèƒŒå‹å¼</span></span><br></pre></td></tr></table></figure>
<h3 id="2ã€Spring-Webflux"><a href="#2ã€Spring-Webflux" class="headerlink" title="2ã€Spring Webflux"></a>2ã€Spring Webflux</h3><blockquote>
<p>WebFluxï¼šåº•å±‚å®Œå…¨åŸºäºnetty+reactor+springweb å®Œæˆâ¼€ä¸ªå…¨å¼‚æ­¥â¾®é˜»å¡çš„webå“åº”å¼æ¡†æ¶ </p>
<p>åº•å±‚ï¼šå¼‚æ­¥ + æ¶ˆæ¯é˜Ÿåˆ—(å†…å­˜) + äº‹ä»¶å›è°ƒæœºåˆ¶ = æ•´å¥—ç³»ç»Ÿ </p>
<p>ä¼˜ç‚¹ï¼šèƒ½ä½¿â½¤å°‘é‡èµ„æºå¤„ç†â¼¤é‡è¯·æ±‚ï¼›</p>
</blockquote>
<h5 id="0ã€ç»„ä»¶å¯¹æ¯”"><a href="#0ã€ç»„ä»¶å¯¹æ¯”" class="headerlink" title="0ã€ç»„ä»¶å¯¹æ¯”"></a>0ã€ç»„ä»¶å¯¹æ¯”</h5><div class="table-container">
<table>
<thead>
<tr>
<th>åŠŸèƒ½ç±»åˆ«</th>
<th>Servletï¼ˆé˜»å¡å¼ Webï¼‰</th>
<th>WebFluxï¼ˆå“åº”å¼ Webï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ ¸å¿ƒ API åŠŸèƒ½å®šä½</td>
<td>é˜»å¡å¼ Web å¼€å‘æ ‡å‡†ï¼ŒåŸºäºåŒæ­¥é˜»å¡æ¨¡å‹</td>
<td>å“åº”å¼ Web å¼€å‘æ¡†æ¶ï¼ŒåŸºäºå¼‚æ­¥éé˜»å¡å“åº”å¼æ¨¡å‹</td>
</tr>
<tr>
<td>å‰ç«¯æ§åˆ¶å™¨</td>
<td><code>DispatcherServlet</code></td>
<td><code>DispatcherHandler</code></td>
</tr>
<tr>
<td>å¤„ç†å™¨</td>
<td><code>Controller</code>ï¼ˆæ³¨è§£å¼ / æ¥å£å¼ï¼‰</td>
<td><code>WebHandler</code> / <code>Controller</code>ï¼ˆå…¼å®¹ Servlet çš„<code>Controller</code>æ³¨è§£ï¼‰</td>
</tr>
<tr>
<td>è¯·æ±‚ &amp; å“åº”å¯¹è±¡</td>
<td><code>ServletRequest</code>ã€<code>ServletResponse</code></td>
<td><code>ServerWebExchange</code>ï¼ˆå°è£…è¯·æ±‚å“åº”ï¼‰â”œâ”€ <code>ServerHttpRequest</code>ï¼ˆè¯·æ±‚å¯¹è±¡ï¼‰â””â”€ <code>ServerHttpResponse</code>ï¼ˆå“åº”å¯¹è±¡ï¼‰</td>
</tr>
<tr>
<td>è¿‡æ»¤å™¨</td>
<td><code>Filter</code>ï¼ˆå¸¸ç”¨<code>HttpFilter</code>å®ç°ç±»ï¼‰</td>
<td><code>WebFilter</code></td>
</tr>
<tr>
<td>å¼‚å¸¸å¤„ç†å™¨</td>
<td><code>HandlerExceptionResolver</code></td>
<td><code>DispatcherExceptionHandler</code></td>
</tr>
<tr>
<td>Web é…ç½®æ³¨è§£</td>
<td><code>@EnableWebMvc</code></td>
<td><code>@EnableWebFlux</code></td>
</tr>
<tr>
<td>è‡ªå®šä¹‰é…ç½®æ¥å£</td>
<td><code>WebMvcConfigurer</code>ï¼ˆç”¨äºæ‰©å±• Spring MVC é…ç½®ï¼‰</td>
<td><code>WebFluxConfigurer</code>ï¼ˆç”¨äºæ‰©å±• Spring WebFlux é…ç½®ï¼‰</td>
</tr>
<tr>
<td>æ¥å£è¿”å›ç»“æœ</td>
<td>ä»»æ„ Java å¯¹è±¡ï¼ˆå¦‚ POJOã€Stringã€void ç­‰ï¼‰</td>
<td><code>Mono</code>ï¼ˆå•ä¸ªç»“æœï¼‰ã€<code>Flux</code>ï¼ˆå¤šä¸ªç»“æœï¼‰ã€ä»»æ„ Java å¯¹è±¡ï¼ˆå…¼å®¹ä¼ ç»Ÿè¿”å›ç±»å‹ï¼‰</td>
</tr>
<tr>
<td>å‘é€ REST è¯·æ±‚å·¥å…·</td>
<td><code>RestTemplate</code>ï¼ˆé˜»å¡å¼ REST å®¢æˆ·ç«¯ï¼‰</td>
<td><code>WebClient</code>ï¼ˆå“åº”å¼éé˜»å¡ REST å®¢æˆ·ç«¯ï¼Œå¯å…¼å®¹åŒæ­¥è°ƒç”¨ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<h5 id="1ã€WebFlux"><a href="#1ã€WebFlux" class="headerlink" title="1ã€WebFlux"></a>1ã€WebFlux</h5><blockquote>
<p>åº•å±‚åŸºäºNettyå®ç°çš„Webå®¹å™¨ä¸è¯·æ±‚/å“åº”å¤„ç†æœºåˆ¶</p>
</blockquote>
<h6 id="1ã€å¼•å…¥"><a href="#1ã€å¼•å…¥" class="headerlink" title="1ã€å¼•å…¥"></a>1ã€å¼•å…¥</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Context å“åº”å¼ä¸Šä¸‹â½‚æ•°æ®ä¼ é€’ï¼› ç”±ä¸‹æ¸¸ä¼ æ’­ç»™ä¸Šæ¸¸ï¼› </p>
<p>ä»¥å‰ï¼š æµè§ˆå™¨ â€”&gt; Controller â€”&gt; Service â€”&gt; Daoï¼š é˜»å¡å¼ç¼–ç¨‹ XML </p>
<p>ç°åœ¨ï¼š Daoï¼ˆæ•°æ®æºæŸ¥è¯¢å¯¹è±¡ã€æ•°æ®å‘å¸ƒè€…ã€‘ï¼‰ â€”&gt; Service â€”&gt; Controller â€”&gt; æµè§ˆå™¨ï¼š å“åº”å¼</p>
<p>â¼¤æ•°æ®æµç¨‹ï¼š ä»â¼€ä¸ªæ•°æ®æºæ‹¿åˆ°â¼¤é‡æ•°æ®è¿›â¾åˆ†æè®¡ç®—ï¼›</p>
<p>ProductVistorDao.loadData() </p>
<p>â€‹        .distinct() </p>
<p>â€‹        .map() </p>
<p>â€‹        .filter() </p>
<p>â€‹        .handle() </p>
<p>â€‹        .subscribe();</p>
<p>è¿™ç§å“åº”å¼çš„ç¼–å†™å°±æ˜¯ä»Daoå¼€å§‹äº†</p>
</blockquote>
<h5 id="2ã€Reactoræ ¸å¿ƒ"><a href="#2ã€Reactoræ ¸å¿ƒ" class="headerlink" title="2ã€Reactoræ ¸å¿ƒ"></a>2ã€Reactoræ ¸å¿ƒ</h5><p><strong>æœ€åŸç”Ÿå†™æ³•ç†è§£åº•å±‚è¡Œä¸º</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chapter03WebfluxApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¿«é€Ÿè‡ªå·±ç¼–å†™ä¸€ä¸ªèƒ½å¤„ç†è¯·æ±‚çš„æœåŠ¡å™¨</span></span><br><span class="line">        <span class="comment">// 1ã€åˆ›å»ºä¸€ä¸ªèƒ½å¤„ç†Httpè¯·æ±‚çš„å¤„ç†å™¨ å‚æ•°ï¼šè¯·æ±‚ã€å“åº”ï¼Œè¿”å›å€¼ï¼šMono&lt;void&gt; ä»£è¡¨è¯·æ±‚å®Œæˆçš„ä¿¡å·</span></span><br><span class="line">        <span class="type">HttpHandler</span> <span class="variable">handler</span> <span class="operator">=</span> (ServerHttpRequest request, ServerHttpResponse response) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è¯·æ±‚è¿›æ¥äº†&quot;</span>);</span><br><span class="line">            <span class="comment">// ç¼–å†™è¯·æ±‚å¤„ç†çš„ä¸šåŠ¡ï¼Œç»™æµè§ˆå™¨å†™ä¸€ä¸ªå†…å®¹ URL + â€œHello~!&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// response.getHeaders();</span></span><br><span class="line">            <span class="comment">// response.getCookies();</span></span><br><span class="line">            <span class="comment">// response.getStatusCode();</span></span><br><span class="line">            <span class="comment">// response.bufferFactory();</span></span><br><span class="line">            <span class="comment">// response.writeWith();</span></span><br><span class="line">            <span class="comment">// response.setComplete();</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ•°æ®çš„å‘å¸ƒè€…ï¼šMono&lt;DataBuffer&gt;ã€Flux&lt;DataBuffer&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//åˆ›å»º å“åº”æ•°æ®çš„ DataBuffer</span></span><br><span class="line">            <span class="type">DataBufferFactory</span> <span class="variable">factory</span> <span class="operator">=</span> response.bufferFactory();</span><br><span class="line">            <span class="type">DataBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> factory.wrap(<span class="keyword">new</span> <span class="title class_">String</span>(request.getURI() + <span class="string">&quot;Hello!&quot;</span>).getBytes());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">//éœ€è¦ä¸€ä¸ªDataBuffer çš„å‘å¸ƒè€…</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> response.writeWith(Mono.just(buffer));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œç›‘å¬8080ç«¯å£ï¼Œæ¥å—æ•°æ®ï¼Œæ‹¿åˆ°æ•°æ®äº¤ç»™ HttpHandler è¿›è¡Œè¯·æ±‚å¤„ç†</span></span><br><span class="line">        <span class="type">ReactorHttpHandlerAdapter</span> <span class="variable">adapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReactorHttpHandlerAdapter</span>(handler);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€å¯åŠ¨NettyæœåŠ¡å™¨</span></span><br><span class="line">        HttpServer.create()</span><br><span class="line">            .host(<span class="string">&quot;localhost&quot;</span>)</span><br><span class="line">            .port(<span class="number">8080</span>)</span><br><span class="line">            .handle(adapter)</span><br><span class="line">            .bindNow();<span class="comment">// ç°åœ¨å°±ç»‘å®š</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡å™¨å¯åŠ¨&quot;</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡å™¨åœæ­¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ¡ˆä¾‹å®æˆ˜</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// WebFlux: å‘ä¸‹å…¼å®¹åŸæ¥SpringMVCçš„å¤§å¤šæ•°æ³¨è§£å’ŒAPI</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@RequestParam(value = &quot;key&quot;, defaultValue = &quot;haha&quot;)</span> String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello World key = &quot;</span> + key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨èæ–¹å¼</span></span><br><span class="line">    <span class="comment">// 1ã€è¿”å›å•ä¸ªæ•°æ®ç”¨Mono&lt;&gt;</span></span><br><span class="line">    <span class="comment">// 2ã€è¿”å›å¤šä¸ªæ•°æ®Flux&lt;&gt;</span></span><br><span class="line">    <span class="comment">// 3ã€é…åˆFluxï¼Œå®ŒæˆSSEï¼šServer Send Event æœåŠ¡ç«¯äº‹ä»¶æ¨é€</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/haha&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">haha</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.just(<span class="string">&quot;haha&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hehe&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Flux&lt;String&gt; <span class="title function_">flux</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.just(<span class="string">&quot;haha1&quot;</span>, <span class="string">&quot;haha2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//SSEæµ‹è¯•ï¼Œchatgptéƒ½åœ¨ç”¨ï¼ŒæœåŠ¡ç«¯æ¨é€</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/sse&quot; ,produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> Flux&lt;String&gt; <span class="title function_">sse</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">            .map(i -&gt; <span class="string">&quot;ha&quot;</span> + i)</span><br><span class="line">            .delayElements(Duration.ofSeconds(<span class="number">5</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//SpringMVC ä»¥å‰æ€ä¹ˆç”¨ï¼ŒåŸºæœ¬å¯ä»¥æ— ç¼åˆ‡æ¢</span></span><br><span class="line">    <span class="comment">// åº•å±‚ï¼šéœ€è¦è‡ªå·±å¼€å§‹ç¼–å†™å“åº”å¼ä»£ç </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//SSEçš„å®Œæ•´API</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/sseApi&quot; ,produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> Flux&lt;ServerSentEvent&gt; <span class="title function_">sseApi</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">            .map(i -&gt; &#123;</span><br><span class="line">                <span class="comment">//æ„å»ºä¸€ä¸ªSSEå¯¹è±¡</span></span><br><span class="line">                ServerSentEvent&lt;String&gt; haha = ServerSentEvent.builder(<span class="string">&quot;ha-&quot;</span> + i)</span><br><span class="line">                    .id(i + <span class="string">&quot;&quot;</span>)</span><br><span class="line">                    .comment(<span class="string">&quot;hei&quot;</span>)</span><br><span class="line">                    .event(<span class="string">&quot;haha&quot;</span>)</span><br><span class="line">                    .build();</span><br><span class="line">                <span class="keyword">return</span> haha;</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3ã€DispatcherHandleråŸç†"><a href="#3ã€DispatcherHandleråŸç†" class="headerlink" title="3ã€DispatcherHandleråŸç†"></a>3ã€DispatcherHandleråŸç†</h5><blockquote>
<p>SpringMVCï¼š DispatcherServletï¼› </p>
<p>SpringWebFluxï¼š DispatcherHandler</p>
</blockquote>
<h6 id="1ã€è¯·æ±‚å¤„ç†æµç¨‹"><a href="#1ã€è¯·æ±‚å¤„ç†æµç¨‹" class="headerlink" title="1ã€è¯·æ±‚å¤„ç†æµç¨‹"></a>1ã€è¯·æ±‚å¤„ç†æµç¨‹</h6><ul>
<li>HandlerMappingï¼šè¯·æ±‚æ˜ å°„å¤„ç†å™¨ï¼› ä¿å­˜æ¯ä¸ªè¯·æ±‚ç”±å“ªä¸ªâ½…æ³•è¿›â¾å¤„ç† </li>
<li>HandlerAdapterï¼šå¤„ç†å™¨é€‚é…å™¨ï¼›åå°„æ‰§â¾â½¬æ ‡â½…æ³• </li>
<li>HandlerResultHandlerï¼šå¤„ç†å™¨ç»“æœå¤„ç†å™¨ï¼›</li>
</ul>
<p>SpringMVCï¼š DispatcherServlet æœ‰â¼€ä¸ª doDispatch() â½…æ³•ï¼Œæ¥å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼› </p>
<p>WebFluxï¼š DispatcherHandler æœ‰â¼€ä¸ª handle() â½…æ³•ï¼Œæ¥å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼›</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¤„ç†æœåŠ¡ç«¯Webè¯·æ±‚äº¤æ¢ï¼ŒåŒ¹é…å¤„ç†å™¨å¹¶æ‰§è¡Œè¯·æ±‚å¤„ç†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> exchange æœåŠ¡ç«¯è¯·æ±‚å“åº”äº¤æ¢å¯¹è±¡ï¼ˆå°è£…è¯·æ±‚ã€å“åº”ç­‰ä¿¡æ¯ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Mono&lt;Void&gt; å¼‚æ­¥å“åº”ç»“æœï¼ˆè¡¨ç¤ºè¯·æ±‚å¤„ç†å®Œæˆï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">handle</span><span class="params">(ServerWebExchange exchange)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. è‹¥å¤„ç†å™¨æ˜ å°„é›†åˆä¸ºç©ºï¼Œè¿”å›404æœªæ‰¾åˆ°é”™è¯¯</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.handlerMappings == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> createNotFoundError();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. åˆ¤æ–­æ˜¯å¦æ˜¯CORSé¢„æ£€è¯·æ±‚ï¼Œè‹¥æ˜¯åˆ™ä¸“é—¨å¤„ç†é¢„æ£€è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">if</span> (CorsUtils.isPreFlightRequest(exchange.getRequest())) &#123;</span><br><span class="line">        <span class="keyword">return</span> handlePreFlight(exchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. éå†å¤„ç†å™¨æ˜ å°„ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªèƒ½å¤„ç†å½“å‰è¯·æ±‚çš„å¤„ç†å™¨å¹¶æ‰§è¡Œå¤„ç†</span></span><br><span class="line">    <span class="keyword">return</span> Flux.fromIterable(<span class="built_in">this</span>.handlerMappings) <span class="comment">// æ‹¿åˆ°æ‰€æœ‰çš„handlerMappingsï¼ˆå¤„ç†å™¨æ˜ å°„ï¼‰</span></span><br><span class="line">            .concatMap(mapping -&gt; mapping.getHandler(exchange)) <span class="comment">// éå†æ¯ä¸ªmappingï¼Œåˆ¤æ–­è°èƒ½å¤„ç†å½“å‰è¯·æ±‚</span></span><br><span class="line">            .next() <span class="comment">// è§¦å‘è·å–å…ƒç´ ï¼Œæ‹¿åˆ°æµä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå³ç¬¬ä¸€ä¸ªèƒ½å¤„ç†è¯·æ±‚çš„handlerï¼‰</span></span><br><span class="line">            .switchIfEmpty(createNotFoundError()) <span class="comment">// è‹¥æœªæ‰¾åˆ°å¯ç”¨å¤„ç†å™¨ï¼Œè¿”å›404é”™è¯¯</span></span><br><span class="line">            .onErrorResume(ex -&gt; handleDispatchError(exchange, ex)) <span class="comment">// å¼‚å¸¸å…œåº•å¤„ç†ï¼šå‰é¢æ­¥éª¤å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œè°ƒç”¨å¼‚å¸¸å¤„ç†æ–¹æ³•</span></span><br><span class="line">            .flatMap(handler -&gt; handleRequestWith(exchange, handler)); <span class="comment">// æ‰¾åˆ°å¤„ç†å™¨åï¼Œè°ƒç”¨æ–¹æ³•å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>1ã€è¯·æ±‚å’Œå“åº”éƒ½å°è£…åœ¨ ServerWebExchange å¯¹è±¡ä¸­ï¼Œç”±handleâ½…æ³•è¿›â¾å¤„ç† </li>
<li>2ã€å¦‚æœæ²¡æœ‰ä»»ä½•çš„è¯·æ±‚æ˜ å°„å™¨ï¼› ç›´æ¥è¿”å›â¼€ä¸ªï¼š åˆ›å»ºâ¼€ä¸ªæœªæ‰¾åˆ°çš„é”™è¯¯ï¼› 404ï¼› è¿”å› Mono.errorï¼›ç»ˆç»“æµ </li>
<li>3ã€è·¨åŸŸâ¼¯å…·ï¼Œæ˜¯å¦è·¨åŸŸè¯·æ±‚ï¼Œè·¨åŸŸè¯·æ±‚æ£€æŸ¥æ˜¯å¦å¤æ‚è·¨åŸŸï¼Œéœ€è¦é¢„æ£€è¯·æ±‚ï¼› </li>
<li>4ã€Fluxæµå¼æ“ä½œï¼Œå…ˆæ‰¾åˆ°HandlerMappingï¼Œå†è·å–handlerAdapterï¼Œå†â½¤Adapterå¤„ç†è¯·æ±‚ï¼ŒæœŸé—´ çš„é”™è¯¯ç”±onErrorResumeè§¦å‘å›è°ƒè¿›â¾å¤„ç†ï¼› </li>
</ul>
<p>æºç ä¸­çš„æ ¸â¼¼ä¸¤ä¸ªï¼š </p>
<ul>
<li>handleRequestWithï¼š ç¼–å†™äº†handlerAdapteræ€ä¹ˆå¤„ç†è¯·æ±‚ </li>
<li>handleResultï¼š Stringã€Userã€ServerSendEventã€Monoã€Flux â€¦</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŸºäºMono.deferåˆ›å»º404æœªæ‰¾åˆ°å¼‚å¸¸çš„Monoæµï¼ˆå»¶è¿ŸåŠ è½½å®ç°ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;R&gt; æ³›å‹ç±»å‹ï¼Œå¯¹åº”Monoçš„å…ƒç´ ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Mono&lt;R&gt; å»¶è¿Ÿåˆ›å»ºçš„ã€åŒ…å«404å¼‚å¸¸çš„Monoæµ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> &lt;R&gt; Mono&lt;R&gt; <span class="title function_">createNotFoundErrorWithDefer</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Mono.defer(() -&gt; &#123;</span><br><span class="line">        <span class="type">Exception</span> <span class="variable">ex</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseStatusException</span>(HttpStatus.NOT_FOUND);</span><br><span class="line">        <span class="keyword">return</span> Mono.error(ex);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*===== æµ‹è¯• Mono.just() =====</span></span><br><span class="line"><span class="comment">ã€Mono.justã€‘Exception å¯¹è±¡å·²åˆ›å»ºï¼ˆå“ªæ€•æ²¡äººè®¢é˜…ï¼‰</span></span><br><span class="line"><span class="comment">createNotFoundWithJust æ–¹æ³•è°ƒç”¨å®Œæˆï¼Œæœªè®¢é˜…è¯¥Mono</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">===== æµ‹è¯• Mono.defer() =====</span></span><br><span class="line"><span class="comment">ã€Mono.deferã€‘æ–¹æ³•å·²è°ƒç”¨ï¼Œä½†è¿˜æœªåˆ›å»º Exception å¯¹è±¡</span></span><br><span class="line"><span class="comment">createNotFoundWithDefer æ–¹æ³•è°ƒç”¨å®Œæˆï¼Œæœªè®¢é˜…è¯¥Mono</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">===== è®¢é˜… deferMono =====</span></span><br><span class="line"><span class="comment">ã€Mono.deferã€‘è®¢é˜…è§¦å‘ï¼ŒException å¯¹è±¡åŠ¨æ€åˆ›å»º*/</span></span><br></pre></td></tr></table></figure>
<h5 id="4ã€æ³¨è§£å¼€å‘"><a href="#4ã€æ³¨è§£å¼€å‘" class="headerlink" title="4ã€æ³¨è§£å¼€å‘"></a>4ã€æ³¨è§£å¼€å‘</h5><h6 id="1ã€ç›®æ ‡æ–¹æ³•ä¼ å‚"><a href="#1ã€ç›®æ ‡æ–¹æ³•ä¼ å‚" class="headerlink" title="1ã€ç›®æ ‡æ–¹æ³•ä¼ å‚"></a>1ã€ç›®æ ‡æ–¹æ³•ä¼ å‚</h6><p>ã€Œç›®æ ‡æ–¹æ³•ã€ç‰¹æŒ‡ <strong>Controller ä¸­ç”¨äºå¤„ç†å‰ç«¯è¯·æ±‚çš„ä¸šåŠ¡æ–¹æ³•</strong>ï¼ˆå³æ ‡æ³¨äº†<code>@GetMapping</code>/<code>@PostMapping</code>/<code>@RequestMapping</code>ç­‰æ³¨è§£çš„æ–¹æ³•ï¼‰ï¼Œã€Œç›®æ ‡æ–¹æ³•ä¼ å‚ã€å°±æ˜¯ç»™è¿™äº› Controller ä¸šåŠ¡æ–¹æ³•å®šä¹‰å‚æ•°ï¼Œç”¨äºæ¥æ”¶ã€å°è£…è¯·æ±‚ç›¸å…³æ•°æ®æˆ–è·å– Web ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p>è¿™äº›å‚æ•°åˆ†ä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯å‰ç«¯ä¸»åŠ¨ä¼ é€’çš„æ•°æ®ï¼Œä¸€ç±»æ˜¯Webä¸Šä¸‹æ–‡è‡ªåŠ¨å°è£…çš„å¯¹è±¡ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Controller æ–¹æ³•å‚æ•°ç±»å‹</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ServerWebExchange</strong></td>
<td>å°è£…è¯·æ±‚å’Œå“åº”å¯¹è±¡çš„é¡¶å±‚å¯¹è±¡ï¼›æ”¯æŒè‡ªå®šä¹‰è·å–è¯·æ±‚æ•°æ®ã€è‡ªå®šä¹‰æ„é€ å“åº”ç»“æœ</td>
</tr>
<tr>
<td><strong>ServerHttpRequest<code>ã€</code>ServerHttpResponse</strong></td>
<td>åˆ†åˆ«å¯¹åº”å“åº”å¼ Web çš„è¯·æ±‚å¯¹è±¡ã€å“åº”å¯¹è±¡ï¼Œç”¨äºç›´æ¥æ“ä½œè¯·æ±‚ä¿¡æ¯å’Œå“åº”ç»“æœ</td>
</tr>
<tr>
<td><strong>WebSession</strong></td>
<td>ç”¨äºè®¿é—®å½“å‰ç”¨æˆ·çš„ Session å¯¹è±¡ï¼Œå­˜å‚¨ / è·å–ä¼šè¯çº§æ•°æ®</td>
</tr>
<tr>
<td><code>java.security.Principal</code></td>
<td>ç”¨äºè·å–å½“å‰è®¤è¯ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åã€ç”¨æˆ·æ ‡è¯†ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>org.springframework.http.HttpMethod</code></td>
<td>ç”¨äºè·å–å½“å‰è¯·æ±‚çš„ HTTP æ–¹æ³•ï¼ˆå¦‚ GETã€POSTã€PUTã€DELETE ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>java.util.Locale</code></td>
<td>ç”¨äºè·å–å½“å‰è¯·æ±‚çš„å›½é™…åŒ–åŒºåŸŸä¿¡æ¯ï¼ˆå¦‚ zh_CNã€en_US ç­‰ï¼‰ï¼Œæ”¯æŒå¤šè¯­è¨€é€‚é…</td>
</tr>
<tr>
<td><code>java.util.TimeZone</code>ã€<code>java.time.ZoneId</code></td>
<td>ç”¨äºè·å–å½“å‰è¯·æ±‚å¯¹åº”çš„æ—¶åŒºä¿¡æ¯ï¼Œæ”¯æŒæ—¶é—´ç›¸å…³çš„æ—¶åŒºè½¬æ¢å¤„ç†</td>
</tr>
<tr>
<td><code>@PathVariable</code></td>
<td>ç”¨äºç»‘å®š URL è·¯å¾„ä¸­çš„å˜é‡ï¼ˆå¦‚<code>/user/&#123;id&#125;</code>ä¸­çš„<code>id</code>ï¼‰ï¼Œè·å–è·¯å¾„å‚æ•°å€¼</td>
</tr>
<tr>
<td><code>@MatrixVariable</code></td>
<td>ç”¨äºè·å– URL ä¸­çš„çŸ©é˜µå˜é‡ï¼ˆå¦‚<code>/user;name=zhangsan;age=20</code>ä¸­çš„<code>name</code>/<code>age</code>ï¼‰</td>
</tr>
<tr>
<td><code>@RequestParam</code></td>
<td>ç”¨äºè·å– URL ä¸­çš„è¯·æ±‚å‚æ•°ï¼ˆå¦‚<code>/user?name=zhangsan&amp;age=20</code>ä¸­çš„<code>name</code>/<code>age</code>ï¼‰ï¼Œæ”¯æŒ GET/POST è¯·æ±‚</td>
</tr>
<tr>
<td><code>@RequestHeader</code></td>
<td>ç”¨äºè·å– HTTP è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼ˆå¦‚<code>Content-Type</code>ã€<code>User-Agent</code>ã€<code>Authorization</code>ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>@CookieValue</code></td>
<td>ç”¨äºè·å–å®¢æˆ·ç«¯è¯·æ±‚ä¸­æºå¸¦çš„ Cookie å€¼ï¼ˆå¦‚è·å–<code>JSESSIONID</code>ã€è‡ªå®šä¹‰ Cookie ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>@RequestBody</code></td>
<td>ç”¨äºè·å– HTTP è¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œé€šå¸¸é€‚é… POST è¯·æ±‚ï¼ˆéè¡¨å•æäº¤ï¼Œå¦‚ JSON æ ¼å¼æ•°æ®ï¼‰ï¼Œä¹Ÿæ”¯æŒæ–‡ä»¶ä¸Šä¼ ç›¸å…³åœºæ™¯</td>
</tr>
<tr>
<td><code>HttpEntity&lt;B&gt;</code></td>
<td>å°è£…åçš„ HTTP è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“ä¿¡æ¯ï¼Œå¯ç»Ÿä¸€è·å–è¯·æ±‚çš„å¤´éƒ¨å’Œæ­£æ–‡æ•°æ®</td>
</tr>
<tr>
<td><code>@RequestPart</code></td>
<td>ä¸“é—¨ç”¨äºè·å–<code>multipart/form-data</code>ç±»å‹è¯·æ±‚ä¸­çš„æ•°æ®ï¼Œå¸¸ç”¨äºæ–‡ä»¶ä¸Šä¼ åœºæ™¯ï¼ˆè·å–ä¸Šä¼ çš„æ–‡ä»¶æˆ–è¡¨å•å­—æ®µï¼‰</td>
</tr>
<tr>
<td><code>java.util.Map</code>ã€<code>org.springframework.ui.Model</code>ã€<code>org.springframework.ui.ModelMap</code></td>
<td>ç”¨äºåœ¨è¯·æ±‚åŸŸä¸­å­˜å‚¨æ•°æ®ï¼Œå®ç°åç«¯å‘å‰ç«¯ï¼ˆè§†å›¾ï¼‰ä¼ é€’æ•°æ®ï¼Œä¸‰è€…åŠŸèƒ½ç±»ä¼¼ï¼ŒModel æ›´æ¨èä½¿ç”¨</td>
</tr>
<tr>
<td><code>@ModelAttribute</code></td>
<td>ç”¨äºç»‘å®šè¯·æ±‚å‚æ•°åˆ° Java å®ä½“å¯¹è±¡ï¼ˆè¡¨å•æ•°æ® / è¯·æ±‚å‚æ•°è‡ªåŠ¨å°è£…ä¸º POJOï¼‰ï¼Œä¹Ÿå¯ç”¨äºæ–¹æ³•çº§æå‰å°è£…æ¨¡å‹æ•°æ®</td>
</tr>
<tr>
<td><code>Errors</code>ã€<code>BindingResult</code></td>
<td>ç”¨äºæ•°æ®æ ¡éªŒï¼Œå°è£…è¯·æ±‚å‚æ•°ç»‘å®šæˆ–ä¸šåŠ¡æ ¡éªŒåçš„é”™è¯¯ä¿¡æ¯ï¼Œéœ€ç´§è·Ÿåœ¨è¢«æ ¡éªŒå¯¹è±¡å‚æ•°ä¹‹å</td>
</tr>
<tr>
<td><code>SessionStatus</code> + ç±»çº§åˆ«<code>@SessionAttributes</code></td>
<td><code>@SessionAttributes</code>ï¼ˆç±»çº§ï¼‰ç”¨äºå£°æ˜éœ€è¦å­˜å…¥ Session çš„æ¨¡å‹æ•°æ®ï¼›<code>SessionStatus</code>ç”¨äºæ ‡è®°ä¼šè¯çŠ¶æ€ç»“æŸï¼ˆæ¸…é™¤<code>@SessionAttributes</code>å£°æ˜çš„ä¼šè¯æ•°æ®ï¼‰</td>
</tr>
<tr>
<td><code>UriComponentsBuilder</code></td>
<td>ç”¨äºæ„é€ ä¸å½“å‰è¯·æ±‚çš„ä¸»æœºã€ç«¯å£ã€åè®®ã€ä¸Šä¸‹æ–‡è·¯å¾„ç›¸å¯¹åº”çš„ URLï¼Œæ–¹ä¾¿ç”Ÿæˆè§„èŒƒçš„é“¾æ¥åœ°å€</td>
</tr>
<tr>
<td><code>@SessionAttribute</code></td>
<td>ç”¨äºè·å–ç”±<code>@SessionAttributes</code>å­˜å…¥ Session ä¸­çš„æ•°æ®ï¼ˆä»…è¯»å–ä¼šè¯æ•°æ®ï¼Œä¸å†™å…¥ï¼‰</td>
</tr>
<tr>
<td><code>@RequestAttribute</code></td>
<td>ç”¨äºè·å–è¯·æ±‚è½¬å‘è¿‡ç¨‹ä¸­ï¼Œå­˜æ”¾åœ¨è¯·æ±‚åŸŸï¼ˆ<code>request.setAttribute</code>ï¼‰ä¸­çš„æ•°æ®ï¼ˆä»…é€‚ç”¨äºè½¬å‘åœºæ™¯ï¼‰</td>
</tr>
<tr>
<td>ä»»æ„å…¶ä»–å‚æ•°ï¼ˆåŸºæœ¬ç±»å‹ / å¯¹è±¡ç±»å‹ï¼‰</td>
<td>1. åŸºæœ¬ç±»å‹ï¼šé»˜è®¤ç­‰ä»·äºæ ‡æ³¨<code>@RequestParam</code>ï¼Œè‡ªåŠ¨ç»‘å®šè¯·æ±‚å‚æ•°ï¼›2. å¯¹è±¡ç±»å‹ï¼šé»˜è®¤ç­‰ä»·äºæ ‡æ³¨<code>@ModelAttribute</code>ï¼Œè‡ªåŠ¨å°è£…è¯·æ±‚å‚æ•°ä¸º POJO å¯¹è±¡</td>
</tr>
</tbody>
</table>
</div>
<p><strong>å¯çœç•¥æ³¨è§£çš„åœºæ™¯</strong>ï¼šåŸºæœ¬ç±»å‹ / POJO ç±»å‹ï¼ˆæŒ‰ååŒ¹é…è¯·æ±‚å‚æ•°ï¼‰ã€Web ä¸Šä¸‹æ–‡ç±»ç±»å‹ï¼ˆæ¡†æ¶è‡ªåŠ¨æ³¨å…¥ï¼‰</p>
<h6 id="2ã€è¿”å›å€¼å†™æ³•"><a href="#2ã€è¿”å›å€¼å†™æ³•" class="headerlink" title="2ã€è¿”å›å€¼å†™æ³•"></a>2ã€è¿”å›å€¼å†™æ³•</h6><p>sseå’ŒwebsocketåŒºåˆ«ï¼š </p>
<ul>
<li>SSEï¼šå•â¼¯ï¼›<strong>é€šé“å»ºç«‹åï¼Œåªæœ‰æœåŠ¡ç«¯èƒ½ä¸»åŠ¨æ¨é€æ•°æ®ï¼Œå®¢æˆ·ç«¯åªèƒ½è¢«åŠ¨æ¥æ”¶</strong></li>
<li>websocketï¼šåŒâ¼¯ï¼š è¿æ¥å»ºâ½´åï¼Œå¯ä»¥ä»»ä½•äº¤äº’ï¼›</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Controller æ–¹æ³•è¿”å›å€¼ç±»å‹ / æ³¨è§£</th>
<th>è¿”å›å€¼æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@ResponseBody</code></td>
<td>æŠŠå“åº”æ•°æ®ç›´æ¥å†™å…¥å“åº”ä½“ï¼›è‹¥è¿”å›å¯¹è±¡ç±»å‹ï¼Œä¼šè‡ªåŠ¨åºåˆ—åŒ–ä¸º JSON æ ¼å¼è¿”å›ï¼ˆæ— éœ€è§†å›¾è§£æï¼‰</td>
</tr>
<tr>
<td><code>HttpEntity&lt;B&gt;</code>ã€<code>ResponseEntity&lt;B&gt;</code></td>
<td><code>HttpEntity</code>ï¼šå°è£…å“åº”å¤´å’Œå“åº”ä½“çš„åŸºç¡€å¯¹è±¡ï¼›<code>ResponseEntity</code>ï¼šå¢å¼ºç‰ˆï¼Œæ”¯æŒå¿«æ·è‡ªå®šä¹‰å“åº”çŠ¶æ€ç ã€å“åº”å¤´ã€å“åº”å†…å®¹</td>
</tr>
<tr>
<td><code>HttpHeaders</code></td>
<td>å“åº”ä¸­ä»…åŒ…å«å“åº”å¤´ä¿¡æ¯ï¼Œæ— å…·ä½“çš„å“åº”ä½“å†…å®¹ï¼ˆé€‚ç”¨äºæ— éœ€è¿”å›ä¸šåŠ¡æ•°æ®ï¼Œä»…éœ€è¿”å›å“åº”å¤´çš„åœºæ™¯ï¼‰</td>
</tr>
<tr>
<td><code>ErrorResponse</code></td>
<td>ç”¨äºå¿«é€Ÿæ„å»ºæ ‡å‡†åŒ–çš„é”™è¯¯å“åº”ï¼Œç®€åŒ–å¼‚å¸¸åœºæ™¯ä¸‹çš„å“åº”æ•°æ®å°è£…</td>
</tr>
<tr>
<td><code>ProblemDetail</code></td>
<td>Spring Boot 3+ æ–°å¢ï¼Œç”¨äºæ„å»ºç¬¦åˆ HTTP é—®é¢˜è¯¦æƒ…è§„èŒƒçš„é”™è¯¯å“åº”ï¼Œæä¾›æ›´è§„èŒƒçš„å¼‚å¸¸ä¿¡æ¯è¿”å›æ ¼å¼</td>
</tr>
<tr>
<td><code>String</code></td>
<td>éµå¾ªä¼ ç»Ÿä½¿ç”¨è§„åˆ™ï¼š1. ç›´æ¥è¿”å›å­—ç¬¦ä¸²ï¼ˆé<code>forward:</code>/<code>redirect:</code>ï¼‰ï¼šé…åˆæ¨¡æ¿å¼•æ“è§£æä¸ºè§†å›¾åç§°2. <code>forward:xxx</code>ï¼šè½¬å‘åˆ°æŒ‡å®šåœ°å€3. <code>redirect:xxx</code>ï¼šé‡å®šå‘åˆ°æŒ‡å®šåœ°å€</td>
</tr>
<tr>
<td><code>View</code></td>
<td>ç›´æ¥è¿”å›è§†å›¾å¯¹è±¡ï¼Œæ˜ç¡®æŒ‡å®šè¦æ¸²æŸ“çš„è§†å›¾ï¼Œæ— éœ€ä¾èµ–è§†å›¾åç§°è§£æ</td>
</tr>
<tr>
<td><code>java.util.Map</code>ã€<code>org.springframework.ui.Model</code></td>
<td>ä¸ä¼ ç»Ÿä½¿ç”¨è§„åˆ™ä¸€è‡´ï¼Œç”¨äºåœ¨è¯·æ±‚åŸŸä¸­å­˜å‚¨æ•°æ®ï¼Œä¼ é€’ç»™å‰ç«¯è§†å›¾è¿›è¡Œæ¸²æŸ“ï¼ˆéœ€é…åˆæ¨¡æ¿å¼•æ“ä½¿ç”¨ï¼‰</td>
</tr>
<tr>
<td><code>@ModelAttribute</code></td>
<td>ä¸ä¼ ç»Ÿä½¿ç”¨è§„åˆ™ä¸€è‡´ï¼Œç”¨äºå°†è¿”å›å€¼å­˜å…¥æ¨¡å‹æ•°æ®ï¼ˆè¯·æ±‚åŸŸ / Sessionï¼‰ï¼Œä¾›å‰ç«¯è§†å›¾è·å–</td>
</tr>
<tr>
<td><strong>Rendering</strong></td>
<td>æ–°ç‰ˆé¡µé¢è·³è½¬ APIï¼Œç”¨äºæŒ‡å®šè¦æ¸²æŸ“çš„è§†å›¾ã€å“åº”çŠ¶æ€ç­‰ï¼Œå®ç°é¡µé¢è·³è½¬ï¼›<strong>ä¸å¯ä¸<code>@ResponseBody</code>æ³¨è§£åŒæ—¶ä½¿ç”¨</strong>ï¼ˆå¦åˆ™ä¼šä¸§å¤±é¡µé¢è·³è½¬åŠŸèƒ½ï¼Œè½¬ä¸ºè¿”å›å¯¹è±¡æœ¬èº«ï¼‰</td>
</tr>
<tr>
<td><code>void</code></td>
<td>ä»…ä»£è¡¨å“åº”å®Œæˆçš„ä¿¡å·ï¼Œæ— å®é™…ä¸šåŠ¡æ•°æ®è¿”å›ï¼›é€šå¸¸ç”¨äºæ— éœ€è¿”å›å†…å®¹ï¼Œä»…éœ€å®Œæˆå“åº”æµç¨‹çš„åœºæ™¯</td>
</tr>
<tr>
<td><code>Flux&lt;ServerSentEvent&gt;</code>ã€<code>Observable&lt;ServerSentEvent&gt;</code> æˆ–å…¶ä»–å“åº”å¼ç±»å‹</td>
<td>ç”¨äºå®ç° SSEï¼ˆServer-Sent Eventsï¼ŒæœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼‰ï¼Œä»¥ <code>text/event-stream</code> æ ¼å¼å‘å®¢æˆ·ç«¯æŒç»­æ¨é€æ•°æ®</td>
</tr>
<tr>
<td>å…¶ä»–æœªåˆ—å‡ºçš„è¿”å›å€¼</td>
<td>æœªåœ¨ä¸Šè¿°åˆ—è¡¨ä¸­çš„æ‰€æœ‰è¿”å›å€¼ï¼Œå‡ä¼šè¢«å½“ä½œå‰ç«¯è§†å›¾çš„æ¸²æŸ“æ•°æ®ï¼ˆå­˜å…¥è¯·æ±‚åŸŸï¼‰ï¼Œé…åˆæ¨¡æ¿å¼•æ“è¿›è¡Œé¡µé¢æ¸²æŸ“</td>
</tr>
</tbody>
</table>
</div>
<h5 id="5ã€æ–‡ä»¶ä¸Šä¼ "><a href="#5ã€æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="5ã€æ–‡ä»¶ä¸Šä¼ "></a>5ã€æ–‡ä»¶ä¸Šä¼ </h5><p>ä»¥å‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyForm</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> MultipartFile file;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileUploadController</span> &#123;</span><br><span class="line">	<span class="meta">@PostMapping(&quot;/form&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">handleFormUpload</span><span class="params">(MyForm form, BindingResult errors)</span> &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç°åœ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">handle</span><span class="params">(<span class="meta">@RequestPart(&quot;meta-data&quot;)</span> Part metadata, </span></span><br><span class="line"><span class="params">	<span class="meta">@RequestPart(&quot;file-data&quot;)</span> FilePart file)</span> &#123; </span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6ã€é”™è¯¯å¤„ç†"><a href="#6ã€é”™è¯¯å¤„ç†" class="headerlink" title="6ã€é”™è¯¯å¤„ç†"></a>6ã€é”™è¯¯å¤„ç†</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">error</span><span class="params">(ArithmeticException exception)</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;å‘â½£äº†æ•°å­¦è¿ç®—å¼‚å¸¸&quot;</span>+exception);</span><br><span class="line">	<span class="comment">//è¿”å›è¿™äº›è¿›â¾é”™è¯¯å¤„ç†ï¼›</span></span><br><span class="line">	<span class="comment">//        ProblemDetailï¼šå»ºé€ è€…ï¼šå£°æ˜å¼ç¼–ç¨‹ã€é“¾å¼è°ƒâ½¤</span></span><br><span class="line">	<span class="comment">//        ErrorResponse ï¼š </span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;ç‚¸äº†ï¼Œå“ˆå“ˆ...&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="7ã€RequestContext"><a href="#7ã€RequestContext" class="headerlink" title="7ã€RequestContext"></a>7ã€RequestContext</h5><h5 id="8ã€è‡ªå®šä¹‰Fluxé…ç½®"><a href="#8ã€è‡ªå®šä¹‰Fluxé…ç½®" class="headerlink" title="8ã€è‡ªå®šä¹‰Fluxé…ç½®"></a>8ã€è‡ªå®šä¹‰Fluxé…ç½®</h5><p><code>@EnableWebFlux</code> æ³¨è§£ï¼Œå¼€å¯WebFluxè‡ªå®šä¹‰ï¼Œç¦ç”¨WebFluxçš„é»˜è®¤æ•ˆæœï¼Œå®Œå…¨è‡ªå®šä¹‰</p>
<p><code>WebFluxConfigurer</code></p>
<blockquote>
<p>å®¹å™¨ä¸­æ³¨å…¥è¿™ä¸ªç±»å‹çš„ç»„ä»¶ï¼Œé‡å†™åº•å±‚é€»è¾‘</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebConfiguration</span> &#123;</span><br><span class="line"><span class="comment">//é…ç½®åº•å±‚</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> WebFluxConfigurer <span class="title function_">webFluxConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebFluxConfigurer</span>() &#123;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">				registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">					.allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">					.allowedMethods(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">					.allowedOrigins(<span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="9ã€Filter"><a href="#9ã€Filter" class="headerlink" title="9ã€Filter"></a>9ã€Filter</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebFilter</span> <span class="keyword">implements</span> <span class="title class_">WebFilter</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, WebFilterChain chain)</span> &#123;</span><br><span class="line">		<span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> exchange.getRequest();</span><br><span class="line">		<span class="type">ServerHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> exchange.getResponse();</span><br><span class="line">		System.out.println(<span class="string">&quot;è¯·æ±‚å¤„ç†æ”¾â¾åˆ°â½¬æ ‡â½…æ³•ä¹‹å‰...&quot;</span>);</span><br><span class="line">		Mono&lt;Void&gt; filter = chain.filter(exchange); <span class="comment">//æ”¾â¾</span></span><br><span class="line">		<span class="comment">//æµâ¼€æ—¦ç»è¿‡æŸä¸ªæ“ä½œå°±ä¼šå˜æˆæ–°æµ</span></span><br><span class="line">		Mono&lt;Void&gt; voidMono = filter.doOnError(err -&gt; &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;â½¬æ ‡â½…æ³•å¼‚å¸¸ä»¥å...&quot;</span>);</span><br><span class="line">		&#125;) <span class="comment">// â½¬æ ‡â½…æ³•å‘â½£å¼‚å¸¸ååšäº‹</span></span><br><span class="line">		.doFinally(signalType -&gt; &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;â½¬æ ‡â½…æ³•æ‰§â¾ä»¥å...&quot;</span>);</span><br><span class="line">		&#125;);<span class="comment">// â½¬æ ‡â½…æ³•æ‰§â¾ä¹‹å</span></span><br><span class="line">		<span class="comment">//ä¸Šâ¾¯æ‰§â¾ä¸èŠ±æ—¶é—´ã€‚</span></span><br><span class="line">		<span class="keyword">return</span> voidMono; <span class="comment">//æ¸…æ¥šè¿”å›çš„æ˜¯è°ï¼ï¼ï¼ä¸€å®šè¦è¿”å›æœ€åçš„ä¹Ÿå°±æ˜¯finallyçš„æµ</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3ã€R2DBC"><a href="#3ã€R2DBC" class="headerlink" title="3ã€R2DBC"></a>3ã€R2DBC</h3><p>Webã€â½¹ç»œã€IOï¼ˆå­˜å‚¨ï¼‰ã€ä¸­é—´ä»¶ï¼ˆRedisã€MySQLï¼‰</p>
<p>åº”â½¤å¼€å‘ï¼š </p>
<ul>
<li>â½¹ç»œ </li>
<li>å­˜å‚¨ï¼šMySQLã€Redis </li>
<li>Webï¼šWebflux </li>
<li>å‰ç«¯ï¼› åç«¯ï¼šController â€” Service â€” Daoï¼ˆr2dbcï¼›mysqlï¼‰</li>
</ul>
<p>æ•°æ®åº“ï¼š  </p>
<ul>
<li>å¯¼â¼Šé©±åŠ¨ï¼› ä»¥å‰ï¼šJDBCï¼ˆjdbcã€å„â¼¤é©±åŠ¨mysql-connectorï¼‰ï¼› ç°åœ¨ï¼šr2dbcï¼ˆr2dbc-spiã€å„â¼¤ é©±åŠ¨ r2dbc-mysqlï¼‰ </li>
<li>é©±åŠ¨ï¼š <ul>
<li>è·å–è¿æ¥ </li>
<li>å‘é€SQLã€æ‰§â¾ </li>
<li>å°è£…æ•°æ®åº“è¿”å›ç»“æœ</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springdoc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springdoc-openapi-starter-webflux-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-openapi3-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="1ã€R2dbc"><a href="#1ã€R2dbc" class="headerlink" title="1ã€R2dbc"></a>1ã€R2dbc</h5><blockquote>
<p>â½¤æ³•ï¼š </p>
<p>1ã€å¯¼â¼Šé©±åŠ¨: å¯¼â¼Šè¿æ¥æ± ï¼ˆr2dbc-poolï¼‰ã€å¯¼â¼Šé©±åŠ¨ï¼ˆr2dbc-mysql )</p>
<p>2ã€ä½¿â½¤é©±åŠ¨æä¾›çš„APIæ“ä½œ</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.asyncer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>r2dbc-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ TAuthor å®ä½“ç±»å·²å®šä¹‰</span></span><br><span class="line"><span class="comment">// public class TAuthor &#123;</span></span><br><span class="line"><span class="comment">//     private Long id;</span></span><br><span class="line"><span class="comment">//     private String name;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     public TAuthor(Long id, String name) &#123;</span></span><br><span class="line"><span class="comment">//         this.id = id;</span></span><br><span class="line"><span class="comment">//         this.name = name;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     @Override</span></span><br><span class="line"><span class="comment">//     public String toString() &#123;</span></span><br><span class="line"><span class="comment">//         return &quot;TAuthor&#123;id=&quot; + id + &quot;, name=&#x27;&quot; + name + &quot;&#x27;&#125;&quot;;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 0ã€MySQL é…ç½®æ„å»º</span></span><br><span class="line"><span class="type">MySqlConnectionConfiguration</span> <span class="variable">configuration</span> <span class="operator">=</span> MySqlConnectionConfiguration.builder()</span><br><span class="line">        .host(<span class="string">&quot;localhost&quot;</span>)</span><br><span class="line">        .port(<span class="number">3306</span>)</span><br><span class="line">        .username(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">        .password(<span class="string">&quot;123456&quot;</span>)</span><br><span class="line">        .database(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1ã€è·å– MySQL è¿æ¥å·¥å‚</span></span><br><span class="line"><span class="type">MySqlConnectionFactory</span> <span class="variable">connectionFactory</span> <span class="operator">=</span> MySqlConnectionFactory.from(configuration);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2ã€è·å–è¿æ¥å¹¶å‘é€ SQLï¼Œå®ç°æ•°æ®æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">// 3ã€æ„å»ºæ•°æ®å‘å¸ƒè€…ï¼Œè®¢é˜…å¹¶å¤„ç†æŸ¥è¯¢ç»“æœ</span></span><br><span class="line">Mono.from(connectionFactory.create())</span><br><span class="line">        .flatMapMany(connection -&gt;</span><br><span class="line">                connection.createStatement(<span class="string">&quot;select * from t_author where id=?id and name=?name&quot;</span>)</span><br><span class="line">                        .bind(<span class="string">&quot;id&quot;</span>, <span class="number">1L</span>) <span class="comment">// ç»‘å®šå…·åå‚æ•° id</span></span><br><span class="line">                        .bind(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>) <span class="comment">// ç»‘å®šå…·åå‚æ•° name</span></span><br><span class="line">                        .execute()</span><br><span class="line">        )</span><br><span class="line">        .flatMap(result -&gt; &#123;</span><br><span class="line">            <span class="comment">// æ˜ å°„æŸ¥è¯¢ç»“æœåˆ° TAuthor å®ä½“å¯¹è±¡</span></span><br><span class="line">            <span class="keyword">return</span> result.map(readable -&gt; &#123;</span><br><span class="line">                <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> readable.get(<span class="string">&quot;id&quot;</span>, Long.class);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> readable.get(<span class="string">&quot;name&quot;</span>, String.class);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TAuthor</span>(id, name);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .subscribe(tAuthor -&gt; System.out.println(<span class="string">&quot;tAuthor = &quot;</span> + tAuthor));</span><br></pre></td></tr></table></figure>
<h5 id="2ã€Spring-Data-R2DBC"><a href="#2ã€Spring-Data-R2DBC" class="headerlink" title="2ã€Spring Data R2DBC"></a>2ã€Spring Data R2DBC</h5><blockquote>
<p> æ å‡â½£äº§â¼’â½…å¼çš„ å“åº”å¼æ•°æ®åº“æ“ä½œ</p>
</blockquote>
<h6 id="0ã€æ•´åˆ"><a href="#0ã€æ•´åˆ" class="headerlink" title="0ã€æ•´åˆ"></a>0ã€æ•´åˆ</h6><p>1ã€å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.asyncer/r2dbc-mysql --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.asyncer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>r2dbc-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å“åº”å¼Spring Data R2dbc--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-r2dbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¼–å†™é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">r2dbc:</span></span><br><span class="line">		<span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">		<span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">		<span class="attr">url:</span> <span class="string">r2dbc:mysql://localhost:3306/test</span></span><br><span class="line">		<span class="attr">name:</span> <span class="string">test</span></span><br></pre></td></tr></table></figure>
<h6 id="1ã€å£°æ˜å¼æ¥å£ï¼šR2dbcRepository"><a href="#1ã€å£°æ˜å¼æ¥å£ï¼šR2dbcRepository" class="headerlink" title="1ã€å£°æ˜å¼æ¥å£ï¼šR2dbcRepository"></a>1ã€å£°æ˜å¼æ¥å£ï¼šR2dbcRepository</h6><p><strong>Repositoryæ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AuthorRepositories</span> <span class="keyword">extends</span> <span class="title class_">R2dbcRepository</span>&lt;TAuthor, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤ç»§æ‰¿äº†ä¸€å †CRUDæ–¹æ³•ï¼›ç±»ä¼¼mybatis-plusçš„åŸºç¡€CRUDåŠŸèƒ½</span></span><br><span class="line">    <span class="comment">// QBCï¼šQuery By Criteriaï¼ˆæŒ‰æ¡ä»¶æŸ¥è¯¢ï¼‰</span></span><br><span class="line">    <span class="comment">// QBEï¼šQuery By Exampleï¼ˆæŒ‰ç¤ºä¾‹æŸ¥è¯¢ï¼‰</span></span><br><span class="line">    <span class="comment">// æˆä¸ºä¸€ä¸ªèµ·åå·¥ç¨‹å¸ˆï¼šæ–¹æ³•åå¯¹åº”SQLæ¡ä»¶ where id In () and name like ?</span></span><br><span class="line">    <span class="comment">// ä»…é™å•è¡¨å¤æ‚æ¡ä»¶æŸ¥è¯¢ï¼šé€šè¿‡æ–¹æ³•åè‡ªåŠ¨ç”ŸæˆSQL</span></span><br><span class="line">    Flux&lt;TAuthor&gt; <span class="title function_">findAllByIdInAndNameLike</span><span class="params">(Collection&lt;Long&gt; id, String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤šè¡¨å¤æ‚æŸ¥è¯¢ï¼šéœ€è‡ªå®šä¹‰SQLæˆ–å®ç°ç±»ï¼ˆæ–¹æ³•åæ— æ³•è‡ªåŠ¨ç”Ÿæˆå¤šè¡¨å…³è”SQLï¼‰</span></span><br><span class="line">    Flux&lt;TAuthor&gt; <span class="title function_">findHaha</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰SQLæŸ¥è¯¢ï¼šé€šè¿‡<span class="doctag">@Query</span>æ³¨è§£æŒ‡å®šSQLè¯­å¥</span></span><br><span class="line"><span class="comment">     * æ”¯æŒå…³è”æŸ¥è¯¢åœºæ™¯ï¼š</span></span><br><span class="line"><span class="comment">     * 1. ä¸€å¯¹ä¸€å…³è”ï¼ˆ1-1ï¼‰ï¼šä¸€ä¸ªå›¾ä¹¦æœ‰å”¯ä¸€ä½œè€…</span></span><br><span class="line"><span class="comment">     * 2. ä¸€å¯¹å¤šå…³è”ï¼ˆ1-Nï¼‰ï¼šä¸€ä¸ªä½œè€…å¯ä»¥æœ‰å¾ˆå¤šå›¾ä¹¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Query(&quot;select * from t_author&quot;)</span></span><br><span class="line">    Flux&lt;TAuthor&gt; <span class="title function_">findAllByCustomSql</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è‡ªå®šä¹‰Converter</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¯»å–æ•°æ®åº“æ•°æ®æ—¶çš„è½¬æ¢å™¨ï¼šå°†æ•°æ®åº“æŸ¥è¯¢è¿”å›çš„ Rowï¼ˆç»“æœè¡Œï¼‰ è½¬æ¢ä¸º TBook å®ä½“å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ReadingConverter</span>ï¼šæ ‡è®°ä¸ºã€Œè¯»å–è½¬æ¢å™¨ã€ï¼ˆæ•°æ®åº“ â†’ åº”ç”¨ç¨‹åºï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ReadingConverter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;Row, TBook&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> TBook <span class="title function_">convert</span><span class="params">(Row source)</span> &#123;</span><br><span class="line">        <span class="comment">// ç©ºå€¼åˆ¤æ–­ï¼šè‹¥æºæ•°æ® Row ä¸º nullï¼Œç›´æ¥è¿”å› null</span></span><br><span class="line">        <span class="keyword">if</span> (source == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. è‡ªå®šä¹‰å°è£… TBook åŸºç¡€å±æ€§</span></span><br><span class="line">        <span class="type">TBook</span> <span class="variable">tBook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TBook</span>();</span><br><span class="line">        tBook.setId(source.get(<span class="string">&quot;id&quot;</span>, Long.class));</span><br><span class="line">        tBook.setTitle(source.get(<span class="string">&quot;title&quot;</span>, String.class));</span><br><span class="line">        <span class="type">Long</span> <span class="variable">author_id</span> <span class="operator">=</span> source.get(<span class="string">&quot;author_id&quot;</span>, Long.class);</span><br><span class="line">        tBook.setAuthorId(author_id);</span><br><span class="line">        <span class="comment">// æ³¨é‡Šä¿ç•™ï¼šå¦‚éœ€å°è£…å‘å¸ƒæ—¶é—´ï¼Œå¯è§£é™¤æ³¨é‡Šå¹¶ç¡®ä¿æ•°æ®åº“å­—æ®µç±»å‹åŒ¹é…</span></span><br><span class="line">        <span class="comment">// tBook.setPublishTime(source.get(&quot;publish_time&quot;, Instant.class));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. å°è£…å…³è”çš„ TAuthor å®ä½“ï¼Œå¹¶è®¾ç½®åˆ° TBook ä¸­</span></span><br><span class="line">        <span class="type">TAuthor</span> <span class="variable">tAuthor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TAuthor</span>();</span><br><span class="line">        tAuthor.setId(author_id);</span><br><span class="line">        tAuthor.setName(source.get(<span class="string">&quot;name&quot;</span>, String.class));</span><br><span class="line">        tBook.setAuthor(tAuthor);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…³é”®ä¿®æ­£ï¼šè¿”å›å°è£…å®Œæˆçš„ TBook å¯¹è±¡ï¼ˆåŸå§‹ä»£ç è¿”å› null ä¼šå¯¼è‡´è½¬æ¢å¤±æ•ˆï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> tBook;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é…ç½®ç”Ÿæ•ˆ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableR2dbcRepositories</span> <span class="comment">//å¼€å¯R2dbc ä»“åº“åŠŸèƒ½ï¼›jpa</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">R2DbcConfiguration</span> &#123;</span><br><span class="line"><span class="meta">@Bean</span> <span class="comment">//æ›¿æ¢å®¹å™¨ä¸­åŸæ¥çš„</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line"><span class="keyword">public</span> R2dbcCustomConversions <span class="title function_">conversions</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="comment">//æŠŠæˆ‘ä»¬çš„è½¬æ¢å™¨åŠ â¼Šè¿›å»ï¼›æ•ˆæœæ–°å¢äº†æˆ‘ä»¬çš„Converter</span></span><br><span class="line">	<span class="keyword">return</span> R2dbcCustomConversions.of(MySqlDialect.INSTANCE,<span class="keyword">new</span> <span class="title class_">BookConverter</span>());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="2ã€ç¼–ç¨‹å¼ç»„ä»¶"><a href="#2ã€ç¼–ç¨‹å¼ç»„ä»¶" class="headerlink" title="2ã€ç¼–ç¨‹å¼ç»„ä»¶"></a>2ã€ç¼–ç¨‹å¼ç»„ä»¶</h6><ul>
<li>R2dbcEntityTemplate </li>
<li>DatabaseClient</li>
</ul>
<h5 id="3ã€æ¡ˆä¾‹ç»ƒä¹ "><a href="#3ã€æ¡ˆä¾‹ç»ƒä¹ " class="headerlink" title="3ã€æ¡ˆä¾‹ç»ƒä¹ "></a>3ã€æ¡ˆä¾‹ç»ƒä¹ </h5><p><strong>1-1 å…³è”æŸ¥è¯¢ï¼ˆå›¾ä¹¦ - ä½œè€…ï¼šä¸€æœ¬å›¾ä¹¦å¯¹åº”ä¸€ä¸ªä½œè€…ï¼‰</strong></p>
<p><strong>æ–¹å¼ 1ï¼šè‡ªå®šä¹‰ <code>Converter&lt;Row, Bean&gt;</code> + æ³¨å†Œè½¬æ¢å™¨</strong></p>
<ol>
<li>è‡ªå®šä¹‰è¯»å–è½¬æ¢å™¨ï¼ˆæ•°æ®åº“ â†’ åº”ç”¨å±‚å®ä½“ï¼‰</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1-1 å…³è”è½¬æ¢ï¼šå°†æ•°æ®åº“æŸ¥è¯¢çš„ Row ç»“æœè½¬æ¢ä¸º TBook å®ä½“ï¼ˆåŒ…å«å…³è”çš„ TAuthorï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ReadingConverter</span>ï¼šæ ‡è®°ä¸ºè¯»å–è½¬æ¢å™¨ï¼ˆä»æ•°æ®åº“è¯»å–æ•°æ®æ—¶è§¦å‘ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ReadingConverter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;Row, TBook&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> TBook <span class="title function_">convert</span><span class="params">(Row source)</span> &#123;</span><br><span class="line">        <span class="comment">// ç©ºå€¼åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span> (source == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è£… TBook åŸºç¡€å±æ€§</span></span><br><span class="line">        <span class="type">TBook</span> <span class="variable">tBook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TBook</span>();</span><br><span class="line">        tBook.setId(source.get(<span class="string">&quot;id&quot;</span>, Long.class));</span><br><span class="line">        tBook.setTitle(source.get(<span class="string">&quot;title&quot;</span>, String.class));</span><br><span class="line">        <span class="type">Long</span> <span class="variable">authorId</span> <span class="operator">=</span> source.get(<span class="string">&quot;author_id&quot;</span>, Long.class);</span><br><span class="line">        tBook.setAuthorId(authorId);</span><br><span class="line">        <span class="comment">// å¯é€‰ï¼šå°è£…å‘å¸ƒæ—¶é—´ï¼ˆéœ€ç¡®ä¿æ•°æ®åº“å­—æ®µç±»å‹ä¸ Instant åŒ¹é…ï¼‰</span></span><br><span class="line">        <span class="comment">// tBook.setPublishTime(source.get(&quot;publish_time&quot;, Instant.class));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è£…å…³è”çš„ TAuthor å®ä½“ï¼ˆ1-1 å…³è”ï¼‰</span></span><br><span class="line">        <span class="type">TAuthor</span> <span class="variable">tAuthor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TAuthor</span>();</span><br><span class="line">        tAuthor.setId(authorId);</span><br><span class="line">        tAuthor.setName(source.get(<span class="string">&quot;name&quot;</span>, String.class));</span><br><span class="line">        tBook.setAuthor(tAuthor);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> tBook;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>æ³¨å†Œè‡ªå®šä¹‰è½¬æ¢å™¨</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³¨å†Œ R2DBC è‡ªå®šä¹‰è½¬æ¢å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">R2dbcConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    R2dbcCustomConversions <span class="title function_">r2dbcCustomConversions</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å­˜æ”¾æ‰€æœ‰è‡ªå®šä¹‰è½¬æ¢å™¨</span></span><br><span class="line">        List&lt;Converter&lt;?, ?&gt;&gt; converters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        converters.add(<span class="keyword">new</span> <span class="title class_">BookConverter</span>()); <span class="comment">// æ·»åŠ å›¾ä¹¦-ä½œè€…å…³è”è½¬æ¢å™¨</span></span><br><span class="line">        <span class="comment">// æŒ‡å®š MySQL æ–¹è¨€å¹¶è¿”å›è‡ªå®šä¹‰è½¬æ¢é…ç½®</span></span><br><span class="line">        <span class="keyword">return</span> R2dbcCustomConversions.of(MySqlDialect.INSTANCE, converters);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>ä½¿ç”¨è½¬æ¢å™¨æŸ¥è¯¢æ•°æ®</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨ Repository æ–¹æ³•ï¼ˆéœ€è‡ªå®šä¹‰ @Query æ³¨è§£æŒ‡å®šå…³è”æŸ¥è¯¢ SQLï¼‰</span></span><br><span class="line">bookRepostory.hahaBook(<span class="number">1L</span>)</span><br><span class="line">        .subscribe(tBook -&gt; System.out.println(<span class="string">&quot;tBook = &quot;</span> + tBook));</span><br></pre></td></tr></table></figure>
<p><strong>æ–¹å¼ 2ï¼šç¼–ç¨‹å¼å°è£… - ä½¿ç”¨ <code>DatabaseClient</code>ï¼ˆåº•å±‚ API æ–¹å¼ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1-1 å…³è”æŸ¥è¯¢ï¼šä½¿ç”¨ DatabaseClient æ‰‹åŠ¨å°è£…ç»“æœé›†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryBookWithAuthorById</span><span class="params">(Long bookId)</span> &#123;</span><br><span class="line">    databaseClient.sql(<span class="string">&quot;select b.*, t.name as name &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;from t_book b &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;LEFT JOIN t_author t on b.author_id = t.id &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;WHERE b.id = ?&quot;</span>)</span><br><span class="line">            .bind(<span class="number">0</span>, bookId) <span class="comment">// ç»‘å®šå ä½ç¬¦å‚æ•°</span></span><br><span class="line">            .fetch() <span class="comment">// è·å–æŸ¥è¯¢ç»“æœ</span></span><br><span class="line">            .all() <span class="comment">// è¿”å›æ‰€æœ‰ç»“æœï¼ˆFlux&lt;Map&lt;String, Object&gt;&gt;ï¼‰</span></span><br><span class="line">            .map(row -&gt; &#123;</span><br><span class="line">                <span class="comment">// æ‰‹åŠ¨å°è£… TBook å®ä½“</span></span><br><span class="line">                <span class="type">TBook</span> <span class="variable">tBook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TBook</span>();</span><br><span class="line">                tBook.setId(Long.parseLong(row.get(<span class="string">&quot;id&quot;</span>).toString()));</span><br><span class="line">                tBook.setTitle(row.get(<span class="string">&quot;title&quot;</span>).toString());</span><br><span class="line">                <span class="type">String</span> <span class="variable">authorIdStr</span> <span class="operator">=</span> row.get(<span class="string">&quot;author_id&quot;</span>).toString();</span><br><span class="line">                <span class="type">Long</span> <span class="variable">authorId</span> <span class="operator">=</span> Long.parseLong(authorIdStr);</span><br><span class="line">                tBook.setAuthorId(authorId);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ‰‹åŠ¨å°è£…å…³è”çš„ TAuthor å®ä½“ï¼ˆ1-1 å…³è”ï¼‰</span></span><br><span class="line">                <span class="type">TAuthor</span> <span class="variable">tAuthor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TAuthor</span>();</span><br><span class="line">                tAuthor.setId(authorId);</span><br><span class="line">                tAuthor.setName(row.get(<span class="string">&quot;name&quot;</span>).toString());</span><br><span class="line">                tBook.setAuthor(tAuthor);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> tBook;</span><br><span class="line">            &#125;)</span><br><span class="line">            .subscribe(tBook -&gt; System.out.println(<span class="string">&quot;tBook = &quot;</span> + tBook)); <span class="comment">// è®¢é˜…æ¶ˆè´¹ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>1-N å…³è”æŸ¥è¯¢ï¼ˆä½œè€… - å›¾ä¹¦ï¼šä¸€ä¸ªä½œè€…å¯¹åº”å¤šæœ¬å›¾ä¹¦ï¼‰</strong></p>
<p>æ ¸å¿ƒå®ç°ï¼š<code>DatabaseClient</code> + <code>bufferUntilChanged</code> åˆ†ç»„å°è£…</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1-N å…³è”æŸ¥è¯¢ï¼šä½¿ç”¨ DatabaseClient + bufferUntilChanged å®ç°åˆ†ç»„å°è£…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">R2dbcOneNTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">oneToN</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Flux&lt;TAuthor&gt; authorFlux = databaseClient.sql(<span class="string">&quot;select a.id aid, a.name, b.* &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;from t_author a &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;left join t_book b on a.id = b.author_id &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;order by a.id&quot;</span>) <span class="comment">// å¿…é¡»æŒ‰ä½œè€…IDæ’åºï¼Œç¡®ä¿åˆ†ç»„æœ‰æ•ˆ</span></span><br><span class="line">                .fetch()</span><br><span class="line">                .all()</span><br><span class="line">                <span class="comment">// æŒ‰ä½œè€…IDåˆ†ç»„ï¼šå½“ aid å˜åŒ–æ—¶ï¼Œåˆ›å»ºæ–°çš„ buffer å­˜å‚¨æ•°æ®</span></span><br><span class="line">                .bufferUntilChanged(rowMap -&gt; Long.parseLong(rowMap.get(<span class="string">&quot;aid&quot;</span>).toString()))</span><br><span class="line">                .map(rowList -&gt; &#123;</span><br><span class="line">                    <span class="comment">// å°è£… TAuthor åŸºç¡€å±æ€§ï¼ˆå–åˆ†ç»„ä¸­ç¬¬ä¸€æ¡æ•°æ®çš„ä½œè€…ä¿¡æ¯ï¼‰</span></span><br><span class="line">                    <span class="type">TAuthor</span> <span class="variable">tAuthor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TAuthor</span>();</span><br><span class="line">                    Map&lt;String, Object&gt; firstRow = rowList.get(<span class="number">0</span>);</span><br><span class="line">                    <span class="type">Long</span> <span class="variable">authorId</span> <span class="operator">=</span> Long.parseLong(firstRow.get(<span class="string">&quot;aid&quot;</span>).toString());</span><br><span class="line">                    tAuthor.setId(authorId);</span><br><span class="line">                    tAuthor.setName(firstRow.get(<span class="string">&quot;name&quot;</span>).toString());</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// å°è£…è¯¥ä½œè€…å¯¹åº”çš„æ‰€æœ‰å›¾ä¹¦ï¼ˆ1-N å…³è”ï¼‰</span></span><br><span class="line">                    List&lt;TBook&gt; bookList = rowList.stream()</span><br><span class="line">                            .map(row -&gt; &#123;</span><br><span class="line">                                <span class="comment">// è¿‡æ»¤æ— æ•ˆå›¾ä¹¦æ•°æ®ï¼ˆå·¦è¿æ¥å¯èƒ½å¯¼è‡´å›¾ä¹¦å­—æ®µä¸º nullï¼‰</span></span><br><span class="line">                                <span class="keyword">if</span> (row.get(<span class="string">&quot;id&quot;</span>) == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="type">TBook</span> <span class="variable">tBook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TBook</span>();</span><br><span class="line">                                tBook.setId(Long.parseLong(row.get(<span class="string">&quot;id&quot;</span>).toString()));</span><br><span class="line">                                tBook.setAuthorId(authorId);</span><br><span class="line">                                tBook.setTitle(row.get(<span class="string">&quot;title&quot;</span>).toString());</span><br><span class="line">                                <span class="keyword">return</span> tBook;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .filter(book -&gt; book != <span class="literal">null</span>) <span class="comment">// å‰”é™¤ null æ•°æ®</span></span><br><span class="line">                            .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">                    tAuthor.setBooks(bookList); <span class="comment">// è®¾ç½®ä½œè€…å…³è”çš„å›¾ä¹¦åˆ—è¡¨</span></span><br><span class="line">                    <span class="keyword">return</span> tAuthor;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¢é˜…æ¶ˆè´¹ç»“æœ</span></span><br><span class="line">        authorFlux.subscribe(tAuthor -&gt; System.out.println(<span class="string">&quot;tAuthor = &quot;</span> + tAuthor));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é˜»å¡ä¸»çº¿ç¨‹ï¼Œé˜²æ­¢æµ‹è¯•æ–¹æ³•æå‰ç»“æŸï¼ˆä»…æµ‹è¯•ç¯å¢ƒä½¿ç”¨ï¼‰</span></span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æœ€ä½³å®è·µ</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åœºæ™¯ç±»å‹</th>
<th>æ¨èå®ç°æ–¹å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºç¡€ CRUD æ“ä½œ</td>
<td>ç›´æ¥ç»§æ‰¿ <code>R2dbcRepository&lt;T, ID&gt;</code>ï¼Œä½¿ç”¨é»˜è®¤æä¾›çš„æ–¹æ³•ï¼ˆå¦‚ <code>save</code>ã€<code>findAll</code>ã€<code>deleteById</code>ï¼‰ï¼Œç±»ä¼¼ MyBatis-Plus åŸºç¡€åŠŸèƒ½</td>
</tr>
<tr>
<td>å•è¡¨å¤æ‚æŸ¥è¯¢ï¼ˆè‡ªå®šä¹‰ SQLï¼‰</td>
<td>ä½¿ç”¨ <code>@Query</code> æ³¨è§£åœ¨ Repository æ¥å£ä¸­è‡ªå®šä¹‰ SQLï¼Œæ”¯æŒå…·åå‚æ•° / å ä½ç¬¦å‚æ•°ï¼Œæ— éœ€æ‰‹åŠ¨å°è£…ç®€å•ç»“æœé›†</td>
</tr>
<tr>
<td>å¤šè¡¨å…³è”æŸ¥è¯¢ï¼ˆ1-1 / 1-Nï¼‰</td>
<td>1. è‡ªå®šä¹‰ <code>@Query</code> + <code>@ReadingConverter</code>ï¼šé€šè¿‡è½¬æ¢å™¨è‡ªåŠ¨å°è£…å…³è”ç»“æœé›†ï¼ˆä¼˜é›…ç®€æ´ï¼‰2. <code>DatabaseClient</code>ï¼šåº•å±‚ APIï¼Œæ‰‹åŠ¨å°è£…ç»“æœé›†ï¼ˆçµæ´»ï¼Œæ”¯æŒå¤æ‚ SQLï¼‰</td>
</tr>
<tr>
<td>ç»“æœå°è£…å¯¹æ¯”ï¼ˆä¸ MyBatisï¼‰</td>
<td>Spring Data R2DBCï¼š<code>Converter</code> / <code>DatabaseClient</code> æ‰‹åŠ¨å°è£…MyBatisï¼š<code>ResultMap</code> æ ‡ç­¾é…ç½®å°è£…</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>ç®€å•ä¸šåŠ¡ä¼˜å…ˆä½¿ç”¨ <code>R2dbcRepository</code> + <code>@Query</code>ï¼Œæå‡å¼€å‘æ•ˆç‡ï¼›</li>
<li>å¤šè¡¨å…³è”æŸ¥è¯¢å¿…é¡»è‡ªå®šä¹‰ç»“æœé›†å°è£…ï¼ˆæ— è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼‰ï¼Œå¯é€‰ã€Œè½¬æ¢å™¨ã€æˆ–ã€ŒDatabaseClientã€ï¼›</li>
<li>1-N å…³è”æŸ¥è¯¢æ—¶ï¼Œéœ€å…ˆæŒ‰ä¸»è¡¨ ID æ’åºï¼Œå†é€šè¿‡ <code>bufferUntilChanged</code> åˆ†ç»„ï¼Œé¿å…æ•°æ®é”™ä¹±ï¼›</li>
<li>æ³¨æ„å¯¹è±¡æ¯”è¾ƒä¸æ•°å­—ç¼“å­˜ï¼šLong ç±»å‹ç¼“å­˜èŒƒå›´ä¸º <code>-128 ~ 127</code>ï¼Œè‡ªå®šä¹‰å¯¹è±¡æ¯”è¾ƒéœ€é‡å†™ <code>equals</code> æ–¹æ³•ã€‚</li>
</ol>
<h3 id="4ã€Spring-Security-Reactive"><a href="#4ã€Spring-Security-Reactive" class="headerlink" title="4ã€Spring Security Reactive"></a>4ã€Spring Security Reactive</h3><blockquote>
<p>â½¬æ ‡ï¼š SpringBoot +  Webflux + Spring Data R2DBC + Spring Security</p>
</blockquote>
<h4 id="1ã€æ•´åˆ"><a href="#1ã€æ•´åˆ" class="headerlink" title="1ã€æ•´åˆ"></a>1ã€æ•´åˆ</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- R2DBC MySQL é©±åŠ¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.asyncer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>r2dbc-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å“åº”å¼ Spring Data R2DBC --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-r2dbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å“åº”å¼ Webï¼ˆWebFluxï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æµ‹è¯•ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Security å®‰å…¨æ¡†æ¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Lombok ç®€åŒ–ä»£ç  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2ã€æ ¸å¿ƒæ¦‚å¿µè¯´æ˜"><a href="#2ã€æ ¸å¿ƒæ¦‚å¿µè¯´æ˜" class="headerlink" title="2ã€æ ¸å¿ƒæ¦‚å¿µè¯´æ˜"></a>2ã€æ ¸å¿ƒæ¦‚å¿µè¯´æ˜</h4><h5 id="åº”ç”¨å®‰å…¨æ ¸å¿ƒèƒ½åŠ›"><a href="#åº”ç”¨å®‰å…¨æ ¸å¿ƒèƒ½åŠ›" class="headerlink" title="åº”ç”¨å®‰å…¨æ ¸å¿ƒèƒ½åŠ›"></a>åº”ç”¨å®‰å…¨æ ¸å¿ƒèƒ½åŠ›</h5><ul>
<li><strong>é˜²æ­¢æ”»å‡»</strong>ï¼šæŠµå¾¡ DDoSã€CSRFã€XSSã€SQL æ³¨å…¥ç­‰å¸¸è§å®‰å…¨æ”»å‡»</li>
<li><strong>æƒé™æ§åˆ¶</strong>ï¼šç®¡æ§ç™»å½•ç”¨æˆ·çš„æ“ä½œèŒƒå›´ï¼Œé˜²æ­¢è¶Šæƒè®¿é—®</li>
<li><strong>ä¼ è¾“åŠ å¯†</strong>ï¼šæ”¯æŒ HTTPSã€X509 ç­‰åŠ å¯†æ–¹å¼ä¿éšœä¼ è¾“å®‰å…¨</li>
<li><strong>è®¤è¯æˆæƒ</strong>ï¼šæ”¯æŒ OAuth2.0ã€JWT ç­‰ä¸»æµè®¤è¯æˆæƒæ–¹æ¡ˆ</li>
</ul>
<h5 id="RBAC-æƒé™æ¨¡å‹"><a href="#RBAC-æƒé™æ¨¡å‹" class="headerlink" title="RBAC æƒé™æ¨¡å‹"></a>RBAC æƒé™æ¨¡å‹</h5><ul>
<li><strong>å…¨ç§°</strong>ï¼šRole Based Access Controlï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰</li>
<li><strong>æ ¸å¿ƒå…³ç³»</strong>ï¼š</li>
</ul>
<ol>
<li>ä¸€ä¸ªç”¨æˆ·å¯å…³è”å¤šä¸ªè§’è‰²</li>
<li>ä¸€ä¸ªè§’è‰²å¯å…³è”å¤šä¸ªæƒé™</li>
<li>ç”¨æˆ·çš„æ“ä½œæƒé™ = å…¶å…³è”æ‰€æœ‰è§’è‰²çš„æƒé™é›†åˆ</li>
</ol>
<ul>
<li><strong>æ§åˆ¶é€»è¾‘</strong>ï¼š</li>
</ul>
<ol>
<li>ç»™ç³»ç»Ÿæ–¹æ³•é…ç½®æ‰€éœ€æƒé™ / è§’è‰²</li>
<li>ç”¨æˆ·æ‰§è¡Œæ–¹æ³•æ—¶ï¼Œæ¡†æ¶è‡ªåŠ¨æ ¡éªŒç”¨æˆ·æ˜¯å¦æ‹¥æœ‰å¯¹åº”æƒé™ / è§’è‰²</li>
<li>æ ¡éªŒé€šè¿‡åˆ™å…è®¸æ‰§è¡Œï¼Œå¦åˆ™æ‹’ç»è®¿é—®</li>
</ol>
<h5 id="æƒé™æ¡†æ¶æ ¸å¿ƒæµç¨‹"><a href="#æƒé™æ¡†æ¶æ ¸å¿ƒæµç¨‹" class="headerlink" title="æƒé™æ¡†æ¶æ ¸å¿ƒæµç¨‹"></a>æƒé™æ¡†æ¶æ ¸å¿ƒæµç¨‹</h5><ol>
<li><strong>è®¤è¯ï¼ˆAuthenticateï¼‰</strong>ï¼šç”¨æˆ·é€šè¿‡è´¦å·å¯†ç ç­‰æ–¹å¼ç™»å½•ç³»ç»Ÿï¼ŒéªŒè¯èº«ä»½åˆæ³•æ€§</li>
<li><strong>æˆæƒï¼ˆAuthorizeï¼‰</strong>ï¼šæŸ¥è¯¢ç™»å½•ç”¨æˆ·çš„è§’è‰²ä¸æƒé™ï¼Œæ‰§è¡Œæ–¹æ³•æ—¶æ ¡éªŒæƒé™åŒ¹é…æ€§</li>
<li><strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼šSpring Security æä¾›è®¤è¯ã€æˆæƒã€å®‰å…¨é˜²æŠ¤çš„å…¨å¥—èƒ½åŠ›</li>
</ol>
<h4 id="3ã€ä»£ç å®ç°"><a href="#3ã€ä»£ç å®ç°" class="headerlink" title="3ã€ä»£ç å®ç°"></a>3ã€ä»£ç å®ç°</h4><h5 id="1ã€å®‰å…¨é…ç½®ç±»"><a href="#1ã€å®‰å…¨é…ç½®ç±»" class="headerlink" title="1ã€å®‰å…¨é…ç½®ç±»"></a>1ã€å®‰å…¨é…ç½®ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Spring Security å“åº”å¼å®‰å…¨é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableReactiveMethodSecurity</span> <span class="comment">// å¼€å¯å“åº”å¼åŸºäºæ–¹æ³•çº§åˆ«çš„æƒé™æ§åˆ¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppSecurityConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ReactiveUserDetailsService appReactiveUserDetailsService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®å®‰å…¨è¿‡æ»¤é“¾ï¼šå®šä¹‰èµ„æºè®¿é—®è§„åˆ™ã€ç™»å½•æ–¹å¼ç­‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    SecurityWebFilterChain <span class="title function_">springSecurityFilterChain</span><span class="params">(ServerHttpSecurity http)</span> &#123;</span><br><span class="line">        <span class="comment">// 1ã€å®šä¹‰å“ªäº›è¯·æ±‚éœ€è¦è®¤è¯ï¼Œå“ªäº›ä¸éœ€è¦</span></span><br><span class="line">        http.authorizeExchange(authorize -&gt; &#123;</span><br><span class="line">            <span class="comment">// 1.1ã€å…è®¸æ‰€æœ‰äººè®¿é—®é™æ€èµ„æº</span></span><br><span class="line">            authorize.matchers(PathRequest.toStaticResources()</span><br><span class="line">                    .atCommonLocations()).permitAll();</span><br><span class="line">            <span class="comment">// 1.2ã€å‰©ä¸‹çš„æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è®¤è¯ï¼ˆç™»å½•åæ‰å¯è®¿é—®ï¼‰</span></span><br><span class="line">            authorize.anyExchange().authenticated();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å¼€å¯é»˜è®¤çš„è¡¨å•ç™»å½•</span></span><br><span class="line">        http.formLogin(formLoginSpec -&gt; &#123;</span><br><span class="line">            <span class="comment">// è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">            <span class="comment">// formLoginSpec.loginPage(&quot;/haha&quot;);</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€å…³é—­CSRFé˜²æŠ¤ï¼ˆé€‚ç”¨äºéæµè§ˆå™¨å®¢æˆ·ç«¯/å‰åç«¯åˆ†ç¦»åœºæ™¯ï¼‰</span></span><br><span class="line">        http.csrf(csrfSpec -&gt; &#123;</span><br><span class="line">            csrfSpec.disable();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4ã€é…ç½®è®¤è¯è§„åˆ™ï¼šä½¿ç”¨è‡ªå®šä¹‰çš„ç”¨æˆ·è¯¦æƒ…æœåŠ¡æŸ¥è¯¢æ•°æ®åº“ç”¨æˆ·</span></span><br><span class="line">        http.authenticationManager(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">UserDetailsRepositoryReactiveAuthenticationManager</span>(</span><br><span class="line">                        appReactiveUserDetailsService)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„å»ºå¹¶è¿”å›å®‰å…¨é…ç½®</span></span><br><span class="line">        <span class="keyword">return</span> http.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®å¯†ç ç¼–ç å™¨ï¼šç”¨äºå¯†ç åŠ å¯†ä¸æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    PasswordEncoder <span class="title function_">passwordEncoder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">PasswordEncoder</span> <span class="variable">encoder</span> <span class="operator">=</span> PasswordEncoderFactories.createDelegatingPasswordEncoder();</span><br><span class="line">        <span class="keyword">return</span> encoder;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2ã€è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡"><a href="#2ã€è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡" class="headerlink" title="2ã€è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡"></a>2ã€è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªå®šä¹‰å“åº”å¼ç”¨æˆ·è¯¦æƒ…æœåŠ¡ï¼šä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ã€è§’è‰²ã€æƒé™ä¿¡æ¯</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppReactiveUserDetailsService</span> <span class="keyword">implements</span> <span class="title class_">ReactiveUserDetailsService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DatabaseClient databaseClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    PasswordEncoder passwordEncoder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·è¯¦æƒ…ï¼ˆè´¦å·ã€å¯†ç ã€è§’è‰²ã€æƒé™ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;UserDetails&gt; <span class="title function_">findByUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»æ•°æ®åº“å…³è”æŸ¥è¯¢ç”¨æˆ·ã€è§’è‰²ã€æƒé™ä¿¡æ¯</span></span><br><span class="line">        Mono&lt;UserDetails&gt; userDetailsMono = databaseClient.sql(<span class="string">&quot;select u.*,r.id rid,r.name,r.value,&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;pm.id pid,pm.value pvalue,pm.description &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;from t_user u &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;left join t_user_role ur on ur.user_id=u.id &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;left join t_roles r on r.id = ur.role_id &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;left join t_role_perm rp on rp.role_id=r.id &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;left join t_perm pm on rp.perm_id=pm.id &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;where u.username = ? limit 1&quot;</span>)</span><br><span class="line">                .bind(<span class="number">0</span>, username)</span><br><span class="line">                .fetch()</span><br><span class="line">                .one() <span class="comment">// æŸ¥è¯¢å•æ¡ç»“æœ</span></span><br><span class="line">                .map(map -&gt; &#123;</span><br><span class="line">                    <span class="comment">// æ„å»º UserDetails å¯¹è±¡ï¼ˆå°è£…ç”¨æˆ·ä¿¡æ¯ã€è§’è‰²ã€æƒé™ï¼‰</span></span><br><span class="line">                    <span class="type">UserDetails</span> <span class="variable">details</span> <span class="operator">=</span> User.builder()</span><br><span class="line">                            .username(username)</span><br><span class="line">                            .password(map.get(<span class="string">&quot;password&quot;</span>).toString()) <span class="comment">// æ•°æ®åº“ä¸­å·²åŠ å¯†çš„å¯†ç </span></span><br><span class="line">                            .roles(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;sale&quot;</span>, <span class="string">&quot;haha&quot;</span>, <span class="string">&quot;delete&quot;</span>) <span class="comment">// è§’è‰²ï¼ˆè‡ªåŠ¨æ·»åŠ  ROLE_ å‰ç¼€ï¼‰</span></span><br><span class="line">                            <span class="comment">// .authorities(new SimpleGrantedAuthority(&quot;ROLE_delete&quot;)) // æ‰‹åŠ¨æŒ‡å®šæƒé™/è§’è‰²</span></span><br><span class="line">                            .build();</span><br><span class="line">                    <span class="comment">// è§’è‰²é»˜è®¤å¸¦ ROLE_ å‰ç¼€ï¼Œæƒé™æ— å‰ç¼€ï¼›hasRole() å¯¹åº”è§’è‰²ï¼ŒhasAuthority() å¯¹åº”æƒé™</span></span><br><span class="line">                    <span class="keyword">return</span> details;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userDetailsMono;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3ã€æµ‹è¯•æ§åˆ¶å™¨"><a href="#3ã€æµ‹è¯•æ§åˆ¶å™¨" class="headerlink" title="3ã€æµ‹è¯•æ§åˆ¶å™¨"></a>3ã€æµ‹è¯•æ§åˆ¶å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éœ€æ‹¥æœ‰ admin è§’è‰²æ‰å¯è®¿é—®ï¼ˆ<span class="doctag">@PreAuthorize</span> æ–¹æ³•çº§æƒé™æ§åˆ¶ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;hasRole(&#x27;admin&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.just(<span class="string">&quot;hello world!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éœ€æ‹¥æœ‰ delete è§’è‰²æ‰å¯è®¿é—®ï¼ˆè§’è‰²è‡ªåŠ¨æ‹¼æ¥ ROLE_ å‰ç¼€ï¼Œå®é™…æ ¡éªŒ ROLE_deleteï¼‰</span></span><br><span class="line"><span class="comment">     * æ”¯æŒå¤æ‚ SpEL è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PreAuthorize(&quot;hasRole(&#x27;delete&#x27;)&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/world&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">world</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.just(<span class="string">&quot;world!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4ã€å…³é”®è¯´æ˜"><a href="#4ã€å…³é”®è¯´æ˜" class="headerlink" title="4ã€å…³é”®è¯´æ˜"></a>4ã€å…³é”®è¯´æ˜</h4><h5 id="1ã€æ ¸å¿ƒæ³¨è§£"><a href="#1ã€æ ¸å¿ƒæ³¨è§£" class="headerlink" title="1ã€æ ¸å¿ƒæ³¨è§£"></a>1ã€æ ¸å¿ƒæ³¨è§£</h5><ul>
<li><code>@EnableReactiveMethodSecurity</code>ï¼šå¼€å¯ WebFlux å“åº”å¼ç¯å¢ƒä¸‹çš„æ–¹æ³•çº§æƒé™æ§åˆ¶</li>
<li><code>@PreAuthorize</code>ï¼šæ–¹æ³•æ‰§è¡Œå‰æ ¡éªŒæƒé™ï¼Œæ”¯æŒ SpEL è¡¨è¾¾å¼ï¼ˆ<code>hasRole()</code> æ ¡éªŒè§’è‰²ã€<code>hasAuthority()</code> æ ¡éªŒæƒé™ï¼‰</li>
</ul>
<h5 id="2ã€å¯†ç å¤„ç†"><a href="#2ã€å¯†ç å¤„ç†" class="headerlink" title="2ã€å¯†ç å¤„ç†"></a>2ã€å¯†ç å¤„ç†</h5><ul>
<li>æ•°æ®åº“ä¸­å­˜å‚¨çš„æ˜¯åŠ å¯†åçš„å¯†ç ï¼Œæ¡†æ¶è‡ªåŠ¨ä½¿ç”¨ <code>PasswordEncoder</code> å¯¹æ¯”è¡¨å•æ˜æ–‡å¯†ç ä¸æ•°æ®åº“å¯†æ–‡å¯†ç </li>
<li>è§’è‰²é…ç½®æ—¶ï¼Œ<code>roles()</code> æ–¹æ³•è‡ªåŠ¨ä¸ºè§’è‰²æ·»åŠ  <code>ROLE_</code> å‰ç¼€ï¼Œä¸ <code>hasRole()</code> å¯¹åº”ï¼›<code>authorities()</code> æ–¹æ³•ç›´æ¥æŒ‡å®šæƒé™ / è§’è‰²ï¼ˆéœ€æ‰‹åŠ¨åŠ  <code>ROLE_</code> å‰ç¼€ï¼‰</li>
</ul>
<h5 id="3ã€å®‰å…¨è¿‡æ»¤é“¾"><a href="#3ã€å®‰å…¨è¿‡æ»¤é“¾" class="headerlink" title="3ã€å®‰å…¨è¿‡æ»¤é“¾"></a>3ã€å®‰å…¨è¿‡æ»¤é“¾</h5><ul>
<li><code>SecurityWebFilterChain</code>ï¼šWebFlux å“åº”å¼ç¯å¢ƒä¸‹çš„å®‰å…¨é…ç½®æ ¸å¿ƒï¼Œæ›¿ä»£ä¼ ç»Ÿ Servlet ç¯å¢ƒçš„ <code>SecurityFilterChain</code></li>
<li>é…ç½®é™æ€èµ„æºæ”¾è¡Œã€è¡¨å•ç™»å½•ã€CSRF å…³é—­ç­‰è§„åˆ™ï¼Œå®šä¹‰èµ„æºè®¿é—®æƒé™</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://oyy0v0.top">oyy0v0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://oyy0v0.top/2025/12/14/2025-12-14%20SpringBoot3/">https://oyy0v0.top/2025/12/14/2025-12-14%20SpringBoot3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://oyy0v0.top" target="_blank">oyy0v0ğŸ˜¼</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring%E5%85%A8%E5%AE%B6%E6%A1%B6/">-Springå…¨å®¶æ¡¶</a></div><div class="post_share"><div class="social-share" data-image="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/12/16/2025-12-16%20Java%E6%B3%A8%E8%A7%A3/" title="Javaæ³¨è§£"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Javaæ³¨è§£</div></div></a></div><div class="next-post pull-right"><a href="/2025/12/03/2025-12-03%20Redis%E9%AB%98%E7%BA%A7%E7%AF%87/" title="redis é«˜çº§ç¯‡"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">redis é«˜çº§ç¯‡</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2025/10/12/2025-10-13%20mybatis%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86/" title="Mybatisçš„æ‰§è¡ŒåŸç†"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-12</div><div class="title">Mybatisçš„æ‰§è¡ŒåŸç†</div></div></a></div><div><a href="/2024/08/07/2024-8-7%20Springboot/" title="Springboot"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-07</div><div class="title">Springboot</div></div></a></div><div><a href="/2024/07/20/2025-10-20%20Mybatis/" title="Mybatis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-20</div><div class="title">Mybatis</div></div></a></div><div><a href="/2025/10/23/2025-10-23%20Spring/" title="Spring"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-23</div><div class="title">Spring</div></div></a></div><div><a href="/2025/10/30/2025-10-30%20Spring%E6%89%A9%E5%B1%95%E7%82%B9%E6%A1%88%E4%BE%8B/" title="Springæ‰©å±•ç‚¹æ¡ˆä¾‹"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-30</div><div class="title">Springæ‰©å±•ç‚¹æ¡ˆä¾‹</div></div></a></div><div><a href="/2025/11/23/2025-11-22%20Spring%E6%94%B6%E5%BD%95%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Springé¢è¯•"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-23</div><div class="title">Springé¢è¯•</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/7.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">oyy0v0</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/oyy0v0"><i class="fab fa-github"></i><span>ğŸ’•å‰å¾€å°å®¶</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/assets/QRCode.jpg" target="_blank" title="icon-weixin"><i class="å¾®ä¿¡" style="color: faa-tada;"></i></a><a class="social-icon" href="https://github.com/oyy0v0" target="_blank" title="icon-github"><i class="Github" style="color: faa-tade;"></i></a><a class="social-icon" href="mailto:2925886492@qq.com" target="_blank" title="icon-youxiang"><i class="QQé‚®ç®±" style="color: faa-tada;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥æ¥åˆ°æˆ‘çš„åšå®¢</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot3"><span class="toc-text">SpringBoot3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-text">å‰ç½®çŸ¥è¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot3%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="toc-text">SpringBoot3æ ¸å¿ƒç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-text">1ã€å¿«é€Ÿå…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SpringBoot%E4%B8%A4%E4%B8%AA%E6%9C%BA%E5%88%B6"><span class="toc-text">SpringBootä¸¤ä¸ªæœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6"><span class="toc-text">1ã€ä¾èµ–ç®¡ç†æœºåˆ¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%9C%BA%E5%88%B6"><span class="toc-text">2ã€è‡ªåŠ¨é…ç½®æœºåˆ¶</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%8A%80%E8%83%BD"><span class="toc-text">æ ¸å¿ƒæŠ€èƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E7%BB%84%E4%BB%B6%E6%B3%A8%E5%86%8C"><span class="toc-text">1ã€ç»„ä»¶æ³¨å†Œ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%9D%A1%E4%BB%B6%E6%B3%A8%E8%A7%A3"><span class="toc-text">2ã€æ¡ä»¶æ³¨è§£</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%B1%9E%E6%80%A7%E7%BB%91%E5%AE%9A"><span class="toc-text">3ã€å±æ€§ç»‘å®š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Springboot%E5%AF%BC%E5%85%A5%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B"><span class="toc-text">Springbootå¯¼å…¥å®Œæ•´æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AF%BC%E5%85%A5starter-web%EF%BC%9A%E5%AF%BC%E5%85%A5%E4%BA%86web%E5%BC%80%E5%8F%91%E5%9C%BA%E6%99%AF"><span class="toc-text">1ã€å¯¼å…¥starter-webï¼šå¯¼å…¥äº†webå¼€å‘åœºæ™¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E4%B8%BB%E7%A8%8B%E5%BA%8F%EF%BC%9A-SpringBootApplication"><span class="toc-text">2ã€ä¸»ç¨‹åºï¼š@SpringBootApplication</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-text">3ã€è‡ªåŠ¨é…ç½®ç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%86%99%E4%B8%9A%E5%8A%A1%EF%BC%8C%E5%85%A8%E7%A8%8B%E6%97%A0%E9%9C%80%E5%85%B3%E5%BF%83%E5%90%84%E7%A7%8D%E6%95%B4%E5%90%88%EF%BC%88%E5%BA%95%E5%B1%82%E6%8A%8A%E6%95%B4%E5%90%88%E5%86%99%E5%A5%BD%E4%BA%86%EF%BC%8C%E8%80%8C%E4%B8%94%E4%B9%9F%E7%94%9F%E6%95%88%E4%BA%86%EF%BC%89%E3%80%82"><span class="toc-text">4ã€å†™ä¸šåŠ¡ï¼Œå…¨ç¨‹æ— éœ€å…³å¿ƒå„ç§æ•´åˆï¼ˆåº•å±‚æŠŠæ•´åˆå†™å¥½äº†ï¼Œè€Œä¸”ä¹Ÿç”Ÿæ•ˆäº†ï¼‰ã€‚</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#YAML%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">YAMLé…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="toc-text">æ—¥å¿—é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F"><span class="toc-text">æ—¥å¿—æ ¼å¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E5%88%B0%E4%BD%BF%E7%94%A8"><span class="toc-text">å›å½’åˆ°ä½¿ç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB"><span class="toc-text">æ—¥å¿—çº§åˆ«</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE"><span class="toc-text">è‡ªå®šä¹‰é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E6%97%A5%E5%BF%97%E7%BB%84%E5%90%88"><span class="toc-text">åˆ‡æ¢æ—¥å¿—ç»„åˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Web%E5%BC%80%E5%8F%91"><span class="toc-text">2ã€Webå¼€å‘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81Web%E5%9C%BA%E6%99%AF"><span class="toc-text">1ã€Webåœºæ™¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-text">2ã€é™æ€èµ„æº</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0%E3%80%81%E4%B8%BB%E8%A6%81%E7%A0%94%E7%A9%B6WebMvcConfiguration%E5%8E%9F%E7%90%86"><span class="toc-text">0ã€ä¸»è¦ç ”ç©¶WebMvcConfigurationåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E7%94%9F%E6%95%88%E6%9D%A1%E4%BB%B6"><span class="toc-text">1ã€ç”Ÿæ•ˆæ¡ä»¶</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%95%88%E6%9E%9C"><span class="toc-text">2ã€æ•ˆæœ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81WebMvcConfigurer%E6%8E%A5%E5%8F%A3"><span class="toc-text">3ã€WebMvcConfigureræ¥å£</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4%E3%80%81%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%A7%84%E5%88%99%E6%BA%90%E7%A0%81"><span class="toc-text">4ã€é™æ€èµ„æºè§„åˆ™æºç </span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5%E3%80%81-EnableWebMvcConfiguration-%E6%BA%90%E7%A0%81"><span class="toc-text">5ã€ EnableWebMvcConfiguration æºç </span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AE%B9%E5%99%A8%E4%B8%AD%E6%94%BE%E4%B8%80%E4%B8%AAWebMvcConfigurer%E5%B0%B1%E8%83%BD%E7%94%9F%E6%95%88"><span class="toc-text">6ã€ä¸ºä»€ä¹ˆå®¹å™¨ä¸­æ”¾ä¸€ä¸ªWebMvcConfigurerå°±èƒ½ç”Ÿæ•ˆ</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E9%BB%98%E8%AE%A4%E8%A7%84%E5%88%99"><span class="toc-text">1ã€é»˜è®¤è§„åˆ™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%A7%84%E5%88%99"><span class="toc-text">2ã€è‡ªå®šä¹‰é™æ€èµ„æºè§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="toc-text">1ã€é…ç½®æ–¹å¼</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E4%BB%A3%E7%A0%81%E6%96%B9%E5%BC%8F"><span class="toc-text">2ã€ä»£ç æ–¹å¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E8%B7%AF%E5%BE%84%E5%8C%B9%E9%85%8D"><span class="toc-text">3ã€è·¯å¾„åŒ¹é…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81Ant%E9%A3%8E%E6%A0%BC%E8%B7%AF%E5%BE%84%E7%94%A8%E6%B3%95"><span class="toc-text">1ã€Anté£æ ¼è·¯å¾„ç”¨æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8D%A2"><span class="toc-text">2ã€æ¨¡å¼åˆ‡æ¢</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86"><span class="toc-text">4ã€å†…å®¹åå•†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%A4%9A%E7%AB%AF%E5%86%85%E5%AE%B9%E9%80%82%E9%85%8D"><span class="toc-text">1ã€å¤šç«¯å†…å®¹é€‚é…</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E9%BB%98%E8%AE%A4%E8%A7%84%E5%88%99-1"><span class="toc-text">1ã€é»˜è®¤è§„åˆ™</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="toc-text">2ã€æ•ˆæœæ¼”ç¤º</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E5%BC%80%E5%90%AF%E5%9F%BA%E4%BA%8E%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86"><span class="toc-text">3ã€å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%86%85%E5%AE%B9%E8%BF%94%E5%9B%9E"><span class="toc-text">2ã€è‡ªå®šä¹‰å†…å®¹è¿”å›</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%A2%9E%E5%8A%A0Yaml%E8%BF%94%E5%9B%9E%E6%94%AF%E6%8C%81"><span class="toc-text">1ã€å¢åŠ Yamlè¿”å›æ”¯æŒ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%80%9D%E8%80%83%EF%BC%9A%E5%A6%82%E4%BD%95%E5%A2%9E%E5%8A%A0%E5%85%B6%E4%BB%96"><span class="toc-text">2ã€æ€è€ƒï¼šå¦‚ä½•å¢åŠ å…¶ä»–</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86%E5%8E%9F%E7%90%86-HttpMessageConverter"><span class="toc-text">3ã€å†…å®¹åå•†åŸç†-HttpMessageConverter</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81-ReeponseBody-%E7%94%B1-HttpMessageConverter-%E5%A4%84%E7%90%86"><span class="toc-text">1ã€@ReeponseBody ç”± HttpMessageConverter å¤„ç†</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81HttpMessageConverter-%E4%BC%9A%E5%85%88%E8%BF%9B%E8%A1%8C%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86"><span class="toc-text">2ã€HttpMessageConverter ä¼šå…ˆè¿›è¡Œå†…å®¹åå•†</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81WebMvcAutoConfiguration-%E6%8F%90%E4%BE%9B%E5%87%A0%E7%A7%8D%E9%BB%98%E8%AE%A4-HttpMessageConverters"><span class="toc-text">3ã€WebMvcAutoConfiguration æä¾›å‡ ç§é»˜è®¤ HttpMessageConverters</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4%E3%80%81WebMvcConfigurationSupport"><span class="toc-text">4ã€WebMvcConfigurationSupport</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-text">5ã€æ¨¡æ¿å¼•æ“</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81Thymeleaf%E6%95%B4%E5%90%88"><span class="toc-text">1ã€Thymeleafæ•´åˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-text">2ã€åŸºç¡€è¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E6%A0%B8%E5%BF%83%E7%94%A8%E6%B3%95"><span class="toc-text">1ã€æ ¸å¿ƒç”¨æ³•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E8%AF%AD%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="toc-text">2ã€è¯­æ³•ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E5%B1%9E%E6%80%A7%E8%AE%BE%E7%BD%AE"><span class="toc-text">3ã€å±æ€§è®¾ç½®</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4%E3%80%81%E9%81%8D%E5%8E%86"><span class="toc-text">4ã€éå†</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5%E3%80%81%E5%88%A4%E6%96%AD"><span class="toc-text">5ã€åˆ¤æ–­</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6%E3%80%81%E5%B1%9E%E6%80%A7%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">6ã€å±æ€§ä¼˜å…ˆçº§</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7%E3%80%81%E8%A1%8C%E5%86%85%E5%86%99%E6%B3%95"><span class="toc-text">7ã€è¡Œå†…å†™æ³•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8%E3%80%81%E5%8F%98%E9%87%8F%E9%80%89%E6%8B%A9"><span class="toc-text">8ã€å˜é‡é€‰æ‹©</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9%E3%80%81%E6%A8%A1%E6%9D%BF%E5%B8%83%E5%B1%80"><span class="toc-text">9ã€æ¨¡æ¿å¸ƒå±€</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10%E3%80%81devtools"><span class="toc-text">10ã€devtools</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E5%9B%BD%E9%99%85%E5%8C%96"><span class="toc-text">6ã€å›½é™…åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-text">7ã€é”™è¯¯å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E9%BB%98%E8%AE%A4%E6%9C%BA%E5%88%B6"><span class="toc-text">1ã€é»˜è®¤æœºåˆ¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E5%93%8D%E5%BA%94"><span class="toc-text">2ã€è‡ªå®šä¹‰é”™è¯¯å“åº”</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89json%E5%93%8D%E5%BA%94"><span class="toc-text">1ã€è‡ªå®šä¹‰jsonå“åº”</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E9%9D%A2%E5%93%8D%E5%BA%94"><span class="toc-text">2ã€è‡ªå®šä¹‰é¡µé¢å“åº”</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E6%88%98"><span class="toc-text">3ã€æœ€ä½³å®æˆ˜</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%AE%B9%E5%99%A8"><span class="toc-text">8ã€åµŒå…¥å¼å®¹å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-text">1ã€è‡ªåŠ¨é…ç½®åŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="toc-text">2ã€è‡ªå®šä¹‰</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">3ã€æœ€ä½³å®è·µ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%E3%80%81%E5%85%A8%E9%9D%A2%E6%8E%A5%E7%AE%A1SpringMVC"><span class="toc-text">9ã€å…¨é¢æ¥ç®¡SpringMVC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81WebMvcAutoConfiguration-%E5%88%B0%E5%BA%95%E2%BE%83%E5%8A%A8%E9%85%8D%E7%BD%AE%E4%BA%86%E5%93%AA%E4%BA%9B%E8%A7%84%E5%88%99"><span class="toc-text">1ã€WebMvcAutoConfiguration åˆ°åº•â¾ƒåŠ¨é…ç½®äº†å“ªäº›è§„åˆ™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81-EnableWebMvc-%E7%A6%81%E2%BD%A4%E9%BB%98%E8%AE%A4%E2%BE%8F%E4%B8%BA"><span class="toc-text">2ã€@EnableWebMvc ç¦â½¤é»˜è®¤â¾ä¸º</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E6%88%98"><span class="toc-text">10ã€æœ€ä½³å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-text">ä¸‰ç§æ–¹å¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%A8%A1%E5%BC%8F"><span class="toc-text">ä¸¤ç§æ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11%E3%80%81Web%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-text">11ã€Webæ–°ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81Problemdetails"><span class="toc-text">1ã€Problemdetails</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%87%BD%E6%95%B0%E5%BC%8FWeb"><span class="toc-text">2ã€å‡½æ•°å¼Web</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%9C%BA%E6%99%AF"><span class="toc-text">1ã€åœºæ™¯</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%A0%B8%E5%BF%83%E7%B1%BB"><span class="toc-text">2ã€æ ¸å¿ƒç±»</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E7%A4%BA%E4%BE%8B"><span class="toc-text">3ã€ç¤ºä¾‹</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE"><span class="toc-text">3ã€æ•°æ®è®¿é—®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E5%90%88SSM%E5%9C%BA%E6%99%AF"><span class="toc-text">æ•´åˆSSMåœºæ™¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BASSM%E6%95%B4%E5%90%88%E9%A1%B9%E7%9B%AE"><span class="toc-text">1ã€åˆ›å»ºSSMæ•´åˆé¡¹ç›®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">2ã€é…ç½®æ•°æ®æº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E9%85%8D%E7%BD%AEMyBatis"><span class="toc-text">3ã€é…ç½®MyBatis</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81CRUD%E7%BC%96%E5%86%99"><span class="toc-text">4ã€CRUDç¼–å†™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-text">5ã€è‡ªåŠ¨é…ç½®åŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E5%BF%AB%E9%80%9F%E5%AE%9A%E4%BD%8D%E7%94%9F%E6%95%88%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">6ã€å¿«é€Ÿå®šä½ç”Ÿæ•ˆçš„é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81%E6%95%B4%E5%90%88%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">7ã€æ•´åˆå…¶ä»–æ•°æ®æº</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81Druid%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">1ã€Druidæ•°æ®æº</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%9F%BA%E7%A1%80%E7%89%B9%E6%80%A7"><span class="toc-text">4ã€åŸºç¡€ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81SpringApplication"><span class="toc-text">1ã€SpringApplication</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E8%87%AA%E5%AE%9A%E4%B9%89banner"><span class="toc-text">1.1 è‡ªå®šä¹‰banner</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2%E8%87%AA%E5%AE%9A%E4%B9%89SpringApplication"><span class="toc-text">1.2è‡ªå®šä¹‰SpringApplication</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3FluentBuilder-API"><span class="toc-text">1.3FluentBuilder API</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81Profiles"><span class="toc-text">2ã€Profiles</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1%E4%BD%BF%E7%94%A8"><span class="toc-text">2.1ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-1-%E6%8C%87%E5%AE%9A%E7%8E%AF%E5%A2%83"><span class="toc-text">2.1.1 æŒ‡å®šç¯å¢ƒ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-2-%E6%BF%80%E6%B4%BB%E7%8E%AF%E5%A2%83"><span class="toc-text">2.1.2 æ¿€æ´»ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-3-%E7%8E%AF%E5%A2%83%E5%8C%85%E5%90%AB"><span class="toc-text">2.1.3 ç¯å¢ƒåŒ…å«</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E5%88%B6%E5%AE%9A%E7%8E%AF%E5%A2%83%EF%BC%8C%E4%B8%8D%E7%AE%A1%E4%BD%A0%E6%BF%80%E6%B4%BB%E5%93%AA%E4%B8%AA%E7%8E%AF%E5%A2%83%EF%BC%8C%E8%BF%99%E4%B8%AA%E9%83%BD%E8%A6%81%E6%9C%89-%E6%80%BB%E6%98%AF%E8%A6%81%E7%94%9F%E6%95%88%E7%9A%84"><span class="toc-text">åŒ…å«åˆ¶å®šç¯å¢ƒï¼Œä¸ç®¡ä½ æ¿€æ´»å“ªä¸ªç¯å¢ƒï¼Œè¿™ä¸ªéƒ½è¦æœ‰,æ€»æ˜¯è¦ç”Ÿæ•ˆçš„</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-Profile%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">2.3 Profileé…ç½®æ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E5%A4%96%E9%83%A8%E5%8C%96%E9%85%8D%E7%BD%AE"><span class="toc-text">3ã€å¤–éƒ¨åŒ–é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-%E9%85%8D%E7%BD%AE%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">3.1 é…ç½®ä¼˜å…ˆçº§</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-%E5%A4%96%E9%83%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">3.2 å¤–éƒ¨é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-%E5%AF%BC%E5%85%A5%E9%85%8D%E7%BD%AE"><span class="toc-text">3.3 å¯¼å…¥é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4-%E5%B1%9E%E6%80%A7%E5%8D%A0%E4%BD%8D%E7%AC%A6"><span class="toc-text">3.4 å±æ€§å ä½ç¬¦</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-JUnit5"><span class="toc-text">4ã€å•å…ƒæµ‹è¯•-JUnit5</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-%E6%95%B4%E5%90%88"><span class="toc-text">4.1 æ•´åˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-%E6%B5%8B%E8%AF%95"><span class="toc-text">4.2 æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-0-%E7%BB%84%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-text">4.2.0 ç»„ä»¶æµ‹è¯•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-1-%E6%B3%A8%E8%A7%A3"><span class="toc-text">4.2.1 æ³¨è§£</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-2-%E6%96%AD%E8%A8%80"><span class="toc-text">4.2.2 æ–­è¨€</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-3-%E5%B5%8C%E5%A5%97%E6%B5%8B%E8%AF%95"><span class="toc-text">4.2.3 åµŒå¥—æµ‹è¯•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-4-%E5%8F%82%E6%95%B0%E5%8C%96%E6%B5%8B%E8%AF%95"><span class="toc-text">4.2.4 å‚æ•°åŒ–æµ‹è¯•</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86"><span class="toc-text">5ã€æ ¸å¿ƒåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BA%8B%E4%BB%B6%E5%92%8C%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-text">1ã€äº‹ä»¶å’Œç›‘å¬å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9B%91%E5%90%AC"><span class="toc-text">1ã€ç”Ÿå‘½å‘¨æœŸç›‘å¬</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E7%9B%91%E5%90%AC%E5%99%A8-SpringApplicationRunListener"><span class="toc-text">1ã€ç›‘å¬å™¨-SpringApplicationRunListener</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91%E6%97%B6%E6%9C%BA"><span class="toc-text">2ã€äº‹ä»¶è§¦å‘æ—¶æœº</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%90%84%E7%A7%8D%E5%9B%9E%E8%B0%83%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-text">1ã€å„ç§å›è°ƒç›‘å¬å™¨</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E5%AE%8C%E6%95%B4%E8%A7%A6%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-text">2ã€å®Œæ•´è§¦å‘æµç¨‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81SpringBoot%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91"><span class="toc-text">3ã€SpringBootäº‹ä»¶é©±åŠ¨å¼€å‘</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-text">2ã€è‡ªåŠ¨é…ç½®åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%85%A5%E9%97%A8%E7%90%86%E8%A7%A3"><span class="toc-text">1ã€å…¥é—¨ç†è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%B5%81%E7%A8%8B"><span class="toc-text">1ã€è‡ªåŠ¨é…ç½®æµç¨‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81SPI%E6%9C%BA%E5%88%B6"><span class="toc-text">2ã€SPIæœºåˆ¶</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E5%8A%9F%E8%83%BD%E5%BC%80%E5%85%B3"><span class="toc-text">3ã€åŠŸèƒ½å¼€å…³</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%BF%9B%E9%98%B6%E7%90%86%E8%A7%A3"><span class="toc-text">2ã€è¿›é˜¶ç†è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81-SpringBootApplication"><span class="toc-text">1ã€@SpringBootApplication</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E5%AE%8C%E6%95%B4%E5%90%AF%E5%8A%A8%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="toc-text">2ã€å®Œæ•´å¯åŠ¨åŠ è½½æµç¨‹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89starter"><span class="toc-text">3ã€è‡ªå®šä¹‰starter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E4%B8%9A%E5%8A%A1%E4%BB%A3%E7%A0%81"><span class="toc-text">1ã€ä¸šåŠ¡ä»£ç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%9F%BA%E6%9C%AC%E6%8A%BD%E5%8F%96"><span class="toc-text">2ã€åŸºæœ¬æŠ½å–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8-EnableXxx%E6%9C%BA%E5%88%B6"><span class="toc-text">3ã€ä½¿ç”¨@EnableXxxæœºåˆ¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%AE%8C%E5%85%A8%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">4ã€å®Œå…¨è‡ªåŠ¨é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%A1%88%E4%BE%8B"><span class="toc-text">å®Œæ•´æ¡ˆä¾‹</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot3%E5%9C%BA%E6%99%AF%E6%95%B4%E5%90%88"><span class="toc-text">SpringBoot3åœºæ™¯æ•´åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">ç¯å¢ƒå‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">0 äº‘æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-docker%E5%AE%89%E8%A3%85"><span class="toc-text">1 dockerå®‰è£…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-prometheus-yml"><span class="toc-text">2 prometheus.yml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-docker-compose-yml"><span class="toc-text">3 docker-compose.yml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%AF%E5%8A%A8%E7%8E%AF%E5%A2%83"><span class="toc-text">4 å¯åŠ¨ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E9%AA%8C%E8%AF%81"><span class="toc-text">5 éªŒè¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E6%95%B4%E5%90%88"><span class="toc-text">Redisæ•´åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-text">Redisè‡ªåŠ¨é…ç½®åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6%E5%8C%96"><span class="toc-text">å®šåˆ¶åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E6%9C%BA%E5%88%B6"><span class="toc-text">1ã€åºåˆ—åŒ–æœºåˆ¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81redis%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">2ã€rediså®¢æˆ·ç«¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3"><span class="toc-text">æ¥å£æ–‡æ¡£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OpenAPI-3-%E4%B8%8E-Swagger"><span class="toc-text">OpenAPI 3 ä¸ Swagger</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81OpenAPI-3-%E6%9E%B6%E6%9E%84"><span class="toc-text">1ã€OpenAPI 3 æ¶æ„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E6%95%B4%E5%90%88"><span class="toc-text">2ã€æ•´åˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8"><span class="toc-text">3ã€ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-text">1ã€å¸¸ç”¨æ³¨è§£</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81Docket%E9%85%8D%E7%BD%AE"><span class="toc-text">2ã€Docketé…ç½®</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81OpenAPI%E9%85%8D%E7%BD%AE"><span class="toc-text">3ã€OpenAPIé…ç½®</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8"><span class="toc-text">è¿œç¨‹è°ƒç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WebClient"><span class="toc-text">WebClient</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-Interface"><span class="toc-text">HTTP Interface</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E6%9C%8D%E5%8A%A1"><span class="toc-text">æ¶ˆæ¯æœåŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97-%E5%9C%BA%E6%99%AF"><span class="toc-text">æ¶ˆæ¯é˜Ÿåˆ—-åœºæ™¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%BC%82%E6%AD%A5"><span class="toc-text">1ã€å¼‚æ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E8%80%A6"><span class="toc-text">2ã€è§£è€¦</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%89%8A%E5%B3%B0"><span class="toc-text">3ã€å‰Šå³°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E7%BC%93%E5%86%B2"><span class="toc-text">4ã€ç¼“å†²</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97-Kafka"><span class="toc-text">æ¶ˆæ¯é˜Ÿåˆ—-Kafka</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%B6%88%E6%81%AF%E6%A8%A1%E5%BC%8F"><span class="toc-text">1ã€æ¶ˆæ¯æ¨¡å¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Kafka%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">2ã€Kafkaå·¥ä½œåŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81SpringBoot%E6%95%B4%E5%90%88"><span class="toc-text">3ã€SpringBootæ•´åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-text">è‡ªåŠ¨é…ç½®åŸç†</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"><span class="toc-text">å‘é€æ¶ˆæ¯</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E6%B6%88%E6%81%AF"><span class="toc-text">ç›‘å¬æ¶ˆæ¯</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-text">å°ç»“</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E5%AE%89%E5%85%A8"><span class="toc-text">Webå®‰å…¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Security"><span class="toc-text">Spring Security</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%84"><span class="toc-text">1ã€å®‰å…¨æ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E8%AE%A4%E8%AF%81%EF%BC%9AAuthentication"><span class="toc-text">1ã€è®¤è¯ï¼šAuthentication</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%8E%88%E6%9D%83%EF%BC%9AAuthorization"><span class="toc-text">2ã€æˆæƒï¼šAuthorization</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4"><span class="toc-text">3ã€æ”»å‡»é˜²æŠ¤</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A%E6%9D%83%E9%99%90%E6%A8%A1%E5%9E%8B"><span class="toc-text">æ‰©å±•ï¼šæƒé™æ¨¡å‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Spring-Security%E5%8E%9F%E7%90%86"><span class="toc-text">2ã€Spring SecurityåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E8%BF%87%E6%BB%A4%E5%99%A8%E9%93%BE%E6%9E%B6%E6%9E%84"><span class="toc-text">1ã€è¿‡æ»¤å™¨é“¾æ¶æ„</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81FilterChainProxy"><span class="toc-text">2ã€FilterChainProxy</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81SecurityFilterChain"><span class="toc-text">3ã€SecurityFilterChain</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8-1"><span class="toc-text">3ã€ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81HttpSecurity"><span class="toc-text">1ã€HttpSecurity</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81MethodSecurity"><span class="toc-text">2ã€MethodSecurity</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%AE%9E%E6%88%98"><span class="toc-text">4ã€å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-text">1ã€å¼•å…¥ä¾èµ–</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7"><span class="toc-text">å¯è§‚æµ‹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81SpringBoot-Actuator"><span class="toc-text">1ã€SpringBoot Actuator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-text">å®æˆ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%9C%BA%E6%99%AF%E5%BC%95%E5%85%A5"><span class="toc-text">1ã€åœºæ™¯å¼•å…¥</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E6%9A%B4%E9%9C%B2%E6%8C%87%E6%A0%87"><span class="toc-text">2ã€æš´éœ²æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE"><span class="toc-text">3ã€è®¿é—®æ•°æ®</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Endpoint"><span class="toc-text">Endpoint</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%B8%B8%E7%94%A8%E7%AB%AF%E7%82%B9"><span class="toc-text">1ã€å¸¸ç”¨ç«¯ç‚¹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E5%AE%9A%E5%88%B6%E7%AB%AF%E7%82%B9"><span class="toc-text">2ã€å®šåˆ¶ç«¯ç‚¹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E7%9B%91%E6%8E%A7%E6%A1%88%E4%BE%8B%E8%90%BD%E5%9C%B0"><span class="toc-text">2ã€ç›‘æ§æ¡ˆä¾‹è½åœ°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85-Prometheus-Grafana"><span class="toc-text">1ã€å®‰è£… Prometheus + Grafana</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-text">2ã€å¯¼å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E9%85%8D%E7%BD%AE-Prometheus-%E6%8B%89%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-text">3ã€é…ç½® Prometheus æ‹‰å–æ•°æ®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E9%85%8D%E7%BD%AEGrafana%E7%9B%91%E6%8E%A7%E9%9D%A2%E6%9D%BF"><span class="toc-text">4ã€é…ç½®Grafanaç›‘æ§é¢æ¿</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOT"><span class="toc-text">AOT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AOT-%E4%B8%8E-JIT"><span class="toc-text">AOT ä¸ JIT</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81Complier-%E4%B8%8E-Interpreter"><span class="toc-text">1ã€Complier ä¸ Interpreter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81AOT%E4%B8%8EJIT%E5%AF%B9%E6%AF%94"><span class="toc-text">2ã€AOTä¸JITå¯¹æ¯”</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81JVM%E6%9E%B6%E6%9E%84"><span class="toc-text">3ã€JVMæ¶æ„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81Java%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-text">4ã€Javaçš„æ‰§è¡Œè¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%A4%A7%E6%A6%82%E6%B5%81%E7%A8%8B"><span class="toc-text">1ã€å¤§æ¦‚æµç¨‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E8%AF%A6%E7%BB%86%E6%B5%81%E7%A8%8B"><span class="toc-text">2ã€è¯¦ç»†æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81JVM%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-text">5ã€JVMç¼–è¯‘å™¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E5%88%86%E5%B1%82%E7%BC%96%E8%AF%91"><span class="toc-text">6ã€åˆ†å±‚ç¼–è¯‘</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GraalVM"><span class="toc-text">GraalVM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%9E%B6%E6%9E%84"><span class="toc-text">1ã€æ¶æ„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%AE%89%E8%A3%85"><span class="toc-text">2ã€å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85MicrosoftVisualStudio"><span class="toc-text">1ã€å®‰è£…MicrosoftVisualStudio</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E5%AE%89%E8%A3%85GraalVM"><span class="toc-text">2ã€å®‰è£…GraalVM</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E9%85%8D%E7%BD%AE"><span class="toc-text">3ã€é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-text">3ã€æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-text">1ã€åˆ›å»ºé¡¹ç›®</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E7%BC%96%E8%AF%91%E9%95%9C%E5%83%8F"><span class="toc-text">2ã€ç¼–è¯‘é•œåƒ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81Linux%E5%B9%B3%E5%8F%B0%E6%B5%8B%E8%AF%95"><span class="toc-text">3ã€Linuxå¹³å°æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81SpringBoot%E6%95%B4%E5%90%88"><span class="toc-text">4ã€SpringBootæ•´åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E4%BE%9D%E8%B5%96%E5%AF%BC%E5%85%A5"><span class="toc-text">1ã€ä¾èµ–å¯¼å…¥</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81-%E2%BD%A3%E6%88%90native-image"><span class="toc-text">2ã€ â½£æˆnative-image</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-text">3ã€å¸¸è§é—®é¢˜</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot3-%E6%94%B9%E5%8F%98%E5%92%8C%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-text">SpringBoot3 æ”¹å˜å’Œæ–°ç‰¹æ€§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot3%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">SpringBoot3å“åº”å¼ç¼–ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE-java8%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-text">å‰ç½® java8æ–°ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81Lambda"><span class="toc-text">1ã€Lambda</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81Function"><span class="toc-text">2ã€Function</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81StreamAPI"><span class="toc-text">3ã€StreamAPI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81Reactor%E6%A0%B8%E5%BF%83"><span class="toc-text">1ã€Reactoræ ¸å¿ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81Reactor-Stream"><span class="toc-text">1ã€Reactor-Stream</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81Reactor"><span class="toc-text">2ã€Reactor</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-text">1ã€å¯¼å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%93%8D%E5%BA%94%E5%BC%8F%E5%85%A5%E9%97%A8%EF%BC%8C%E5%9F%BA%E7%A1%80API"><span class="toc-text">2ã€å“åº”å¼å…¥é—¨ï¼ŒåŸºç¡€API</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81subscribe"><span class="toc-text">3ã€subscribe</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B5%81%E7%9A%84%E5%8F%96%E6%B6%88"><span class="toc-text">4ã€æµçš„å–æ¶ˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E8%83%8C%E5%8E%8B%EF%BC%88Backpressure-%EF%BC%89%E5%92%8C%E8%AF%B7%E6%B1%82%E9%87%8D%E5%A1%91%EF%BC%88Reshape-Requests%EF%BC%89"><span class="toc-text">5ã€èƒŒå‹ï¼ˆBackpressure ï¼‰å’Œè¯·æ±‚é‡å¡‘ï¼ˆReshape Requestsï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81buffer-%E7%BC%93%E5%86%B2"><span class="toc-text">1ã€buffer:ç¼“å†²</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81limit%EF%BC%9A%E9%99%90%E6%B5%81"><span class="toc-text">2ã€limitï¼šé™æµ</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97Sink"><span class="toc-text">6ã€ç¼–ç¨‹æ–¹å¼åˆ›å»ºåºåˆ—Sink</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81handle"><span class="toc-text">7ã€handle()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6"><span class="toc-text">8ã€è‡ªå®šä¹‰çº¿ç¨‹è°ƒåº¦</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9%E3%80%81%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-text">9ã€é”™è¯¯å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81Catch-and-return-a-static-defalut-value"><span class="toc-text">1ã€Catch and return a static defalut value</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81Catch-and-execute-an-alternative-path-with-fallback-method"><span class="toc-text">2ã€Catch and execute an alternative path with fallback method</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3%E3%80%81Catch-and-dynamically-compute-a-fallback-value"><span class="toc-text">3ã€Catch and dynamically compute a fallback value</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4%E3%80%81Catch%EF%BC%8Cwrap-to-a-BussinessException%EF%BC%8Cand-re-throw"><span class="toc-text">4ã€Catchï¼Œwrap to a BussinessExceptionï¼Œand re-throw</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5%E3%80%81Catch-log-an-error-specific-message-and-re-throw"><span class="toc-text">5ã€Catch, log an error-specific message, and re-throw.</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6%E3%80%81Use-the-finally-block-to-clean-up-resources-or-a-Java-7-%E2%80%9C-try-with-resource%E2%80%9D-construct"><span class="toc-text">6ã€Use the finally block to clean up resources or a Java 7 â€œ try-with-resourceâ€ construct.</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7%E3%80%81%E5%BF%BD%E7%95%A5%E5%BD%93%E5%89%8D%E5%BC%82%E5%B8%B8%EF%BC%8C%E4%BB%85%E9%80%9A%E7%9F%A5%E8%AE%B0%E5%BD%95%EF%BC%8C%E7%BB%A7%E7%BB%AD%E6%8E%A8%E8%BF%9B"><span class="toc-text">7ã€å¿½ç•¥å½“å‰å¼‚å¸¸ï¼Œä»…é€šçŸ¥è®°å½•ï¼Œç»§ç»­æ¨è¿›</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10%E3%80%81%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="toc-text">10ã€å¸¸ç”¨æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#filter"><span class="toc-text">filter</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#filterMap"><span class="toc-text">filterMap</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#concatMap"><span class="toc-text">concatMap</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#transform"><span class="toc-text">transform</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#empty"><span class="toc-text">empty</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#merge"><span class="toc-text">merge</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#zip"><span class="toc-text">zip</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11%E3%80%81sinks%E3%80%81%E9%87%8D%E8%AF%95%E3%80%81Context%E3%80%81%E9%98%BB%E5%A1%9EAPI"><span class="toc-text">11ã€sinksã€é‡è¯•ã€Contextã€é˜»å¡API</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Spring-Webflux"><span class="toc-text">2ã€Spring Webflux</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0%E3%80%81%E7%BB%84%E4%BB%B6%E5%AF%B9%E6%AF%94"><span class="toc-text">0ã€ç»„ä»¶å¯¹æ¯”</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81WebFlux"><span class="toc-text">1ã€WebFlux</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%BC%95%E5%85%A5"><span class="toc-text">1ã€å¼•å…¥</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Reactor%E6%A0%B8%E5%BF%83"><span class="toc-text">2ã€Reactoræ ¸å¿ƒ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81DispatcherHandler%E5%8E%9F%E7%90%86"><span class="toc-text">3ã€DispatcherHandleråŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B"><span class="toc-text">1ã€è¯·æ±‚å¤„ç†æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-text">4ã€æ³¨è§£å¼€å‘</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E7%9B%AE%E6%A0%87%E6%96%B9%E6%B3%95%E4%BC%A0%E5%8F%82"><span class="toc-text">1ã€ç›®æ ‡æ–¹æ³•ä¼ å‚</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC%E5%86%99%E6%B3%95"><span class="toc-text">2ã€è¿”å›å€¼å†™æ³•</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">5ã€æ–‡ä»¶ä¸Šä¼ </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-text">6ã€é”™è¯¯å¤„ç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7%E3%80%81RequestContext"><span class="toc-text">7ã€RequestContext</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89Flux%E9%85%8D%E7%BD%AE"><span class="toc-text">8ã€è‡ªå®šä¹‰Fluxé…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9%E3%80%81Filter"><span class="toc-text">9ã€Filter</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81R2DBC"><span class="toc-text">3ã€R2DBC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81R2dbc"><span class="toc-text">1ã€R2dbc</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Spring-Data-R2DBC"><span class="toc-text">2ã€Spring Data R2DBC</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#0%E3%80%81%E6%95%B4%E5%90%88"><span class="toc-text">0ã€æ•´åˆ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81%E5%A3%B0%E6%98%8E%E5%BC%8F%E6%8E%A5%E5%8F%A3%EF%BC%9AR2dbcRepository"><span class="toc-text">1ã€å£°æ˜å¼æ¥å£ï¼šR2dbcRepository</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2%E3%80%81%E7%BC%96%E7%A8%8B%E5%BC%8F%E7%BB%84%E4%BB%B6"><span class="toc-text">2ã€ç¼–ç¨‹å¼ç»„ä»¶</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%A1%88%E4%BE%8B%E7%BB%83%E4%B9%A0"><span class="toc-text">3ã€æ¡ˆä¾‹ç»ƒä¹ </span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81Spring-Security-Reactive"><span class="toc-text">4ã€Spring Security Reactive</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E6%95%B4%E5%90%88"><span class="toc-text">1ã€æ•´åˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%B4%E6%98%8E"><span class="toc-text">2ã€æ ¸å¿ƒæ¦‚å¿µè¯´æ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B"><span class="toc-text">åº”ç”¨å®‰å…¨æ ¸å¿ƒèƒ½åŠ›</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RBAC-%E6%9D%83%E9%99%90%E6%A8%A1%E5%9E%8B"><span class="toc-text">RBAC æƒé™æ¨¡å‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E6%A1%86%E6%9E%B6%E6%A0%B8%E5%BF%83%E6%B5%81%E7%A8%8B"><span class="toc-text">æƒé™æ¡†æ¶æ ¸å¿ƒæµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">3ã€ä»£ç å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-text">1ã€å®‰å…¨é…ç½®ç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%94%A8%E6%88%B7%E8%AF%A6%E6%83%85%E6%9C%8D%E5%8A%A1"><span class="toc-text">2ã€è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E6%B5%8B%E8%AF%95%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-text">3ã€æµ‹è¯•æ§åˆ¶å™¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%85%B3%E9%94%AE%E8%AF%B4%E6%98%8E"><span class="toc-text">4ã€å…³é”®è¯´æ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E6%A0%B8%E5%BF%83%E6%B3%A8%E8%A7%A3"><span class="toc-text">1ã€æ ¸å¿ƒæ³¨è§£</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%AF%86%E7%A0%81%E5%A4%84%E7%90%86"><span class="toc-text">2ã€å¯†ç å¤„ç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%AE%89%E5%85%A8%E8%BF%87%E6%BB%A4%E9%93%BE"><span class="toc-text">3ã€å®‰å…¨è¿‡æ»¤é“¾</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2026 By oyy0v0</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.oyy0v0.top/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/cursor.js"></script><script async src="//at.alicdn.com/t/c/font_4658720_723un29n3vn.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg);"> <a class="categoryBar-list-link" href="categories/javaå…¥é—¨/">javaå…¥é—¨</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">java</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg);"> <a class="categoryBar-list-link" href="categories/ç®—æ³•/">ç®—æ³•</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr">ç®—æ³•</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg);"> <a class="categoryBar-list-link" href="categories/åšå®¢/">åšå®¢</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">åšå®¢</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg);"> <a class="categoryBar-list-link" href="categories/AI/">AI</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">AI</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg);"> <a class="categoryBar-list-link" href="categories/GitHub/">GitHub</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">å‰ç«¯</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg);"> <a class="categoryBar-list-link" href="categories/å‰ç«¯/">å‰ç«¯</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">GitHub</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg);"> <a class="categoryBar-list-link" href="categories/é¢è¯•é›†åˆ/">é¢è¯•é›†åˆ</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">å…«è‚¡æ–‡</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg);"> <a class="categoryBar-list-link" href="categories/java/">java</a><span class="categoryBar-list-count">35</span><span class="categoryBar-list-descr">é¢è¯•é›†åˆ</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg);"> <a class="categoryBar-list-link" href="categories/æ“ä½œç³»ç»Ÿ/">æ“ä½œç³»ç»Ÿ</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">Goè¯­è¨€</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg);"> <a class="categoryBar-list-link" href="categories/Goè¯­è¨€/">Goè¯­è¨€</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">Linux</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg);"> <a class="categoryBar-list-link" href="categories/è®¡ç®—æœºç½‘ç»œ/">è®¡ç®—æœºç½‘ç»œ</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">æ“ä½œç³»ç»Ÿ</span></li><li class="categoryBar-list-item" style="background:url(https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg);"> <a class="categoryBar-list-link" href="categories/è¸©å‘æ‚è®°/">è¸©å‘æ‚è®°</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">è®¡ç®—æœºç½‘ç»œ</span></li></ul></div></div>';
      console.log('å·²æŒ‚è½½butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '8b4e8faa226f49ff851d67d0354499b7';
  var gaud_map_key = '85e43a6ba1ebb38fd12b0d8a886ecb9b';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-07-28</span><a class="blog-slider__title" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt="">å…«è‚¡æ–‡é›†åˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/07/28/2025-6-18 å…«è‚¡æ–‡/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-14</span><a class="blog-slider__title" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt="">Javaçº¿ç¨‹æ± çš„åŸç†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/14/2025-10-14 Javaçº¿ç¨‹æ± çš„åŸç†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/29/2024-8-29 Solr/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-29</span><a class="blog-slider__title" href="2024/08/29/2024-8-29 Solr/" alt="">Solr</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/29/2024-8-29 Solr/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-24</span><a class="blog-slider__title" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt="">è™šæ‹Ÿæœº</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/24/2024-8-24 è™šæ‹ŸæœºVMware/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt="">è®¾è®¡æ¨¡å¼</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/11/26/2024-11-26è®¾è®¡æ¨¡å¼/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/11/26/2024-11-22 é¢è¯•/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-11-26</span><a class="blog-slider__title" href="2024/11/26/2024-11-22 é¢è¯•/" alt="">é¢è¯•é›†åˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/11/26/2024-11-22 é¢è¯•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2026/01/06/2026-1-5 SpringCloud/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2026-01-06</span><a class="blog-slider__title" href="2026/01/06/2026-1-5 SpringCloud/" alt="">SpringCloud</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2026/01/06/2026-1-5 SpringCloud/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2026/01/21/2026-1-21 Elasticsearch/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2026-01-21</span><a class="blog-slider__title" href="2026/01/21/2026-1-21 Elasticsearch/" alt="">Elasticsearch</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2026/01/21/2026-1-21 Elasticsearch/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2026/02/05/2026-2-5 SpringSecurity/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2026-02-05</span><a class="blog-slider__title" href="2026/02/05/2026-2-5 SpringSecurity/" alt="">SpringSecurity</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2026/02/05/2026-2-5 SpringSecurity/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2026/01/25/2026-1-25 zookeeper/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2026-01-25</span><a class="blog-slider__title" href="2026/01/25/2026-1-25 zookeeper/" alt="">zookeeper</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2026/01/25/2026-1-25 zookeeper/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt="">å¼€å‘æµç¨‹åŒ–</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-22 å¼€å‘æµç¨‹åŒ–/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt="">Servletå…¥é—¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 Servletå…¥é—¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14 JSP/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14 JSP/" alt="">JSP</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14 JSP/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/14/2025-12-14 SpringBoot3/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-14</span><a class="blog-slider__title" href="2025/12/14/2025-12-14 SpringBoot3/" alt="">Springboot3</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/14/2025-12-14 SpringBoot3/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt="">å¸¸ç”¨æ³¨è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-12 å¸¸ç”¨æ³¨è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/17.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt="">Servletè¿›é˜¶</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-14  Servletè¿›é˜¶/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-03</span><a class="blog-slider__title" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt="">redis é«˜çº§ç¯‡</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/03/2025-12-03 Redisé«˜çº§ç¯‡/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt="">Maven</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 Mavenå®æˆ˜/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2025-11-26 Redis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2025-11-26 Redis/" alt="">redis</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/23/2025-11-26 Redis/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/23/2025-11-23 SpringMVC/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231208202901.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-23</span><a class="blog-slider__title" href="2025/11/23/2025-11-23 SpringMVC/" alt="">SpringMVC</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/23/2025-11-23 SpringMVC/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-23</span><a class="blog-slider__title" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt="">Springé¢è¯•</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/23/2025-11-22 Springæ”¶å½•é¢è¯•é¢˜/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-30</span><a class="blog-slider__title" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt="">Springæ‰©å±•ç‚¹æ¡ˆä¾‹</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/30/2025-10-30 Springæ‰©å±•ç‚¹æ¡ˆä¾‹/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/23/2025-10-23 Spring/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-23</span><a class="blog-slider__title" href="2025/10/23/2025-10-23 Spring/" alt="">Spring</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/23/2025-10-23 Spring/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/28/2025-10-28 JavaEE/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231208202901.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-28</span><a class="blog-slider__title" href="2025/10/28/2025-10-28 JavaEE/" alt="">JavaEE</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/28/2025-10-28 JavaEE/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-22</span><a class="blog-slider__title" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt="">Sentinelé™æµå’Œç†”æ–­</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/22/2025-10-22 Sentinelé™æµå’Œç†”æ–­/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-22</span><a class="blog-slider__title" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt="">Netty</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/22/2025-10-22 Nettyäº†è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/20/2025-10-20 Mybatis/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-20</span><a class="blog-slider__title" href="2024/07/20/2025-10-20 Mybatis/" alt="">Mybatis</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/07/20/2025-10-20 Mybatis/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt="">å›ºå®šæ€è·¯è¯¦è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-9 å›ºå®šæ€è·¯è¯¦è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2025-10-21 Dubbo/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2025-10-21 Dubbo/" alt="">Dubbo</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/14/2025-10-21 Dubbo/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 Springboot/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 Springboot/" alt="">Springboot</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 Springboot/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-12</span><a class="blog-slider__title" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt="">Mybatisçš„æ‰§è¡ŒåŸç†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/12/2025-10-13 mybatisçš„æ‰§è¡ŒåŸç†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/20.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-07</span><a class="blog-slider__title" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt="">è¸©å‘è®°å½•</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/07/2024-8-7 è¸©å‘è®°å½•/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-16</span><a class="blog-slider__title" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt="">å‰ç«¯é€Ÿé€š</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/16/2024-8-16 å‰ç«¯é€Ÿé€š/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-23</span><a class="blog-slider__title" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt="">Nginx+lua+OpenRestyé«˜æ€§èƒ½å®è·µ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/23/2024-8-23 Nginxå’Œluaå’ŒOpenrestyé«˜æ€§èƒ½å®è·µ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231208202901.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-14</span><a class="blog-slider__title" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt="">RPCè¿œç¨‹æœåŠ¡è°ƒç”¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/08/14/2024-8-14 RPCè¿œç¨‹æœåŠ¡è°ƒç”¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-24</span><a class="blog-slider__title" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt="">ç®—æ³•åˆé›†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/06/24/2025-6-24 ç®—æ³•åˆé›†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-10</span><a class="blog-slider__title" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt="">é˜Ÿåˆ—å’Œæ ˆ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/10/2025-3-9 é˜Ÿåˆ—å’Œæ ˆ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/22.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt="">é“¾è¡¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/02/2025-3-2 é“¾è¡¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-11</span><a class="blog-slider__title" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt="">ç®—æ³•é—®é¢˜åˆé›†</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/11/2025-3-11 ç®—æ³•é—®é¢˜åˆé›†/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-16</span><a class="blog-slider__title" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt="">Javaæ³¨è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/12/16/2025-12-16 Javaæ³¨è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-02-23</span><a class="blog-slider__title" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt="">æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/02/23/2025-2-23 æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼ˆç®—æ³•ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-02</span><a class="blog-slider__title" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt="">java8æ–°ç‰¹æ€§</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/03/02/2025-2-25 java8æ–°ç‰¹æ€§/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-07</span><a class="blog-slider__title" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt="">åŠ¨æ€ä»£ç†å’Œåå°„</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/07/2025-11-7 åŠ¨æ€ä»£ç†å’Œåå°„/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-04</span><a class="blog-slider__title" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt="">ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/11/04/2025-11-4 ç®—æ³•ç†è§£ï¼ˆå£è¯­åŒ–ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/12.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-10-20</span><a class="blog-slider__title" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt="">RPCäº†è§£</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2025/10/20/2025-10-20 RPCäº†è§£/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-05-14</span><a class="blog-slider__title" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt="">è®¡ç®—æœºç½‘ç»œ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/05/14/2024-4-29 è®¡ç®—æœºç½‘ç»œ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-15</span><a class="blog-slider__title" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt="">æ•°æ®åº“</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/15/2024-4-15 æ•°æ®åº“/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/07/13/2024-7-2 Vue2/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-13</span><a class="blog-slider__title" href="2024/07/13/2024-7-2 Vue2/" alt="">Vue2</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/07/13/2024-7-2 Vue2/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/13.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-28</span><a class="blog-slider__title" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt="">Goè¯­è¨€</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/28/2024-4-28 goè¯­è¨€/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/10.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt="">æ“ä½œç³»ç»Ÿ</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/18/2024-4-20 æ“ä½œç³»ç»Ÿ/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2024/04/18/2024-4-18 JDBC/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-18</span><a class="blog-slider__title" href="2024/04/18/2024-4-18 JDBC/" alt="">JDBC</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2024/04/18/2024-4-18 JDBC/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/07/06/2023-7-1Javaå°è®°/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/14.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-07-06</span><a class="blog-slider__title" href="2023/07/06/2023-7-1Javaå°è®°/" alt="">Javaå°è®°</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/07/06/2023-7-1Javaå°è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/6.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-18</span><a class="blog-slider__title" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt="">å‰ç«¯å°è®°</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/12/18/2023-12-18 å‰ç«¯å°è®°/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-06-23</span><a class="blog-slider__title" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt="">Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/06/23/2023-6-24Gitå’ŒGithubä½¿ç”¨æ•™ç¨‹/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-15</span><a class="blog-slider__title" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt="">AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/08/15/2023-8-15 AIå¤ä»¤è¥å¤©æ°”é¢„æŠ¥å¤§èµ›/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/3.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-12</span><a class="blog-slider__title" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt="">å»ºç«‹åšå®¢</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/12/12/2023-12-11 å»ºç«‹åšå®¢ä¿å§†æ•™ç¨‹ï¼ˆ1ï¼‰/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-08</span><a class="blog-slider__title" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt="">å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2023/05/08/2023-5-8å“ˆå¸Œè¡¨å’Œæœ‰åºè¡¨/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://oyy0v0pic.oss-cn-guangzhou.aliyuncs.com/15.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-27</span><a class="blog-slider__title" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt="">javaseå…¥é—¨ï¼ˆæšä¸¾1ï¼‰</a><div class="blog-slider__text">çŸ¥è¯†åˆ†äº«</div><a class="blog-slider__button" href="2022/11/27/2022-11-27 æšä¸¾ç±»/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯æ‰˜ç®¡äº4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/about/'|| '/about/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://github-api.oyy0v0.top//api?oyy0v0",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'oyy0v0')
    }
  </script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>